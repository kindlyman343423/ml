// ml@v0.3.8, MIT licensed. https://github.com/mljs/ml
!function(r){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=r();else if("function"==typeof define&&define.amd)define([],r);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.ML=r()}}(function(){var define,module,exports;return function r(t,n,e){function i(s,a){if(!n[s]){if(!t[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(o)return o(s,!0);var f=new Error("Cannot find module '"+s+"'");throw f.code="MODULE_NOT_FOUND",f}var c=n[s]={exports:{}};t[s][0].call(c.exports,function(r){var n=t[s][1][r];return i(n?n:r)},c,c.exports,r,t,n,e)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<e.length;s++)i(e[s]);return i}({1:[function(r,t,n){var e=n.Math={};e.Matrix=n.Matrix=r("ml-matrix"),e.Distance=r("ml-distance"),e.SG=r("ml-savitzky-golay");var i=n.Stat={};i.array=r("ml-stat/array"),i.matrix=r("ml-stat/matrix");var o=n.SL={};o.SVM=r("ml-svm");var s=n.Clust={};s.kmeans=r("ml-kmeans"),s.hclust=r("ml-hclust");var a=n.NN=n.nn={};a.SOM=r("ml-som");n.ArrayUtils=n.AU=r("ml-array-utils")},{"ml-array-utils":13,"ml-distance":67,"ml-hclust":70,"ml-kmeans":71,"ml-matrix":80,"ml-savitzky-golay":83,"ml-som":84,"ml-stat/array":87,"ml-stat/matrix":89,"ml-svm":90}],2:[function(r,t){"use strict";function n(r){if(!(this instanceof n))return new n(r);if(r=e.checkMatrix(r),!r.isSymmetric())throw new Error("Matrix is not symmetric");var t,i,o,s=r,a=s.rows,u=new e(a,a),f=!0;for(i=0;a>i;i++){var c=u[i],h=0;for(o=0;i>o;o++){var m=u[o],l=0;for(t=0;o>t;t++)l+=m[t]*c[t];c[o]=l=(s[i][o]-l)/u[o][o],h+=l*l}for(h=s[i][i]-h,f&=h>0,u[i][i]=Math.sqrt(Math.max(h,0)),o=i+1;a>o;o++)u[i][o]=0}if(!f)throw new Error("Matrix is not positive definite");this.L=u}var e=r("../matrix");n.prototype={get leftTriangularFactor(){return this.L},solve:function(r){r=e.checkMatrix(r);var t=this.L,n=t.rows;if(r.rows!==n)throw new Error("Matrix dimensions do not match");var i,o,s,a=r.columns,u=r.clone();for(s=0;n>s;s++)for(o=0;a>o;o++){for(i=0;s>i;i++)u[s][o]-=u[i][o]*t[s][i];u[s][o]/=t[s][s]}for(s=n-1;s>=0;s--)for(o=0;a>o;o++){for(i=s+1;n>i;i++)u[s][o]-=u[i][o]*t[i][s];u[s][o]/=t[s][s]}return u}},t.exports=n},{"../matrix":10}],3:[function(r,t){"use strict";function n(r){if(!(this instanceof n))return new n(r);if(r=u.checkMatrix(r),!r.isSquare())throw new Error("Matrix is not a square matrix");var t,a,f=r.columns,c=u.zeros(f,f),h=new Array(f),m=new Array(f),l=r;if(r.isSymmetric()){for(t=0;f>t;t++)for(a=0;f>a;a++)c[t][a]=l[t][a];e(f,m,h,c),i(f,m,h,c)}else{var p=u.zeros(f,f),d=new Array(f);for(a=0;f>a;a++)for(t=0;f>t;t++)p[t][a]=l[t][a];o(f,p,d,c),s(f,m,h,c,p)}this.n=f,this.e=m,this.d=h,this.V=c}function e(r,t,n,e){var i,o,s,a,u,f,c,h;for(u=0;r>u;u++)n[u]=e[r-1][u];for(a=r-1;a>0;a--){for(h=0,s=0,f=0;a>f;f++)h+=Math.abs(n[f]);if(0===h)for(t[a]=n[a-1],u=0;a>u;u++)n[u]=e[a-1][u],e[a][u]=0,e[u][a]=0;else{for(f=0;a>f;f++)n[f]/=h,s+=n[f]*n[f];for(i=n[a-1],o=Math.sqrt(s),i>0&&(o=-o),t[a]=h*o,s-=i*o,n[a-1]=i-o,u=0;a>u;u++)t[u]=0;for(u=0;a>u;u++){for(i=n[u],e[u][a]=i,o=t[u]+e[u][u]*i,f=u+1;a-1>=f;f++)o+=e[f][u]*n[f],t[f]+=e[f][u]*i;t[u]=o}for(i=0,u=0;a>u;u++)t[u]/=s,i+=t[u]*n[u];for(c=i/(s+s),u=0;a>u;u++)t[u]-=c*n[u];for(u=0;a>u;u++){for(i=n[u],o=t[u],f=u;a-1>=f;f++)e[f][u]-=i*t[f]+o*n[f];n[u]=e[a-1][u],e[a][u]=0}}n[a]=s}for(a=0;r-1>a;a++){if(e[r-1][a]=e[a][a],e[a][a]=1,s=n[a+1],0!==s){for(f=0;a>=f;f++)n[f]=e[f][a+1]/s;for(u=0;a>=u;u++){for(o=0,f=0;a>=f;f++)o+=e[f][a+1]*e[f][u];for(f=0;a>=f;f++)e[f][u]-=o*n[f]}}for(f=0;a>=f;f++)e[f][a+1]=0}for(u=0;r>u;u++)n[u]=e[r-1][u],e[r-1][u]=0;e[r-1][r-1]=1,t[0]=0}function i(r,t,n,e){var i,o,s,a,u,c,h,m,l,p,d,g,v,y,w,x,M;for(s=1;r>s;s++)t[s-1]=t[s];t[r-1]=0;var b=0,k=0,A=Math.pow(2,-52);for(c=0;r>c;c++){for(k=Math.max(k,Math.abs(n[c])+Math.abs(t[c])),h=c;r>h&&!(Math.abs(t[h])<=A*k);)h++;if(h>c){M=0;do{for(M+=1,i=n[c],m=(n[c+1]-i)/(2*t[c]),l=f(m,1),0>m&&(l=-l),n[c]=t[c]/(m+l),n[c+1]=t[c]*(m+l),p=n[c+1],o=i-n[c],s=c+2;r>s;s++)n[s]-=o;for(b+=o,m=n[h],d=1,g=d,v=d,y=t[c+1],w=0,x=0,s=h-1;s>=c;s--)for(v=g,g=d,x=w,i=d*t[s],o=d*m,l=f(m,t[s]),t[s+1]=w*l,w=t[s]/l,d=m/l,m=d*n[s]-w*i,n[s+1]=o+w*(d*i+w*n[s]),u=0;r>u;u++)o=e[u][s+1],e[u][s+1]=w*e[u][s]+d*o,e[u][s]=d*e[u][s]-w*o;m=-w*x*v*y*t[c]/p,t[c]=w*m,n[c]=d*m}while(Math.abs(t[c])>A*k)}n[c]=n[c]+b,t[c]=0}for(s=0;r-1>s;s++){for(u=s,m=n[s],a=s+1;r>a;a++)n[a]<m&&(u=a,m=n[a]);if(u!==s)for(n[u]=n[s],n[s]=m,a=0;r>a;a++)m=e[a][s],e[a][s]=e[a][u],e[a][u]=m}}function o(r,t,n,e){var i,o,s,a,u,f,c,h=0,m=r-1;for(f=h+1;m-1>=f;f++){for(c=0,a=f;m>=a;a++)c+=Math.abs(t[a][f-1]);if(0!==c){for(s=0,a=m;a>=f;a--)n[a]=t[a][f-1]/c,s+=n[a]*n[a];for(o=Math.sqrt(s),n[f]>0&&(o=-o),s-=n[f]*o,n[f]=n[f]-o,u=f;r>u;u++){for(i=0,a=m;a>=f;a--)i+=n[a]*t[a][u];for(i/=s,a=f;m>=a;a++)t[a][u]-=i*n[a]}for(a=0;m>=a;a++){for(i=0,u=m;u>=f;u--)i+=n[u]*t[a][u];for(i/=s,u=f;m>=u;u++)t[a][u]-=i*n[u]}n[f]=c*n[f],t[f][f-1]=c*o}}for(a=0;r>a;a++)for(u=0;r>u;u++)e[a][u]=a===u?1:0;for(f=m-1;f>=h+1;f--)if(0!==t[f][f-1]){for(a=f+1;m>=a;a++)n[a]=t[a][f-1];for(u=f;m>=u;u++){for(o=0,a=f;m>=a;a++)o+=n[a]*e[a][u];for(o=o/n[f]/t[f][f-1],a=f;m>=a;a++)e[a][u]+=o*n[a]}}}function s(r,t,n,e,i){var o,s,u,f,c,h,m,l,p,d,g,v,y,w,x,M=r-1,b=0,k=r-1,A=Math.pow(2,-52),S=0,j=0,R=0,q=0,T=0,V=0,D=0,C=0;for(o=0;r>o;o++)for((b>o||o>k)&&(n[o]=i[o][o],t[o]=0),s=Math.max(o-1,0);r>s;s++)j+=Math.abs(i[o][s]);for(;M>=b;){for(f=M;f>b&&(V=Math.abs(i[f-1][f-1])+Math.abs(i[f][f]),0===V&&(V=j),!(Math.abs(i[f][f-1])<A*V));)f--;if(f===M)i[M][M]=i[M][M]+S,n[M]=i[M][M],t[M]=0,M--,C=0;else if(f===M-1){if(m=i[M][M-1]*i[M-1][M],R=(i[M-1][M-1]-i[M][M])/2,q=R*R+m,D=Math.sqrt(Math.abs(q)),i[M][M]=i[M][M]+S,i[M-1][M-1]=i[M-1][M-1]+S,l=i[M][M],q>=0){for(D=R>=0?R+D:R-D,n[M-1]=l+D,n[M]=n[M-1],0!==D&&(n[M]=l-m/D),t[M-1]=0,t[M]=0,l=i[M][M-1],V=Math.abs(l)+Math.abs(D),R=l/V,q=D/V,T=Math.sqrt(R*R+q*q),R/=T,q/=T,s=M-1;r>s;s++)D=i[M-1][s],i[M-1][s]=q*D+R*i[M][s],i[M][s]=q*i[M][s]-R*D;for(o=0;M>=o;o++)D=i[o][M-1],i[o][M-1]=q*D+R*i[o][M],i[o][M]=q*i[o][M]-R*D;for(o=b;k>=o;o++)D=e[o][M-1],e[o][M-1]=q*D+R*e[o][M],e[o][M]=q*e[o][M]-R*D}else n[M-1]=l+R,n[M]=l+R,t[M-1]=D,t[M]=-D;M-=2,C=0}else{if(l=i[M][M],p=0,m=0,M>f&&(p=i[M-1][M-1],m=i[M][M-1]*i[M-1][M]),10===C){for(S+=l,o=b;M>=o;o++)i[o][o]-=l;V=Math.abs(i[M][M-1])+Math.abs(i[M-1][M-2]),l=p=.75*V,m=-.4375*V*V}if(30===C&&(V=(p-l)/2,V=V*V+m,V>0)){for(V=Math.sqrt(V),l>p&&(V=-V),V=l-m/((p-l)/2+V),o=b;M>=o;o++)i[o][o]-=V;S+=V,l=p=m=.964}for(C+=1,c=M-2;c>=f&&(D=i[c][c],T=l-D,V=p-D,R=(T*V-m)/i[c+1][c]+i[c][c+1],q=i[c+1][c+1]-D-T-V,T=i[c+2][c+1],V=Math.abs(R)+Math.abs(q)+Math.abs(T),R/=V,q/=V,T/=V,c!==f)&&!(Math.abs(i[c][c-1])*(Math.abs(q)+Math.abs(T))<A*Math.abs(R)*(Math.abs(i[c-1][c-1])+Math.abs(D)+Math.abs(i[c+1][c+1])));)c--;for(o=c+2;M>=o;o++)i[o][o-2]=0,o>c+2&&(i[o][o-3]=0);for(u=c;M-1>=u&&(w=u!==M-1,u!==c&&(R=i[u][u-1],q=i[u+1][u-1],T=w?i[u+2][u-1]:0,l=Math.abs(R)+Math.abs(q)+Math.abs(T),0!==l&&(R/=l,q/=l,T/=l)),0!==l);u++)if(V=Math.sqrt(R*R+q*q+T*T),0>R&&(V=-V),0!==V){for(u!==c?i[u][u-1]=-V*l:f!==c&&(i[u][u-1]=-i[u][u-1]),R+=V,l=R/V,p=q/V,D=T/V,q/=R,T/=R,s=u;r>s;s++)R=i[u][s]+q*i[u+1][s],w&&(R+=T*i[u+2][s],i[u+2][s]=i[u+2][s]-R*D),i[u][s]=i[u][s]-R*l,i[u+1][s]=i[u+1][s]-R*p;for(o=0;o<=Math.min(M,u+3);o++)R=l*i[o][u]+p*i[o][u+1],w&&(R+=D*i[o][u+2],i[o][u+2]=i[o][u+2]-R*T),i[o][u]=i[o][u]-R,i[o][u+1]=i[o][u+1]-R*q;for(o=b;k>=o;o++)R=l*e[o][u]+p*e[o][u+1],w&&(R+=D*e[o][u+2],e[o][u+2]=e[o][u+2]-R*T),e[o][u]=e[o][u]-R,e[o][u+1]=e[o][u+1]-R*q}}}if(0!==j){for(M=r-1;M>=0;M--)if(R=n[M],q=t[M],0===q)for(f=M,i[M][M]=1,o=M-1;o>=0;o--){for(m=i[o][o]-R,T=0,s=f;M>=s;s++)T+=i[o][s]*i[s][M];if(t[o]<0)D=m,V=T;else if(f=o,0===t[o]?i[o][M]=0!==m?-T/m:-T/(A*j):(l=i[o][o+1],p=i[o+1][o],q=(n[o]-R)*(n[o]-R)+t[o]*t[o],h=(l*V-D*T)/q,i[o][M]=h,i[o+1][M]=Math.abs(l)>Math.abs(D)?(-T-m*h)/l:(-V-p*h)/D),h=Math.abs(i[o][M]),A*h*h>1)for(s=o;M>=s;s++)i[s][M]=i[s][M]/h}else if(0>q)for(f=M-1,Math.abs(i[M][M-1])>Math.abs(i[M-1][M])?(i[M-1][M-1]=q/i[M][M-1],i[M-1][M]=-(i[M][M]-R)/i[M][M-1]):(x=a(0,-i[M-1][M],i[M-1][M-1]-R,q),i[M-1][M-1]=x[0],i[M-1][M]=x[1]),i[M][M-1]=0,i[M][M]=1,o=M-2;o>=0;o--){for(d=0,g=0,s=f;M>=s;s++)d+=i[o][s]*i[s][M-1],g+=i[o][s]*i[s][M];if(m=i[o][o]-R,t[o]<0)D=m,T=d,V=g;else if(f=o,0===t[o]?(x=a(-d,-g,m,q),i[o][M-1]=x[0],i[o][M]=x[1]):(l=i[o][o+1],p=i[o+1][o],v=(n[o]-R)*(n[o]-R)+t[o]*t[o]-q*q,y=2*(n[o]-R)*q,0===v&&0===y&&(v=A*j*(Math.abs(m)+Math.abs(q)+Math.abs(l)+Math.abs(p)+Math.abs(D))),x=a(l*T-D*d+q*g,l*V-D*g-q*d,v,y),i[o][M-1]=x[0],i[o][M]=x[1],Math.abs(l)>Math.abs(D)+Math.abs(q)?(i[o+1][M-1]=(-d-m*i[o][M-1]+q*i[o][M])/l,i[o+1][M]=(-g-m*i[o][M]-q*i[o][M-1])/l):(x=a(-T-p*i[o][M-1],-V-p*i[o][M],D,q),i[o+1][M-1]=x[0],i[o+1][M]=x[1])),h=Math.max(Math.abs(i[o][M-1]),Math.abs(i[o][M])),A*h*h>1)for(s=o;M>=s;s++)i[s][M-1]=i[s][M-1]/h,i[s][M]=i[s][M]/h}for(o=0;r>o;o++)if(b>o||o>k)for(s=o;r>s;s++)e[o][s]=i[o][s];for(s=r-1;s>=b;s--)for(o=b;k>=o;o++){for(D=0,u=b;u<=Math.min(s,k);u++)D+=e[o][u]*i[u][s];e[o][s]=D}}}function a(r,t,n,e){var i,o;return Math.abs(n)>Math.abs(e)?(i=e/n,o=n+i*e,[(r+i*t)/o,(t-i*r)/o]):(i=n/e,o=e+i*n,[(i*r+t)/o,(i*t-r)/o])}var u=r("../matrix"),f=r("./util").hypotenuse;n.prototype={get realEigenvalues(){return this.d},get imaginaryEigenvalues(){return this.e},get eigenvectorMatrix(){return this.V},get diagonalMatrix(){var r,t,n=this.n,e=this.e,i=this.d,o=new u(n,n);for(r=0;n>r;r++){for(t=0;n>t;t++)o[r][t]=0;o[r][r]=i[r],e[r]>0?o[r][r+1]=e[r]:e[r]<0&&(o[r][r-1]=e[r])}return o}},t.exports=n},{"../matrix":10,"./util":7}],4:[function(r,t){"use strict";function n(r){if(!(this instanceof n))return new n(r);r=e.checkMatrix(r);var t,i,o,s,a,u,f,c,h,m,l=r.clone(),p=l.rows,d=l.columns,g=new Array(p),v=1;for(t=0;p>t;t++)g[t]=t;for(h=new Array(p),i=0;d>i;i++){for(t=0;p>t;t++)h[t]=l[t][i];for(t=0;p>t;t++){for(c=l[t],m=Math.min(t,i),a=0,o=0;m>o;o++)a+=c[o]*h[o];c[i]=h[t]-=a}for(s=i,t=i+1;p>t;t++)Math.abs(h[t])>Math.abs(h[s])&&(s=t);if(s!==i){for(o=0;d>o;o++)u=l[s][o],l[s][o]=l[i][o],l[i][o]=u;f=g[s],g[s]=g[i],g[i]=f,v=-v}if(p>i&&0!==l[i][i])for(t=i+1;p>t;t++)l[t][i]/=l[i][i]}this.LU=l,this.pivotVector=g,this.pivotSign=v}var e=r("../matrix");n.prototype={isSingular:function(){for(var r=this.LU,t=r.columns,n=0;t>n;n++)if(0===r[n][n])return!0;return!1},get determinant(){var r=this.LU;if(!r.isSquare())throw new Error("Matrix must be square");for(var t=this.pivotSign,n=r.columns,e=0;n>e;e++)t*=r[e][e];return t},get lowerTriangularFactor(){for(var r=this.LU,t=r.rows,n=r.columns,i=new e(t,n),o=0;t>o;o++)for(var s=0;n>s;s++)i[o][s]=o>s?r[o][s]:o===s?1:0;return i},get upperTriangularFactor(){for(var r=this.LU,t=r.rows,n=r.columns,i=new e(t,n),o=0;t>o;o++)for(var s=0;n>s;s++)i[o][s]=s>=o?r[o][s]:0;return i},get pivotPermutationVector(){return this.pivotVector.slice()},solve:function(r){r=e.checkMatrix(r);var t=this.LU,n=t.rows;if(n!==r.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");var i,o,s,a=r.columns,u=r.subMatrixRow(this.pivotVector,0,a-1),f=t.columns;for(s=0;f>s;s++)for(i=s+1;f>i;i++)for(o=0;a>o;o++)u[i][o]-=u[s][o]*t[i][s];for(s=f-1;s>=0;s--){for(o=0;a>o;o++)u[s][o]/=t[s][s];for(i=0;s>i;i++)for(o=0;a>o;o++)u[i][o]-=u[s][o]*t[i][s]}return u}},t.exports=n},{"../matrix":10}],5:[function(r,t){"use strict";function n(r){if(!(this instanceof n))return new n(r);r=e.checkMatrix(r);var t,o,s,a,u=r.clone(),f=r.rows,c=r.columns,h=new Array(c);for(s=0;c>s;s++){var m=0;for(t=s;f>t;t++)m=i(m,u[t][s]);if(0!==m){for(u[s][s]<0&&(m=-m),t=s;f>t;t++)u[t][s]/=m;for(u[s][s]+=1,o=s+1;c>o;o++){for(a=0,t=s;f>t;t++)a+=u[t][s]*u[t][o];for(a=-a/u[s][s],t=s;f>t;t++)u[t][o]+=a*u[t][s]}}h[s]=-m}this.QR=u,this.Rdiag=h}var e=r("../matrix"),i=r("./util").hypotenuse;n.prototype={solve:function(r){r=e.checkMatrix(r);var t=this.QR,n=t.rows;if(r.rows!==n)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");var i,o,s,a,u=r.columns,f=r.clone(),c=t.columns;for(s=0;c>s;s++)for(o=0;u>o;o++){for(a=0,i=s;n>i;i++)a+=t[i][s]*f[i][o];for(a=-a/t[s][s],i=s;n>i;i++)f[i][o]+=a*t[i][s]}for(s=c-1;s>=0;s--){for(o=0;u>o;o++)f[s][o]/=this.Rdiag[s];for(i=0;s>i;i++)for(o=0;u>o;o++)f[i][o]-=f[s][o]*t[i][s]}return f.subMatrix(0,c-1,0,u-1)},isFullRank:function(){for(var r=this.QR.columns,t=0;r>t;t++)if(0===this.Rdiag[t])return!1;return!0},get upperTriangularFactor(){var r,t,n=this.QR,i=n.columns,o=new e(i,i);for(r=0;i>r;r++)for(t=0;i>t;t++)o[r][t]=t>r?n[r][t]:r===t?this.Rdiag[r]:0;return o},get orthogonalFactor(){var r,t,n,i,o=this.QR,s=o.rows,a=o.columns,u=new e(s,a);for(n=a-1;n>=0;n--){for(r=0;s>r;r++)u[r][n]=0;for(u[n][n]=1,t=n;a>t;t++)if(0!==o[n][n]){for(i=0,r=n;s>r;r++)i+=o[r][n]*u[r][t];for(i=-i/o[n][n],r=n;s>r;r++)u[r][t]+=i*o[r][n]}}return u}},t.exports=n},{"../matrix":10,"./util":7}],6:[function(r,t){"use strict";function n(r,t){if(!(this instanceof n))return new n(r,t);r=e.checkMatrix(r),t=t||{};var o=r.clone(),s=r.rows,a=r.columns,u=Math.min(s,a),f=!0,c=!0;t.computeLeftSingularVectors===!1&&(f=!1),t.computeRightSingularVectors===!1&&(c=!1);var h=t.autoTranspose===!0,m=!1;if(a>s)if(h){o=o.transpose(),s=o.rows,a=o.columns,m=!0;var l=f;f=c,c=l}else console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");var p,d,g,v,y,w,x,M,b,k,A,S,j,R,q,T,V,D,C,O,E,z=new Array(Math.min(s+1,a)),I=e.zeros(s,u),_=e.zeros(a,a),P=new Array(a),N=new Array(s),L=Math.min(s-1,a),U=Math.max(0,Math.min(a-2,s));for(g=0,k=Math.max(L,U);k>g;g++){if(L>g){for(z[g]=0,p=g;s>p;p++)z[g]=i(z[g],o[p][g]);if(0!==z[g]){for(o[g][g]<0&&(z[g]=-z[g]),p=g;s>p;p++)o[p][g]/=z[g];o[g][g]+=1}z[g]=-z[g]}for(d=g+1;a>d;d++){if(L>g&&0!==z[g]){for(y=0,p=g;s>p;p++)y+=o[p][g]*o[p][d];for(y=-y/o[g][g],p=g;s>p;p++)o[p][d]+=y*o[p][g]}P[d]=o[g][d]}if(f&&L>g)for(p=g;s>p;p++)I[p][g]=o[p][g];if(U>g){for(P[g]=0,p=g+1;a>p;p++)P[g]=i(P[g],P[p]);if(0!==P[g]){for(P[g+1]<0&&(P[g]=-P[g]),p=g+1;a>p;p++)P[p]/=P[g];P[g+1]+=1}if(P[g]=-P[g],s>g+1&&0!==P[g]){for(p=g+1;s>p;p++)N[p]=0;for(d=g+1;a>d;d++)for(p=g+1;s>p;p++)N[p]+=P[d]*o[p][d];for(d=g+1;a>d;d++)for(y=-P[d]/P[g+1],p=g+1;s>p;p++)o[p][d]+=y*N[p]}if(c)for(p=g+1;a>p;p++)_[p][g]=P[p]}}if(v=Math.min(a,s+1),a>L&&(z[L]=o[L][L]),v>s&&(z[v-1]=0),v>U+1&&(P[U]=o[U][v-1]),P[v-1]=0,f){for(d=L;u>d;d++){for(p=0;s>p;p++)I[p][d]=0;I[d][d]=1}for(g=L-1;g>=0;g--)if(0!==z[g]){for(d=g+1;u>d;d++){for(y=0,p=g;s>p;p++)y+=I[p][g]*I[p][d];for(y=-y/I[g][g],p=g;s>p;p++)I[p][d]+=y*I[p][g]}for(p=g;s>p;p++)I[p][g]=-I[p][g];for(I[g][g]=1+I[g][g],p=0;g-1>p;p++)I[p][g]=0}else{for(p=0;s>p;p++)I[p][g]=0;I[g][g]=1}}if(c)for(g=a-1;g>=0;g--){if(U>g&&0!==P[g])for(d=g+1;a>d;d++){for(y=0,p=g+1;a>p;p++)y+=_[p][g]*_[p][d];for(y=-y/_[g+1][g],p=g+1;a>p;p++)_[p][d]+=y*_[p][g]}for(p=0;a>p;p++)_[p][g]=0;_[g][g]=1}for(var F=v-1,B=0,X=Math.pow(2,-52);v>0;){for(g=v-2;g>=-1&&-1!==g;g--)if(Math.abs(P[g])<=X*(Math.abs(z[g])+Math.abs(z[g+1]))){P[g]=0;break}if(g===v-2)A=4;else{for(w=v-1;w>=g&&w!==g;w--)if(y=(w!==v?Math.abs(P[w]):0)+(w!==g+1?Math.abs(P[w-1]):0),Math.abs(z[w])<=X*y){z[w]=0;break}w===g?A=3:w===v-1?A=1:(A=2,g=w)}switch(g++,A){case 1:for(x=P[v-2],P[v-2]=0,d=v-2;d>=g;d--)if(y=i(z[d],x),M=z[d]/y,b=x/y,z[d]=y,d!==g&&(x=-b*P[d-1],P[d-1]=M*P[d-1]),c)for(p=0;a>p;p++)y=M*_[p][d]+b*_[p][v-1],_[p][v-1]=-b*_[p][d]+M*_[p][v-1],_[p][d]=y;break;case 2:for(x=P[g-1],P[g-1]=0,d=g;v>d;d++)if(y=i(z[d],x),M=z[d]/y,b=x/y,z[d]=y,x=-b*P[d],P[d]=M*P[d],f)for(p=0;s>p;p++)y=M*I[p][d]+b*I[p][g-1],I[p][g-1]=-b*I[p][d]+M*I[p][g-1],I[p][d]=y;break;case 3:for(S=Math.max(Math.max(Math.max(Math.max(Math.abs(z[v-1]),Math.abs(z[v-2])),Math.abs(P[v-2])),Math.abs(z[g])),Math.abs(P[g])),j=z[v-1]/S,R=z[v-2]/S,q=P[v-2]/S,T=z[g]/S,V=P[g]/S,D=((R+j)*(R-j)+q*q)/2,C=j*q*j*q,O=0,(0!==D||0!==C)&&(O=Math.sqrt(D*D+C),0>D&&(O=-O),O=C/(D+O)),x=(T+j)*(T-j)+O,E=T*V,d=g;v-1>d;d++){if(y=i(x,E),M=x/y,b=E/y,d!==g&&(P[d-1]=y),x=M*z[d]+b*P[d],P[d]=M*P[d]-b*z[d],E=b*z[d+1],z[d+1]=M*z[d+1],c)for(p=0;a>p;p++)y=M*_[p][d]+b*_[p][d+1],_[p][d+1]=-b*_[p][d]+M*_[p][d+1],_[p][d]=y;if(y=i(x,E),M=x/y,b=E/y,z[d]=y,x=M*P[d]+b*z[d+1],z[d+1]=-b*P[d]+M*z[d+1],E=b*P[d+1],P[d+1]=M*P[d+1],f&&s-1>d)for(p=0;s>p;p++)y=M*I[p][d]+b*I[p][d+1],I[p][d+1]=-b*I[p][d]+M*I[p][d+1],I[p][d]=y}P[v-2]=x,B+=1;break;case 4:if(z[g]<=0&&(z[g]=z[g]<0?-z[g]:0,c))for(p=0;F>=p;p++)_[p][g]=-_[p][g];for(;F>g&&!(z[g]>=z[g+1]);){if(y=z[g],z[g]=z[g+1],z[g+1]=y,c&&a-1>g)for(p=0;a>p;p++)y=_[p][g+1],_[p][g+1]=_[p][g],_[p][g]=y;if(f&&s-1>g)for(p=0;s>p;p++)y=I[p][g+1],I[p][g+1]=I[p][g],I[p][g]=y;g++}B=0,v--}}if(m){var Q=_;_=I,I=Q}this.m=s,this.n=a,this.s=z,this.U=I,this.V=_}var e=r("../matrix"),i=r("./util").hypotenuse;n.prototype={get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]},get norm2(){return this.s[0]},get rank(){for(var r=Math.pow(2,-52),t=Math.max(this.m,this.n)*this.s[0]*r,n=0,e=this.s,i=0,o=e.length;o>i;i++)e[i]>t&&n++;return n},get diagonal(){return this.s},get threshold(){return Math.pow(2,-52)/2*Math.max(this.m,this.n)*this.s[0]},get leftSingularVectors(){return this.U},get rightSingularVectors(){return this.V},get diagonalMatrix(){return e.diag(this.s)},solve:function(r){var t,n=r,i=this.threshold,o=this.s.length,s=e.zeros(o,o);for(t=0;o>t;t++)s[t][t]=Math.abs(this.s[t])<=i?0:1/this.s[t];var a,u,f,c=this.V.mmul(s),h=this.V.rows,m=this.U.rows,l=e.zeros(h,m);for(t=0;h>t;t++)for(a=0;m>a;a++){for(f=0,u=0;o>u;u++)f+=c[t][u]*this.U[a][u];l[t][a]=f}return l.mmul(n)},solveForDiagonal:function(r){return this.solve(e.diag(r))},inverse:function(){var r,t,n=this.threshold,i=this.V.rows,o=this.V.columns,s=new e(i,this.s.length);for(r=0;i>r;r++)for(t=0;o>t;t++)s[r][t]=Math.abs(this.s[t])>n?this.V[r][t]/this.s[t]:0;var a,u,f=this.U.rows,c=this.U.columns,h=new e(i,f);for(r=0;i>r;r++)for(t=0;f>t;t++){for(u=0,a=0;c>a;a++)u+=s[r][a]*this.U[t][a];h[r][t]=u}return h}},t.exports=n},{"../matrix":10,"./util":7}],7:[function(r,t,n){"use strict";n.hypotenuse=function(r,t){var n;return Math.abs(r)>Math.abs(t)?(n=t/r,Math.abs(r)*Math.sqrt(1+n*n)):0!==t?(n=r/t,Math.abs(t)*Math.sqrt(1+n*n)):0}},{}],8:[function(r,t){"use strict";function n(r){return e(r,i.eye(r.rows))}function e(r,t){return r.isSquare()?new a(r).solve(t):new u(r).solve(t)}var i=r("./matrix"),o=r("./dc/svd"),s=r("./dc/evd"),a=r("./dc/lu"),u=r("./dc/qr"),f=r("./dc/cholesky");i.prototype.inverse=function(){return n(this)},i.prototype.solve=function(r){return e(this,r)},t.exports={SingularValueDecomposition:o,SVD:o,EigenvalueDecomposition:s,EVD:s,LuDecomposition:a,LU:a,QrDecomposition:u,QR:u,CholeskyDecomposition:f,CHO:f,inverse:n,solve:e}},{"./dc/cholesky":2,"./dc/evd":3,"./dc/lu":4,"./dc/qr":5,"./dc/svd":6,"./matrix":10}],9:[function(r,t){"use strict";t.exports=r("./matrix"),t.exports.Decompositions=t.exports.DC=r("./decompositions")},{"./decompositions":8,"./matrix":10}],10:[function(r,t){"use strict";function n(r){for(var t=0,n=r.length,e=new Array(n);n>t;t++)e[t]=r[t];return e}function e(r,t){var i,o,s=0;if(Array.isArray(r)){if(o=t,i=o?n(r):r,r=i.length,t=i[0].length,"undefined"==typeof t)throw new TypeError("Data must be a 2D array");if(!(r>0&&t>0))throw new RangeError("Invalid dimensions: "+r+"x"+t);for(;r>s;s++){if(i[s].length!==t)throw new RangeError("Inconsistent array dimensions");o&&(i[s]=n(i[s]))}}else{if("number"!=typeof r)throw new TypeError("Invalid arguments");if(!(r>0&&t>0))throw new RangeError("Invalid dimensions: "+r+"x"+t);for(i=new Array(r);r>s;s++)i[s]=new Array(t)}return Object.defineProperty(i,"rows",{writable:!0,value:r}),Object.defineProperty(i,"columns",{writable:!0,value:t}),i.__proto__=e.prototype,i}var i=Array.prototype.splice,o=Array.prototype.concat;e.from1DArray=function(r,t,n){var i,o,s=0;if(i=r*t,i!==n.length)throw new RangeError("Data length does not match given dimensions");for(o=new Array(r);r>s;s++)o[s]=n.slice(s*t,(s+1)*t);return new e(o)},e.rowVector=function(r){return new e([r])},e.columnVector=function(r){for(var t=r.length,n=new Array(t),i=0;t>i;i++)n[i]=[r[i]];return new e(n)},e.empty=function(r,t){return new e(r,t)},e.zeros=function(r,t){return e.empty(r,t).fill(0)},e.ones=function(r,t){return e.empty(r,t).fill(1)},e.rand=function(r,t){for(var n=e.empty(r,t),i=0,o=n.rows;o>i;i++)for(var s=0,a=n.columns;a>s;s++)n[i][s]=Math.random();return n},e.eye=function(r){for(var t=e.zeros(r,r),n=t.rows,i=0;n>i;i++)t[i][i]=1;return t},e.diag=function(r){for(var t=r.length,n=e.zeros(t,t),i=0;t>i;i++)n[i][i]=r[i];return n},e.indices=function(r,t){for(var n=new Array(t-r),e=0;e<n.length;e++)n[e]=r++;return n},e.stack=function(r){var t,n,i;if(e.isMatrix(r)){var o=0,s=0;for(t=0;t<arguments.length;t++)o+=arguments[t].rows,arguments[t].columns>s&&(s=arguments[t].columns);var a=e.zeros(o,s),u=0;for(t=0;t<arguments.length;t++){var f=arguments[t];for(n=0;n<f.rows;n++){for(i=0;i<f.columns;i++)a[u][i]=f[n][i];u++}}return a}if(Array.isArray(r)){var c=e.empty(arguments.length,r.length);for(t=0;t<arguments.length;t++)c.setRow(t,arguments[t]);return c}},e.expand=function(r,t){for(var n=[],i=0;i<t.length;i++)for(var o=0;o<t[i];o++)n.push(r[i]);return new e(n)},e.checkMatrix=function(r){if(!r)throw new TypeError("Argument has to be a matrix");return"Matrix"!==r.klass&&(r=new e(r)),r},e.isMatrix=function(r){return r?"Matrix"===r.klass:!1},Object.defineProperty(e.prototype,"klass",{get:function(){return"Matrix"}}),Object.defineProperty(e.prototype,"size",{get:function(){return this.rows*this.columns}}),e.prototype.checkRowIndex=function(r){if(0>r||r>this.rows-1)throw new RangeError("Row index out of range.")},e.prototype.checkColumnIndex=function(r){if(0>r||r>this.columns-1)throw new RangeError("Column index out of range.")},e.prototype.checkDimensions=function(r){if(this.rows!==r.rows||this.columns!==r.columns)throw new RangeError("Matrices dimensions must be equal.")},e.prototype.apply=function(r){for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)r.call(this,e,i);return this},e.prototype.clone=function(){return new e(this.to2DArray())},e.prototype.to1DArray=function(){return o.apply([],this)},e.prototype.to2DArray=function(){for(var r=this.rows,t=new Array(r),e=0;r>e;e++)t[e]=n(this[e]);return t},e.prototype.isRowVector=function(){return 1===this.rows},e.prototype.isColumnVector=function(){return 1===this.columns},e.prototype.isVector=function(){return 1===this.rows||1===this.columns},e.prototype.isSquare=function(){return this.rows===this.columns},e.prototype.isSymmetric=function(){if(this.isSquare()){for(var r=this.rows,t=0;r>t;t++)for(var n=0;t>=n;n++)if(this[t][n]!==this[n][t])return!1;return!0}return!1},e.prototype.set=function(r,t,n){return this[r][t]=n,this},e.prototype.get=function(r,t){return this[r][t]},e.prototype.fill=function(r){for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]=r;return this},e.prototype.neg=function(){return this.mulS(-1)},e.prototype.add=function(r){return"number"==typeof r?this.addS(r):(r=e.checkMatrix(r),this.addM(r))},e.prototype.addS=function(r){for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]+=r;return this},e.prototype.addM=function(r){this.checkDimensions(r);for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]+=r[e][i];return this},e.prototype.sub=function(r){return"number"==typeof r?this.subS(r):(r=e.checkMatrix(r),this.subM(r))},e.prototype.subS=function(r){for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]-=r;return this},e.prototype.subM=function(r){this.checkDimensions(r);for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]-=r[e][i];return this},e.prototype.mul=function(r){return"number"==typeof r?this.mulS(r):(r=e.checkMatrix(r),this.mulM(r))},e.prototype.mulS=function(r){for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]*=r;return this},e.prototype.mulM=function(r){this.checkDimensions(r);for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]*=r[e][i];return this},e.prototype.div=function(r){return"number"==typeof r?this.divS(r):(r=e.checkMatrix(r),this.divM(r))},e.prototype.divS=function(r){for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]/=r;return this},e.prototype.divM=function(r){this.checkDimensions(r);for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]/=r[e][i];return this},e.prototype.getRow=function(r){return this.checkRowIndex(r),n(this[r])},e.prototype.getRowVector=function(r){return e.rowVector(this.getRow(r))},e.prototype.setRow=function(r,t){if(this.checkRowIndex(r),e.isMatrix(t)&&(t=t.to1DArray()),t.length!==this.columns)throw new RangeError("Invalid row size");return this[r]=n(t),this},e.prototype.removeRow=function(r){if(this.checkRowIndex(r),1===this.rows)throw new RangeError("A matrix cannot have less than one row");return i.call(this,r,1),this.rows-=1,this},e.prototype.addRow=function(r,t){if("undefined"==typeof t&&(t=r,r=this.rows),0>r||r>this.rows)throw new RangeError("Row index out of range.");if(e.isMatrix(t)&&(t=t.to1DArray()),t.length!==this.columns)throw new RangeError("Invalid row size");return i.call(this,r,0,n(t)),this.rows+=1,this},e.prototype.swapRows=function(r,t){this.checkRowIndex(r),this.checkRowIndex(t);var n=this[r];return this[r]=this[t],this[t]=n,this},e.prototype.getColumn=function(r){this.checkColumnIndex(r);for(var t=this.rows,n=new Array(t),e=0;t>e;e++)n[e]=this[e][r];return n},e.prototype.getColumnVector=function(r){return e.columnVector(this.getColumn(r))},e.prototype.setColumn=function(r,t){this.checkColumnIndex(r),e.isMatrix(t)&&(t=t.to1DArray());var n=this.rows;if(t.length!==n)throw new RangeError("Invalid column size");for(var i=0;n>i;i++)this[i][r]=t[i];return this},e.prototype.removeColumn=function(r){if(this.checkColumnIndex(r),1===this.columns)throw new RangeError("A matrix cannot have less than one column");for(var t=0,n=this.rows;n>t;t++)this[t].splice(r,1);return this.columns-=1,this},e.prototype.addColumn=function(r,t){if("undefined"==typeof t&&(t=r,r=this.columns),0>r||r>this.columns)throw new RangeError("Column index out of range.");e.isMatrix(t)&&(t=t.to1DArray());var n=this.rows;if(t.length!==n)throw new RangeError("Invalid column size");for(var i=0;n>i;i++)this[i].splice(r,0,t[i]);return this.columns+=1,this},e.prototype.swapColumns=function(r,t){this.checkRowIndex(r),this.checkRowIndex(t);for(var n,e,i=this.rows,o=0;i>o;o++)e=this[o],n=e[r],e[r]=e[t],e[t]=n;return this},e.prototype.checkRowVector=function(r){if(e.isMatrix(r)&&(r=r.to1DArray()),r.length!==this.columns)throw new RangeError("vector size must be the same as the number of columns");return r},e.prototype.checkColumnVector=function(r){if(e.isMatrix(r)&&(r=r.to1DArray()),r.length!==this.rows)throw new RangeError("vector size must be the same as the number of rows");return r},e.prototype.addRowVector=function(r){r=this.checkRowVector(r);for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]+=r[i];return this},e.prototype.subRowVector=function(r){r=this.checkRowVector(r);for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]-=r[i];return this},e.prototype.mulRowVector=function(r){r=this.checkRowVector(r);for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]*=r[i];return this},e.prototype.divRowVector=function(r){r=this.checkRowVector(r);for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]/=r[i];return this},e.prototype.addColumnVector=function(r){r=this.checkColumnVector(r);for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]+=r[e];return this},e.prototype.subColumnVector=function(r){r=this.checkColumnVector(r);for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]-=r[e];return this},e.prototype.mulColumnVector=function(r){r=this.checkColumnVector(r);for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]*=r[e];return this},e.prototype.divColumnVector=function(r){r=this.checkColumnVector(r);for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]/=r[e];return this},e.prototype.mulRow=function(r,t){this.checkRowIndex(r);for(var n=0,e=this.columns;e>n;n++)this[r][n]*=t;return this},e.prototype.mulColumn=function(r,t){this.checkColumnIndex(r);for(var n=0,e=this.rows;e>n;n++)this[n][r]*=t},e.prototype.max=function(){for(var r=-1/0,t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]>r&&(r=this[e][i]);return r},e.prototype.maxIndex=function(){for(var r=-1/0,t={},n=this.rows,e=this.columns,i=0;n>i;i++)for(var o=0;e>o;o++)this[i][o]>r&&(r=this[i][o],t.row=i,t.column=o);return t},e.prototype.min=function(){for(var r=1/0,t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]<r&&(r=this[e][i]);return r},e.prototype.minIndex=function(){for(var r=1/0,t={},n=this.rows,e=this.columns,i=0;n>i;i++)for(var o=0;e>o;o++)this[i][o]<r&&(r=this[i][o],t.row=i,t.column=o);return t},e.prototype.maxRow=function(r){this.checkRowIndex(r);for(var t=-1/0,n=0,e=this.columns;e>n;n++)this[r][n]>t&&(t=this[r][n]);return t},e.prototype.maxRowIndex=function(r){this.checkRowIndex(r);for(var t=-1/0,n={row:r},e=0,i=this.columns;i>e;e++)this[r][e]>t&&(t=this[r][e],n.column=e);return n},e.prototype.minRow=function(r){this.checkRowIndex(r);for(var t=1/0,n=0,e=this.columns;e>n;n++)this[r][n]<t&&(t=this[r][n]);return t},e.prototype.minRowIndex=function(r){this.checkRowIndex(r);for(var t=1/0,n={row:r,column:0},e=0,i=this.columns;i>e;e++)this[r][e]<t&&(t=this[r][e],n.column=e);return n},e.prototype.maxColumn=function(r){this.checkColumnIndex(r);for(var t=-1/0,n=0,e=this.rows;e>n;n++)this[n][r]>t&&(t=this[n][r]);return t},e.prototype.maxColumnIndex=function(r){this.checkColumnIndex(r);for(var t=-1/0,n={row:0,column:r},e=0,i=this.rows;i>e;e++)this[e][r]>t&&(t=this[e][r],n.row=e);return n},e.prototype.minColumn=function(r){this.checkColumnIndex(r);for(var t=1/0,n=0,e=this.rows;e>n;n++)this[n][r]<t&&(t=this[n][r]);return t},e.prototype.minColumnIndex=function(r){this.checkColumnIndex(r);for(var t=1/0,n={row:0,column:r},e=0,i=this.rows;i>e;e++)this[e][r]<t&&(t=this[e][r],n.row=e);return n},e.prototype.diag=function s(){if(!this.isSquare())throw new TypeError("Only square matrices have a diagonal.");for(var s=new Array(this.rows),r=0,t=this.rows;t>r;r++)s[r]=this[r][r];return s},e.prototype.sum=function(){for(var r=0,t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)r+=this[e][i];return r},e.prototype.mean=function(){return this.sum()/this.size},e.prototype.prod=function a(){for(var a=1,r=this.rows,t=this.columns,n=0;r>n;n++)for(var e=0;t>e;e++)a*=this[n][e];return a},e.prototype.cumulativeSum=function(){for(var r=0,t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)r+=this[e][i],this[e][i]=r;return this},e.prototype.dot=function u(r){if(this.size!==r.size)throw new RangeError("vectors do not have the same size");for(var t=this.to1DArray(),n=r.to1DArray(),u=0,e=t.length,i=0;e>i;i++)u+=t[i]*n[i];return u},e.prototype.mmul=function(r){if(!e.isMatrix(r))throw new TypeError('parameter "other" must be a matrix');this.columns!==r.rows&&console.warn("Number of columns of left matrix are not equal to number of rows of right matrix.");var t,n,i,o=this.rows,s=this.columns,a=r.columns,u=new e(o,a),f=new Array(s);for(n=0;a>n;n++){for(i=0;s>i;i++)f[i]=r[i][n];for(t=0;o>t;t++){var c=this[t],h=0;for(i=0;s>i;i++)h+=c[i]*f[i];u[t][n]=h}}return u},e.prototype.sortRows=function(r){for(var t=0,n=this.rows;n>t;t++)this[t].sort(r);return this},e.prototype.sortColumns=function(r){for(var t=0,n=this.columns;n>t;t++)this.setColumn(t,this.getColumn(t).sort(r));return this},e.prototype.transpose=function(){for(var r=new e(this.columns,this.rows),t=this.rows,n=this.columns,i=0;t>i;i++)for(var o=0;n>o;o++)r[o][i]=this[i][o];return r},e.prototype.subMatrix=function(r,t,n,i){if(r>t||n>i||0>r||r>=this.rows||0>t||t>=this.rows||0>n||n>=this.columns||0>i||i>=this.columns)throw new RangeError("Argument out of range");for(var o=new e(t-r+1,i-n+1),s=r;t>=s;s++)for(var a=n;i>=a;a++)o[s-r][a-n]=this[s][a];return o},e.prototype.subMatrixRow=function(r,t,n){if("undefined"==typeof t?(t=0,n=this.columns-1):"undefined"==typeof n&&(n=this.columns-1),t>n||0>t||t>=this.columns||0>n||n>=this.columns)throw new RangeError("Argument out of range.");
for(var i=r.length,o=this.rows,s=new e(i,n-t+1),a=0;i>a;a++)for(var u=t;n>=u;u++){if(r[a]<0||r[a]>=o)throw new RangeError("Argument out of range.");s[a][u-t]=this[r[a]][u]}return s},e.prototype.subMatrixColumn=function(r,t,n){if("undefined"==typeof t?(t=0,n=this.rows-1):"undefined"==typeof n&&(n=this.rows-1),t>n||0>t||t>=this.rows||0>n||n>=this.rows)throw new RangeError("Argument out of range.");for(var i=r.length,o=this.columns,s=new e(n-t+1,i),a=0;i>a;a++)for(var u=t;n>=u;u++){if(r[a]<0||r[a]>=o)throw new RangeError("Argument out of range.");s[u-t][a]=this[u][r[a]]}return s},e.prototype.trace=function f(){if(!this.isSquare())throw new TypeError("The matrix is not square");for(var f=0,r=0,t=this.rows;t>r;r++)f+=this[r][r];return f},e.prototype.abs=function(){for(var r=this.rows,t=this.columns,n=0;r>n;n++)for(var e=0;t>e;e++)this[n][e]=Math.abs(this[n][e])},t.exports=e},{}],11:[function(r,t){"use strict";function n(r,t){if(r.length%t!==0)throw new RangeError("Dimensions number must be accordance with the size of the array.");for(var n=r.length/t,e=new Array(n),i=0,o=0;o<r.length;o+=t){for(var s=new Array(t),a=0;t>a;++a)s[a]=r[o+a];e[i]=s,i++}return e}function e(r,t){if(r.length%t!==0)throw new RangeError("Dimensions number must be accordance with the size of the array.");for(var n=new Array(t),e=r.length/t,i=0;i<n.length;i++)n[i]=new Array(e);for(i=0;i<r.length;i+=t)for(var o=0;t>o;++o){var s=Math.floor(i/t);n[o][s]=r[i+o]}return n}function i(r){for(var t=new Array(r.length*r[0].length),n=0,e=0;e<r[0].length;++e)for(var i=0;i<r.length;++i)t[n]=r[i][e],++n;return t}function o(r){for(var t=new Array(r[0].length),n=0;n<t.length;++n)t[n]=new Array(r.length);for(n=0;n<r.length;++n)for(var e=0;e<r[0].length;++e)t[e][n]=r[n][e];return t}function s(r){for(var t=new Array(r.length*r[0].length),n=0,e=0;e<r.length;++e)for(var i=0;i<r[0].length;++i)t[n]=r[e][i],++n;return t}function a(r,t){var n,e;r.length<=t.length?(e=r,n=t):(e=t,n=r);for(var i=n.length-e.length+1,o=new Array(i),s=0;i>s;++s){for(var a=0,u=0;u<e.length;++u)a+=e[u]*n[s+u];o[s]=a}return o}t.exports={coordArrayToPoints:n,coordArrayToCoordMatrix:e,coordMatrixToCoordArray:i,coordMatrixToPoints:o,pointsToCoordArray:s,pointsToCoordMatrix:o,applyDotProduct:a}},{}],12:[function(r,t,n){"use strict";function e(r,t,n){function e(){return"smooth"===l?i(b,A,R,q):k}function o(){R=s(b,k,A,S),q=-R*b+k}function s(r,t,n,e){return(e-t)/(n-r)}var a=r.length;if(r.length!==t.length)throw new RangeError("the x and y vector doesn't have the same size.");void 0===n&&(n={});var u=void 0===n.from?r[0]:n.from,f=void 0===n.to?r[r.length-1]:n.to,c=u>f;if(c){var h=u;u=f,f=h}var m=void 0===n.numberOfPoints?100:n.numberOfPoints;if(1>m)throw new RangeError("the number of point must be higher than 1");var l="slot"===n.variant?"slot":"smooth",p=(f-u)/(m-1),d=p/2,g=u-d,v=new Array(m),y=r[1]-r[0],w=r[r.length-1]-r[r.length-2],x=g,M=g+p,b=-Number.MAX_VALUE,k=0,A=r[0]-y,S=0,j=0,R=0,q=0,T=0,V=0,D=0,C=0,O=0;r:for(;;){for(;A-M>=0;){var E="smooth"===l?i(0,M-b,R,k):k;V=j+E;var z="smooth"===l?p:D-1;if(v[O]=(V-T)/z,O++,O===m)break r;x=M,M+=p,T=V,"slot"===l&&(D=0)}x>=b&&A>=x&&(E="smooth"===l?i(0,x-b,R,k):k,T=j+E,"slot"===l&&D++),j+=e(),0!==D&&D++,b=A,k=S,a>C?(A=r[C],S=t[C],C++):C===a&&(A+=w,S=0),o()}return c?v.reverse():v}function i(r,t,n,e){return.5*n*t*t+e*t-(.5*n*r*r+e*r)}n.getEquallySpacedData=e,n.integral=i},{}],13:[function(r,t,n){t.exports=n=r("./ArrayUtils"),n.getEquallySpacedData=r("./getEquallySpaced").getEquallySpacedData,n.SNV=r("./snv").SNV},{"./ArrayUtils":11,"./getEquallySpaced":12,"./snv":14}],14:[function(r,t,n){"use strict";function e(r){var t=r;o.isMatrix(r)||(t=new o(r).clone());var n=o.columnVector(i.matrix.mean(r,1)),e=o.columnVector(i.matrix.standardDeviation(r.transpose(),n));return t.sub(n.mmul(o.ones(1,t.columns))).divM(e.mmul(o.ones(1,t.columns)))}n.SNV=e;var i=r("ml-stat"),o=r("ml-matrix")},{"ml-matrix":9,"ml-stat":88}],15:[function(r,t){t.exports=function(r,t){for(var n=0,e=r.length,i=0;e>n;n++)i+=(r[n]-t[n])*(r[n]-t[n])*(r[n]+t[n])/(r[n]*t[n]);return 2*i}},{}],16:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0,o=0,s=0;n>s;s++)o=Math.abs(r[s]-t[s]),i+=o,o>e&&(e=o);return(e+i)/2}},{}],17:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0;n>i;i++)e+=Math.sqrt(r[i]*t[i]);return-Math.log(e)}},{}],18:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0;n>i;i++)e+=Math.abs(r[i]-t[i])/(r[i]+t[i]);return e}},{}],19:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0,o=0;n>o;o++)i=Math.abs(r[o]-t[o]),i>e&&(e=i);return e}},{}],20:[function(r,t){t.exports=function(r,t){for(var n=0,e=r.length,i=0;e>n;n++)i+=Math.sqrt((r[n]-t[n])*(r[n]-t[n])/((r[n]+t[n])*(r[n]+t[n])));return 2*i}},{}],21:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0,o=0,s=0;n>s;s++)e+=r[s]*t[s],i+=r[s]*r[s],o+=t[s]*t[s];return e/(Math.sqrt(i)*Math.sqrt(o))}},{}],22:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0,o=0;n>o;o++)e+=Math.min(r[o],t[o]),i+=r[o]+t[o];return 1-2*e/i}},{}],23:[function(r,t){var n=r("./czekanowski");t.exports=function(r,t){return 1-n(r,t)}},{"./czekanowski":22}],24:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0,o=0,s=0;n>s;s++)e+=r[s]*r[s],i+=t[s]*t[s],o+=(r[s]-t[s])*(r[s]-t[s]);return o/(e+i)}},{}],25:[function(r,t){var n=r("./dice");t.exports=function(r,t){return 1-n(r,t)}},{"./dice":24}],26:[function(r,t){t.exports=function(r,t){for(var n=0,e=r.length,i=0;e>n;n++)i+=(r[n]-t[n])*(r[n]-t[n])/((r[n]+t[n])*(r[n]+t[n]));return 2*i}},{}],27:[function(r,t){var n=r("./squared-euclidean");t.exports=function(r,t){return Math.sqrt(n(r,t))}},{"./squared-euclidean":57}],28:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0;n>i;i++)e+=Math.sqrt(r[i]*t[i]);return e}},{}],29:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0;n>i;i++)e+=Math.abs(r[i]-t[i]);return e/n}},{}],30:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0;n>i;i++)e+=r[i]*t[i]/(r[i]+t[i]);return 2*e}},{}],31:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0;n>i;i++)e+=Math.sqrt(r[i]*t[i]);return 2*Math.sqrt(1-e)}},{}],32:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0;n>i;i++)e+=r[i]*t[i];return e}},{}],33:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0;n>i;i++)e+=Math.min(r[i],t[i]);return 1-e}},{}],34:[function(r,t){var n=r("./intersection");t.exports=function(r,t){return 1-n(r,t)}},{"./intersection":33}],35:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0,o=0,s=0,a=0;n>a;a++)e+=r[a]*t[a],i+=r[a]*r[a],o+=t[a]*t[a],s+=(r[a]-t[a])*(r[a]-t[a]);return s/(i+o-e)}},{}],36:[function(r,t){var n=r("./jaccard");t.exports=function(r,t){return 1-n(r,t)}},{"./jaccard":35}],37:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0;n>i;i++)e+=(r[i]-t[i])*Math.log(r[i]/t[i]);return e}},{}],38:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0;n>i;i++)e+=(r[i]*Math.log(r[i])+t[i]*Math.log(t[i]))/2-(r[i]+t[i])/2*Math.log((r[i]+t[i])/2);return e}},{}],39:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0,o=0;n>o;o++)e+=r[o]*Math.log(2*r[o]/(r[o]+t[o])),i+=t[o]*Math.log(2*t[o]/(r[o]+t[o]));return(e+i)/2}},{}],40:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0;n>i;i++)e+=r[i]*Math.log(2*r[i]/(r[i]+t[i]));return e}},{}],41:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0,o=0;n>o;o++)e+=Math.abs(r[o]-t[o]),i+=Math.min(r[o],t[o]);return e/i}},{}],42:[function(r,t){var n=r("./kulczynski");t.exports=function(r,t){return 1/n(r,t)}},{"./kulczynski":41}],43:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0;n>i;i++)e+=r[i]*Math.log(r[i]/t[i]);return e}},{}],44:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0,o=0,s=0;n>s;s++)e+=r[s]*t[s],i+=r[s]*r[s],o+=t[s]*t[s];return e/(i+o-e)}},{}],45:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0;n>i;i++)e+=Math.pow(r[i]*r[i]-t[i]*t[i],2)/(2*Math.pow(r[i]*t[i],1.5));return e}},{}],46:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0;n>i;i++)e+=Math.log(Math.abs(r[i]-t[i])+1);return e}},{}],47:[function(r,t){t.exports=function(r,t){for(var n=0,e=r.length,i=0;e>n;n++)i+=Math.abs(r[n]-t[n]);return i}},{}],48:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0;n>i;i++)e+=Math.sqrt(r[i]*t[i]);return Math.sqrt(2-2*e)}},{}],49:[function(r,t){t.exports=function(r,t,n){for(var e=0,i=r.length,o=0;i>e;e++)o+=Math.pow(Math.abs(r[e]-t[e]),n);return Math.pow(o,1/n)}},{}],50:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0,o=0;n>o;o++)e+=Math.min(r[o],t[o]),i+=r[o]+t[o];return 1-e/i}},{}],51:[function(r,t){t.exports=function(r,t){for(var n=0,e=r.length,i=0;e>n;n++)i+=(r[n]-t[n])*(r[n]-t[n])/r[n];return i}},{}],52:[function(r,t){t.exports=function(r,t){for(var n=0,e=r.length,i=0;e>n;n++)i+=(r[n]-t[n])*(r[n]-t[n])/t[n];return i}},{}],53:[function(r,t){t.exports=function(r,t){for(var n=0,e=r.length,i=0;e>n;n++)i+=(r[n]-t[n])*(r[n]-t[n])/(r[n]+t[n]);return 2*i}},{}],54:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0,o=0;n>o;o++)e+=Math.min(r[o],t[o]),i+=Math.max(r[o],t[o]);return e/i}},{}],55:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0,o=0;n>o;o++)e+=Math.abs(r[o]-t[o]),i+=Math.max(r[o],t[o]);return e/i}},{}],56:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0,o=0;n>o;o++)e+=Math.abs(r[o]-t[o]),i+=r[o]+t[o];return e/i}},{}],57:[function(r,t){t.exports=function(r,t){for(var n=0,e=r.length,i=0;e>n;n++)i+=(r[n]-t[n])*(r[n]-t[n]);return i}},{}],58:[function(r,t){t.exports=function(r,t){for(var n=0,e=r.length,i=0;e>n;n++)i+=(r[n]-t[n])*(r[n]-t[n])/(r[n]+t[n]);return i}},{}],59:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0;n>i;i++)e+=(Math.sqrt(r[i])-Math.sqrt(t[i]))*(Math.sqrt(r[i])-Math.sqrt(t[i]));return e}},{}],60:[function(r,t){var n=r("./squaredChord");t.exports=function(r,t){return 1-n(r,t)}},{"./squaredChord":59}],61:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0;n>i;i++)e+=(r[i]+t[i])/2*Math.log((r[i]+t[i])/(2*Math.sqrt(r[i]*t[i])));return e}},{}],62:[function(r,t){var n=r("./tanimotoS");t.exports=function(r,t,e){if(e=e||!1)return 1-n(r,t,e);for(var i=r.length,o=0,s=0,a=0,u=0;i>u;u++)o+=r[u],s+=t[u],a+=Math.min(r[u],t[u]);return(o+s-2*a)/(o+s-a)}},{"./tanimotoS":63}],63:[function(r,t){t.exports=function(r,t,n){if(n=n||!1){for(var e=0,i=0,o=0;o<r.length;o++)e+=r[o]&&t[o],i+=r[o]||t[o];return 0===i?1:e/i}for(var s=r.length,a=0,u=0,f=0,c=0;s>c;c++)a+=r[c],u+=t[c],f+=Math.min(r[c],t[c]);return 1-(a+u-2*f)/(a+u-f)}},{}],64:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0;n>i;i++)e+=r[i]*Math.log(2*r[i]/(r[i]+t[i]))+t[i]*Math.log(2*t[i]/(r[i]+t[i]));return e}},{}],65:[function(r,t){"use strict";function n(r,t,e,i,o,s){if(o=o||.16,s=s||.01,o>i-e)return void 0;for(var a=0,u=0;r[u]<i;u++)r[u]>e&&(a+=t[u]);if(s>a)return void 0;for(var f=0,c=0;r[c]<i;c++)r[u]>e&&(f+=r[c]*t[c]);return f/=a,1e-5>f-e||1e-5>i-f?void 0:o/4>f-e?n(r,t,f,i,o,s):o/4>i-f?n(r,t,e,f,o,s):{sum:a,center:f,left:n(r,t,e,f,o,s),right:n(r,t,f,i,o,s)}}function e(r,t,n,i,o){if(void 0===r||void 0===t)return 0;var s=n*Math.min(r.sum,t.sum)/Math.max(r.sum,t.sum)+(1-n)*Math.exp(-o*Math.abs(r.center-t.center));return i*s+(1-i)*(e(r.left,t.left,n,i,o)+e(r.right,t.right,n,i,o))}function i(r,t,i,s,a){a=a||{};for(var u in o)a.hasOwnProperty(u)||(a[u]=o[u]);var f,c;return f=r.sum?r:n(r.x,r.y,i,s,a.minWindow,a.threshold),c=t.sum?t:n(t.x,t.y,i,s,a.minWindow,a.threshold),e(f,c,a.alpha,a.beta,a.gamma)}var o={minWindow:.16,threshold:.01,alpha:.1,beta:.33,gamma:.001};t.exports={calc:i,createTree:n}},{}],66:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0;n>i;i++)e+=1-Math.min(r[i],t[i])/Math.max(r[i],t[i]);return e}},{}],67:[function(r,t,n){n.euclidean=r("./dist/euclidean"),n.squaredEuclidean=r("./dist/squared-euclidean"),n.manhattan=r("./dist/manhattan"),n.minkowski=r("./dist/minkowski"),n.chebyshev=r("./dist/chebyshev"),n.sorensen=r("./dist/sorensen"),n.gower=r("./dist/gower"),n.soergel=r("./dist/soergel"),n.kulczynski=r("./dist/kulczynski"),n.kulczynskiS=r("./dist/kulczynskiS"),n.canberra=r("./dist/canberra"),n.lorentzian=r("./dist/lorentzian"),n.intersection=r("./dist/intersection"),n.intersectionS=r("./dist/intersectionS"),n.waveHedges=r("./dist/waveHedges"),n.czekanowski=r("./dist/czekanowski"),n.czekanowskiS=r("./dist/czekanowskiS"),n.motyka=r("./dist/motyka"),n.kulczynskiS=r("./dist/kulczynskiS"),n.ruzicka=r("./dist/ruzicka"),n.tanimoto=r("./dist/tanimoto"),n.tanimotoS=r("./dist/tanimotoS"),n.innerProduct=r("./dist/innerProduct"),n.harmonicMean=r("./dist/harmonicMean"),n.cosine=r("./dist/cosine"),n.kumarHassebrook=r("./dist/kumarHassebrook"),n.jaccard=r("./dist/jaccard"),n.jaccardS=r("./dist/jaccardS"),n.dice=r("./dist/dice"),n.diceS=r("./dist/diceS"),n.fidelity=r("./dist/fidelity"),n.bhattacharyya=r("./dist/bhattacharyya"),n.hellinger=r("./dist/hellinger"),n.matusita=r("./dist/matusita"),n.squaredChord=r("./dist/squaredChord"),n.squaredChordS=r("./dist/squaredChordS"),n.pearson=r("./dist/pearson"),n.neyman=r("./dist/neyman"),n.squared=r("./dist/squared"),n.probabilisticSymmetric=r("./dist/probabilisticSymmetric"),n.divergence=r("./dist/divergence"),n.clark=r("./dist/clark"),n.additiveSymmetric=r("./dist/additiveSymmetric"),n.kullbackLeibler=r("./dist/kullbackLeibler"),n.jeffreys=r("./dist/jeffreys"),n.kdivergence=r("./dist/kdivergence"),n.topsoe=r("./dist/topsoe"),n.jensenShannon=r("./dist/jensenShannon"),n.jensenDifference=r("./dist/jensenDifference"),n.taneja=r("./dist/taneja"),n.kumarJohnson=r("./dist/kumarJohnson"),n.avg=r("./dist/avg"),n.tree=r("./dist/tree")},{"./dist/additiveSymmetric":15,"./dist/avg":16,"./dist/bhattacharyya":17,"./dist/canberra":18,"./dist/chebyshev":19,"./dist/clark":20,"./dist/cosine":21,"./dist/czekanowski":22,"./dist/czekanowskiS":23,"./dist/dice":24,"./dist/diceS":25,"./dist/divergence":26,"./dist/euclidean":27,"./dist/fidelity":28,"./dist/gower":29,"./dist/harmonicMean":30,"./dist/hellinger":31,"./dist/innerProduct":32,"./dist/intersection":33,"./dist/intersectionS":34,"./dist/jaccard":35,"./dist/jaccardS":36,"./dist/jeffreys":37,"./dist/jensenDifference":38,"./dist/jensenShannon":39,"./dist/kdivergence":40,"./dist/kulczynski":41,"./dist/kulczynskiS":42,"./dist/kullbackLeibler":43,"./dist/kumarHassebrook":44,"./dist/kumarJohnson":45,"./dist/lorentzian":46,"./dist/manhattan":47,"./dist/matusita":48,"./dist/minkowski":49,"./dist/motyka":50,"./dist/neyman":51,"./dist/pearson":52,"./dist/probabilisticSymmetric":53,"./dist/ruzicka":54,"./dist/soergel":55,"./dist/sorensen":56,"./dist/squared":58,"./dist/squared-euclidean":57,"./dist/squaredChord":59,"./dist/squaredChordS":60,"./dist/taneja":61,"./dist/tanimoto":62,"./dist/tanimotoS":63,"./dist/topsoe":64,"./dist/tree":65,"./dist/waveHedges":66}],68:[function(r,t){"use strict";function n(r,t){for(var n=0,e=r.length,i=0;e>n;n++)i+=(r[n]-t[n])*(r[n]-t[n]);return Math.sqrt(i)}function e(r){for(var t=r.concat(),n=0;n<t.length;++n)for(var e=n+1;e<t.length;++e)t[n]===t[e]&&t.splice(e--,1);return t}function i(r,t,n){for(var e=1e101,i=0;i<r.length;i++)for(var o=i;o<t.length;o++){var s=n(r[i],t[o]);e=Math.min(s,e)}return e}function o(r,t,n){for(var e=-1,i=0;i<r.length;i++)for(var o=i;o<t.length;o++){var s=n(r[i],t[o]);e=Math.max(s,e)}return e}function s(r,t,n){for(var e=0,i=0;i<r.length;i++)for(var o=0;o<t.length;o++)e+=n(r[i],t[o]);return e/(r.length*t.length)}function a(r,t,n){for(var e=0,i=0,o=0,s=0,a=0;a<r.length;a++)e+=r[a][0],i+=r[a][1];for(var u=0;u<t.length;u++)o+=t[u][0],s+=t[u][1];return e/=r.length,i/=r.length,o/=t.length,s/=t.length,n([e,i],[o,s])}function u(r,t,n){for(var e=0,i=0,o=0,s=0,a=0;a<r.length;a++)e+=r[a][0],i+=r[a][1];for(var u=0;u<t.length;u++)o+=t[u][0],s+=t[u][1];return e/=r.length,i/=r.length,o/=t.length,s/=t.length,n([e,i],[o,s])*r.length*t.length/(r.length+t.length)}function f(r,t){t=t||{},this.options={};for(var n in c)this.options[n]=t.hasOwnProperty(n)?t[n]:c[n];this.len=r.length;for(var f=new Array(this.len),h=0;h<this.len;h++)f[h]=[r[h]];if(r=f.concat(),"string"==typeof this.options.kind)switch(this.options.kind){case"single":this.options.kind=i;break;case"complete":this.options.kind=o;break;case"average":this.options.kind=s;break;case"centroid":this.options.kind=a;break;case"ward":this.options.kind=u;break;default:throw new RangeError("Unknown kind of similarity")}else if("function"!=typeof this.options.kind)throw new TypeError("Undefined kind of similarity");for(var m=new Array(r.length),l=0;l<r.length;l++)m[l]={index:l,dis:void 0,data:r[l].concat(),children:[]};for(var p=1e6,d={},g=0;m.length>1;){d={},p=1e6;for(var v=0;v<m.length;v++)for(var y=v+1;y<m.length;y++)g=this.options.kind(m[v].data,m[y].data,this.options.sim).toFixed(4),g in d?d[g].push([v,y]):d[g]=[[v,y]],p=Math.min(g,p);for(var w,x,M=d[p.toFixed(4)],b=[];M.length>0;){w=M.shift();for(var k=M.length-1;k>=0;k--)x=M[k].filter(function(r){return-1!=w.indexOf(r)}),x.length>0&&(w=e(w.concat(M[k])),k=M.length-1,M.splice(k,1));b.push(w)}for(var A=0;A<b.length;A++){for(var S={dis:void 0,data:void 0,children:[]},j=[],R=0;R<b[A].length;R++){var q=b[A][R];j=j.concat(m[q].data),m[q].dis=p,S.children.push(m[q]),delete m[q]}S.data=j.concat(),m.push(S)}for(var T=0;T<m.length;T++)void 0===m[T]&&(m.splice(T,1),T--)}m[0].dis=0,this.tree=m[0]}var c={sim:n,kind:"single"};f.prototype.getDendogram=function(r){if(r=r||{length:this.len,ND:!0},r.length!==this.len)throw new Error("Invalid input size");for(var t=JSON.parse(JSON.stringify(this.tree)),n=[t];n.length>0;){var e=n.shift();if(1===e.data.length)e.data=r.ND?e.data[0]:r[e.index],delete e.index;else{delete e.data,delete e.index;for(var i=0;i<e.children.length;i++)n.push(e.children[i])}}return t},f.prototype.nClusters=function(r){if(r>=this.len)throw new RangeError("Too many clusters");for(var t=[this.tree];t.length<r;)for(var n=t.shift(),e=0;e<n.children.length;e++)t.push(n.children[e]);for(var i=new Array(t.length),o=0;o<t.length;o++){var s=t[o];i[o]=s.data.concat()}return i},t.exports=f},{}],69:[function(r,t){"use strict";function n(r,t){for(var n=0,e=r.length,i=0;e>n;n++)i+=(r[n]-t[n])*(r[n]-t[n]);return Math.sqrt(i)}function e(r,t,n){for(var e=1e101,i=0;i<r.length;i++)for(var o=i;o<t.length;o++){var s=n(r[i],t[o]);e=Math.min(s,e)}return e}function i(r,t,n){for(var e=-1,i=0;i<r.length;i++)for(var o=i;o<t.length;o++){var s=n(r[i],t[o]);e=Math.max(s,e)}return e}function o(r,t,n){for(var e=0,i=0;i<r.length;i++)for(var o=0;o<t.length;o++)e+=n(r[i],t[o]);return e/(r.length*t.length)}function s(r,t,n){for(var e=0,i=0,o=0,s=0,a=0;a<r.length;a++)e+=r[a][0],i+=r[a][1];for(var u=0;u<t.length;u++)o+=t[u][0],s+=t[u][1];return e/=r.length,i/=r.length,o/=t.length,s/=t.length,n([e,i],[o,s])}function a(r,t,n){for(var e=0,i=0,o=0,s=0,a=0;a<r.length;a++)e+=r[a][0],i+=r[a][1];for(var u=0;u<t.length;u++)o+=t[u][0],s+=t[u][1];return e/=r.length,i/=r.length,o/=t.length,s/=t.length,n([e,i],[o,s])*r.length*t.length/(r.length+t.length)}function u(r,t,n){for(var e,i,o={d:0,p:0},s=0;s<r.length;s++){e=0;for(var a=0;a<r.length;a++)s!==a&&(e+=n(r[s],r[a]));e/=r.length-1,i=0;for(var u=0;u<t.length;u++)i+=n(r[s],t[u]);i/=t.length,e-i>o.d&&(o.d=e-i,o.p=s)}return o}function f(r,t){t=t||{},this.options={};for(var n in c)this.options[n]=t.hasOwnProperty(n)?t[n]:c[n];if(this.len=r.length,"string"==typeof this.options.kind)switch(this.options.kind){case"single":this.options.kind=e;break;case"complete":this.options.kind=i;break;case"average":this.options.kind=o;break;case"centroid":this.options.kind=s;break;case"ward":this.options.kind=a;break;default:throw new RangeError("Unknown kind of similarity")}else if("function"!=typeof this.options.kind)throw new TypeError("Undefined kind of similarity");for(var f={},h=0;h<r.length;h++)f[r[h][0]]?f[r[h][0]][r[h][1]]=h:(f[r[h][0]]={},f[r[h][0]][r[h][1]]=h);this.tree={dis:0,data:r,children:[]};for(var m,l,p,d,g,v=[this.tree];0!==v.length;){l=0,p=0;for(var y=0;y<v.length;y++){m=0;for(var w=0;w<v[y].length;w++)for(var x=w+1;x<v[y].length;x++)m=Math.max(this.options.sim(v[y].data[w],v[y].data[x]),m);m>l&&(l=m,p=y)}l=0;var M={dis:void 0,data:v[p].data.concat(),children:[]},b={dis:void 0,data:[],children:[]};v[p].children=[M,b],v.splice(p,1);for(var k=0;k<M.data.length;k++){d=0;for(var A=0;A<M.data.length;A++)k!==A&&(d+=this.options.sim(M.data[A],M.data[k]));d/=M.data.length-1,d>l&&(l=d,g=k)}for(b.data=[M.data[g]],M.data.splice(g,1),d=u(M.data,b.data,this.options.sim);d.d>0;)b.data.push(M.data[d.p]),M.data.splice(d.p,1),d=u(M.data,b.data,this.options.sim);M.dis=this.options.kind(M.data,b.data,this.options.sim),b.dis=M.dis,1===M.data.length?M.index=f[M.data[0][0]][M.data[0][1]]:v.push(M),1===b.data.length?b.index=f[b.data[0][0]][b.data[0][1]]:v.push(b)}}var c={sim:n,kind:"single"};f.prototype.getDendogram=function(r){if(r=r||{length:this.len,ND:!0},r.length!==this.len)throw new Error("Invalid input size");for(var t=JSON.parse(JSON.stringify(this.tree)),n=[t];n.length>0;){var e=n.shift();if(1===e.data.length)e.data=r.ND?e.data[0]:r[e.index],delete e.index;else{delete e.data,delete e.index;for(var i=0;i<e.children.length;i++)n.push(e.children[i])}}return t},f.prototype.nClusters=function(r){if(r>=this.len)throw new RangeError("Too many clusters");for(var t=[this.tree];t.length<r;)for(var n=t.shift(),e=0;e<n.children.length;e++)t.push(n.children[e]);for(var i=new Array(t.length),o=0;o<t.length;o++){var s=t[o];i[o]=s.data.concat()}return i},t.exports=f},{}],70:[function(r,t,n){n.agnes=r("./agnes"),n.diana=r("./diana")},{"./agnes":68,"./diana":69}],71:[function(r,t){t.exports=r("./kmeans")},{"./kmeans":72}],72:[function(r,t){"use strict";function n(r,t){for(var n=0,e=r.length,i=0;e>i;i++)n+=(r[i]-t[i])*(r[i]-t[i]);return n}function e(r,t,e){for(var i=0,o=r.length,s=0,a=0;o>a;a++)s=e[a],i+=n(r[a],t[s]);return i}function i(r,t){for(var e=r.length,i=t.length,o=0,s=new Array(e),a=0;e>a;a++)s[a]=0;for(var u=new Array(e),a=0;e>a;a++){u[a]=new Array(i);for(var f=0;i>f;f++)o=n(r[a],t[f]),u[a][f]=new Array(2),u[a][f][0]=o,u[a][f][1]=f;for(var c=u[a][0][0],h=0,f=0;i>f;f++)u[a][f][0]<c&&(c=u[a][f][0],h=u[a][f][1]);s[a]=h}return s}function o(r,t,n){for(var e=r[0].length,i=r.length,o=new Array(n),s=0;n>s;s++){o[s]=new Array(e);for(var a=0;e>a;a++)o[s][a]=0}for(var u=0;n>u;u++){for(var f=[],s=0;i>s;s++)t[s]==u&&f.push(r[s]);for(var c=0;e>c;c++){for(var h=[],s=0;i>s;s++)t[s]==u&&h.push(r[s][c]);for(var m=0,l=h.length,s=0;l>s;s++)m+=h[s];o[u][c]=m/l}}return o}function s(r,t,n,s){n="undefined"==typeof n?100:n,s="undefined"==typeof s?1e-6:s;var a=r.length;if(0==a)return[];for(var u=t.length,f=new Array(a),c=0;a>c;c++)f[c]=0;if(u>=a){for(var c=0;a>c;c++)f[c]=c;return f}var h;h=1e100;for(var m=0,l=0;n>l;l++){if(f=i(r,t),t=o(r,f,u),m=e(r,t,f),s>h-m||s>(h-m)/h)return f;h=m}return f}t.exports=s},{}],73:[function(r,t,n){arguments[4][2][0].apply(n,arguments)},{"../matrix":81,dup:2}],74:[function(r,t,n){arguments[4][3][0].apply(n,arguments)},{"../matrix":81,"./util":78,dup:3}],75:[function(r,t,n){arguments[4][4][0].apply(n,arguments)},{"../matrix":81,dup:4}],76:[function(r,t,n){arguments[4][5][0].apply(n,arguments)},{"../matrix":81,"./util":78,dup:5}],77:[function(r,t,n){arguments[4][6][0].apply(n,arguments)},{"../matrix":81,"./util":78,dup:6}],78:[function(r,t,n){arguments[4][7][0].apply(n,arguments)},{dup:7}],79:[function(r,t,n){arguments[4][8][0].apply(n,arguments)},{"./dc/cholesky":73,"./dc/evd":74,"./dc/lu":75,"./dc/qr":76,"./dc/svd":77,"./matrix":81,dup:8}],80:[function(r,t,n){arguments[4][9][0].apply(n,arguments)},{"./decompositions":79,"./matrix":81,dup:9}],81:[function(r,t){"use strict";function n(r){for(var t=0,n=r.length,e=new Array(n);n>t;t++)e[t]=r[t];return e}function e(r){this.message=r||"Unknown matrix error"}function i(r,t){var o,s,a=0;if(Array.isArray(r)){if(s=t,o=s?n(r):r,r=o.length,t=o[0].length,"undefined"==typeof t)throw new e("Data must be a 2D array");if(!(r>0&&t>0))throw new e("Invalid dimensions: "+r+"x"+t);for(;r>a;a++){if(o[a].length!==t)throw new e("Inconsistent array dimensions");s&&(o[a]=n(o[a]))}}else{if("number"!=typeof r)throw new e("Invalid arguments");if(!(r>0&&t>0))throw new e("Invalid dimensions: "+r+"x"+t);for(o=new Array(r);r>a;a++)o[a]=new Array(t)}return Object.defineProperty(o,"rows",{writable:!0,value:r}),Object.defineProperty(o,"columns",{writable:!0,value:t}),o.__proto__=i.prototype,o}var o=Array.prototype.splice,s=Array.prototype.concat;e.prototype=Object.create(Error.prototype),e.prototype.name="MatrixError",e.prototype.constructor=e,i.from1DArray=function(r,t,n){var o,s,a=0;if(o=r*t,o!==n.length)throw new e("Data length does not match given dimensions");for(s=new Array(r);r>a;a++)s[a]=n.slice(a*t,(a+1)*t);return new i(s)},i.rowVector=function(r){return new i([r])},i.columnVector=function(r){for(var t=r.length,n=new Array(t),e=0;t>e;e++)n[e]=[r[e]];return new i(n)},i.empty=function(r,t){return new i(r,t)},i.zeros=function(r,t){return i.empty(r,t).fill(0)},i.ones=function(r,t){return i.empty(r,t).fill(1)},i.rand=function(r,t){for(var n=i.empty(r,t),e=0,o=n.rows;o>e;e++)for(var s=0,a=n.columns;a>s;s++)n[e][s]=Math.random();return n},i.eye=function(r){for(var t=i.zeros(r,r),n=t.rows,e=0;n>e;e++)t[e][e]=1;return t},i.diag=function(r){for(var t=r.length,n=i.zeros(t,t),e=0;t>e;e++)n[e][e]=r[e];return n},i.indices=function(r,t){for(var n=new Array(t-r),e=0;e<n.length;e++)n[e]=r++;return n},i.stack=function(r){var t,n,e;if(i.isMatrix(r)){var o=0,s=0;for(t=0;t<arguments.length;t++)o+=arguments[t].rows,arguments[t].columns>s&&(s=arguments[t].columns);var a=i.zeros(o,s),u=0;for(t=0;t<arguments.length;t++){var f=arguments[t];for(n=0;n<f.rows;n++){for(e=0;e<f.columns;e++)a[u][e]=f[n][e];u++}}return a}if(Array.isArray(r)){var c=i.empty(arguments.length,r.length);for(t=0;t<arguments.length;t++)c.setRow(t,arguments[t]);return c}},i.expand=function(r,t){for(var n=[],e=0;e<t.length;e++)for(var o=0;o<t[e];o++)n.push(r[e]);return new i(n)},i.checkMatrix=function(r){if(!r)throw new e("Argument has to be a matrix");return"Matrix"!==r.klass&&(r=new i(r)),r},i.isMatrix=function(r){return r?"Matrix"===r.klass:!1},Object.defineProperty(i.prototype,"klass",{get:function(){return"Matrix"}}),Object.defineProperty(i.prototype,"size",{get:function(){return this.rows*this.columns}}),i.prototype.checkRowIndex=function(r){if(0>r||r>this.rows-1)throw new e("Row index out of range.")},i.prototype.checkColumnIndex=function(r){if(0>r||r>this.columns-1)throw new e("Column index out of range.")},i.prototype.checkDimensions=function(r){if(this.rows!==r.rows||this.columns!==r.columns)throw new e("Matrices dimensions must be equal.")},i.prototype.apply=function(r){for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)r.call(this,e,i);return this},i.prototype.clone=function(){return new i(this.to2DArray())},i.prototype.to1DArray=function(){return s.apply([],this)},i.prototype.to2DArray=function(){for(var r=this.rows,t=new Array(r),e=0;r>e;e++)t[e]=n(this[e]);return t},i.prototype.isRowVector=function(){return 1===this.rows},i.prototype.isColumnVector=function(){return 1===this.columns},i.prototype.isVector=function(){return 1===this.rows||1===this.columns},i.prototype.isSquare=function(){return this.rows===this.columns},i.prototype.isSymmetric=function(){if(this.isSquare()){for(var r=this.rows,t=0;r>t;t++)for(var n=0;t>=n;n++)if(this[t][n]!==this[n][t])return!1;return!0}return!1},i.prototype.set=function(r,t,n){return this[r][t]=n,this},i.prototype.get=function(r,t){return this[r][t]},i.prototype.fill=function(r){for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]=r;return this},i.prototype.neg=function(){return this.mulS(-1)},i.prototype.add=function(r){return"number"==typeof r?this.addS(r):(r=i.checkMatrix(r),this.addM(r))},i.prototype.addS=function(r){for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]+=r;return this},i.prototype.addM=function(r){this.checkDimensions(r);for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]+=r[e][i];return this},i.prototype.sub=function(r){return"number"==typeof r?this.subS(r):(r=i.checkMatrix(r),this.subM(r))},i.prototype.subS=function(r){for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]-=r;return this},i.prototype.subM=function(r){this.checkDimensions(r);for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]-=r[e][i];return this},i.prototype.mul=function(r){return"number"==typeof r?this.mulS(r):(r=i.checkMatrix(r),this.mulM(r))},i.prototype.mulS=function(r){for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]*=r;return this},i.prototype.mulM=function(r){this.checkDimensions(r);for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]*=r[e][i];return this},i.prototype.div=function(r){return"number"==typeof r?this.divS(r):(r=i.checkMatrix(r),this.divM(r))},i.prototype.divS=function(r){for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]/=r;return this},i.prototype.divM=function(r){this.checkDimensions(r);for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]/=r[e][i];return this},i.prototype.getRow=function(r){return this.checkRowIndex(r),n(this[r])},i.prototype.setRow=function(r,t){if(this.checkRowIndex(r),i.isMatrix(t)&&(t=t.to1DArray()),t.length!==this.columns)throw new e("Invalid row size");return this[r]=n(t),this},i.prototype.removeRow=function(r){if(this.checkRowIndex(r),1===this.rows)throw new e("A matrix cannot have less than one row");return o.call(this,r,1),this.rows-=1,this},i.prototype.addRow=function(r,t){if("undefined"==typeof t&&(t=r,r=this.rows),0>r||r>this.rows)throw new e("Row index out of range.");if(i.isMatrix(t)&&(t=t.to1DArray()),t.length!==this.columns)throw new e("Invalid row size");return o.call(this,r,0,n(t)),this.rows+=1,this},i.prototype.swapRows=function(r,t){this.checkRowIndex(r),this.checkRowIndex(t);var n=this[r];return this[r]=this[t],this[t]=n,this},i.prototype.getColumn=function(r){this.checkColumnIndex(r);for(var t=this.rows,n=new Array(t),e=0;t>e;e++)n[e]=this[e][r];return n},i.prototype.setColumn=function(r,t){this.checkColumnIndex(r),i.isMatrix(t)&&(t=t.to1DArray());var n=this.rows;if(t.length!==n)throw new e("Invalid column size");for(var o=0;n>o;o++)this[o][r]=t[o];return this},i.prototype.removeColumn=function(r){if(this.checkColumnIndex(r),1===this.columns)throw new e("A matrix cannot have less than one column");for(var t=0,n=this.rows;n>t;t++)this[t].splice(r,1);return this.columns-=1,this},i.prototype.addColumn=function(r,t){if("undefined"==typeof t&&(t=r,r=this.columns),0>r||r>this.columns)throw new e("Column index out of range.");i.isMatrix(t)&&(t=t.to1DArray());var n=this.rows;if(t.length!==n)throw new e("Invalid column size");for(var o=0;n>o;o++)this[o].splice(r,0,t[o]);return this.columns+=1,this},i.prototype.swapColumns=function(r,t){this.checkRowIndex(r),this.checkRowIndex(t);for(var n,e,i=this.rows,o=0;i>o;o++)e=this[o],n=e[r],e[r]=e[t],e[t]=n;return this},i.prototype.checkRowVector=function(r){if(i.isMatrix(r)&&(r=r.to1DArray()),r.length!==this.columns)throw new e("vector size must be the same as the number of columns");return r},i.prototype.checkColumnVector=function(r){if(i.isMatrix(r)&&(r=r.to1DArray()),r.length!==this.rows)throw new e("vector size must be the same as the number of rows");return r},i.prototype.addRowVector=function(r){r=this.checkRowVector(r);for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]+=r[i];return this},i.prototype.subRowVector=function(r){r=this.checkRowVector(r);for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]-=r[i];return this},i.prototype.mulRowVector=function(r){r=this.checkRowVector(r);for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]*=r[i];return this
},i.prototype.divRowVector=function(r){r=this.checkRowVector(r);for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]/=r[i];return this},i.prototype.addColumnVector=function(r){r=this.checkColumnVector(r);for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]+=r[e];return this},i.prototype.subColumnVector=function(r){r=this.checkColumnVector(r);for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]-=r[e];return this},i.prototype.mulColumnVector=function(r){r=this.checkColumnVector(r);for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]*=r[e];return this},i.prototype.divColumnVector=function(r){r=this.checkColumnVector(r);for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]/=r[e];return this},i.prototype.mulRow=function(r,t){this.checkRowIndex(r);for(var n=0,e=this.columns;e>n;n++)this[r][n]*=t;return this},i.prototype.mulColumn=function(r,t){this.checkColumnIndex(r);for(var n=0,e=this.rows;e>n;n++)this[n][r]*=t},i.prototype.max=function(){for(var r=-1/0,t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]>r&&(r=this[e][i]);return r},i.prototype.maxIndex=function(){for(var r=-1/0,t={},n=this.rows,e=this.columns,i=0;n>i;i++)for(var o=0;e>o;o++)this[i][o]>r&&(r=this[i][o],t.row=i,t.column=o);return t},i.prototype.min=function(){for(var r=1/0,t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]<r&&(r=this[e][i]);return r},i.prototype.minIndex=function(){for(var r=1/0,t={},n=this.rows,e=this.columns,i=0;n>i;i++)for(var o=0;e>o;o++)this[i][o]<r&&(r=this[i][o],t.row=i,t.column=o);return t},i.prototype.maxRow=function(r){this.checkRowIndex(r);for(var t=-1/0,n=0,e=this.columns;e>n;n++)this[r][n]>t&&(t=this[r][n]);return t},i.prototype.maxRowIndex=function(r){this.checkRowIndex(r);for(var t=-1/0,n={row:r},e=0,i=this.columns;i>e;e++)this[r][e]>t&&(t=this[r][e],n.column=e);return n},i.prototype.minRow=function(r){this.checkRowIndex(r);for(var t=1/0,n=0,e=this.columns;e>n;n++)this[r][n]<t&&(t=this[r][n]);return t},i.prototype.minRowIndex=function(r){this.checkRowIndex(r);for(var t=1/0,n={row:r,column:0},e=0,i=this.columns;i>e;e++)this[r][e]<t&&(t=this[r][e],n.column=e);return n},i.prototype.maxColumn=function(r){this.checkColumnIndex(r);for(var t=-1/0,n=0,e=this.rows;e>n;n++)this[n][r]>t&&(t=this[n][r]);return t},i.prototype.maxColumnIndex=function(r){this.checkColumnIndex(r);for(var t=-1/0,n={row:0,column:r},e=0,i=this.rows;i>e;e++)this[e][r]>t&&(t=this[e][r],n.row=e);return n},i.prototype.minColumn=function(r){this.checkColumnIndex(r);for(var t=1/0,n=0,e=this.rows;e>n;n++)this[n][r]<t&&(t=this[n][r]);return t},i.prototype.minColumnIndex=function(r){this.checkColumnIndex(r);for(var t=1/0,n={row:0,column:r},e=0,i=this.rows;i>e;e++)this[e][r]<t&&(t=this[e][r],n.row=e);return n},i.prototype.diag=function a(){if(!this.isSquare())throw new e("Only square matrices have a diagonal.");for(var a=new Array(this.rows),r=0,t=this.rows;t>r;r++)a[r]=this[r][r];return a},i.prototype.sum=function(){for(var r=0,t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)r+=this[e][i];return r},i.prototype.mean=function(){return this.sum()/this.size},i.prototype.prod=function u(){for(var u=1,r=this.rows,t=this.columns,n=0;r>n;n++)for(var e=0;t>e;e++)u*=this[n][e];return u},i.prototype.cumulativeSum=function(){for(var r=0,t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)r+=this[e][i],this[e][i]=r;return this},i.prototype.dot=function f(r){if(this.size!==r.size)throw new e("vectors do not have the same size");for(var t=this.to1DArray(),n=r.to1DArray(),f=0,i=t.length,o=0;i>o;o++)f+=t[o]*n[o];return f},i.prototype.mmul=function(r){if(!i.isMatrix(r))throw new e('parameter "other" must be a matrix');this.columns!==r.rows&&console.warn("Number of columns of left matrix are not equal to number of rows of right matrix.");var t,n,o,s=this.rows,a=this.columns,u=r.columns,f=new i(s,u),c=new Array(a);for(n=0;u>n;n++){for(o=0;a>o;o++)c[o]=r[o][n];for(t=0;s>t;t++){var h=this[t],m=0;for(o=0;a>o;o++)m+=h[o]*c[o];f[t][n]=m}}return f},i.prototype.sortRows=function(r){for(var t=0,n=this.rows;n>t;t++)this[t].sort(r);return this},i.prototype.sortColumns=function(r){for(var t=0,n=this.columns;n>t;t++)this.setColumn(t,this.getColumn(t).sort(r));return this},i.prototype.transpose=function(){for(var r=new i(this.columns,this.rows),t=this.rows,n=this.columns,e=0;t>e;e++)for(var o=0;n>o;o++)r[o][e]=this[e][o];return r},i.prototype.subMatrix=function(r,t,n,o){if(r>t||n>o||0>r||r>=this.rows||0>t||t>=this.rows||0>n||n>=this.columns||0>o||o>=this.columns)throw new e("Argument out of range");for(var s=new i(t-r+1,o-n+1),a=r;t>=a;a++)for(var u=n;o>=u;u++)s[a-r][u-n]=this[a][u];return s},i.prototype.subMatrixRow=function(r,t,n){if("undefined"==typeof t?(t=0,n=this.columns-1):"undefined"==typeof n&&(n=this.columns-1),t>n||0>t||t>=this.columns||0>n||n>=this.columns)throw new e("Argument out of range.");for(var o=r.length,s=this.rows,a=new i(o,n-t+1),u=0;o>u;u++)for(var f=t;n>=f;f++){if(r[u]<0||r[u]>=s)throw new e("Argument out of range.");a[u][f-t]=this[r[u]][f]}return a},i.prototype.subMatrixColumn=function(r,t,n){if("undefined"==typeof t?(t=0,n=this.rows-1):"undefined"==typeof n&&(n=this.rows-1),t>n||0>t||t>=this.rows||0>n||n>=this.rows)throw new e("Argument out of range.");for(var o=r.length,s=this.columns,a=new i(n-t+1,o),u=0;o>u;u++)for(var f=t;n>=f;f++){if(r[u]<0||r[u]>=s)throw new e("Argument out of range.");a[f-t][u]=this[f][r[u]]}return a},i.prototype.trace=function c(){if(!this.isSquare())throw new e("The matrix is not square");for(var c=0,r=0,t=this.rows;t>r;r++)c+=this[r][r];return c},i.prototype.abs=function(){for(var r=this.rows,t=this.columns,n=0;r>n;n++)for(var e=0;t>e;e++)this[n][e]=Math.abs(this[n][e])},i.MatrixError=e,t.exports=i},{}],82:[function(require,module,exports){(function(global){"use strict";var numeric="undefined"==typeof exports?function(){}:exports;"undefined"!=typeof global&&(global.numeric=numeric),numeric.version="1.2.6",numeric.bench=function(r,t){var n,e,i,o;for("undefined"==typeof t&&(t=15),i=.5,n=new Date;;){for(i*=2,o=i;o>3;o-=4)r(),r(),r(),r();for(;o>0;)r(),o--;if(e=new Date,e-n>t)break}for(o=i;o>3;o-=4)r(),r(),r(),r();for(;o>0;)r(),o--;return e=new Date,1e3*(3*i-1)/(e-n)},numeric._myIndexOf=function(r){var t,n=this.length;for(t=0;n>t;++t)if(this[t]===r)return t;return-1},numeric.myIndexOf=Array.prototype.indexOf?Array.prototype.indexOf:numeric._myIndexOf,numeric.Function=Function,numeric.precision=4,numeric.largeArray=50,numeric.prettyPrint=function(r){function t(r){if(0===r)return"0";if(isNaN(r))return"NaN";if(0>r)return"-"+t(-r);if(isFinite(r)){var n=Math.floor(Math.log(r)/Math.log(10)),e=r/Math.pow(10,n),i=e.toPrecision(numeric.precision);return 10===parseFloat(i)&&(n++,e=1,i=e.toPrecision(numeric.precision)),parseFloat(i).toString()+"e"+n.toString()}return"Infinity"}function n(r){var i;if("undefined"==typeof r)return e.push(Array(numeric.precision+8).join(" ")),!1;if("string"==typeof r)return e.push('"'+r+'"'),!1;if("boolean"==typeof r)return e.push(r.toString()),!1;if("number"==typeof r){var o=t(r),s=r.toPrecision(numeric.precision),a=parseFloat(r.toString()).toString(),u=[o,s,a,parseFloat(s).toString(),parseFloat(a).toString()];for(i=1;i<u.length;i++)u[i].length<o.length&&(o=u[i]);return e.push(Array(numeric.precision+8-o.length).join(" ")+o),!1}if(null===r)return e.push("null"),!1;if("function"==typeof r){e.push(r.toString());var f=!1;for(i in r)r.hasOwnProperty(i)&&(e.push(f?",\n":"\n{"),f=!0,e.push(i),e.push(": \n"),n(r[i]));return f&&e.push("}\n"),!0}if(r instanceof Array){if(r.length>numeric.largeArray)return e.push("...Large Array..."),!0;var f=!1;for(e.push("["),i=0;i<r.length;i++)i>0&&(e.push(","),f&&e.push("\n ")),f=n(r[i]);return e.push("]"),!0}e.push("{");var f=!1;for(i in r)r.hasOwnProperty(i)&&(f&&e.push(",\n"),f=!0,e.push(i),e.push(": \n"),n(r[i]));return e.push("}"),!0}var e=[];return n(r),e.join("")},numeric.parseDate=function(r){function t(r){if("string"==typeof r)return Date.parse(r.replace(/-/g,"/"));if(!(r instanceof Array))throw new Error("parseDate: parameter must be arrays of strings");var n,e=[];for(n=0;n<r.length;n++)e[n]=t(r[n]);return e}return t(r)},numeric.parseFloat=function(r){function t(r){if("string"==typeof r)return parseFloat(r);if(!(r instanceof Array))throw new Error("parseFloat: parameter must be arrays of strings");var n,e=[];for(n=0;n<r.length;n++)e[n]=t(r[n]);return e}return t(r)},numeric.parseCSV=function(r){var t,n,e=r.split("\n"),i=[],o=/(([^'",]*)|('[^']*')|("[^"]*")),/g,s=/^\s*(([+-]?[0-9]+(\.[0-9]*)?(e[+-]?[0-9]+)?)|([+-]?[0-9]*(\.[0-9]+)?(e[+-]?[0-9]+)?))\s*$/,a=function(r){return r.substr(0,r.length-1)},u=0;for(n=0;n<e.length;n++){var f,c=(e[n]+",").match(o);if(c.length>0){for(i[u]=[],t=0;t<c.length;t++)f=a(c[t]),i[u][t]=s.test(f)?parseFloat(f):f;u++}}return i},numeric.toCSV=function(r){var t,n,e,i,o,s,a=numeric.dim(r);for(e=a[0],i=a[1],s=[],t=0;e>t;t++){for(o=[],n=0;e>n;n++)o[n]=r[t][n].toString();s[t]=o.join(", ")}return s.join("\n")+"\n"},numeric.getURL=function(r){var t=new XMLHttpRequest;return t.open("GET",r,!1),t.send(),t},numeric.imageURL=function(r){function t(r){var t,n,e,i,o,s,a,u,f=r.length,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",h="";for(t=0;f>t;t+=3)n=r[t],e=r[t+1],i=r[t+2],o=n>>2,s=((3&n)<<4)+(e>>4),a=((15&e)<<2)+(i>>6),u=63&i,t+1>=f?a=u=64:t+2>=f&&(u=64),h+=c.charAt(o)+c.charAt(s)+c.charAt(a)+c.charAt(u);return h}function n(r,t,n){"undefined"==typeof t&&(t=0),"undefined"==typeof n&&(n=r.length);{var e,i=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],o=-1,s=0;r.length}for(e=t;n>e;e++)s=255&(o^r[e]),o=o>>>8^i[s];return-1^o}var e,i,o,s,a,u,f,c,h,m,l=r[0].length,p=r[0][0].length,d=[137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,p>>24&255,p>>16&255,p>>8&255,255&p,l>>24&255,l>>16&255,l>>8&255,255&l,8,2,0,0,0,-1,-2,-3,-4,-5,-6,-7,-8,73,68,65,84,8,29];for(m=n(d,12,29),d[29]=m>>24&255,d[30]=m>>16&255,d[31]=m>>8&255,d[32]=255&m,e=1,i=0,f=0;l>f;f++){for(d.push(l-1>f?0:1),a=3*p+1+(0===f)&255,u=3*p+1+(0===f)>>8&255,d.push(a),d.push(u),d.push(255&~a),d.push(255&~u),0===f&&d.push(0),c=0;p>c;c++)for(o=0;3>o;o++)a=r[o][f][c],a=a>255?255:0>a?0:Math.round(a),e=(e+a)%65521,i=(i+e)%65521,d.push(a);d.push(0)}return h=(i<<16)+e,d.push(h>>24&255),d.push(h>>16&255),d.push(h>>8&255),d.push(255&h),s=d.length-41,d[33]=s>>24&255,d[34]=s>>16&255,d[35]=s>>8&255,d[36]=255&s,m=n(d,37),d.push(m>>24&255),d.push(m>>16&255),d.push(m>>8&255),d.push(255&m),d.push(0),d.push(0),d.push(0),d.push(0),d.push(73),d.push(69),d.push(78),d.push(68),d.push(174),d.push(66),d.push(96),d.push(130),"data:image/png;base64,"+t(d)},numeric._dim=function(r){for(var t=[];"object"==typeof r;)t.push(r.length),r=r[0];return t},numeric.dim=function(r){var t,n;return"object"==typeof r?(t=r[0],"object"==typeof t?(n=t[0],"object"==typeof n?numeric._dim(r):[r.length,t.length]):[r.length]):[]},numeric.mapreduce=function(r,t){return Function("x","accum","_s","_k",'if(typeof accum === "undefined") accum = '+t+';\nif(typeof x === "number") { var xi = x; '+r+'; return accum; }\nif(typeof _s === "undefined") _s = numeric.dim(x);\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i,xi;\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) {\n        accum = arguments.callee(x[i],accum,_s,_k+1);\n    }    return accum;\n}\nfor(i=_n-1;i>=1;i-=2) { \n    xi = x[i];\n    '+r+";\n    xi = x[i-1];\n    "+r+";\n}\nif(i === 0) {\n    xi = x[i];\n    "+r+"\n}\nreturn accum;")},numeric.mapreduce2=function(r,t){return Function("x","var n = x.length;\nvar i,xi;\n"+t+";\nfor(i=n-1;i!==-1;--i) { \n    xi = x[i];\n    "+r+";\n}\nreturn accum;")},numeric.same=function r(t,n){var e,i;if(!(t instanceof Array&&n instanceof Array))return!1;if(i=t.length,i!==n.length)return!1;for(e=0;i>e;e++)if(t[e]!==n[e]){if("object"!=typeof t[e])return!1;if(!r(t[e],n[e]))return!1}return!0},numeric.rep=function(r,t,n){"undefined"==typeof n&&(n=0);var e,i=r[n],o=Array(i);if(n===r.length-1){for(e=i-2;e>=0;e-=2)o[e+1]=t,o[e]=t;return-1===e&&(o[0]=t),o}for(e=i-1;e>=0;e--)o[e]=numeric.rep(r,t,n+1);return o},numeric.dotMMsmall=function(r,t){var n,e,i,o,s,a,u,f,c,h,m;for(o=r.length,s=t.length,a=t[0].length,u=Array(o),n=o-1;n>=0;n--){for(f=Array(a),c=r[n],i=a-1;i>=0;i--){for(h=c[s-1]*t[s-1][i],e=s-2;e>=1;e-=2)m=e-1,h+=c[e]*t[e][i]+c[m]*t[m][i];0===e&&(h+=c[0]*t[0][i]),f[i]=h}u[n]=f}return u},numeric._getCol=function(r,t,n){var e,i=r.length;for(e=i-1;e>0;--e)n[e]=r[e][t],--e,n[e]=r[e][t];0===e&&(n[0]=r[0][t])},numeric.dotMMbig=function(r,t){var n,e,i,o,s=numeric._getCol,a=t.length,u=Array(a),f=r.length,c=t[0].length,h=new Array(f),m=numeric.dotVV;for(--a,--f,e=f;-1!==e;--e)h[e]=Array(c);for(--c,e=c;-1!==e;--e)for(s(t,e,u),i=f;-1!==i;--i)o=0,n=r[i],h[i][e]=m(n,u);return h},numeric.dotMV=function(r,t){var n,e=r.length,i=(t.length,Array(e)),o=numeric.dotVV;for(n=e-1;n>=0;n--)i[n]=o(r[n],t);return i},numeric.dotVM=function(r,t){var n,e,i,o,s,a,u;for(i=r.length,o=t[0].length,s=Array(o),e=o-1;e>=0;e--){for(a=r[i-1]*t[i-1][e],n=i-2;n>=1;n-=2)u=n-1,a+=r[n]*t[n][e]+r[u]*t[u][e];0===n&&(a+=r[0]*t[0][e]),s[e]=a}return s},numeric.dotVV=function(r,t){var n,e,i=r.length,o=r[i-1]*t[i-1];for(n=i-2;n>=1;n-=2)e=n-1,o+=r[n]*t[n]+r[e]*t[e];return 0===n&&(o+=r[0]*t[0]),o},numeric.dot=function(r,t){var n=numeric.dim;switch(1e3*n(r).length+n(t).length){case 2002:return t.length<10?numeric.dotMMsmall(r,t):numeric.dotMMbig(r,t);case 2001:return numeric.dotMV(r,t);case 1002:return numeric.dotVM(r,t);case 1001:return numeric.dotVV(r,t);case 1e3:return numeric.mulVS(r,t);case 1:return numeric.mulSV(r,t);case 0:return r*t;default:throw new Error("numeric.dot only works on vectors and matrices")}},numeric.diag=function(r){var t,n,e,i,o=r.length,s=Array(o);for(t=o-1;t>=0;t--){for(i=Array(o),n=t+2,e=o-1;e>=n;e-=2)i[e]=0,i[e-1]=0;for(e>t&&(i[e]=0),i[t]=r[t],e=t-1;e>=1;e-=2)i[e]=0,i[e-1]=0;0===e&&(i[0]=0),s[t]=i}return s},numeric.getDiag=function(r){var t,n=Math.min(r.length,r[0].length),e=Array(n);for(t=n-1;t>=1;--t)e[t]=r[t][t],--t,e[t]=r[t][t];return 0===t&&(e[0]=r[0][0]),e},numeric.identity=function(r){return numeric.diag(numeric.rep([r],1))},numeric.pointwise=function(r,t,n){"undefined"==typeof n&&(n="");var e,i,o=[],s=/\[i\]$/,a="",u=!1;for(e=0;e<r.length;e++)s.test(r[e])?(i=r[e].substring(0,r[e].length-3),a=i):i=r[e],"ret"===i&&(u=!0),o.push(i);return o[r.length]="_s",o[r.length+1]="_k",o[r.length+2]='if(typeof _s === "undefined") _s = numeric.dim('+a+');\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i'+(u?"":", ret = Array(_n)")+";\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) ret[i] = arguments.callee("+r.join(",")+",_s,_k+1);\n    return ret;\n}\n"+n+"\nfor(i=_n-1;i!==-1;--i) {\n    "+t+"\n}\nreturn ret;",Function.apply(null,o)},numeric.pointwise2=function(r,t,n){"undefined"==typeof n&&(n="");var e,i,o=[],s=/\[i\]$/,a="",u=!1;for(e=0;e<r.length;e++)s.test(r[e])?(i=r[e].substring(0,r[e].length-3),a=i):i=r[e],"ret"===i&&(u=!0),o.push(i);return o[r.length]="var _n = "+a+".length;\nvar i"+(u?"":", ret = Array(_n)")+";\n"+n+"\nfor(i=_n-1;i!==-1;--i) {\n"+t+"\n}\nreturn ret;",Function.apply(null,o)},numeric._biforeach=function t(r,n,e,i,o){if(i===e.length-1)return void o(r,n);var s,a=e[i];for(s=a-1;s>=0;s--)t("object"==typeof r?r[s]:r,"object"==typeof n?n[s]:n,e,i+1,o)},numeric._biforeach2=function n(r,t,e,i,o){if(i===e.length-1)return o(r,t);var s,a=e[i],u=Array(a);for(s=a-1;s>=0;--s)u[s]=n("object"==typeof r?r[s]:r,"object"==typeof t?t[s]:t,e,i+1,o);return u},numeric._foreach=function e(r,t,n,i){if(n===t.length-1)return void i(r);var o,s=t[n];for(o=s-1;o>=0;o--)e(r[o],t,n+1,i)},numeric._foreach2=function i(r,t,n,e){if(n===t.length-1)return e(r);var o,s=t[n],a=Array(s);for(o=s-1;o>=0;o--)a[o]=i(r[o],t,n+1,e);return a},numeric.ops2={add:"+",sub:"-",mul:"*",div:"/",mod:"%",and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">=",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"},numeric.opseq={addeq:"+=",subeq:"-=",muleq:"*=",diveq:"/=",modeq:"%=",lshifteq:"<<=",rshifteq:">>=",rrshifteq:">>>=",bandeq:"&=",boreq:"|=",bxoreq:"^="},numeric.mathfuns=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan","isNaN","isFinite"],numeric.mathfuns2=["atan2","pow","max","min"],numeric.ops1={neg:"-",not:"!",bnot:"~",clone:""},numeric.mapreducers={any:["if(xi) return true;","var accum = false;"],all:["if(!xi) return false;","var accum = true;"],sum:["accum += xi;","var accum = 0;"],prod:["accum *= xi;","var accum = 1;"],norm2Squared:["accum += xi*xi;","var accum = 0;"],norminf:["accum = max(accum,abs(xi));","var accum = 0, max = Math.max, abs = Math.abs;"],norm1:["accum += abs(xi)","var accum = 0, abs = Math.abs;"],sup:["accum = max(accum,xi);","var accum = -Infinity, max = Math.max;"],inf:["accum = min(accum,xi);","var accum = Infinity, min = Math.min;"]},function(){var r,t;for(r=0;r<numeric.mathfuns2.length;++r)t=numeric.mathfuns2[r],numeric.ops2[t]=t;for(r in numeric.ops2)if(numeric.ops2.hasOwnProperty(r)){t=numeric.ops2[r];var n,e,i="";-1!==numeric.myIndexOf.call(numeric.mathfuns2,r)?(i="var "+t+" = Math."+t+";\n",n=function(r,n,e){return r+" = "+t+"("+n+","+e+")"},e=function(r,n){return r+" = "+t+"("+r+","+n+")"}):(n=function(r,n,e){return r+" = "+n+" "+t+" "+e},e=numeric.opseq.hasOwnProperty(r+"eq")?function(r,n){return r+" "+t+"= "+n}:function(r,n){return r+" = "+r+" "+t+" "+n}),numeric[r+"VV"]=numeric.pointwise2(["x[i]","y[i]"],n("ret[i]","x[i]","y[i]"),i),numeric[r+"SV"]=numeric.pointwise2(["x","y[i]"],n("ret[i]","x","y[i]"),i),numeric[r+"VS"]=numeric.pointwise2(["x[i]","y"],n("ret[i]","x[i]","y"),i),numeric[r]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar VV = numeric."+r+"VV, VS = numeric."+r+"VS, SV = numeric."+r+'SV;\nvar dim = numeric.dim;\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof x === "object") {\n      if(typeof y === "object") x = numeric._biforeach2(x,y,dim(x),0,VV);\n      else x = numeric._biforeach2(x,y,dim(x),0,VS);\n  } else if(typeof y === "object") x = numeric._biforeach2(x,y,dim(y),0,SV);\n  else '+e("x","y")+"\n}\nreturn x;\n"),numeric[t]=numeric[r],numeric[r+"eqV"]=numeric.pointwise2(["ret[i]","x[i]"],e("ret[i]","x[i]"),i),numeric[r+"eqS"]=numeric.pointwise2(["ret[i]","x"],e("ret[i]","x"),i),numeric[r+"eq"]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar V = numeric."+r+"eqV, S = numeric."+r+'eqS\nvar s = numeric.dim(x);\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof y === "object") numeric._biforeach(x,y,s,0,V);\n  else numeric._biforeach(x,y,s,0,S);\n}\nreturn x;\n')}for(r=0;r<numeric.mathfuns2.length;++r)t=numeric.mathfuns2[r],delete numeric.ops2[t];for(r=0;r<numeric.mathfuns.length;++r)t=numeric.mathfuns[r],numeric.ops1[t]=t;for(r in numeric.ops1)numeric.ops1.hasOwnProperty(r)&&(i="",t=numeric.ops1[r],-1!==numeric.myIndexOf.call(numeric.mathfuns,r)&&Math.hasOwnProperty(t)&&(i="var "+t+" = Math."+t+";\n"),numeric[r+"eqV"]=numeric.pointwise2(["ret[i]"],"ret[i] = "+t+"(ret[i]);",i),numeric[r+"eq"]=Function("x",'if(typeof x !== "object") return '+t+"x\nvar i;\nvar V = numeric."+r+"eqV;\nvar s = numeric.dim(x);\nnumeric._foreach(x,s,0,V);\nreturn x;\n"),numeric[r+"V"]=numeric.pointwise2(["x[i]"],"ret[i] = "+t+"(x[i]);",i),numeric[r]=Function("x",'if(typeof x !== "object") return '+t+"(x)\nvar i;\nvar V = numeric."+r+"V;\nvar s = numeric.dim(x);\nreturn numeric._foreach2(x,s,0,V);\n"));for(r=0;r<numeric.mathfuns.length;++r)t=numeric.mathfuns[r],delete numeric.ops1[t];for(r in numeric.mapreducers)numeric.mapreducers.hasOwnProperty(r)&&(t=numeric.mapreducers[r],numeric[r+"V"]=numeric.mapreduce2(t[0],t[1]),numeric[r]=Function("x","s","k",t[1]+'if(typeof x !== "object") {    xi = x;\n'+t[0]+';\n    return accum;\n}if(typeof s === "undefined") s = numeric.dim(x);\nif(typeof k === "undefined") k = 0;\nif(k === s.length-1) return numeric.'+r+"V(x);\nvar xi;\nvar n = x.length, i;\nfor(i=n-1;i!==-1;--i) {\n   xi = arguments.callee(x[i]);\n"+t[0]+";\n}\nreturn accum;\n"))}(),numeric.truncVV=numeric.pointwise(["x[i]","y[i]"],"ret[i] = round(x[i]/y[i])*y[i];","var round = Math.round;"),numeric.truncVS=numeric.pointwise(["x[i]","y"],"ret[i] = round(x[i]/y)*y;","var round = Math.round;"),numeric.truncSV=numeric.pointwise(["x","y[i]"],"ret[i] = round(x/y[i])*y[i];","var round = Math.round;"),numeric.trunc=function(r,t){return"object"==typeof r?"object"==typeof t?numeric.truncVV(r,t):numeric.truncVS(r,t):"object"==typeof t?numeric.truncSV(r,t):Math.round(r/t)*t},numeric.inv=function(r){var t,n,e,i,o,s,a,r,u=numeric.dim(r),f=Math.abs,c=u[0],h=u[1],m=numeric.clone(r),l=numeric.identity(c);for(s=0;h>s;++s){var p=-1,d=-1;for(o=s;o!==c;++o)a=f(m[o][s]),a>d&&(p=o,d=a);for(n=m[p],m[p]=m[s],m[s]=n,i=l[p],l[p]=l[s],l[s]=i,r=n[s],a=s;a!==h;++a)n[a]/=r;for(a=h-1;-1!==a;--a)i[a]/=r;for(o=c-1;-1!==o;--o)if(o!==s){for(t=m[o],e=l[o],r=t[s],a=s+1;a!==h;++a)t[a]-=n[a]*r;for(a=h-1;a>0;--a)e[a]-=i[a]*r,--a,e[a]-=i[a]*r;0===a&&(e[0]-=i[0]*r)}}return l},numeric.det=function(r){var t=numeric.dim(r);if(2!==t.length||t[0]!==t[1])throw new Error("numeric: det() only works on square matrices");var n,e,i,o,s,a,u,f,c=t[0],h=1,m=numeric.clone(r);for(e=0;c-1>e;e++){for(i=e,n=e+1;c>n;n++)Math.abs(m[n][e])>Math.abs(m[i][e])&&(i=n);for(i!==e&&(u=m[i],m[i]=m[e],m[e]=u,h*=-1),o=m[e],n=e+1;c>n;n++){for(s=m[n],a=s[e]/o[e],i=e+1;c-1>i;i+=2)f=i+1,s[i]-=o[i]*a,s[f]-=o[f]*a;i!==c&&(s[i]-=o[i]*a)}if(0===o[e])return 0;h*=o[e]}return h*m[e][e]},numeric.transpose=function(r){var t,n,e,i,o,s=r.length,a=r[0].length,u=Array(a);for(n=0;a>n;n++)u[n]=Array(s);for(t=s-1;t>=1;t-=2){for(i=r[t],e=r[t-1],n=a-1;n>=1;--n)o=u[n],o[t]=i[n],o[t-1]=e[n],--n,o=u[n],o[t]=i[n],o[t-1]=e[n];0===n&&(o=u[0],o[t]=i[0],o[t-1]=e[0])}if(0===t){for(e=r[0],n=a-1;n>=1;--n)u[n][0]=e[n],--n,u[n][0]=e[n];0===n&&(u[0][0]=e[0])}return u},numeric.negtranspose=function(r){var t,n,e,i,o,s=r.length,a=r[0].length,u=Array(a);for(n=0;a>n;n++)u[n]=Array(s);for(t=s-1;t>=1;t-=2){for(i=r[t],e=r[t-1],n=a-1;n>=1;--n)o=u[n],o[t]=-i[n],o[t-1]=-e[n],--n,o=u[n],o[t]=-i[n],o[t-1]=-e[n];0===n&&(o=u[0],o[t]=-i[0],o[t-1]=-e[0])}if(0===t){for(e=r[0],n=a-1;n>=1;--n)u[n][0]=-e[n],--n,u[n][0]=-e[n];0===n&&(u[0][0]=-e[0])}return u},numeric._random=function o(r,t){var n,e,i=r[t],s=Array(i);if(t===r.length-1){for(e=Math.random,n=i-1;n>=1;n-=2)s[n]=e(),s[n-1]=e();return 0===n&&(s[0]=e()),s}for(n=i-1;n>=0;n--)s[n]=o(r,t+1);return s},numeric.random=function(r){return numeric._random(r,0)},numeric.norm2=function(r){return Math.sqrt(numeric.norm2Squared(r))},numeric.linspace=function(r,t,n){if("undefined"==typeof n&&(n=Math.max(Math.round(t-r)+1,1)),2>n)return 1===n?[r]:[];var e,i=Array(n);for(n--,e=n;e>=0;e--)i[e]=(e*t+(n-e)*r)/n;return i},numeric.getBlock=function(r,t,n){function e(r,o){var s,a=t[o],u=n[o]-a,f=Array(u);if(o===i.length-1){for(s=u;s>=0;s--)f[s]=r[s+a];return f}for(s=u;s>=0;s--)f[s]=e(r[s+a],o+1);return f}var i=numeric.dim(r);return e(r,0)},numeric.setBlock=function(r,t,n,e){function i(r,e,s){var a,u=t[s],f=n[s]-u;if(s===o.length-1)for(a=f;a>=0;a--)r[a+u]=e[a];for(a=f;a>=0;a--)i(r[a+u],e[a],s+1)}var o=numeric.dim(r);return i(r,e,0),r},numeric.getRange=function(r,t,n){var e,i,o,s,a=t.length,u=n.length,f=Array(a);for(e=a-1;-1!==e;--e)for(f[e]=Array(u),o=f[e],s=r[t[e]],i=u-1;-1!==i;--i)o[i]=s[n[i]];return f},numeric.blockMatrix=function(r){var t=numeric.dim(r);if(t.length<4)return numeric.blockMatrix([r]);var n,e,i,o,s,a=t[0],u=t[1];for(n=0,e=0,i=0;a>i;++i)n+=r[i][0].length;for(o=0;u>o;++o)e+=r[0][o][0].length;var f=Array(n);for(i=0;n>i;++i)f[i]=Array(e);var c,h,m,l,p,d=0;for(i=0;a>i;++i){for(c=e,o=u-1;-1!==o;--o)for(s=r[i][o],c-=s[0].length,m=s.length-1;-1!==m;--m)for(p=s[m],h=f[d+m],l=p.length-1;-1!==l;--l)h[c+l]=p[l];d+=r[i][0].length}return f},numeric.tensor=function(r,t){if("number"==typeof r||"number"==typeof t)return numeric.mul(r,t);var n=numeric.dim(r),e=numeric.dim(t);if(1!==n.length||1!==e.length)throw new Error("numeric: tensor product is only defined for vectors");var i,o,s,a,u=n[0],f=e[0],c=Array(u);for(o=u-1;o>=0;o--){for(i=Array(f),a=r[o],s=f-1;s>=3;--s)i[s]=a*t[s],--s,i[s]=a*t[s],--s,i[s]=a*t[s],--s,i[s]=a*t[s];for(;s>=0;)i[s]=a*t[s],--s;c[o]=i}return c},numeric.T=function(r,t){this.x=r,this.y=t},numeric.t=function(r,t){return new numeric.T(r,t)},numeric.Tbinop=function(r,t,n,e,i){numeric.indexOf;if("string"!=typeof i){var o;i="";for(o in numeric)numeric.hasOwnProperty(o)&&(r.indexOf(o)>=0||t.indexOf(o)>=0||n.indexOf(o)>=0||e.indexOf(o)>=0)&&o.length>1&&(i+="var "+o+" = numeric."+o+";\n")}return Function(["y"],"var x = this;\nif(!(y instanceof numeric.T)) { y = new numeric.T(y); }\n"+i+"\nif(x.y) {  if(y.y) {    return new numeric.T("+e+");\n  }\n  return new numeric.T("+n+");\n}\nif(y.y) {\n  return new numeric.T("+t+");\n}\nreturn new numeric.T("+r+");\n")},numeric.T.prototype.add=numeric.Tbinop("add(x.x,y.x)","add(x.x,y.x),y.y","add(x.x,y.x),x.y","add(x.x,y.x),add(x.y,y.y)"),numeric.T.prototype.sub=numeric.Tbinop("sub(x.x,y.x)","sub(x.x,y.x),neg(y.y)","sub(x.x,y.x),x.y","sub(x.x,y.x),sub(x.y,y.y)"),numeric.T.prototype.mul=numeric.Tbinop("mul(x.x,y.x)","mul(x.x,y.x),mul(x.x,y.y)","mul(x.x,y.x),mul(x.y,y.x)","sub(mul(x.x,y.x),mul(x.y,y.y)),add(mul(x.x,y.y),mul(x.y,y.x))"),numeric.T.prototype.reciprocal=function(){var r=numeric.mul,t=numeric.div;if(this.y){var n=numeric.add(r(this.x,this.x),r(this.y,this.y));return new numeric.T(t(this.x,n),t(numeric.neg(this.y),n))}return new T(t(1,this.x))},numeric.T.prototype.div=function s(r){if(r instanceof numeric.T||(r=new numeric.T(r)),r.y)return this.mul(r.reciprocal());var s=numeric.div;return this.y?new numeric.T(s(this.x,r.x),s(this.y,r.x)):new numeric.T(s(this.x,r.x))},numeric.T.prototype.dot=numeric.Tbinop("dot(x.x,y.x)","dot(x.x,y.x),dot(x.x,y.y)","dot(x.x,y.x),dot(x.y,y.x)","sub(dot(x.x,y.x),dot(x.y,y.y)),add(dot(x.x,y.y),dot(x.y,y.x))"),numeric.T.prototype.transpose=function(){var r=numeric.transpose,t=this.x,n=this.y;return n?new numeric.T(r(t),r(n)):new numeric.T(r(t))},numeric.T.prototype.transjugate=function(){var r=numeric.transpose,t=this.x,n=this.y;return n?new numeric.T(r(t),numeric.negtranspose(n)):new numeric.T(r(t))},numeric.Tunop=function(r,t,n){return"string"!=typeof n&&(n=""),Function("var x = this;\n"+n+"\nif(x.y) {  "+t+";\n}\n"+r+";\n")},numeric.T.prototype.exp=numeric.Tunop("return new numeric.T(ex)","return new numeric.T(mul(cos(x.y),ex),mul(sin(x.y),ex))","var ex = numeric.exp(x.x), cos = numeric.cos, sin = numeric.sin, mul = numeric.mul;"),numeric.T.prototype.conj=numeric.Tunop("return new numeric.T(x.x);","return new numeric.T(x.x,numeric.neg(x.y));"),numeric.T.prototype.neg=numeric.Tunop("return new numeric.T(neg(x.x));","return new numeric.T(neg(x.x),neg(x.y));","var neg = numeric.neg;"),numeric.T.prototype.sin=numeric.Tunop("return new numeric.T(numeric.sin(x.x))","return x.exp().sub(x.neg().exp()).div(new numeric.T(0,2));"),numeric.T.prototype.cos=numeric.Tunop("return new numeric.T(numeric.cos(x.x))","return x.exp().add(x.neg().exp()).div(2);"),numeric.T.prototype.abs=numeric.Tunop("return new numeric.T(numeric.abs(x.x));","return new numeric.T(numeric.sqrt(numeric.add(mul(x.x,x.x),mul(x.y,x.y))));","var mul = numeric.mul;"),numeric.T.prototype.log=numeric.Tunop("return new numeric.T(numeric.log(x.x));","var theta = new numeric.T(numeric.atan2(x.y,x.x)), r = x.abs();\nreturn new numeric.T(numeric.log(r.x),theta.x);"),numeric.T.prototype.norm2=numeric.Tunop("return numeric.norm2(x.x);","var f = numeric.norm2Squared;\nreturn Math.sqrt(f(x.x)+f(x.y));"),numeric.T.prototype.inv=function(){var r=this;if("undefined"==typeof r.y)return new numeric.T(numeric.inv(r.x));var t,n,e,i,o,s,a,u,f,c,h,t,n,e,m,l,p,d,g,v,y,w=r.x.length,x=numeric.identity(w),M=numeric.rep([w,w],0),b=numeric.clone(r.x),k=numeric.clone(r.y);for(t=0;w>t;t++){for(p=b[t][t],d=k[t][t],m=p*p+d*d,e=t,n=t+1;w>n;n++)p=b[n][t],d=k[n][t],l=p*p+d*d,l>m&&(e=n,m=l);for(e!==t&&(y=b[t],b[t]=b[e],b[e]=y,y=k[t],k[t]=k[e],k[e]=y,y=x[t],x[t]=x[e],x[e]=y,y=M[t],M[t]=M[e],M[e]=y),i=b[t],o=k[t],u=x[t],f=M[t],p=i[t],d=o[t],n=t+1;w>n;n++)g=i[n],v=o[n],i[n]=(g*p+v*d)/m,o[n]=(v*p-g*d)/m;for(n=0;w>n;n++)g=u[n],v=f[n],u[n]=(g*p+v*d)/m,f[n]=(v*p-g*d)/m;for(n=t+1;w>n;n++){for(s=b[n],a=k[n],c=x[n],h=M[n],p=s[t],d=a[t],e=t+1;w>e;e++)g=i[e],v=o[e],s[e]-=g*p-v*d,a[e]-=v*p+g*d;for(e=0;w>e;e++)g=u[e],v=f[e],c[e]-=g*p-v*d,h[e]-=v*p+g*d}}for(t=w-1;t>0;t--)for(u=x[t],f=M[t],n=t-1;n>=0;n--)for(c=x[n],h=M[n],p=b[n][t],d=k[n][t],e=w-1;e>=0;e--)g=u[e],v=f[e],c[e]-=p*g-d*v,h[e]-=p*v+d*g;return new numeric.T(x,M)},numeric.T.prototype.get=function(r){var t,n=this.x,e=this.y,i=0,o=r.length;if(e){for(;o>i;)t=r[i],n=n[t],e=e[t],i++;return new numeric.T(n,e)}for(;o>i;)t=r[i],n=n[t],i++;return new numeric.T(n)},numeric.T.prototype.set=function(r,t){var n,e=this.x,i=this.y,o=0,s=r.length,a=t.x,u=t.y;if(0===s)return u?this.y=u:i&&(this.y=void 0),this.x=e,this;if(u){for(i||(i=numeric.rep(numeric.dim(e),0),this.y=i);s-1>o;)n=r[o],e=e[n],i=i[n],o++;return n=r[o],e[n]=a,i[n]=u,this}if(i){for(;s-1>o;)n=r[o],e=e[n],i=i[n],o++;return n=r[o],e[n]=a,i[n]=a instanceof Array?numeric.rep(numeric.dim(a),0):0,this}for(;s-1>o;)n=r[o],e=e[n],o++;return n=r[o],e[n]=a,this},numeric.T.prototype.getRows=function(r,t){var n,e,i=t-r+1,o=Array(i),s=this.x,a=this.y;
for(n=r;t>=n;n++)o[n-r]=s[n];if(a){for(e=Array(i),n=r;t>=n;n++)e[n-r]=a[n];return new numeric.T(o,e)}return new numeric.T(o)},numeric.T.prototype.setRows=function(r,t,n){var e,i=this.x,o=this.y,s=n.x,a=n.y;for(e=r;t>=e;e++)i[e]=s[e-r];if(a)for(o||(o=numeric.rep(numeric.dim(i),0),this.y=o),e=r;t>=e;e++)o[e]=a[e-r];else if(o)for(e=r;t>=e;e++)o[e]=numeric.rep([s[e-r].length],0);return this},numeric.T.prototype.getRow=function(r){var t=this.x,n=this.y;return n?new numeric.T(t[r],n[r]):new numeric.T(t[r])},numeric.T.prototype.setRow=function(r,t){var n=this.x,e=this.y,i=t.x,o=t.y;return n[r]=i,o?(e||(e=numeric.rep(numeric.dim(n),0),this.y=e),e[r]=o):e&&(e=numeric.rep([i.length],0)),this},numeric.T.prototype.getBlock=function(r,t){var n=this.x,e=this.y,i=numeric.getBlock;return e?new numeric.T(i(n,r,t),i(e,r,t)):new numeric.T(i(n,r,t))},numeric.T.prototype.setBlock=function(r,t,n){n instanceof numeric.T||(n=new numeric.T(n));var e=this.x,i=this.y,o=numeric.setBlock,s=n.x,a=n.y;return a?(i||(this.y=numeric.rep(numeric.dim(this),0),i=this.y),o(e,r,t,s),o(i,r,t,a),this):(o(e,r,t,s),void(i&&o(i,r,t,numeric.rep(numeric.dim(s),0))))},numeric.T.rep=function(r,t){var n=numeric.T;t instanceof n||(t=new n(t));var e=t.x,i=t.y,o=numeric.rep;return i?new n(o(r,e),o(r,i)):new n(o(r,e))},numeric.T.diag=function a(r){r instanceof numeric.T||(r=new numeric.T(r));var t=r.x,n=r.y,a=numeric.diag;return n?new numeric.T(a(t),a(n)):new numeric.T(a(t))},numeric.T.eig=function(){if(this.y)throw new Error("eig: not implemented for complex matrices.");return numeric.eig(this.x)},numeric.T.identity=function(r){return new numeric.T(numeric.identity(r))},numeric.T.prototype.getDiag=function(){var r=numeric,t=this.x,n=this.y;return n?new r.T(r.getDiag(t),r.getDiag(n)):new r.T(r.getDiag(t))},numeric.house=function(r){var t=numeric.clone(r),n=r[0]>=0?1:-1,e=n*numeric.norm2(r);t[0]+=e;var i=numeric.norm2(t);if(0===i)throw new Error("eig: internal error");return numeric.div(t,i)},numeric.toUpperHessenberg=function(r){var t=numeric.dim(r);if(2!==t.length||t[0]!==t[1])throw new Error("numeric: toUpperHessenberg() only works on square matrices");var n,e,i,o,s,a,u,f,c,h,m=t[0],l=numeric.clone(r),p=numeric.identity(m);for(e=0;m-2>e;e++){for(o=Array(m-e-1),n=e+1;m>n;n++)o[n-e-1]=l[n][e];if(numeric.norm2(o)>0){for(s=numeric.house(o),a=numeric.getBlock(l,[e+1,e],[m-1,m-1]),u=numeric.tensor(s,numeric.dot(s,a)),n=e+1;m>n;n++)for(f=l[n],c=u[n-e-1],i=e;m>i;i++)f[i]-=2*c[i-e];for(a=numeric.getBlock(l,[0,e+1],[m-1,m-1]),u=numeric.tensor(numeric.dot(a,s),s),n=0;m>n;n++)for(f=l[n],c=u[n],i=e+1;m>i;i++)f[i]-=2*c[i-e-1];for(a=Array(m-e-1),n=e+1;m>n;n++)a[n-e-1]=p[n];for(u=numeric.tensor(s,numeric.dot(s,a)),n=e+1;m>n;n++)for(h=p[n],c=u[n-e-1],i=0;m>i;i++)h[i]-=2*c[i]}}return{H:l,Q:p}},numeric.epsilon=2.220446049250313e-16,numeric.QRFrancis=function(r,t){"undefined"==typeof t&&(t=1e4),r=numeric.clone(r);var n,e,i,o,s,a,u,f,c,h,m,l,p,d,g,v,y,w,x=(numeric.clone(r),numeric.dim(r)),M=x[0],b=numeric.identity(M);if(3>M)return{Q:b,B:[[0,M-1]]};var k=numeric.epsilon;for(w=0;t>w;w++){for(v=0;M-1>v;v++)if(Math.abs(r[v+1][v])<k*(Math.abs(r[v][v])+Math.abs(r[v+1][v+1]))){var A=numeric.QRFrancis(numeric.getBlock(r,[0,0],[v,v]),t),S=numeric.QRFrancis(numeric.getBlock(r,[v+1,v+1],[M-1,M-1]),t);for(l=Array(v+1),g=0;v>=g;g++)l[g]=b[g];for(p=numeric.dot(A.Q,l),g=0;v>=g;g++)b[g]=p[g];for(l=Array(M-v-1),g=v+1;M>g;g++)l[g-v-1]=b[g];for(p=numeric.dot(S.Q,l),g=v+1;M>g;g++)b[g]=p[g-v-1];return{Q:b,B:A.B.concat(numeric.add(S.B,v+1))}}if(i=r[M-2][M-2],o=r[M-2][M-1],s=r[M-1][M-2],a=r[M-1][M-1],f=i+a,u=i*a-o*s,c=numeric.getBlock(r,[0,0],[2,2]),f*f>=4*u){var j,R;j=.5*(f+Math.sqrt(f*f-4*u)),R=.5*(f-Math.sqrt(f*f-4*u)),c=numeric.add(numeric.sub(numeric.dot(c,c),numeric.mul(c,j+R)),numeric.diag(numeric.rep([3],j*R)))}else c=numeric.add(numeric.sub(numeric.dot(c,c),numeric.mul(c,f)),numeric.diag(numeric.rep([3],u)));for(n=[c[0][0],c[1][0],c[2][0]],e=numeric.house(n),l=[r[0],r[1],r[2]],p=numeric.tensor(e,numeric.dot(e,l)),g=0;3>g;g++)for(m=r[g],d=p[g],y=0;M>y;y++)m[y]-=2*d[y];for(l=numeric.getBlock(r,[0,0],[M-1,2]),p=numeric.tensor(numeric.dot(l,e),e),g=0;M>g;g++)for(m=r[g],d=p[g],y=0;3>y;y++)m[y]-=2*d[y];for(l=[b[0],b[1],b[2]],p=numeric.tensor(e,numeric.dot(e,l)),g=0;3>g;g++)for(h=b[g],d=p[g],y=0;M>y;y++)h[y]-=2*d[y];var q;for(v=0;M-2>v;v++){for(y=v;v+1>=y;y++)if(Math.abs(r[y+1][y])<k*(Math.abs(r[y][y])+Math.abs(r[y+1][y+1]))){var A=numeric.QRFrancis(numeric.getBlock(r,[0,0],[y,y]),t),S=numeric.QRFrancis(numeric.getBlock(r,[y+1,y+1],[M-1,M-1]),t);for(l=Array(y+1),g=0;y>=g;g++)l[g]=b[g];for(p=numeric.dot(A.Q,l),g=0;y>=g;g++)b[g]=p[g];for(l=Array(M-y-1),g=y+1;M>g;g++)l[g-y-1]=b[g];for(p=numeric.dot(S.Q,l),g=y+1;M>g;g++)b[g]=p[g-y-1];return{Q:b,B:A.B.concat(numeric.add(S.B,y+1))}}for(q=Math.min(M-1,v+3),n=Array(q-v),g=v+1;q>=g;g++)n[g-v-1]=r[g][v];for(e=numeric.house(n),l=numeric.getBlock(r,[v+1,v],[q,M-1]),p=numeric.tensor(e,numeric.dot(e,l)),g=v+1;q>=g;g++)for(m=r[g],d=p[g-v-1],y=v;M>y;y++)m[y]-=2*d[y-v];for(l=numeric.getBlock(r,[0,v+1],[M-1,q]),p=numeric.tensor(numeric.dot(l,e),e),g=0;M>g;g++)for(m=r[g],d=p[g],y=v+1;q>=y;y++)m[y]-=2*d[y-v-1];for(l=Array(q-v),g=v+1;q>=g;g++)l[g-v-1]=b[g];for(p=numeric.tensor(e,numeric.dot(e,l)),g=v+1;q>=g;g++)for(h=b[g],d=p[g-v-1],y=0;M>y;y++)h[y]-=2*d[y]}}throw new Error("numeric: eigenvalue iteration does not converge -- increase maxiter?")},numeric.eig=function(r,t){var n,e,i,o,s,a,u,f,c,h,m,l,p,d,g,v,y,w=numeric.toUpperHessenberg(r),x=numeric.QRFrancis(w.H,t),M=numeric.T,b=r.length,k=x.B,A=numeric.dot(x.Q,numeric.dot(w.H,numeric.transpose(x.Q))),S=new M(numeric.dot(x.Q,w.Q)),j=k.length,R=Math.sqrt;for(e=0;j>e;e++)if(n=k[e][0],n===k[e][1]);else{if(o=n+1,s=A[n][n],a=A[n][o],u=A[o][n],f=A[o][o],0===a&&0===u)continue;c=-s-f,h=s*f-a*u,m=c*c-4*h,m>=0?(l=0>c?-.5*(c-R(m)):-.5*(c+R(m)),v=(s-l)*(s-l)+a*a,y=u*u+(f-l)*(f-l),v>y?(v=R(v),d=(s-l)/v,g=a/v):(y=R(y),d=u/y,g=(f-l)/y),i=new M([[g,-d],[d,g]]),S.setRows(n,o,i.dot(S.getRows(n,o)))):(l=-.5*c,p=.5*R(-m),v=(s-l)*(s-l)+a*a,y=u*u+(f-l)*(f-l),v>y?(v=R(v+p*p),d=(s-l)/v,g=a/v,l=0,p/=v):(y=R(y+p*p),d=u/y,g=(f-l)/y,l=p/y,p=0),i=new M([[g,-d],[d,g]],[[l,p],[p,-l]]),S.setRows(n,o,i.dot(S.getRows(n,o))))}var q=S.dot(r).dot(S.transjugate()),b=r.length,T=numeric.T.identity(b);for(o=0;b>o;o++)if(o>0)for(e=o-1;e>=0;e--){var V=q.get([e,e]),D=q.get([o,o]);numeric.neq(V.x,D.x)||numeric.neq(V.y,D.y)?(l=q.getRow(e).getBlock([e],[o-1]),p=T.getRow(o).getBlock([e],[o-1]),T.set([o,e],q.get([e,o]).neg().sub(l.dot(p)).div(V.sub(D)))):T.setRow(o,T.getRow(e))}for(o=0;b>o;o++)l=T.getRow(o),T.setRow(o,l.div(l.norm2()));return T=T.transpose(),T=S.transjugate().dot(T),{lambda:q.getDiag(),E:T}},numeric.ccsSparse=function(r){var t,n,e,i,o=r.length,s=[];for(e=o-1;-1!==e;--e){n=r[e];for(i in n){for(i=parseInt(i);i>=s.length;)s[s.length]=0;0!==n[i]&&s[i]++}}var t=s.length,a=Array(t+1);for(a[0]=0,e=0;t>e;++e)a[e+1]=a[e]+s[e];var u=Array(a[t]),f=Array(a[t]);for(e=o-1;-1!==e;--e){n=r[e];for(i in n)0!==n[i]&&(s[i]--,u[a[i]+s[i]]=e,f[a[i]+s[i]]=n[i])}return[a,u,f]},numeric.ccsFull=function(r){var t,n,e,i,o=r[0],s=r[1],a=r[2],u=numeric.ccsDim(r),f=u[0],c=u[1],h=numeric.rep([f,c],0);for(t=0;c>t;t++)for(e=o[t],i=o[t+1],n=e;i>n;++n)h[s[n]][t]=a[n];return h},numeric.ccsTSolve=function(r,t,n,e,i){function o(r){var t;if(0===n[r]){for(n[r]=1,t=s[r];t<s[r+1];++t)o(a[t]);i[h]=r,++h}}var s=r[0],a=r[1],u=r[2],f=s.length-1,c=Math.max,h=0;"undefined"==typeof e&&(n=numeric.rep([f],0)),"undefined"==typeof e&&(e=numeric.linspace(0,n.length-1)),"undefined"==typeof i&&(i=[]);var m,l,p,d,g,v,y;for(m=e.length-1;-1!==m;--m)o(e[m]);for(i.length=h,m=i.length-1;-1!==m;--m)n[i[m]]=0;for(m=e.length-1;-1!==m;--m)l=e[m],n[l]=t[l];for(m=i.length-1;-1!==m;--m){for(l=i[m],p=s[l],d=c(s[l+1],p),g=p;g!==d;++g)if(a[g]===l){n[l]/=u[g];break}for(y=n[l],g=p;g!==d;++g)v=a[g],v!==l&&(n[v]-=y*u[g])}return n},numeric.ccsDFS=function(r){this.k=Array(r),this.k1=Array(r),this.j=Array(r)},numeric.ccsDFS.prototype.dfs=function(r,t,n,e,i,o){var s,a,u,f=0,c=i.length,h=this.k,m=this.k1,l=this.j;if(0===e[r])for(e[r]=1,l[0]=r,h[0]=a=t[r],m[0]=u=t[r+1];;)if(a>=u){if(i[c]=l[f],0===f)return;++c,--f,a=h[f],u=m[f]}else s=o[n[a]],0===e[s]?(e[s]=1,h[f]=a,++f,l[f]=s,a=t[s],m[f]=u=t[s+1]):++a},numeric.ccsLPSolve=function(r,t,n,e,i,o,s){var a,u,f,c,h,m,l,p,d,g=r[0],v=r[1],y=r[2],w=(g.length-1,t[0]),x=t[1],M=t[2];for(u=w[i],f=w[i+1],e.length=0,a=u;f>a;++a)s.dfs(o[x[a]],g,v,n,e,o);for(a=e.length-1;-1!==a;--a)n[e[a]]=0;for(a=u;a!==f;++a)c=o[x[a]],n[c]=M[a];for(a=e.length-1;-1!==a;--a){for(c=e[a],h=g[c],m=g[c+1],l=h;m>l;++l)if(o[v[l]]===c){n[c]/=y[l];break}for(d=n[c],l=h;m>l;++l)p=o[v[l]],p!==c&&(n[p]-=d*y[l])}return n},numeric.ccsLUP1=function(r,t){var n,e,i,o,s,a,u,f=r[0].length-1,c=[numeric.rep([f+1],0),[],[]],h=[numeric.rep([f+1],0),[],[]],m=c[0],l=c[1],p=c[2],d=h[0],g=h[1],v=h[2],y=numeric.rep([f],0),w=numeric.rep([f],0),x=numeric.ccsLPSolve,M=(Math.max,Math.abs),b=numeric.linspace(0,f-1),k=numeric.linspace(0,f-1),A=new numeric.ccsDFS(f);for("undefined"==typeof t&&(t=1),n=0;f>n;++n){for(x(c,r,y,w,n,k,A),o=-1,s=-1,e=w.length-1;-1!==e;--e)i=w[e],n>=i||(a=M(y[i]),a>o&&(s=i,o=a));for(M(y[n])<t*o&&(e=b[n],o=b[s],b[n]=o,k[o]=n,b[s]=e,k[e]=s,o=y[n],y[n]=y[s],y[s]=o),o=m[n],s=d[n],u=y[n],l[o]=b[n],p[o]=1,++o,e=w.length-1;-1!==e;--e)i=w[e],a=y[i],w[e]=0,y[i]=0,n>=i?(g[s]=i,v[s]=a,++s):(l[o]=b[i],p[o]=a/u,++o);m[n+1]=o,d[n+1]=s}for(e=l.length-1;-1!==e;--e)l[e]=k[l[e]];return{L:c,U:h,P:b,Pinv:k}},numeric.ccsDFS0=function(r){this.k=Array(r),this.k1=Array(r),this.j=Array(r)},numeric.ccsDFS0.prototype.dfs=function(r,t,n,e,i,o){var s,a,u,f=0,c=i.length,h=this.k,m=this.k1,l=this.j;if(0===e[r])for(e[r]=1,l[0]=r,h[0]=a=t[o[r]],m[0]=u=t[o[r]+1];;){if(isNaN(a))throw new Error("Ow!");if(a>=u){if(i[c]=o[l[f]],0===f)return;++c,--f,a=h[f],u=m[f]}else s=n[a],0===e[s]?(e[s]=1,h[f]=a,++f,l[f]=s,s=o[s],a=t[s],m[f]=u=t[s+1]):++a}},numeric.ccsLPSolve0=function(r,t,n,e,i,o,s,a){var u,f,c,h,m,l,p,d,g,v=r[0],y=r[1],w=r[2],x=(v.length-1,t[0]),M=t[1],b=t[2];for(f=x[i],c=x[i+1],e.length=0,u=f;c>u;++u)a.dfs(M[u],v,y,n,e,o,s);for(u=e.length-1;-1!==u;--u)h=e[u],n[s[h]]=0;for(u=f;u!==c;++u)h=M[u],n[h]=b[u];for(u=e.length-1;-1!==u;--u){for(h=e[u],d=s[h],m=v[h],l=v[h+1],p=m;l>p;++p)if(y[p]===d){n[d]/=w[p];break}for(g=n[d],p=m;l>p;++p)n[y[p]]-=g*w[p];n[d]=g}},numeric.ccsLUP0=function(r,t){var n,e,i,o,s,a,u,f=r[0].length-1,c=[numeric.rep([f+1],0),[],[]],h=[numeric.rep([f+1],0),[],[]],m=c[0],l=c[1],p=c[2],d=h[0],g=h[1],v=h[2],y=numeric.rep([f],0),w=numeric.rep([f],0),x=numeric.ccsLPSolve0,M=(Math.max,Math.abs),b=numeric.linspace(0,f-1),k=numeric.linspace(0,f-1),A=new numeric.ccsDFS0(f);for("undefined"==typeof t&&(t=1),n=0;f>n;++n){for(x(c,r,y,w,n,k,b,A),o=-1,s=-1,e=w.length-1;-1!==e;--e)i=w[e],n>=i||(a=M(y[b[i]]),a>o&&(s=i,o=a));for(M(y[b[n]])<t*o&&(e=b[n],o=b[s],b[n]=o,k[o]=n,b[s]=e,k[e]=s),o=m[n],s=d[n],u=y[b[n]],l[o]=b[n],p[o]=1,++o,e=w.length-1;-1!==e;--e)i=w[e],a=y[b[i]],w[e]=0,y[b[i]]=0,n>=i?(g[s]=i,v[s]=a,++s):(l[o]=b[i],p[o]=a/u,++o);m[n+1]=o,d[n+1]=s}for(e=l.length-1;-1!==e;--e)l[e]=k[l[e]];return{L:c,U:h,P:b,Pinv:k}},numeric.ccsLUP=numeric.ccsLUP0,numeric.ccsDim=function(r){return[numeric.sup(r[1])+1,r[0].length-1]},numeric.ccsGetBlock=function(r,t,n){var e=numeric.ccsDim(r),i=e[0],o=e[1];"undefined"==typeof t?t=numeric.linspace(0,i-1):"number"==typeof t&&(t=[t]),"undefined"==typeof n?n=numeric.linspace(0,o-1):"number"==typeof n&&(n=[n]);var s,a,u,f,c,h=t.length,m=n.length,l=numeric.rep([o],0),p=[],d=[],g=[l,p,d],v=r[0],y=r[1],w=r[2],x=numeric.rep([i],0),M=0,b=numeric.rep([i],0);for(a=0;m>a;++a){f=n[a];var k=v[f],A=v[f+1];for(s=k;A>s;++s)u=y[s],b[u]=1,x[u]=w[s];for(s=0;h>s;++s)c=t[s],b[c]&&(p[M]=s,d[M]=x[t[s]],++M);for(s=k;A>s;++s)u=y[s],b[u]=0;l[a+1]=M}return g},numeric.ccsDot=function(r,t){var n,e,i,o,s,a,u,f,c,h,m,l=r[0],p=r[1],d=r[2],g=t[0],v=t[1],y=t[2],w=numeric.ccsDim(r),x=numeric.ccsDim(t),M=w[0],b=(w[1],x[1]),k=numeric.rep([M],0),A=numeric.rep([M],0),S=Array(M),j=numeric.rep([b],0),R=[],q=[],T=[j,R,q];for(i=0;i!==b;++i){for(o=g[i],s=g[i+1],c=0,e=o;s>e;++e)for(h=v[e],m=y[e],a=l[h],u=l[h+1],n=a;u>n;++n)f=p[n],0===A[f]&&(S[c]=f,A[f]=1,c+=1),k[f]=k[f]+d[n]*m;for(o=j[i],s=o+c,j[i+1]=s,e=c-1;-1!==e;--e)m=o+e,n=S[e],R[m]=n,q[m]=k[n],A[n]=0,k[n]=0;j[i+1]=j[i]+c}return T},numeric.ccsLUPSolve=function(r,t){var n=r.L,e=r.U,i=(r.P,t[0]),o=!1;"object"!=typeof i&&(t=[[0,t.length],numeric.linspace(0,t.length-1),t],i=t[0],o=!0);var s,a,u,f,c,h,m=t[1],l=t[2],p=n[0].length-1,d=i.length-1,g=numeric.rep([p],0),v=Array(p),y=numeric.rep([p],0),w=Array(p),x=numeric.rep([d+1],0),M=[],b=[],k=numeric.ccsTSolve,A=0;for(s=0;d>s;++s){for(c=0,u=i[s],f=i[s+1],a=u;f>a;++a)h=r.Pinv[m[a]],w[c]=h,y[h]=l[a],++c;for(w.length=c,k(n,y,g,w,v),a=w.length-1;-1!==a;--a)y[w[a]]=0;if(k(e,g,y,v,w),o)return y;for(a=v.length-1;-1!==a;--a)g[v[a]]=0;for(a=w.length-1;-1!==a;--a)h=w[a],M[A]=h,b[A]=y[h],y[h]=0,++A;x[s+1]=A}return[x,M,b]},numeric.ccsbinop=function(r,t){return"undefined"==typeof t&&(t=""),Function("X","Y","var Xi = X[0], Xj = X[1], Xv = X[2];\nvar Yi = Y[0], Yj = Y[1], Yv = Y[2];\nvar n = Xi.length-1,m = Math.max(numeric.sup(Xj),numeric.sup(Yj))+1;\nvar Zi = numeric.rep([n+1],0), Zj = [], Zv = [];\nvar x = numeric.rep([m],0),y = numeric.rep([m],0);\nvar xk,yk,zk;\nvar i,j,j0,j1,k,p=0;\n"+t+"for(i=0;i<n;++i) {\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Xj[j];\n    x[k] = 1;\n    Zj[p] = k;\n    ++p;\n  }\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Yj[j];\n    y[k] = Yv[j];\n    if(x[k] === 0) {\n      Zj[p] = k;\n      ++p;\n    }\n  }\n  Zi[i+1] = p;\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = Xv[j];\n  j0 = Zi[i]; j1 = Zi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Zj[j];\n    xk = x[k];\n    yk = y[k];\n"+r+"\n    Zv[j] = zk;\n  }\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = 0;\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) y[Yj[j]] = 0;\n}\nreturn [Zi,Zj,Zv];")},function(){var k,A,B,C;for(k in numeric.ops2)A=isFinite(eval("1"+numeric.ops2[k]+"0"))?"[Y[0],Y[1],numeric."+k+"(X,Y[2])]":"NaN",B=isFinite(eval("0"+numeric.ops2[k]+"1"))?"[X[0],X[1],numeric."+k+"(X[2],Y)]":"NaN",C=isFinite(eval("1"+numeric.ops2[k]+"0"))&&isFinite(eval("0"+numeric.ops2[k]+"1"))?"numeric.ccs"+k+"MM(X,Y)":"NaN",numeric["ccs"+k+"MM"]=numeric.ccsbinop("zk = xk "+numeric.ops2[k]+"yk;"),numeric["ccs"+k]=Function("X","Y",'if(typeof X === "number") return '+A+';\nif(typeof Y === "number") return '+B+";\nreturn "+C+";\n")}(),numeric.ccsScatter=function(r){var t,n=r[0],e=r[1],i=r[2],o=numeric.sup(e)+1,s=n.length,a=numeric.rep([o],0),u=Array(s),f=Array(s),c=numeric.rep([o],0);for(t=0;s>t;++t)c[e[t]]++;for(t=0;o>t;++t)a[t+1]=a[t]+c[t];var h,m,l=a.slice(0);for(t=0;s>t;++t)m=e[t],h=l[m],u[h]=n[t],f[h]=i[t],l[m]=l[m]+1;return[a,u,f]},numeric.ccsGather=function(r){var t,n,e,i,o,s=r[0],a=r[1],u=r[2],f=s.length-1,c=a.length,h=Array(c),m=Array(c),l=Array(c);for(o=0,t=0;f>t;++t)for(e=s[t],i=s[t+1],n=e;n!==i;++n)m[o]=t,h[o]=a[n],l[o]=u[n],++o;return[h,m,l]},numeric.sdim=function u(r,t,n){if("undefined"==typeof t&&(t=[]),"object"!=typeof r)return t;"undefined"==typeof n&&(n=0),n in t||(t[n]=0),r.length>t[n]&&(t[n]=r.length);var e;for(e in r)r.hasOwnProperty(e)&&u(r[e],t,n+1);return t},numeric.sclone=function f(r,t,n){"undefined"==typeof t&&(t=0),"undefined"==typeof n&&(n=numeric.sdim(r).length);var e,i=Array(r.length);if(t===n-1){for(e in r)r.hasOwnProperty(e)&&(i[e]=r[e]);return i}for(e in r)r.hasOwnProperty(e)&&(i[e]=f(r[e],t+1,n));return i},numeric.sdiag=function(r){var t,n,e=r.length,i=Array(e);for(t=e-1;t>=1;t-=2)n=t-1,i[t]=[],i[t][t]=r[t],i[n]=[],i[n][n]=r[n];return 0===t&&(i[0]=[],i[0][0]=r[t]),i},numeric.sidentity=function(r){return numeric.sdiag(numeric.rep([r],1))},numeric.stranspose=function(r){{var t,n,e,i=[];r.length}for(t in r)if(r.hasOwnProperty(t)){e=r[t];for(n in e)e.hasOwnProperty(n)&&("object"!=typeof i[n]&&(i[n]=[]),i[n][t]=e[n])}return i},numeric.sLUP=function(){throw new Error("The function numeric.sLUP had a bug in it and has been removed. Please use the new numeric.ccsLUP function instead.")},numeric.sdotMM=function(r,t){var n,e,i,o,s,a,u,f=r.length,c=(t.length,numeric.stranspose(t)),h=c.length,m=Array(f);for(i=f-1;i>=0;i--){for(u=[],n=r[i],s=h-1;s>=0;s--){a=0,e=c[s];for(o in n)n.hasOwnProperty(o)&&o in e&&(a+=n[o]*e[o]);a&&(u[s]=a)}m[i]=u}return m},numeric.sdotMV=function(r,t){var n,e,i,o,s=r.length,a=Array(s);for(e=s-1;e>=0;e--){n=r[e],o=0;for(i in n)n.hasOwnProperty(i)&&t[i]&&(o+=n[i]*t[i]);o&&(a[e]=o)}return a},numeric.sdotVM=function(r,t){var n,e,i,o,s=[];for(n in r)if(r.hasOwnProperty(n)){i=t[n],o=r[n];for(e in i)i.hasOwnProperty(e)&&(s[e]||(s[e]=0),s[e]+=o*i[e])}return s},numeric.sdotVV=function(r,t){var n,e=0;for(n in r)r[n]&&t[n]&&(e+=r[n]*t[n]);return e},numeric.sdot=function(r,t){var n=numeric.sdim(r).length,e=numeric.sdim(t).length,i=1e3*n+e;switch(i){case 0:return r*t;case 1001:return numeric.sdotVV(r,t);case 2001:return numeric.sdotMV(r,t);case 1002:return numeric.sdotVM(r,t);case 2002:return numeric.sdotMM(r,t);default:throw new Error("numeric.sdot not implemented for tensors of order "+n+" and "+e)}},numeric.sscatter=function(r){var t,n,e,i,o=r[0].length,s=r.length,a=[];for(n=o-1;n>=0;--n)if(r[s-1][n]){for(i=a,e=0;s-2>e;e++)t=r[e][n],i[t]||(i[t]=[]),i=i[t];i[r[e][n]]=r[e+1][n]}return a},numeric.sgather=function c(r,t,n){"undefined"==typeof t&&(t=[]),"undefined"==typeof n&&(n=[]);var e,i,o;e=n.length;for(i in r)if(r.hasOwnProperty(i))if(n[e]=parseInt(i),o=r[i],"number"==typeof o){if(o){if(0===t.length)for(i=e+1;i>=0;--i)t[i]=[];for(i=e;i>=0;--i)t[i].push(n[i]);t[e+1].push(o)}}else c(o,t,n);return n.length>e&&n.pop(),t},numeric.cLU=function(r){var t,n,e,i,o,s,a=r[0],u=r[1],f=r[2],c=a.length,h=0;for(t=0;c>t;t++)a[t]>h&&(h=a[t]);h++;var m,l,p,d=Array(h),g=Array(h),v=numeric.rep([h],1/0),y=numeric.rep([h],-1/0);for(e=0;c>e;e++)t=a[e],n=u[e],n<v[t]&&(v[t]=n),n>y[t]&&(y[t]=n);for(t=0;h-1>t;t++)y[t]>y[t+1]&&(y[t+1]=y[t]);for(t=h-1;t>=1;t--)v[t]<v[t-1]&&(v[t-1]=v[t]);var w=0,x=0;for(t=0;h>t;t++)g[t]=numeric.rep([y[t]-v[t]+1],0),d[t]=numeric.rep([t-v[t]],0),w+=t-v[t]+1,x+=y[t]-t+1;for(e=0;c>e;e++)t=a[e],g[t][u[e]-v[t]]=f[e];for(t=0;h-1>t;t++)for(i=t-v[t],m=g[t],n=t+1;v[n]<=t&&h>n;n++)if(o=t-v[n],s=y[t]-t,l=g[n],p=l[o]/m[i]){for(e=1;s>=e;e++)l[e+o]-=p*m[e+i];d[n][t-v[n]]=p}var c,M,b,m=[],l=[],k=[],A=[],S=[],j=[];for(c=0,M=0,t=0;h>t;t++){for(i=v[t],o=y[t],b=g[t],n=t;o>=n;n++)b[n-i]&&(m[c]=t,l[c]=n,k[c]=b[n-i],c++);for(b=d[t],n=i;t>n;n++)b[n-i]&&(A[M]=t,S[M]=n,j[M]=b[n-i],M++);A[M]=t,S[M]=t,j[M]=1,M++}return{U:[m,l,k],L:[A,S,j]}},numeric.cLUsolve=function(r,t){var n,e,i=r.L,o=r.U,s=numeric.clone(t),a=i[0],u=i[1],f=i[2],c=o[0],h=o[1],m=o[2],l=c.length,p=(a.length,s.length);for(e=0,n=0;p>n;n++){for(;u[e]<n;)s[n]-=f[e]*s[u[e]],e++;e++}for(e=l-1,n=p-1;n>=0;n--){for(;h[e]>n;)s[n]-=m[e]*s[h[e]],e--;s[n]/=m[e],e--}return s},numeric.cgrid=function(r,t){"number"==typeof r&&(r=[r,r]);var n,e,i,o=numeric.rep(r,-1);if("function"!=typeof t)switch(t){case"L":t=function(t,n){return t>=r[0]/2||n<r[1]/2};break;default:t=function(){return!0}}for(i=0,n=1;n<r[0]-1;n++)for(e=1;e<r[1]-1;e++)t(n,e)&&(o[n][e]=i,i++);return o},numeric.cdelsq=function(r){var t,n,e,i,o,s=[[-1,0],[0,-1],[0,1],[1,0]],a=numeric.dim(r),u=a[0],f=a[1],c=[],h=[],m=[];for(t=1;u-1>t;t++)for(n=1;f-1>n;n++)if(!(r[t][n]<0)){for(e=0;4>e;e++)i=t+s[e][0],o=n+s[e][1],r[i][o]<0||(c.push(r[t][n]),h.push(r[i][o]),m.push(-1));c.push(r[t][n]),h.push(r[t][n]),m.push(4)}return[c,h,m]},numeric.cdotMV=function(r,t){var n,e,i,o=r[0],s=r[1],a=r[2],u=o.length;for(i=0,e=0;u>e;e++)o[e]>i&&(i=o[e]);for(i++,n=numeric.rep([i],0),e=0;u>e;e++)n[o[e]]+=a[e]*t[s[e]];return n},numeric.Spline=function(r,t,n,e,i){this.x=r,this.yl=t,this.yr=n,this.kl=e,this.kr=i},numeric.Spline.prototype._at=function(r,t){var r,n,e,i,o=this.x,s=this.yl,a=this.yr,u=this.kl,f=this.kr,c=numeric.add,h=numeric.sub,m=numeric.mul;n=h(m(u[t],o[t+1]-o[t]),h(a[t+1],s[t])),e=c(m(f[t+1],o[t]-o[t+1]),h(a[t+1],s[t])),i=(r-o[t])/(o[t+1]-o[t]);var l=i*(1-i);return c(c(c(m(1-i,s[t]),m(i,a[t+1])),m(n,l*(1-i))),m(e,l*i))},numeric.Spline.prototype.at=function(r){if("number"==typeof r){var t,n,e,i=this.x,o=i.length,s=Math.floor;for(t=0,n=o-1;n-t>1;)e=s((t+n)/2),i[e]<=r?t=e:n=e;return this._at(r,t)}var a,o=r.length,u=Array(o);for(a=o-1;-1!==a;--a)u[a]=this.at(r[a]);return u},numeric.Spline.prototype.diff=function(){var r,t,n,e=this.x,i=this.yl,o=this.yr,s=this.kl,a=this.kr,u=i.length,f=s,c=a,h=Array(u),m=Array(u),l=numeric.add,p=numeric.mul,d=numeric.div,g=numeric.sub;for(r=u-1;-1!==r;--r)t=e[r+1]-e[r],n=g(o[r+1],i[r]),h[r]=d(l(p(n,6),p(s[r],-4*t),p(a[r+1],-2*t)),t*t),m[r+1]=d(l(p(n,-6),p(s[r],2*t),p(a[r+1],4*t)),t*t);return new numeric.Spline(e,f,c,h,m)},numeric.Spline.prototype.roots=function(){function r(r){return r*r}var t=[],n=this.x,e=this.yl,i=this.yr,o=this.kl,s=this.kr;"number"==typeof e[0]&&(e=[e],i=[i],o=[o],s=[s]);var a,u,f,c,h,m,l,p,d,g,v,y,w,x,M,b,k,A,S,j,R,q,T,V,D=e.length,C=n.length-1,t=Array(D),O=Math.sqrt;for(a=0;a!==D;++a){for(c=e[a],h=i[a],m=o[a],l=s[a],p=[],u=0;u!==C;u++){for(u>0&&h[u]*c[u]<0&&p.push(n[u]),b=n[u+1]-n[u],k=n[u],v=c[u],y=h[u+1],d=m[u]/b,g=l[u+1]/b,M=r(d-g+3*(v-y))+12*g*v,w=g+3*v+2*d-3*y,x=3*(g+d+2*(v-y)),0>=M?(S=w/x,A=S>n[u]&&S<n[u+1]?[n[u],S,n[u+1]]:[n[u],n[u+1]]):(S=(w-O(M))/x,j=(w+O(M))/x,A=[n[u]],S>n[u]&&S<n[u+1]&&A.push(S),j>n[u]&&j<n[u+1]&&A.push(j),A.push(n[u+1])),q=A[0],S=this._at(q,u),f=0;f<A.length-1;f++)if(T=A[f+1],j=this._at(T,u),0!==S)if(0===j||S*j>0)q=T,S=j;else{for(var E=0;;){if(V=(S*T-j*q)/(S-j),q>=V||V>=T)break;if(R=this._at(V,u),R*j>0)T=V,j=R,-1===E&&(S*=.5),E=-1;else{if(!(R*S>0))break;q=V,S=R,1===E&&(j*=.5),E=1}}p.push(V),q=A[f+1],S=this._at(q,u)}else p.push(q),q=T,S=j;0===j&&p.push(T)}t[a]=p}return"number"==typeof this.yl[0]?t[0]:t},numeric.spline=function(r,t,n,e){var i,o=r.length,s=[],a=[],u=[],f=numeric.sub,c=numeric.mul,h=numeric.add;for(i=o-2;i>=0;i--)a[i]=r[i+1]-r[i],u[i]=f(t[i+1],t[i]);("string"==typeof n||"string"==typeof e)&&(n=e="periodic");var m=[[],[],[]];switch(typeof n){case"undefined":s[0]=c(3/(a[0]*a[0]),u[0]),m[0].push(0,0),m[1].push(0,1),m[2].push(2/a[0],1/a[0]);break;case"string":s[0]=h(c(3/(a[o-2]*a[o-2]),u[o-2]),c(3/(a[0]*a[0]),u[0])),m[0].push(0,0,0),m[1].push(o-2,0,1),m[2].push(1/a[o-2],2/a[o-2]+2/a[0],1/a[0]);break;default:s[0]=n,m[0].push(0),m[1].push(0),m[2].push(1)}for(i=1;o-1>i;i++)s[i]=h(c(3/(a[i-1]*a[i-1]),u[i-1]),c(3/(a[i]*a[i]),u[i])),m[0].push(i,i,i),m[1].push(i-1,i,i+1),m[2].push(1/a[i-1],2/a[i-1]+2/a[i],1/a[i]);switch(typeof e){case"undefined":s[o-1]=c(3/(a[o-2]*a[o-2]),u[o-2]),m[0].push(o-1,o-1),m[1].push(o-2,o-1),m[2].push(1/a[o-2],2/a[o-2]);break;case"string":m[1][m[1].length-1]=0;break;default:s[o-1]=e,m[0].push(o-1),m[1].push(o-1),m[2].push(1)}s="number"!=typeof s[0]?numeric.transpose(s):[s];var l=Array(s.length);if("string"==typeof n)for(i=l.length-1;-1!==i;--i)l[i]=numeric.ccsLUPSolve(numeric.ccsLUP(numeric.ccsScatter(m)),s[i]),l[i][o-1]=l[i][0];else for(i=l.length-1;-1!==i;--i)l[i]=numeric.cLUsolve(numeric.cLU(m),s[i]);return l="number"==typeof t[0]?l[0]:numeric.transpose(l),new numeric.Spline(r,t,t,l,l)},numeric.fftpow2=function h(r,t){var n=r.length;if(1!==n){var e,i,o=Math.cos,s=Math.sin,a=Array(n/2),u=Array(n/2),f=Array(n/2),c=Array(n/2);for(i=n/2,e=n-1;-1!==e;--e)--i,f[i]=r[e],c[i]=t[e],--e,a[i]=r[e],u[i]=t[e];h(a,u),h(f,c),i=n/2;var m,l,p,d=-6.283185307179586/n;for(e=n-1;-1!==e;--e)--i,-1===i&&(i=n/2-1),m=d*e,l=o(m),p=s(m),r[e]=a[i]+l*f[i]-p*c[i],t[e]=u[i]+l*c[i]+p*f[i]}},numeric._ifftpow2=function m(r,t){var n=r.length;if(1!==n){var e,i,o=Math.cos,s=Math.sin,a=Array(n/2),u=Array(n/2),f=Array(n/2),c=Array(n/2);for(i=n/2,e=n-1;-1!==e;--e)--i,f[i]=r[e],c[i]=t[e],--e,a[i]=r[e],u[i]=t[e];m(a,u),m(f,c),i=n/2;var h,l,p,d=6.283185307179586/n;for(e=n-1;-1!==e;--e)--i,-1===i&&(i=n/2-1),h=d*e,l=o(h),p=s(h),r[e]=a[i]+l*f[i]-p*c[i],t[e]=u[i]+l*c[i]+p*f[i]}},numeric.ifftpow2=function(r,t){numeric._ifftpow2(r,t),numeric.diveq(r,r.length),numeric.diveq(t,t.length)},numeric.convpow2=function(r,t,n,e){numeric.fftpow2(r,t),numeric.fftpow2(n,e);var i,o,s,a,u,f=r.length;for(i=f-1;-1!==i;--i)o=r[i],a=t[i],s=n[i],u=e[i],r[i]=o*s-a*u,t[i]=o*u+a*s;numeric.ifftpow2(r,t)},numeric.T.prototype.fft=function(){{var r,t,n=this.x,e=this.y,i=n.length,o=Math.log,s=o(2),a=Math.ceil(o(2*i-1)/s),u=Math.pow(2,a),f=numeric.rep([u],0),c=numeric.rep([u],0),h=Math.cos,m=Math.sin,l=-3.141592653589793/i,p=numeric.rep([u],0),d=numeric.rep([u],0);Math.floor(i/2)}for(r=0;i>r;r++)p[r]=n[r];if("undefined"!=typeof e)for(r=0;i>r;r++)d[r]=e[r];for(f[0]=1,r=1;u/2>=r;r++)t=l*r*r,f[r]=h(t),c[r]=m(t),f[u-r]=h(t),c[u-r]=m(t);var g=new numeric.T(p,d),v=new numeric.T(f,c);return g=g.mul(v),numeric.convpow2(g.x,g.y,numeric.clone(v.x),numeric.neg(v.y)),g=g.mul(v),g.x.length=i,g.y.length=i,g},numeric.T.prototype.ifft=function(){{var r,t,n=this.x,e=this.y,i=n.length,o=Math.log,s=o(2),a=Math.ceil(o(2*i-1)/s),u=Math.pow(2,a),f=numeric.rep([u],0),c=numeric.rep([u],0),h=Math.cos,m=Math.sin,l=3.141592653589793/i,p=numeric.rep([u],0),d=numeric.rep([u],0);Math.floor(i/2)}for(r=0;i>r;r++)p[r]=n[r];if("undefined"!=typeof e)for(r=0;i>r;r++)d[r]=e[r];for(f[0]=1,r=1;u/2>=r;r++)t=l*r*r,f[r]=h(t),c[r]=m(t),f[u-r]=h(t),c[u-r]=m(t);var g=new numeric.T(p,d),v=new numeric.T(f,c);return g=g.mul(v),numeric.convpow2(g.x,g.y,numeric.clone(v.x),numeric.neg(v.y)),g=g.mul(v),g.x.length=i,g.y.length=i,g.div(i)},numeric.gradient=function(r,t){var n=t.length,e=r(t);if(isNaN(e))throw new Error("gradient: f(x) is a NaN!");var i,o,s,a,u,f,c,h,m,l,p=Math.max,d=numeric.clone(t),g=Array(n),p=(numeric.div,numeric.sub,Math.max),v=.001,y=Math.abs,w=Math.min,x=0;for(i=0;n>i;i++)for(var M=p(1e-6*e,1e-8);;){if(++x,x>20)throw new Error("Numerical gradient fails");if(d[i]=t[i]+M,o=r(d),d[i]=t[i]-M,s=r(d),d[i]=t[i],isNaN(o)||isNaN(s))M/=16;else{if(g[i]=(o-s)/(2*M),u=t[i]-M,f=t[i],c=t[i]+M,h=(o-e)/M,m=(e-s)/M,l=p(y(g[i]),y(e),y(o),y(s),y(u),y(f),y(c),1e-8),a=w(p(y(h-g[i]),y(m-g[i]),y(h-m))/l,M/l),!(a>v))break;M/=16}}return g},numeric.uncmin=function(r,t,n,e,i,o,s){var a=numeric.gradient;"undefined"==typeof s&&(s={}),"undefined"==typeof n&&(n=1e-8),"undefined"==typeof e&&(e=function(t){return a(r,t)}),"undefined"==typeof i&&(i=1e3),t=numeric.clone(t);var u,f,c=t.length,h=r(t);if(isNaN(h))throw new Error("uncmin: f(x0) is a NaN!");var m=Math.max,l=numeric.norm2;n=m(n,numeric.epsilon);var p,d,g,v,y,w,x,M,b,k,A=s.Hinv||numeric.identity(c),S=numeric.dot,j=(numeric.inv,numeric.sub),R=numeric.add,q=numeric.tensor,T=numeric.div,V=numeric.mul,D=numeric.all,C=numeric.isFinite,O=numeric.neg,E=0,z="";for(d=e(t);i>E;){if("function"==typeof o&&o(E,t,h,d,A)){z="Callback returned true";break}if(!D(C(d))){z="Gradient has Infinity or NaN";break}if(p=O(S(A,d)),!D(C(p))){z="Search direction has Infinity or NaN";break}if(k=l(p),n>k){z="Newton step smaller than tol";break}for(b=1,f=S(d,p),y=t;i>E&&!(n>b*k)&&(v=V(p,b),y=R(t,v),u=r(y),u-h>=.1*b*f||isNaN(u));)b*=.5,++E;if(n>b*k){z="Line search step size smaller than tol";break}if(E===i){z="maxit reached during line search";break}g=e(y),w=j(g,d),M=S(w,v),x=S(A,w),A=j(R(A,V((M+S(w,x))/(M*M),q(v,v))),T(R(q(x,v),q(v,x)),M)),t=y,h=u,d=g,++E}return{solution:t,f:h,gradient:d,invHessian:A,iterations:E,message:z}},numeric.Dopri=function(r,t,n,e,i,o,s){this.x=r,this.y=t,this.f=n,this.ymid=e,this.iterations=i,this.events=s,this.message=o},numeric.Dopri.prototype._at=function(r,t){function n(r){return r*r}var e,i,o,s,a,u,r,f,c,h,m,l=this,p=l.x,d=l.y,g=l.f,v=l.ymid,y=(p.length,Math.floor,.5),w=numeric.add,x=numeric.mul,M=numeric.sub;return e=p[t],i=p[t+1],s=d[t],a=d[t+1],f=i-e,o=e+y*f,u=v[t],c=M(g[t],x(s,1/(e-o)+2/(e-i))),h=M(g[t+1],x(a,1/(i-o)+2/(i-e))),m=[n(r-i)*(r-o)/n(e-i)/(e-o),n(r-e)*n(r-i)/n(e-o)/n(i-o),n(r-e)*(r-o)/n(i-e)/(i-o),(r-e)*n(r-i)*(r-o)/n(e-i)/(e-o),(r-i)*n(r-e)*(r-o)/n(e-i)/(i-o)],w(w(w(w(x(s,m[0]),x(u,m[1])),x(a,m[2])),x(c,m[3])),x(h,m[4]))},numeric.Dopri.prototype.at=function(r){var t,n,e,i=Math.floor;if("number"!=typeof r){var o=r.length,s=Array(o);for(t=o-1;-1!==t;--t)s[t]=this.at(r[t]);return s}var a=this.x;for(t=0,n=a.length-1;n-t>1;)e=i(.5*(t+n)),a[e]<=r?t=e:n=e;return this._at(r,t)},numeric.dopri=function(r,t,n,e,i,o,s){"undefined"==typeof i&&(i=1e-6),"undefined"==typeof o&&(o=1e3);var a,u,f,c,h,m,l,p,d,g,v,y,w,x=[r],M=[n],b=[e(r,n)],k=[],A=.2,S=[.075,.225],j=[44/45,-56/15,32/9],R=[19372/6561,-25360/2187,64448/6561,-212/729],q=[9017/3168,-355/33,46732/5247,49/176,-5103/18656],T=[35/384,0,500/1113,125/192,-2187/6784,11/84],V=[.10013431883002395,0,.3918321794184259,-0.02982460176594817,.05893268337240795,-0.04497888809104361,.023904308236133973],D=[.2,.3,.8,8/9,1,1],C=[-71/57600,0,71/16695,-71/1920,17253/339200,-22/525,.025],O=0,E=(t-r)/10,z=0,I=numeric.add,_=numeric.mul,P=(Math.max,Math.min),N=Math.abs,L=numeric.norminf,U=Math.pow,F=numeric.any,B=numeric.lt,X=numeric.and,Q=(numeric.sub,new numeric.Dopri(x,M,b,k,-1,""));for("function"==typeof s&&(v=s(r,n));t>r&&o>z;)if(++z,r+E>t&&(E=t-r),a=e(r+D[0]*E,I(n,_(A*E,b[O]))),u=e(r+D[1]*E,I(I(n,_(S[0]*E,b[O])),_(S[1]*E,a))),f=e(r+D[2]*E,I(I(I(n,_(j[0]*E,b[O])),_(j[1]*E,a)),_(j[2]*E,u))),c=e(r+D[3]*E,I(I(I(I(n,_(R[0]*E,b[O])),_(R[1]*E,a)),_(R[2]*E,u)),_(R[3]*E,f))),h=e(r+D[4]*E,I(I(I(I(I(n,_(q[0]*E,b[O])),_(q[1]*E,a)),_(q[2]*E,u)),_(q[3]*E,f)),_(q[4]*E,c))),d=I(I(I(I(I(n,_(b[O],E*T[0])),_(u,E*T[2])),_(f,E*T[3])),_(c,E*T[4])),_(h,E*T[5])),m=e(r+E,d),l=I(I(I(I(I(_(b[O],E*C[0]),_(u,E*C[2])),_(f,E*C[3])),_(c,E*C[4])),_(h,E*C[5])),_(m,E*C[6])),g="number"==typeof l?N(l):L(l),g>i){if(E=.2*E*U(i/g,.25),r+E===r){Q.msg="Step size became too small";break}}else{if(k[O]=I(I(I(I(I(I(n,_(b[O],E*V[0])),_(u,E*V[2])),_(f,E*V[3])),_(c,E*V[4])),_(h,E*V[5])),_(m,E*V[6])),++O,x[O]=r+E,M[O]=d,b[O]=m,"function"==typeof s){var W,Y,H=r,Z=r+.5*E;if(y=s(Z,k[O-1]),w=X(B(v,0),B(0,y)),F(w)||(H=Z,Z=r+E,v=y,y=s(Z,d),w=X(B(v,0),B(0,y))),F(w)){for(var G,J,K=0,$=1,rt=1;;){if("number"==typeof v)Y=(rt*y*H-$*v*Z)/(rt*y-$*v);else for(Y=Z,p=v.length-1;-1!==p;--p)v[p]<0&&y[p]>0&&(Y=P(Y,(rt*y[p]*H-$*v[p]*Z)/(rt*y[p]-$*v[p])));if(H>=Y||Y>=Z)break;W=Q._at(Y,O-1),J=s(Y,W),G=X(B(v,0),B(0,J)),F(G)?(Z=Y,y=J,w=G,rt=1,-1===K?$*=.5:$=1,K=-1):(H=Y,v=J,$=1,1===K?rt*=.5:rt=1,K=1)}return d=Q._at(.5*(r+Y),O-1),Q.f[O]=e(Y,W),Q.x[O]=Y,Q.y[O]=W,Q.ymid[O-1]=d,Q.events=w,Q.iterations=z,Q}}r+=E,n=d,v=y,E=P(.8*E*U(i/g,.25),4*E)}return Q.iterations=z,Q},numeric.LU=function(r,t){t=t||!1;var n,e,i,o,s,a,u,f,c,h=Math.abs,m=r.length,l=m-1,p=new Array(m);for(t||(r=numeric.clone(r)),i=0;m>i;++i){for(u=i,a=r[i],c=h(a[i]),e=i+1;m>e;++e)o=h(r[e][i]),o>c&&(c=o,u=e);for(p[i]=u,u!=i&&(r[i]=r[u],r[u]=a,a=r[i]),s=a[i],n=i+1;m>n;++n)r[n][i]/=s;for(n=i+1;m>n;++n){for(f=r[n],e=i+1;l>e;++e)f[e]-=f[i]*a[e],++e,f[e]-=f[i]*a[e];e===l&&(f[e]-=f[i]*a[e])}}return{LU:r,P:p}},numeric.LUsolve=function(r,t){var n,e,i,o,s,a=r.LU,u=a.length,f=numeric.clone(t),c=r.P;for(n=u-1;-1!==n;--n)f[n]=t[n];for(n=0;u>n;++n)for(i=c[n],c[n]!==n&&(s=f[n],f[n]=f[i],f[i]=s),o=a[n],e=0;n>e;++e)f[n]-=f[e]*o[e];for(n=u-1;n>=0;--n){for(o=a[n],e=n+1;u>e;++e)f[n]-=f[e]*o[e];f[n]/=o[n]}return f},numeric.solve=function(r,t,n){return numeric.LUsolve(numeric.LU(r,n),t)},numeric.echelonize=function(r){var t,n,e,i,o,s,a,u,f=numeric.dim(r),c=f[0],h=f[1],m=numeric.identity(c),l=Array(c),p=Math.abs,d=numeric.diveq;for(r=numeric.clone(r),t=0;c>t;++t){for(e=0,o=r[t],s=m[t],n=1;h>n;++n)p(o[e])<p(o[n])&&(e=n);for(l[t]=e,d(s,o[e]),d(o,o[e]),n=0;c>n;++n)if(n!==t){for(a=r[n],u=a[e],i=h-1;-1!==i;--i)a[i]-=o[i]*u;for(a=m[n],i=c-1;-1!==i;--i)a[i]-=s[i]*u}}return{I:m,A:r,P:l}},numeric.__solveLP=function(r,t,n,e,i,o,s){var a,u,f,c,h=numeric.sum,m=(numeric.log,numeric.mul),l=numeric.sub,p=numeric.dot,d=numeric.div,g=numeric.add,v=r.length,y=n.length,w=!1,x=0,M=1,b=(numeric.transpose(t),numeric.svd,numeric.transpose),k=(numeric.leq,Math.sqrt),A=Math.abs,S=(numeric.muleq,numeric.norminf,numeric.any,Math.min),j=numeric.all,R=numeric.gt,q=Array(v),T=Array(y),V=(numeric.rep([y],1),numeric.solve),D=l(n,p(t,o)),C=p(r,r);for(f=x;i>f;++f){var O,E;for(O=y-1;-1!==O;--O)T[O]=d(t[O],D[O]);
var z=b(T);for(O=v-1;-1!==O;--O)q[O]=h(z[O]);M=.25*A(C/p(r,q));var I=100*k(C/p(q,q));for((!isFinite(M)||M>I)&&(M=I),c=g(r,m(M,q)),u=p(z,T),O=v-1;-1!==O;--O)u[O][O]+=1;E=V(u,d(c,M),!0);var _=d(D,p(t,E)),P=1;for(O=y-1;-1!==O;--O)_[O]<0&&(P=S(P,-.999*_[O]));if(a=l(o,m(E,P)),D=l(n,p(t,a)),!j(R(D,0)))return{solution:o,message:"",iterations:f};if(o=a,e>M)return{solution:a,message:"",iterations:f};if(s){var N=p(r,c),L=p(t,c);for(w=!0,O=y-1;-1!==O;--O)if(N*L[O]<0){w=!1;break}}else w=o[v-1]>=0?!1:!0;if(w)return{solution:a,message:"Unbounded",iterations:f}}return{solution:o,message:"maximum iteration count exceeded",iterations:f}},numeric._solveLP=function(r,t,n,e,i){var o,s=r.length,a=n.length,u=(numeric.sum,numeric.log,numeric.mul,numeric.sub),f=numeric.dot,c=(numeric.div,numeric.add,numeric.rep([s],0).concat([1])),h=numeric.rep([a,1],-1),m=numeric.blockMatrix([[t,h]]),l=n,o=numeric.rep([s],0).concat(Math.max(0,numeric.sup(numeric.neg(n)))+1),p=numeric.__solveLP(c,m,l,e,i,o,!1),d=numeric.clone(p.solution);d.length=s;var g=numeric.inf(u(n,f(t,d)));if(0>g)return{solution:0/0,message:"Infeasible",iterations:p.iterations};var v=numeric.__solveLP(r,t,n,e,i-p.iterations,d,!0);return v.iterations+=p.iterations,v},numeric.solveLP=function(r,t,n,e,i,o,s){if("undefined"==typeof s&&(s=1e3),"undefined"==typeof o&&(o=numeric.epsilon),"undefined"==typeof e)return numeric._solveLP(r,t,n,o,s);var a,u=e.length,f=e[0].length,c=t.length,h=numeric.echelonize(e),m=numeric.rep([f],0),l=h.P,p=[];for(a=l.length-1;-1!==a;--a)m[l[a]]=1;for(a=f-1;-1!==a;--a)0===m[a]&&p.push(a);var d=numeric.getRange,g=numeric.linspace(0,u-1),v=numeric.linspace(0,c-1),y=d(e,g,p),w=d(t,v,l),x=d(t,v,p),M=numeric.dot,b=numeric.sub,k=M(w,h.I),A=b(x,M(k,y)),S=b(n,M(k,i)),j=Array(l.length),R=Array(p.length);for(a=l.length-1;-1!==a;--a)j[a]=r[l[a]];for(a=p.length-1;-1!==a;--a)R[a]=r[p[a]];var q=b(R,M(j,M(h.I,y))),T=numeric._solveLP(q,A,S,o,s),V=T.solution;if(V!==V)return T;var D=M(h.I,b(i,M(y,V))),C=Array(r.length);for(a=l.length-1;-1!==a;--a)C[l[a]]=D[a];for(a=p.length-1;-1!==a;--a)C[p[a]]=V[a];return{solution:C,message:T.message,iterations:T.iterations}},numeric.MPStoLP=function(r){function t(t){throw new Error("MPStoLP: "+t+"\nLine "+n+": "+r[n]+"\nCurrent state: "+a[s]+"\n")}r instanceof String&&r.split("\n");var n,e,i,o,s=0,a=["Initial state","NAME","ROWS","COLUMNS","RHS","BOUNDS","ENDATA"],u=r.length,f=0,c={},h=[],m=0,l={},p=0,d=[],g=[],v=[];for(n=0;u>n;++n){i=r[n];var y=i.match(/\S*/g),w=[];for(e=0;e<y.length;++e)""!==y[e]&&w.push(y[e]);if(0!==w.length){for(e=0;e<a.length&&i.substr(0,a[e].length)!==a[e];++e);if(e<a.length){if(s=e,1===e&&(o=w[1]),6===e)return{name:o,c:d,A:numeric.transpose(g),b:v,rows:c,vars:l}}else switch(s){case 0:case 1:t("Unexpected line");case 2:switch(w[0]){case"N":0===f?f=w[1]:t("Two or more N rows");break;case"L":c[w[1]]=m,h[m]=1,v[m]=0,++m;break;case"G":c[w[1]]=m,h[m]=-1,v[m]=0,++m;break;case"E":c[w[1]]=m,h[m]=0,v[m]=0,++m;break;default:t("Parse error "+numeric.prettyPrint(w))}break;case 3:l.hasOwnProperty(w[0])||(l[w[0]]=p,d[p]=0,g[p]=numeric.rep([m],0),++p);var x=l[w[0]];for(e=1;e<w.length;e+=2)if(w[e]!==f){var M=c[w[e]];g[x][M]=(h[M]<0?-1:1)*parseFloat(w[e+1])}else d[x]=parseFloat(w[e+1]);break;case 4:for(e=1;e<w.length;e+=2)v[c[w[e]]]=(h[c[w[e]]]<0?-1:1)*parseFloat(w[e+1]);break;case 5:break;case 6:t("Internal error")}}}t("Reached end of file without ENDATA")},numeric.seedrandom={pow:Math.pow,random:Math.random},function(r,t,n,e,i,o,s){function a(r){var t,e,i=this,o=r.length,s=0,a=i.i=i.j=i.m=0;for(i.S=[],i.c=[],o||(r=[o++]);n>s;)i.S[s]=s++;for(s=0;n>s;s++)t=i.S[s],a=c(a+t+r[s%o]),e=i.S[a],i.S[s]=e,i.S[a]=t;i.g=function(r){var t=i.S,e=c(i.i+1),o=t[e],s=c(i.j+o),a=t[s];t[e]=a,t[s]=o;for(var u=t[c(o+a)];--r;)e=c(e+1),o=t[e],s=c(s+o),a=t[s],t[e]=a,t[s]=o,u=u*n+t[c(o+a)];return i.i=e,i.j=s,u},i.g(n)}function u(r,t,n,e,i){if(n=[],i=typeof r,t&&"object"==i)for(e in r)if(e.indexOf("S")<5)try{n.push(u(r[e],t-1))}catch(o){}return n.length?n:r+("string"!=i?"\x00":"")}function f(r,t,n,e){for(r+="",n=0,e=0;e<r.length;e++)t[c(e)]=c((n^=19*t[c(e)])+r.charCodeAt(e));r="";for(e in t)r+=String.fromCharCode(t[e]);return r}function c(r){return r&n-1}t.seedrandom=function(c,h){var m,l=[];return c=f(u(h?[c,r]:arguments.length?c:[(new Date).getTime(),r,window],3),l),m=new a(l),f(m.S,r),t.random=function(){for(var r=m.g(e),t=s,a=0;i>r;)r=(r+a)*n,t*=n,a=m.g(1);for(;r>=o;)r/=2,t/=2,a>>>=1;return(r+a)/t},c},s=t.pow(n,e),i=t.pow(2,i),o=2*i,f(t.random(),r)}([],numeric.seedrandom,256,6,52),function(r){function t(r){if("object"!=typeof r)return r;var n,e=[],i=r.length;for(n=0;i>n;n++)e[n+1]=t(r[n]);return e}function n(r){if("object"!=typeof r)return r;var t,e=[],i=r.length;for(t=1;i>t;t++)e[t-1]=n(r[t]);return e}function e(r,t,n){var e,i,o,s,a;for(o=1;n>=o;o+=1){for(r[o][o]=1/r[o][o],a=-r[o][o],e=1;o>e;e+=1)r[e][o]=a*r[e][o];if(s=o+1,s>n)break;for(i=s;n>=i;i+=1)for(a=r[o][i],r[o][i]=0,e=1;o>=e;e+=1)r[e][i]=r[e][i]+a*r[e][o]}}function i(r,t,n,e){var i,o,s,a;for(o=1;n>=o;o+=1){for(a=0,i=1;o>i;i+=1)a+=r[i][o]*e[i];e[o]=(e[o]-a)/r[o][o]}for(s=1;n>=s;s+=1)for(o=n+1-s,e[o]=e[o]/r[o][o],a=-e[o],i=1;o>i;i+=1)e[i]=e[i]+a*r[i][o]}function o(r,t,n,e){var i,o,s,a,u,f;for(o=1;n>=o;o+=1){if(e[1]=o,f=0,s=o-1,1>s){if(f=r[o][o]-f,0>=f)break;r[o][o]=Math.sqrt(f)}else{for(a=1;s>=a;a+=1){for(u=r[a][o],i=1;a>i;i+=1)u-=r[i][o]*r[i][a];u/=r[a][a],r[a][o]=u,f+=u*u}if(f=r[o][o]-f,0>=f)break;r[o][o]=Math.sqrt(f)}e[1]=0}}function s(r,t,n,s,a,u,f,c,h,m,l,p,d,g,v,y){function w(){for(g[1]=g[1]+1,j=O,A=1;m>=A;A+=1){for(j+=1,N=-c[A],S=1;s>=S;S+=1)N+=f[S][A]*a[S];if(Math.abs(N)<Y&&(N=0),A>l)v[j]=N;else if(v[j]=-Math.abs(N),N>0){for(S=1;s>=S;S+=1)f[S][A]=-f[S][A];c[A]=-c[A]}}for(A=1;d>=A;A+=1)v[O+p[A]]=0;for(z=0,P=0,A=1;m>=A;A+=1)v[O+A]<P*v[_+A]&&(z=A,P=v[O+A]/v[_+A]);return 0===z?999:0}function x(){for(A=1;s>=A;A+=1){for(N=0,S=1;s>=S;S+=1)N+=r[S][A]*f[S][z];v[A]=N}for(R=V,A=1;s>=A;A+=1)v[R+A]=0;for(S=d+1;s>=S;S+=1)for(A=1;s>=A;A+=1)v[R+A]=v[R+A]+r[A][S]*v[S];for(Q=!0,A=d;A>=1;A-=1){for(N=v[A],j=C+A*(A+3)/2,R=j-A,S=A+1;d>=S;S+=1)N-=v[j]*v[D+S],j+=S;if(N/=v[R],v[D+A]=N,p[A]<l)break;if(0>N)break;Q=!1,T=A}if(!Q)for(L=v[E+T]/v[D+T],A=1;d>=A&&!(p[A]<l)&&!(v[D+A]<0);A+=1)P=v[E+A]/v[D+A],L>P&&(L=P,T=A);for(N=0,A=V+1;V+s>=A;A+=1)N+=v[A]*v[A];if(Math.abs(N)<=Y){if(Q)return y[1]=1,999;for(A=1;d>=A;A+=1)v[E+A]=v[E+A]-L*v[D+A];return v[E+d+1]=v[E+d+1]+L,700}for(N=0,A=1;s>=A;A+=1)N+=v[V+A]*f[A][z];for(U=-v[O+z]/N,W=!0,Q||U>L&&(U=L,W=!1),A=1;s>=A;A+=1)a[A]=a[A]+U*v[V+A],Math.abs(a[A])<Y&&(a[A]=0);for(u[1]=u[1]+U*N*(U/2+v[E+d+1]),A=1;d>=A;A+=1)v[E+A]=v[E+A]-U*v[D+A];if(v[E+d+1]=v[E+d+1]+U,!W){for(N=-c[z],S=1;s>=S;S+=1)N+=a[S]*f[S][z];if(z>l)v[O+z]=N;else if(v[O+z]=-Math.abs(N),N>0){for(S=1;s>=S;S+=1)f[S][z]=-f[S][z];c[z]=-c[z]}return 700}for(d+=1,p[d]=z,j=C+(d-1)*d/2+1,A=1;d-1>=A;A+=1)v[j]=v[A],j+=1;if(d===s)v[j]=v[s];else{for(A=s;A>=d+1&&0!==v[A]&&(F=Math.max(Math.abs(v[A-1]),Math.abs(v[A])),B=Math.min(Math.abs(v[A-1]),Math.abs(v[A])),P=v[A-1]>=0?Math.abs(F*Math.sqrt(1+B*B/(F*F))):-Math.abs(F*Math.sqrt(1+B*B/(F*F))),F=v[A-1]/P,B=v[A]/P,1!==F);A-=1)if(0===F)for(v[A-1]=B*P,S=1;s>=S;S+=1)P=r[S][A-1],r[S][A-1]=r[S][A],r[S][A]=P;else for(v[A-1]=P,X=B/(1+F),S=1;s>=S;S+=1)P=F*r[S][A-1]+B*r[S][A],r[S][A]=X*(r[S][A-1]+P)-r[S][A],r[S][A-1]=P;v[j]=v[d]}return 0}function M(){if(j=C+T*(T+1)/2+1,R=j+T,0===v[R])return 798;if(F=Math.max(Math.abs(v[R-1]),Math.abs(v[R])),B=Math.min(Math.abs(v[R-1]),Math.abs(v[R])),P=v[R-1]>=0?Math.abs(F*Math.sqrt(1+B*B/(F*F))):-Math.abs(F*Math.sqrt(1+B*B/(F*F))),F=v[R-1]/P,B=v[R]/P,1===F)return 798;if(0===F){for(A=T+1;d>=A;A+=1)P=v[R-1],v[R-1]=v[R],v[R]=P,R+=A;for(A=1;s>=A;A+=1)P=r[A][T],r[A][T]=r[A][T+1],r[A][T+1]=P}else{for(X=B/(1+F),A=T+1;d>=A;A+=1)P=F*v[R-1]+B*v[R],v[R]=X*(v[R-1]+P)-v[R],v[R-1]=P,R+=A;for(A=1;s>=A;A+=1)P=F*r[A][T]+B*r[A][T+1],r[A][T+1]=X*(r[A][T]+P)-r[A][T+1],r[A][T]=P}return 0}function b(){for(R=j-T,A=1;T>=A;A+=1)v[R]=v[j],j+=1,R+=1;return v[E+T]=v[E+T+1],p[T]=p[T+1],T+=1,d>T?797:0}function k(){return v[E+d]=v[E+d+1],v[E+d+1]=0,p[d]=0,d-=1,g[2]=g[2]+1,0}var A,S,j,R,q,T,V,D,C,O,E,z,I,_,P,N,L,U,F,B,X,Q,W,Y,H,Z,G;I=Math.min(s,m),j=2*s+I*(I+5)/2+2*m+1,Y=1e-60;do Y+=Y,H=1+.1*Y,Z=1+.2*Y;while(1>=H||1>=Z);for(A=1;s>=A;A+=1)v[A]=t[A];for(A=s+1;j>=A;A+=1)v[A]=0;for(A=1;m>=A;A+=1)p[A]=0;if(q=[],0===y[1]){if(o(r,n,s,q),0!==q[1])return void(y[1]=2);i(r,n,s,t),e(r,n,s)}else{for(S=1;s>=S;S+=1)for(a[S]=0,A=1;S>=A;A+=1)a[S]=a[S]+r[A][S]*t[A];for(S=1;s>=S;S+=1)for(t[S]=0,A=S;s>=A;A+=1)t[S]=t[S]+r[S][A]*a[A]}for(u[1]=0,S=1;s>=S;S+=1)for(a[S]=t[S],u[1]=u[1]+v[S]*a[S],v[S]=0,A=S+1;s>=A;A+=1)r[A][S]=0;for(u[1]=-u[1]/2,y[1]=0,V=s,D=V+s,E=D+I,C=E+I+1,O=C+I*(I+1)/2,_=O+m,A=1;m>=A;A+=1){for(N=0,S=1;s>=S;S+=1)N+=f[S][A]*f[S][A];v[_+A]=Math.sqrt(N)}for(d=0,g[1]=0,g[2]=0,G=0;;){if(G=w(),999===G)return;for(;;){if(G=x(),0===G)break;if(999===G)return;if(700===G)if(T===d)k();else{for(;;)if(M(),G=b(),797!==G)break;k()}}}}function a(r,e,i,o,a,u){r=t(r),e=t(e),i=t(i);var f,c,h,m,l,p,d=[],g=[],v=[],y=[],w=[];if(a=a||0,u=u?t(u):[void 0,0],o=o?t(o):[],c=r.length-1,h=i[1].length-1,!o)for(f=1;h>=f;f+=1)o[f]=0;for(f=1;h>=f;f+=1)g[f]=0;for(m=0,l=Math.min(c,h),f=1;c>=f;f+=1)v[f]=0;for(d[1]=0,f=1;2*c+l*(l+5)/2+2*h+1>=f;f+=1)y[f]=0;for(f=1;2>=f;f+=1)w[f]=0;return s(r,e,c,c,v,d,i,o,c,h,a,g,m,w,y,u),p="",1===u[1]&&(p="constraints are inconsistent, no solution!"),2===u[1]&&(p="matrix D in quadratic function is not positive definite!"),{solution:n(v),value:n(d),unconstrained_solution:n(e),iterations:n(w),iact:n(g),message:p}}r.solveQP=a}(numeric),numeric.svd=function(r){function t(r,t){return r=Math.abs(r),t=Math.abs(t),r>t?r*Math.sqrt(1+t*t/r/r):0==t?r:t*Math.sqrt(1+r*r/t/t)}var n,e=numeric.epsilon,i=1e-64/e,o=50,s=0,a=0,u=0,f=0,c=0,h=numeric.clone(r),m=h.length,l=h[0].length;if(l>m)throw"Need more rows than columns";var p=new Array(l),d=new Array(l);for(a=0;l>a;a++)p[a]=d[a]=0;var g=numeric.rep([l,l],0),v=0,y=0,w=0,x=0,M=0,b=0,k=0;for(a=0;l>a;a++){for(p[a]=y,k=0,c=a+1,u=a;m>u;u++)k+=h[u][a]*h[u][a];if(i>=k)y=0;else for(v=h[a][a],y=Math.sqrt(k),v>=0&&(y=-y),w=v*y-k,h[a][a]=v-y,u=c;l>u;u++){for(k=0,f=a;m>f;f++)k+=h[f][a]*h[f][u];for(v=k/w,f=a;m>f;f++)h[f][u]+=v*h[f][a]}for(d[a]=y,k=0,u=c;l>u;u++)k+=h[a][u]*h[a][u];if(i>=k)y=0;else{for(v=h[a][a+1],y=Math.sqrt(k),v>=0&&(y=-y),w=v*y-k,h[a][a+1]=v-y,u=c;l>u;u++)p[u]=h[a][u]/w;for(u=c;m>u;u++){for(k=0,f=c;l>f;f++)k+=h[u][f]*h[a][f];for(f=c;l>f;f++)h[u][f]+=k*p[f]}}M=Math.abs(d[a])+Math.abs(p[a]),M>x&&(x=M)}for(a=l-1;-1!=a;a+=-1){if(0!=y){for(w=y*h[a][a+1],u=c;l>u;u++)g[u][a]=h[a][u]/w;for(u=c;l>u;u++){for(k=0,f=c;l>f;f++)k+=h[a][f]*g[f][u];for(f=c;l>f;f++)g[f][u]+=k*g[f][a]}}for(u=c;l>u;u++)g[a][u]=0,g[u][a]=0;g[a][a]=1,y=p[a],c=a}for(a=l-1;-1!=a;a+=-1){for(c=a+1,y=d[a],u=c;l>u;u++)h[a][u]=0;if(0!=y){for(w=h[a][a]*y,u=c;l>u;u++){for(k=0,f=c;m>f;f++)k+=h[f][a]*h[f][u];for(v=k/w,f=a;m>f;f++)h[f][u]+=v*h[f][a]}for(u=a;m>u;u++)h[u][a]=h[u][a]/y}else for(u=a;m>u;u++)h[u][a]=0;h[a][a]+=1}for(e*=x,f=l-1;-1!=f;f+=-1)for(var A=0;o>A;A++){var S=!1;for(c=f;-1!=c;c+=-1){if(Math.abs(p[c])<=e){S=!0;break}if(Math.abs(d[c-1])<=e)break}if(!S){s=0,k=1;var j=c-1;for(a=c;f+1>a&&(v=k*p[a],p[a]=s*p[a],!(Math.abs(v)<=e));a++)for(y=d[a],w=t(v,y),d[a]=w,s=y/w,k=-v/w,u=0;m>u;u++)M=h[u][j],b=h[u][a],h[u][j]=M*s+b*k,h[u][a]=-M*k+b*s}if(b=d[f],c==f){if(0>b)for(d[f]=-b,u=0;l>u;u++)g[u][f]=-g[u][f];break}if(A>=o-1)throw"Error: no convergence.";for(x=d[c],M=d[f-1],y=p[f-1],w=p[f],v=((M-b)*(M+b)+(y-w)*(y+w))/(2*w*M),y=t(v,1),v=0>v?((x-b)*(x+b)+w*(M/(v-y)-w))/x:((x-b)*(x+b)+w*(M/(v+y)-w))/x,s=1,k=1,a=c+1;f+1>a;a++){for(y=p[a],M=d[a],w=k*y,y=s*y,b=t(v,w),p[a-1]=b,s=v/b,k=w/b,v=x*s+y*k,y=-x*k+y*s,w=M*k,M*=s,u=0;l>u;u++)x=g[u][a-1],b=g[u][a],g[u][a-1]=x*s+b*k,g[u][a]=-x*k+b*s;for(b=t(v,w),d[a-1]=b,s=v/b,k=w/b,v=s*y+k*M,x=-k*y+s*M,u=0;m>u;u++)M=h[u][a-1],b=h[u][a],h[u][a-1]=M*s+b*k,h[u][a]=-M*k+b*s}p[c]=0,p[f]=v,d[f]=x}for(a=0;a<d.length;a++)d[a]<e&&(d[a]=0);for(a=0;l>a;a++)for(u=a-1;u>=0;u--)if(d[u]<d[a]){for(s=d[u],d[u]=d[a],d[a]=s,f=0;f<h.length;f++)n=h[f][a],h[f][a]=h[f][u],h[f][u]=n;for(f=0;f<g.length;f++)n=g[f][a],g[f][a]=g[f][u],g[f][u]=n;a=u}return{U:h,S:d,V:g}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],83:[function(r,t){"use strict";function n(r,t){this.data=r,this.h=t}var e=r("numeric"),i={windSize:5,deriv:1,pol:2};n.prototype.calc=function(r){r=r||{},this.options={};for(var t in i)this.options[t]=r.hasOwnProperty(t)?r[t]:i[t];if(this.options.windSize%2===0||this.options.windSize<5)throw new RangeError("Invalid window size");if(this.options.deriv<0||this.options.pol<1)throw new RangeError("Number too small");if(this.options.pol!==Math.floor(this.options.pol)||this.options.deriv!==Math.floor(this.options.deriv)||this.options.windSize!==Math.floor(this.options.windSize))throw new TypeError("Only integers allowed");var n,o;if(5!==this.options.windSize||2!==this.options.pol||1!==this.options.deriv&&2!==this.options.deriv){for(var s=new Array(this.options.windSize),a=0;a<s.length;a++){s[a]=new Array(this.options.pol+1);for(var u=-(this.options.windSize-1)/2,f=0;f<s[a].length;f++)s[a][f]=u+1===0&&0===f?1:Math.pow(u+a,f)}n=e.dot(e.inv(e.dot(e.transpose(s),s)),e.transpose(s)),n=n[this.options.deriv].concat(),o=1}else 1===this.options.deriv?(n=[-2,-1,0,1,2],o=10):(n=[2,-1,-2,-1,2],o=7);for(var c=new Array(this.data.length),h=Math.ceil(this.options.windSize/2);h<c.length-Math.floor(this.options.windSize/2);h++){for(var m=0,l=0;l<n.length;l++)m+=n[l]*this.data[l+h-Math.floor(this.options.windSize/2)]/(o*Math.pow(this.h,this.options.deriv));c[h]=m}return c},t.exports=n},{numeric:82}],84:[function(require,module,exports){"use strict";function SOM(r,t,n,e){this.x=r,this.y=t,n=n||{},this.options={};for(var i in defaultOptions)this.options[i]=n.hasOwnProperty(i)?n[i]:defaultOptions[i];if("number"==typeof this.options.fields)this.numWeights=this.options.fields;else{if(!Array.isArray(this.options.fields))throw new Error("Invalid fields definition");this.numWeights=this.options.fields.length;var o=getConverters(this.options.fields);this.extractor=o.extractor,this.creator=o.creator}if("rect"===this.options.gridType)this.nodeType=NodeSquare,this.gridDim={x:r,y:t};else{this.nodeType=NodeHexagonal;var s=this.x-Math.floor(this.y/2);this.gridDim={x:s,y:this.y,z:-(0-s-this.y)}}if(this.torus=this.options.torus,this.distanceMethod=this.torus?"getDistanceTorus":"getDistance",this.distance=this.options.distance,this.maxDistance=getMaxDistance(this.distance,this.numWeights),e===!0)return void(this.done=!0);if(!(r>0&&t>0))throw new Error("x and y must be positive");this.times={findBMU:0,adjust:0},this.randomizer=this.options.randomizer,this.iterationCount=0,this.iterations=this.options.iterations,this.startLearningRate=this.learningRate=this.options.learningRate,this.mapRadius=Math.floor(Math.max(r,t)/2),this.algorithmMethod=this.options.method,this._initNodes(),this.done=!1}function getConverters(r){for(var t=r.length,n=new Array(t),e=new Array(t),i=0;t>i;i++)n[i]=getNormalizer(r[i].range),e[i]=getDenormalizer(r[i].range);return{extractor:function(e){for(var i=new Array(t),o=0;t>o;o++)i[o]=n[o](e[r[o].name]);return i},creator:function(n){for(var i={},o=0;t>o;o++)i[r[o].name]=e[o](n[o]);return i}}}function getNormalizer(r){return function(t){return(t-r[0])/(r[1]-r[0])}}function getDenormalizer(r){return function(t){return r[0]+t*(r[1]-r[0])}}function squareEuclidean(r,t){for(var n=0,e=0,i=r.length;i>e;e++)n+=(r[e]-t[e])*(r[e]-t[e]);return n}function getRandomValue(r,t){return r[Math.floor(t()*r.length)]}function getMaxDistance(r,t){for(var n=new Array(t),e=new Array(t),i=0;t>i;i++)n[i]=0,e[i]=1;return r(n,e)}var NodeSquare=require("./node-square"),NodeHexagonal=require("./node-hexagonal"),defaultOptions={fields:3,randomizer:Math.random,distance:squareEuclidean,iterations:10,learningRate:.1,gridType:"rect",torus:!0,method:"random"};SOM.load=function loadModel(model,distance){if("SOM"===model.name){var x=model.data.length,y=model.data[0].length;distance?model.options.distance=distance:model.options.distance&&(model.options.distance=eval("("+model.options.distance+")"));var som=new SOM(x,y,model.options,!0);som.nodes=new Array(x);for(var i=0;x>i;i++){som.nodes[i]=new Array(y);for(var j=0;y>j;j++)som.nodes[i][j]=new som.nodeType(i,j,model.data[i][j],som)}return som}throw new Error("expecting a SOM model")},SOM.prototype["export"]=function(r){if(!this.done)throw new Error("model is not ready yet");var t={name:"SOM"};t.options={fields:this.options.fields,gridType:this.options.gridType,torus:this.options.torus},t.data=new Array(this.x);for(var n=0;n<this.x;n++){t.data[n]=new Array(this.y);for(var e=0;e<this.y;e++)t.data[n][e]=this.nodes[n][e].weights}return r&&(t.options.distance=this.distance.toString()),t},SOM.prototype._initNodes=function(){var r,t,n,e=Date.now();for(this.nodes=new Array(this.x),r=0;r<this.x;r++)for(this.nodes[r]=new Array(this.y),t=0;t<this.y;t++){var i=new Array(this.numWeights);for(n=0;n<this.numWeights;n++)i[n]=this.randomizer();this.nodes[r][t]=new this.nodeType(r,t,i,this)}this.times.initNodes=Date.now()-e},SOM.prototype.setTraining=function(r){if(this.trainingSet)throw new Error("training set has already been set");var t,n=Date.now(),e=r,i=r.length;if(this.extractor)for(e=new Array(i),t=0;i>t;t++)e[t]=this.extractor(r[t]);this.numIterations=this.iterations*i,this.timeConstant="random"===this.algorithmMethod?this.numIterations/Math.log(this.mapRadius):i/Math.log(this.mapRadius),this.trainingSet=e,this.times.setTraining=Date.now()-n},SOM.prototype.trainOne=function(){if(this.done)return!1;if(this.numIterations-->0){var r,t,n;return"random"===this.algorithmMethod?(r=this.mapRadius*Math.exp(-this.iterationCount/this.timeConstant),t=getRandomValue(this.trainingSet,this.randomizer),this._adjust(t,r),this.learningRate=this.startLearningRate*Math.exp(-this.iterationCount/this.numIterations)):(n=-Math.floor(this.iterationCount/this.trainingSet.length),r=this.mapRadius*Math.exp(n/this.timeConstant),t=this.trainingSet[this.iterationCount%this.trainingSet.length],this._adjust(t,r),(this.iterationCount+1)%this.trainingSet.length===0&&(this.learningRate=this.startLearningRate*Math.exp(n/Math.floor(this.numIterations/this.trainingSet.length)))),this.iterationCount++,!0}return this.done=!0,!1},SOM.prototype._adjust=function(r,t){var n,e,i,o,s=Date.now(),a=this._findBestMatchingUnit(r),u=Date.now();this.times.findBMU+=u-s;var f=Math.floor(t),c=a.x-f,h=a.x+f,m=a.y-f,l=a.y+f;for(n=c;h>=n;n++){var p=n;for(0>n?p+=this.x:n>=this.x&&(p-=this.x),e=m;l>=e;e++){var d=e;0>e?d+=this.y:e>=this.y&&(d-=this.y),i=a[this.distanceMethod](this.nodes[p][d]),t>i&&(o=Math.exp(-i/(2*t)),this.nodes[p][d].adjustWeights(r,this.learningRate,o))}}this.times.adjust+=Date.now()-u},SOM.prototype.train=function(r){if(!this.done)for(this.setTraining(r);this.trainOne(););},SOM.prototype.getConvertedNodes=function(){for(var r=new Array(this.x),t=0;t<this.x;t++){r[t]=new Array(this.y);for(var n=0;n<this.y;n++){var e=this.nodes[t][n];r[t][n]=this.creator?this.creator(e.weights):e.weights}}return r},SOM.prototype._findBestMatchingUnit=function(r){for(var t,n,e=1/0,i=0;i<this.x;i++)for(var o=0;o<this.y;o++)n=this.distance(this.nodes[i][o].weights,r),e>n&&(e=n,t=this.nodes[i][o]);return t},SOM.prototype.predict=function(r,t){if("boolean"==typeof r&&(t=r,r=null),r||(r=this.trainingSet),Array.isArray(r)&&(Array.isArray(r[0])||"object"==typeof r[0])){var n=this;return r.map(function(r){return n._predict(r,t)})}return this._predict(r,t)},SOM.prototype._predict=function(r,t){Array.isArray(r)||(r=this.extractor(r));var n=this._findBestMatchingUnit(r),e=[n.x,n.y];return t&&(e[2]=n.getPosition(r)),e},SOM.prototype.getQuantizationError=function(){for(var r=this.getFit(),t=r.length,n=0,e=0;t>e;e++)n+=r[e];return n/t},SOM.prototype.getFit=function(r){r||(r=this.trainingSet);for(var t,n=r.length,e=new Array(n),i=0;n>i;i++)t=this._findBestMatchingUnit(r[i]),e[i]=Math.sqrt(this.distance(r[i],t.weights));return e},module.exports=SOM},{"./node-hexagonal":85,"./node-square":86}],85:[function(r,t){function n(r,t,n,i){e.call(this,r,t,n,i),this.hX=r-Math.floor(t/2),this.z=0-this.hX-t}var e=r("./node-square");n.prototype=new e,n.prototype.constructor=n,n.prototype.getDistance=function(r){return Math.max(Math.abs(this.hX-r.hX),Math.abs(this.y-r.y),Math.abs(this.z-r.z))},n.prototype.getDistanceTorus=function(r){var t=Math.abs(this.hX-r.hX),n=Math.abs(this.y-r.y),e=Math.abs(this.z-r.z);return Math.max(Math.min(t,this.som.gridDim.x-t),Math.min(n,this.som.gridDim.y-n),Math.min(e,this.som.gridDim.z-e))},n.prototype.getPosition=function(){throw new Error("Unimplemented : cannot get position of the points for hexagonal grid")},t.exports=n},{"./node-square":86}],86:[function(r,t){function n(r,t,n,e){this.x=r,this.y=t,this.weights=n,this.som=e,this.neighbors={}}n.prototype.adjustWeights=function(r,t,n){for(var e=0,i=this.weights.length;i>e;e++)this.weights[e]+=t*n*(r[e]-this.weights[e])},n.prototype.getDistance=function(r){return Math.max(Math.abs(this.x-r.x),Math.abs(this.y-r.y))},n.prototype.getDistanceTorus=function(r){var t=Math.abs(this.x-r.x),n=Math.abs(this.y-r.y);return Math.max(Math.min(t,this.som.gridDim.x-t),Math.min(n,this.som.gridDim.y-n))},n.prototype.getNeighbors=function(r){if(!this.neighbors[r]){this.neighbors[r]=new Array(2);var t;if(this[r]>0?t=this[r]-1:this.som.torus&&(t=this.som.gridDim[r]-1),"undefined"!=typeof t){var n,e;"x"===r?(n=t,e=this.y):(n=this.x,e=t),this.neighbors[r][0]=this.som.nodes[n][e]}var i;this[r]<this.som.gridDim[r]-1?i=this[r]+1:this.som.torus&&(i=0),"undefined"!=typeof i&&("x"===r?(n=i,e=this.y):(n=this.x,e=i),this.neighbors[r][1]=this.som.nodes[n][e])}return this.neighbors[r]},n.prototype.getPos=function(r,t){var n,e,i=this.getNeighbors(r),o=this.som.distance;if(i[0])if(i[1]){var s=o(t,i[0].weights),a=o(t,i[1].weights);a>s?(n=i[0],e=-1):(n=i[1],e=1)}else n=i[0],e=-1;else n=i[1],e=1;var u=1-o(t,this.weights),f=1-o(t,n.weights),c=(u-f)/(2-u-f);return.5+.5*c*e},n.prototype.getPosition=function(r){return[this.getPos("x",r),this.getPos("y",r)]},t.exports=n},{}],87:[function(r,t){"use strict";function n(r){for(var t=-1/0,n=r.length,e=0;n>e;e++)r[e]>t&&(t=r[e]);return t}function e(r){for(var t=1/0,n=r.length,e=0;n>e;e++)r[e]<t&&(t=r[e]);return t}function i(r){for(var t=1/0,n=-1/0,e=r.length,i=0;e>i;i++)r[i]<t&&(t=r[i]),r[i]>n&&(n=r[i]);return{min:t,max:n}}function o(r){for(var t=0,n=r.length,e=0;n>e;e++)t+=r[e];return t/n}function s(r){for(var t=0,n=r.length,e=0;n>e;e++)t*=r[e];return Math.pow(t,1/n)}function a(r){for(var t=0,n=r.length,e=0;n>e;e++)t+=Math.log(r[e]);return t/n}function u(r,t){for(var n=0,e=0,i=r.length,o=0;i>o;o++)n+=t[o]*r[o],e+=t[o];return n/e}function f(r,t,n){"undefined"==typeof n&&(n=!1),r=n?r:r.slice(),r.sort();for(var e=r.length,i=Math.floor(e*t),o=0,s=i;e-i>s;s++)o+=r[s];return o/(e-2*i)}function c(r,t){"undefined"==typeof t&&(t=1);for(var n=0,e=0,i=r.length,o=0;i>o;o++)n+=Math.pow(r[o],t+1),e+=Math.pow(r[o],t);return n/e}function h(r,t){return Math.sqrt(d(r,t))}function m(r){return h(r)/Math.sqrt(r.length)}function l(r,t){"undefined"==typeof t&&(t=!1),t||(r=r.slice(),r.sort());var n=r.length,e=Math.floor(n/2);return n%2===0?.5*(r[e-1]+r[e]):r[e]}function p(r,t){"undefined"==typeof t&&(t=!1),t||(r=r.slice(),r.sort());var n=r.length/4,e=r[Math.ceil(n)-1],i=l(r,!0),o=r[Math.ceil(3*n)-1];return{q1:e,q2:i,q3:o}}function d(r,t){"undefined"==typeof t&&(t=!0);for(var n=o(r),e=0,i=r.length,s=0;i>s;s++){var a=r[s]-n;e+=a*a}return t?e/(i-1):e/i}function g(r,t){return Math.sqrt(v(r,t))}function v(r,t){"undefined"==typeof t&&(t=!0);for(var n=0,e=0,i=r.length,o=0;i>o;o++){var s=r[o],a=d(s);n+=(s.length-1)*a,e+=t?s.length-1:s.length}return n/e}function y(r){var t,n=r.length,e=new Array(n);for(t=0;n>t;t++)e[t]=0;var i=new Array(n),o=0;for(t=0;n>t;t++){var s=i.indexOf(r[t]);s>=0?e[s]++:(i[o]=r[t],e[o]=1,o++)}var a=0,u=0;for(t=0;o>t;t++)e[t]>a&&(a=e[t],u=t);return i[u]}function w(r,t,n){"undefined"==typeof n&&(n=!0);var e=o(r),i=o(t);if(r.length!==t.length)throw"Vectors do not have the same dimensions";for(var s=0,a=r.length,u=0;a>u;u++){var f=r[u]-e,c=t[u]-i;s+=f*c}return n?s/(a-1):s/a}function x(r,t){"undefined"==typeof t&&(t=!0);for(var n=o(r),e=0,i=0,s=r.length,a=0;s>a;a++){var u=r[a]-n;e+=u*u,i+=u*u*u}var f=e/s,c=i/s,h=c/Math.pow(f,1.5);if(t){var m=Math.sqrt(s*(s-1)),l=s-2;return m/l*h}return h}function M(r,t){"undefined"==typeof t&&(t=!0);for(var n=o(r),e=r.length,i=0,s=0,a=0;e>a;a++){var u=r[a]-n;i+=u*u,s+=u*u*u*u}var f=i/e,c=s/e;if(t){var h=i/(e-1),m=e*(e+1)/((e-1)*(e-2)*(e-3)),l=s/(h*h),p=(e-1)*(e-1)/((e-2)*(e-3));return m*l-3*p}return c/(f*f)-3}function b(r,t){"undefined"==typeof t&&(t=0);for(var n=0,e=r.length,i=0;e>i;i++)n+=r[i]*Math.log(r[i]+t);return-n}function k(r,t){for(var n=0,e=r.length,i=0;e>i;i++)n+=r[i]*t[i];return n}function A(r,t){return Math.sqrt(S(r,t))}function S(r,t){for(var n=k(r,t),e=0,i=r.length,o=0,s=0,a=0;i>a;a++){var u=r[a]-n,f=t[a];e+=f*u*u,s+=f,o+=f*f}return e*(s/(s*s-o))}function j(r,t){"undefined"==typeof t&&(t=!1);var n=r;t||(n=r.slice());for(var e=o(n),i=n.length,s=0;i>s;s++)n[s]-=e}function R(r,t,n){"undefined"==typeof t&&(t=h(r)),"undefined"==typeof n&&(n=!1);for(var e=r.length,i=n?r:new Array(e),o=0;e>o;o++)i[o]=r[o]/t;return i}function q(r){var t=r.length,n=new Array(t);n[0]=r[0];for(var e=1;t>e;e++)n[e]=n[e-1]+r[e];return n}t.exports={min:e,max:n,minMax:i,mean:o,geometricMean:s,logGeometricMean:a,grandMean:u,truncatedMean:f,contraHarmonicMean:c,standardDeviation:h,standardError:m,median:l,quartiles:p,variance:d,pooledStandardDeviation:g,pooledVariance:v,mode:y,covariance:w,skewness:x,kurtosis:M,entropy:b,weightedMean:k,weightedStandardDeviation:A,weightedVariance:S,center:j,standardize:R,cumulativeSum:q}},{}],88:[function(r,t,n){n.array=r("./array"),n.matrix=r("./matrix")},{"./array":87,"./matrix":89}],89:[function(r,t){"use strict";function n(r,t){"undefined"==typeof t&&(t=0);for(var n=0,e=r.length,i=r[0].length,o=0;e>o;o++)for(var s=0;i>s;s++)n+=r[o][s]*Math.log(r[o][s]+t);return-n}function e(r,t){"undefined"==typeof t&&(t=0);var n,e,i,o,s=r.length,a=r[0].length;if(-1===t){for(n=[0],e=s*a,i=0;s>i;i++)for(o=0;a>o;o++)n[0]+=r[i][o];n[0]/=e}else if(0===t)for(n=new Array(a),e=s,o=0;a>o;o++){for(n[o]=0,i=0;s>i;i++)n[o]+=r[i][o];n[o]/=e}else{if(1!==t)throw new Error("Invalid dimension");for(n=new Array(s),e=a,o=0;s>o;o++){for(n[o]=0,i=0;a>i;i++)n[o]+=r[o][i];n[o]/=e}}return n}function i(r,t,n){for(var e=o(r,t,n),i=e.length,s=0;i>s;s++)e[s]=Math.sqrt(e[s]);return e}function o(r,t,n){"undefined"==typeof n&&(n=!0),t=t||e(r);var i=r.length;if(0===i)return[];for(var o=r[0].length,s=new Array(o),a=0;o>a;a++){for(var u=0,f=0,c=0,h=0;i>h;h++)c=r[h][a]-t[a],u+=c,f+=c*c;s[a]=n?(f-u*u/i)/(i-1):(f-u*u/i)/i}return s}function s(r){for(var t=r.length,n=r[0].length,e=new Array(n),i=0;n>i;i++){for(var o=new Array(t),s=0;t>s;s++)o[s]=r[s][i];o.sort();var a=o.length;e[i]=a%2===0?.5*(o[a/2]+o[a/2-1]):o[Math.floor(a/2)]}return e}function a(r){var t,n,e=r.length,i=r[0].length,o=new Array(i);for(t=0;i>t;t++){for(var s=new Array(e),a=0;e>a;a++)s[a]=0;var u=new Array(e),f=0;for(n=0;e>n;n++){var c=u.indexOf(r[n][t]);c>=0?s[c]++:(u[f]=r[n][t],s[f]=1,f++)}var h=0,m=0;for(n=0;f>n;n++)s[n]>h&&(h=s[n],m=n);o[t]=u[m]}return o}function u(r,t){"undefined"==typeof t&&(t=!0);for(var n=e(r),i=r.length,o=n.length,s=new Array(o),a=0;o>a;a++){for(var u=0,f=0,c=0;i>c;c++){var h=r[c][a]-n[a];u+=h*h,f+=h*h*h}var m=u/i,l=f/i,p=l/Math.pow(m,1.5);if(t){var d=Math.sqrt(i*(i-1)),g=i-2;s[a]=d/g*p}else s[a]=p}return s}function f(r,t){"undefined"==typeof t&&(t=!0);for(var n=e(r),i=r.length,o=r[0].length,s=new Array(o),a=0;o>a;a++){for(var u=0,f=0,c=0;i>c;c++){var h=r[c][a]-n[a];u+=h*h,f+=h*h*h*h}var m=u/i,l=f/i;if(t){var p=u/(i-1),d=i*(i+1)/((i-1)*(i-2)*(i-3)),g=f/(p*p),v=(i-1)*(i-1)/((i-2)*(i-3));s[a]=d*g-3*v}else s[a]=l/(m*m)-3}return s}function c(r){for(var t=r.length,n=i(r),e=n.length,o=new Array(e),s=Math.sqrt(t),a=0;e>a;a++)o[a]=n[a]/s;return o}function h(r,t){return m(r,void 0,t)}function m(r,t,n){"undefined"==typeof n&&(n=0),"undefined"==typeof t&&(0===n?t=r.length-1:1===n&&(t=r[0].length-1));var i=e(r,n),o=r.length;if(0===o)return[[]];var s,a,u,f,c,h=r[0].length;if(0===n){for(s=new Array(h),a=0;h>a;a++)s[a]=new Array(h);for(a=0;h>a;a++)for(u=a;h>u;u++){for(f=0,c=0;o>c;c++)f+=(r[c][u]-i[u])*(r[c][a]-i[a]);f/=t,s[a][u]=f,s[u][a]=f}}else{if(1!==n)throw new Error("Invalid dimension");for(s=new Array(o),a=0;o>a;a++)s[a]=new Array(o);for(a=0;o>a;a++)for(u=a;o>u;u++){for(f=0,c=0;h>c;c++)f+=(r[u][c]-i[u])*(r[a][c]-i[a]);f/=t,s[a][u]=f,s[u][a]=f}}return s}function l(r){var t,n,o=e(r),s=i(r,!0,o),a=p(r,o,s),u=r.length,f=r[0].length,c=new Array(f);for(t=0;f>t;t++)c[t]=new Array(f);for(t=0;f>t;t++)for(n=t;f>n;n++){for(var h=0,m=0,l=a.length;l>m;m++)h+=a[m][n]*a[m][t];h/=u-1,c[t][n]=h,c[n][t]=h}return c}function p(r,t,n){return t=t||e(r),"undefined"==typeof n&&(n=i(r,!0,t)),g(d(r,t,!1),n,!0)}function d(r,t,n){t=t||e(r);var i,o,s,a=r,u=r.length;if(!n)for(a=new Array(u),i=0;u>i;i++)a[i]=new Array(r[i].length);for(i=0;u>i;i++){var f=a[i];for(o=0,s=f.length;s>o;o++)f[o]=r[i][o]-t[o]}return a}function g(r,t,n){"undefined"==typeof t&&(t=i(r));var e,o,s,a=r,u=r.length;if(!n)for(a=new Array(u),e=0;u>e;e++)a[e]=new Array(r[e].length);for(e=0;u>e;e++){var f=a[e],c=r[e];for(o=0,s=f.length;s>o;o++)0===t[o]||isNaN(t[o])||(f[o]=c[o]/t[o])}return a}function v(r,t){var n=e(r),i=r.length;if(0===i)return[];for(var o=r[0].length,s=new Array(o),a=0;o>a;a++){for(var u=0,f=0,c=0,h=0;i>h;h++){var m=r[h][a]-n[a],l=t[h];u+=l*m*m,c+=l,f+=l*l}s[a]=u*(c/(c*c-f))}return s}function y(r,t,n){"undefined"==typeof n&&(n=0);var e=r.length;if(0===e)return[];var i,o,s,a,u,f,c=r[0].length;if(0===n){for(i=new Array(c),o=0;c>o;o++)i[o]=0;for(o=0;e>o;o++)for(f=r[o],u=t[o],a=0;c>a;a++)i[a]+=f[a]*u}else{if(1!==n)throw new Error("Invalid dimension");for(i=new Array(e),o=0;e>o;o++)i[o]=0;for(a=0;e>a;a++)for(f=r[a],u=t[a],o=0;c>o;o++)i[a]+=f[o]*u}var h=M(t);if(0!==h)for(o=0,s=i.length;s>o;o++)i[o]/=h;return i}function w(r,t,n,e){e=e||0,n=n||y(r,t,e);for(var i=0,o=0,s=0,a=t.length;a>s;s++)i+=t[s],o+=t[s]*t[s];var u=i/(i*i-o);return x(r,t,n,u,e)}function x(r,t,n,e,i){i=i||0,n=n||y(r,t,i),"undefined"==typeof e&&(e=1);var o=r.length;if(0===o)return[[]];var s,a,u,f,c,h=r[0].length;if(0===i){for(s=new Array(h),a=0;h>a;a++)s[a]=new Array(h);for(a=0;h>a;a++)for(u=a;h>u;u++){for(c=0,f=0;o>f;f++)c+=t[f]*(r[f][u]-n[u])*(r[f][a]-n[a]);s[a][u]=c*e,s[u][a]=c*e}}else{if(1!==i)throw new Error("Invalid dimension");for(s=new Array(o),a=0;o>a;a++)s[a]=new Array(o);for(a=0;o>a;a++)for(u=a;o>u;u++){for(c=0,f=0;h>f;f++)c+=t[f]*(r[u][f]-n[u])*(r[a][f]-n[a]);s[a][u]=c*e,s[u][a]=c*e}}return s}function M(r){for(var t=0,n=r.length,e=0;n>e;e++)t+=r[e];return t}t.exports={entropy:n,mean:e,standardDeviation:i,variance:o,median:s,mode:a,skewness:u,kurtosis:f,standardError:c,covariance:h,scatter:m,correlation:l,zScores:p,center:d,standardize:g,weightedVariance:v,weightedMean:y,weightedCovariance:w,weightedScatter:x}},{}],90:[function(r,t,n){t.exports=n=r("./svm"),n.kernel=r("./kernel").kernel},{"./kernel":91,"./svm":92}],91:[function(r,t){"use strict";function n(r,t,n,e){return i(n)(r,t,e)}function e(r,t){for(var n=r.length,e=0,i=0;n>i;i++)e+=r[i]*t[i];return e}function i(r){switch(r="undefined"==typeof r?"lineal":r){case"lineal":return o;case"polynomial":return s;case"radial":return a;default:throw new TypeError("Function kernel undefined: "+r)}}function o(r,t){return e(r,t)}function s(r,t,n){return n="undefined"==typeof n?2:n,Math.pow(e(r,t)+1,n)}function a(r,t,n){n="undefined"==typeof n?2:n;for(var i=r.length,o=new Array(i),s=0;i>s;s++)o[s]=r[s]-t[s];var a=e(o,o);return Math.exp(a/(-2*n*n))}t.exports={kernel:n,getKernel:i,lineal:o,polynomial:s,radial:a}},{}],92:[function(r,t){"use strict";function n(r,t,n,e,i,o,s){for(var a=t.length,u=i,f=0;a>f;f++)i+=e[f]*n[f]*o(t[f],r,s);return u}function e(r){r=r||{},this.options={};for(var t in o)this.options[t]=r.hasOwnProperty(t)?r[t]:o[t];
this.kernel=i(this.options.k),this.b=0}var i=(r("./kernel").kernel,r("./kernel").getKernel),o={C:10,tol:.1,max_passes:100,par:2,k:"lineal"};e.prototype.train=function(r,t){for(var e=t.length,i=new Array(e),o=0;e>o;o++)i[o]=0;if(r.length!==e)throw new TypeError("Arrays should have the same length");for(var s=0,a=0,u=0,f=0,c=0,h=0,m=0,l=0,p=0,d=0,g=0;f<this.options.max_passes;){for(var v=0,y=0;e>y;y++)if(c=n(r[y],r,t,i,s,this.kernel,this.options.par)-t[y],t[y]*c<-this.options.tol&&i[y]<this.options.C||t[y]*c>this.options.tol&&i[y]>0){var w=0;do w=Math.ceil(Math.random()*(e-1));while(w===y);h=n(r[w],r,t,i,s,this.kernel,this.options.par)-t[w],m=i[y],l=i[w],t[y]===t[w]?(p=Math.max(0,m+l-this.options.C),d=Math.min(this.options.C,m+l)):(p=Math.max(0,m-l),d=Math.min(this.options.C,this.options.C-m+l)),p!==d&&(g=2*this.kernel(r[y],r[w],this.options.par)-this.kernel(r[y],r[y],this.options.par)-this.kernel(r[w],r[w],this.options.par),0>g&&(i[w]=i[w]-t[w]*(c-h)/g,i[w]>d?i[w]=d:i[w]<p&&(i[w]=p),Math.abs(l-i[w])>=1e-4&&(i[y]=i[y]+t[y]*t[w]*(l-i[w]),a=s-c-t[y]*(i[y]-m)*this.kernel(r[y],r[y],this.options.par)-t[w]*(i[w]-l)*this.kernel(r[y],r[w],this.options.par),u=s-h-t[y]*(i[y]-m)*this.kernel(r[y],r[w],this.options.par)-t[w]*(i[w]-l)*this.kernel(r[w],r[w],this.options.par),s=i[y]<this.options.C&&i[y]>0?a:i[w]<this.options.C&&i[w]>0?u:(a+u)/2,v+=1)))}0==v?f+=1:f=0}this.b=s;var x=r[0].length;this.W=new Array(x);for(var M=0;x>M;M++){this.W[M]=0;for(var b=0;e>b;b++)this.W[M]+=t[b]*i[b]*r[b][M]}this.alphas=i.splice()},e.load=function(r){if("SVM"===r.name){var t=new e(r.options);return t.W=r.W.slice(),t.b=r.b,t}throw new TypeError("expecting a SVM model")},e.prototype["export"]=function(){var r={name:"SVM"};return r.options=this.options,r.W=this.W,r.b=this.b,r},e.prototype.getAlphas=function(){return this.alphas.slice()},e.prototype.getThreshold=function(){return this.b},e.prototype.predict=function(r){var t;if(Array.isArray(r)&&(Array.isArray(r[0])||"object"==typeof r[0])){for(var n=new Array(r.length),e=0;e<n.length;e++){t=this.b;for(var i=0;i<this.W.length;i++)t+=this.W[i]*r[i];n[e]=0>t?-1:1}return n}t=this.b;for(var o=0;o<this.W.length;o++)t+=this.W[o]*r[o];return 0>t?-1:1},t.exports=e},{"./kernel":91}]},{},[1])(1)});
//# sourceMappingURL=ml.min.js.map