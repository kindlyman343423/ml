// ml@v0.3.7, MIT licensed. https://github.com/mljs/ml
!function(r){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=r();else if("function"==typeof define&&define.amd)define([],r);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.ML=r()}}(function(){var define,module,exports;return function r(t,n,e){function i(a,s){if(!n[a]){if(!t[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(o)return o(a,!0);var f=new Error("Cannot find module '"+a+"'");throw f.code="MODULE_NOT_FOUND",f}var c=n[a]={exports:{}};t[a][0].call(c.exports,function(r){var n=t[a][1][r];return i(n?n:r)},c,c.exports,r,t,n,e)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<e.length;a++)i(e[a]);return i}({1:[function(r,t,n){var e=n.Math={};e.Matrix=n.Matrix=r("ml-matrix"),e.Distance=r("ml-distance"),e.SG=r("ml-savitzky-golay");var i=n.Stat={};i.array=r("ml-stat/array"),i.matrix=r("ml-stat/matrix");var o=n.SL={};o.SVM=r("ml-svm");var a=n.Clust={};a.kmeans=r("ml-kmeans"),a.hclust=r("ml-hclust");var s=n.NN=n.nn={};s.SOM=r("ml-som");n.ArrayUtils=n.AU=r("ml-array-utils")},{"ml-array-utils":4,"ml-distance":57,"ml-hclust":60,"ml-kmeans":61,"ml-matrix":70,"ml-savitzky-golay":73,"ml-som":74,"ml-stat/array":77,"ml-stat/matrix":78,"ml-svm":79}],2:[function(r,t){"use strict";function n(r,t){if(r.length%t!==0)throw new RangeError("Dimensions number must be accordance with the size of the array.");for(var n=r.length/t,e=new Array(n),i=0,o=0;o<r.length;o+=t){for(var a=new Array(t),s=0;t>s;++s)a[s]=r[o+s];e[i]=a,i++}return e}function e(r,t){if(r.length%t!==0)throw new RangeError("Dimensions number must be accordance with the size of the array.");for(var n=new Array(t),e=r.length/t,i=0;i<n.length;i++)n[i]=new Array(e);for(i=0;i<r.length;i+=t)for(var o=0;t>o;++o){var a=Math.floor(i/t);n[o][a]=r[i+o]}return n}function i(r){for(var t=new Array(r.length*r[0].length),n=0,e=0;e<r[0].length;++e)for(var i=0;i<r.length;++i)t[n]=r[i][e],++n;return t}function o(r){for(var t=new Array(r[0].length),n=0;n<t.length;++n)t[n]=new Array(r.length);for(n=0;n<r.length;++n)for(var e=0;e<r[0].length;++e)t[e][n]=r[n][e];return t}function a(r){for(var t=new Array(r.length*r[0].length),n=0,e=0;e<r.length;++e)for(var i=0;i<r[0].length;++i)t[n]=r[e][i],++n;return t}function s(r,t){var n,e;r.length<=t.length?(e=r,n=t):(e=t,n=r);for(var i=n.length-e.length+1,o=new Array(i),a=0;i>a;++a){for(var s=0,u=0;u<e.length;++u)s+=e[u]*n[a+u];o[a]=s}return o}t.exports={coordArrayToPoints:n,coordArrayToCoordMatrix:e,coordMatrixToCoordArray:i,coordMatrixToPoints:o,pointsToCoordArray:a,pointsToCoordMatrix:o,applyDotProduct:s}},{}],3:[function(r,t,n){"use strict";function e(r,t,n){function e(){return"smooth"===l?i(b,A,q,T):k}function o(){q=a(b,k,A,S),T=-q*b+k}function a(r,t,n,e){return(e-t)/(n-r)}var s=r.length;if(r.length!==t.length)throw new RangeError("the x and y vector doesn't have the same size.");void 0===n&&(n={});var u=void 0===n.from?r[0]:n.from,f=void 0===n.to?r[r.length-1]:n.to,c=u>f;if(c){var h=u;u=f,f=h}var m=void 0===n.numberOfPoints?100:n.numberOfPoints;if(1>m)throw new RangeError("the number of point must be higher than 1");var l="slot"===n.variant?"slot":"smooth",p=(f-u)/(m-1),d=p/2,g=u-d,v=new Array(m),y=r[1]-r[0],w=r[r.length-1]-r[r.length-2],x=g,M=g+p,b=-Number.MAX_VALUE,k=0,A=r[0]-y,S=0,j=0,q=0,T=0,V=0,D=0,O=0,R=0,_=0;r:for(;;){for(;A-M>=0;){var z="smooth"===l?i(0,M-b,q,k):k;D=j+z;var C="smooth"===l?p:O-1;if(v[_]=(D-V)/C,_++,_===m)break r;x=M,M+=p,V=D,"slot"===l&&(O=0)}x>=b&&A>=x&&(z="smooth"===l?i(0,x-b,q,k):k,V=j+z,"slot"===l&&O++),j+=e(),0!==O&&O++,b=A,k=S,s>R?(A=r[R],S=t[R],R++):R===s&&(A+=w,S=0),o()}return c?v.reverse():v}function i(r,t,n,e){return.5*n*t*t+e*t-(.5*n*r*r+e*r)}n.getEquallySpacedData=e,n.integral=i},{}],4:[function(r,t,n){t.exports=n=r("./ArrayUtils"),n.getEquallySpacedData=r("./getEquallySpaced").getEquallySpacedData},{"./ArrayUtils":2,"./getEquallySpaced":3}],5:[function(r,t){t.exports=function(r,t){for(var n=0,e=r.length,i=0;e>n;n++)i+=(r[n]-t[n])*(r[n]-t[n])*(r[n]+t[n])/(r[n]*t[n]);return 2*i}},{}],6:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0,o=0,a=0;n>a;a++)o=Math.abs(r[a]-t[a]),i+=o,o>e&&(e=o);return(e+i)/2}},{}],7:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0;n>i;i++)e+=Math.sqrt(r[i]*t[i]);return-Math.log(e)}},{}],8:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0;n>i;i++)e+=Math.abs(r[i]-t[i])/(r[i]+t[i]);return e}},{}],9:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0,o=0;n>o;o++)i=Math.abs(r[o]-t[o]),i>e&&(e=i);return e}},{}],10:[function(r,t){t.exports=function(r,t){for(var n=0,e=r.length,i=0;e>n;n++)i+=Math.sqrt((r[n]-t[n])*(r[n]-t[n])/((r[n]+t[n])*(r[n]+t[n])));return 2*i}},{}],11:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0,o=0,a=0;n>a;a++)e+=r[a]*t[a],i+=r[a]*r[a],o+=t[a]*t[a];return e/(Math.sqrt(i)*Math.sqrt(o))}},{}],12:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0,o=0;n>o;o++)e+=Math.min(r[o],t[o]),i+=r[o]+t[o];return 1-2*e/i}},{}],13:[function(r,t){var n=r("./czekanowski");t.exports=function(r,t){return 1-n(r,t)}},{"./czekanowski":12}],14:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0,o=0,a=0;n>a;a++)e+=r[a]*r[a],i+=t[a]*t[a],o+=(r[a]-t[a])*(r[a]-t[a]);return o/(e+i)}},{}],15:[function(r,t){var n=r("./dice");t.exports=function(r,t){return 1-n(r,t)}},{"./dice":14}],16:[function(r,t){t.exports=function(r,t){for(var n=0,e=r.length,i=0;e>n;n++)i+=(r[n]-t[n])*(r[n]-t[n])/((r[n]+t[n])*(r[n]+t[n]));return 2*i}},{}],17:[function(r,t){var n=r("./squared-euclidean");t.exports=function(r,t){return Math.sqrt(n(r,t))}},{"./squared-euclidean":47}],18:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0;n>i;i++)e+=Math.sqrt(r[i]*t[i]);return e}},{}],19:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0;n>i;i++)e+=Math.abs(r[i]-t[i]);return e/n}},{}],20:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0;n>i;i++)e+=r[i]*t[i]/(r[i]+t[i]);return 2*e}},{}],21:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0;n>i;i++)e+=Math.sqrt(r[i]*t[i]);return 2*Math.sqrt(1-e)}},{}],22:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0;n>i;i++)e+=r[i]*t[i];return e}},{}],23:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0;n>i;i++)e+=Math.min(r[i],t[i]);return 1-e}},{}],24:[function(r,t){var n=r("./intersection");t.exports=function(r,t){return 1-n(r,t)}},{"./intersection":23}],25:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0,o=0,a=0,s=0;n>s;s++)e+=r[s]*t[s],i+=r[s]*r[s],o+=t[s]*t[s],a+=(r[s]-t[s])*(r[s]-t[s]);return a/(i+o-e)}},{}],26:[function(r,t){var n=r("./jaccard");t.exports=function(r,t){return 1-n(r,t)}},{"./jaccard":25}],27:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0;n>i;i++)e+=(r[i]-t[i])*Math.log(r[i]/t[i]);return e}},{}],28:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0;n>i;i++)e+=(r[i]*Math.log(r[i])+t[i]*Math.log(t[i]))/2-(r[i]+t[i])/2*Math.log((r[i]+t[i])/2);return e}},{}],29:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0,o=0;n>o;o++)e+=r[o]*Math.log(2*r[o]/(r[o]+t[o])),i+=t[o]*Math.log(2*t[o]/(r[o]+t[o]));return(e+i)/2}},{}],30:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0;n>i;i++)e+=r[i]*Math.log(2*r[i]/(r[i]+t[i]));return e}},{}],31:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0,o=0;n>o;o++)e+=Math.abs(r[o]-t[o]),i+=Math.min(r[o],t[o]);return e/i}},{}],32:[function(r,t){var n=r("./kulczynski");t.exports=function(r,t){return 1/n(r,t)}},{"./kulczynski":31}],33:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0;n>i;i++)e+=r[i]*Math.log(r[i]/t[i]);return e}},{}],34:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0,o=0,a=0;n>a;a++)e+=r[a]*t[a],i+=r[a]*r[a],o+=t[a]*t[a];return e/(i+o-e)}},{}],35:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0;n>i;i++)e+=Math.pow(r[i]*r[i]-t[i]*t[i],2)/(2*Math.pow(r[i]*t[i],1.5));return e}},{}],36:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0;n>i;i++)e+=Math.log(Math.abs(r[i]-t[i])+1);return e}},{}],37:[function(r,t){t.exports=function(r,t){for(var n=0,e=r.length,i=0;e>n;n++)i+=Math.abs(r[n]-t[n]);return i}},{}],38:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0;n>i;i++)e+=Math.sqrt(r[i]*t[i]);return Math.sqrt(2-2*e)}},{}],39:[function(r,t){t.exports=function(r,t,n){for(var e=0,i=r.length,o=0;i>e;e++)o+=Math.pow(Math.abs(r[e]-t[e]),n);return Math.pow(o,1/n)}},{}],40:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0,o=0;n>o;o++)e+=Math.min(r[o],t[o]),i+=r[o]+t[o];return 1-e/i}},{}],41:[function(r,t){t.exports=function(r,t){for(var n=0,e=r.length,i=0;e>n;n++)i+=(r[n]-t[n])*(r[n]-t[n])/r[n];return i}},{}],42:[function(r,t){t.exports=function(r,t){for(var n=0,e=r.length,i=0;e>n;n++)i+=(r[n]-t[n])*(r[n]-t[n])/t[n];return i}},{}],43:[function(r,t){t.exports=function(r,t){for(var n=0,e=r.length,i=0;e>n;n++)i+=(r[n]-t[n])*(r[n]-t[n])/(r[n]+t[n]);return 2*i}},{}],44:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0,o=0;n>o;o++)e+=Math.min(r[o],t[o]),i+=Math.max(r[o],t[o]);return e/i}},{}],45:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0,o=0;n>o;o++)e+=Math.abs(r[o]-t[o]),i+=Math.max(r[o],t[o]);return e/i}},{}],46:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0,o=0;n>o;o++)e+=Math.abs(r[o]-t[o]),i+=r[o]+t[o];return e/i}},{}],47:[function(r,t){t.exports=function(r,t){for(var n=0,e=r.length,i=0;e>n;n++)i+=(r[n]-t[n])*(r[n]-t[n]);return i}},{}],48:[function(r,t){t.exports=function(r,t){for(var n=0,e=r.length,i=0;e>n;n++)i+=(r[n]-t[n])*(r[n]-t[n])/(r[n]+t[n]);return i}},{}],49:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0;n>i;i++)e+=(Math.sqrt(r[i])-Math.sqrt(t[i]))*(Math.sqrt(r[i])-Math.sqrt(t[i]));return e}},{}],50:[function(r,t){var n=r("./squaredChord");t.exports=function(r,t){return 1-n(r,t)}},{"./squaredChord":49}],51:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0;n>i;i++)e+=(r[i]+t[i])/2*Math.log((r[i]+t[i])/(2*Math.sqrt(r[i]*t[i])));return e}},{}],52:[function(r,t){var n=r("./tanimotoS");t.exports=function(r,t,e){if(e=e||!1)return 1-n(r,t,e);for(var i=r.length,o=0,a=0,s=0,u=0;i>u;u++)o+=r[u],a+=t[u],s+=Math.min(r[u],t[u]);return(o+a-2*s)/(o+a-s)}},{"./tanimotoS":53}],53:[function(r,t){t.exports=function(r,t,n){if(n=n||!1){for(var e=0,i=0,o=0;o<r.length;o++)e+=r[o]&&t[o],i+=r[o]||t[o];return 0===i?1:e/i}for(var a=r.length,s=0,u=0,f=0,c=0;a>c;c++)s+=r[c],u+=t[c],f+=Math.min(r[c],t[c]);return 1-(s+u-2*f)/(s+u-f)}},{}],54:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0;n>i;i++)e+=r[i]*Math.log(2*r[i]/(r[i]+t[i]))+t[i]*Math.log(2*t[i]/(r[i]+t[i]));return e}},{}],55:[function(r,t){"use strict";function n(r,t,e,i,o,a){if(o=o||.16,a=a||.01,o>i-e)return void 0;for(var s=0,u=0;r[u]<i;u++)r[u]>e&&(s+=t[u]);if(a>s)return void 0;for(var f=0,c=0;r[c]<i;c++)r[u]>e&&(f+=r[c]*t[c]);return f/=s,1e-5>f-e||1e-5>i-f?void 0:o/4>f-e?n(r,t,f,i,o,a):o/4>i-f?n(r,t,e,f,o,a):{sum:s,center:f,left:n(r,t,e,f,o,a),right:n(r,t,f,i,o,a)}}function e(r,t,n,i,o){if(void 0===r||void 0===t)return 0;var a=n*Math.min(r.sum,t.sum)/Math.max(r.sum,t.sum)+(1-n)*Math.exp(-o*Math.abs(r.center-t.center));return i*a+(1-i)*(e(r.left,t.left,n,i,o)+e(r.right,t.right,n,i,o))}function i(r,t,i,a,s){s=s||{};for(var u in o)s.hasOwnProperty(u)||(s[u]=o[u]);var f,c;return f=r.sum?r:n(r.x,r.y,i,a,s.minWindow,s.threshold),c=t.sum?t:n(t.x,t.y,i,a,s.minWindow,s.threshold),e(f,c,s.alpha,s.beta,s.gamma)}var o={minWindow:.16,threshold:.01,alpha:.1,beta:.33,gamma:.001};t.exports={calc:i,createTree:n}},{}],56:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0;n>i;i++)e+=1-Math.min(r[i],t[i])/Math.max(r[i],t[i]);return e}},{}],57:[function(r,t,n){n.euclidean=r("./dist/euclidean"),n.squaredEuclidean=r("./dist/squared-euclidean"),n.manhattan=r("./dist/manhattan"),n.minkowski=r("./dist/minkowski"),n.chebyshev=r("./dist/chebyshev"),n.sorensen=r("./dist/sorensen"),n.gower=r("./dist/gower"),n.soergel=r("./dist/soergel"),n.kulczynski=r("./dist/kulczynski"),n.kulczynskiS=r("./dist/kulczynskiS"),n.canberra=r("./dist/canberra"),n.lorentzian=r("./dist/lorentzian"),n.intersection=r("./dist/intersection"),n.intersectionS=r("./dist/intersectionS"),n.waveHedges=r("./dist/waveHedges"),n.czekanowski=r("./dist/czekanowski"),n.czekanowskiS=r("./dist/czekanowskiS"),n.motyka=r("./dist/motyka"),n.kulczynskiS=r("./dist/kulczynskiS"),n.ruzicka=r("./dist/ruzicka"),n.tanimoto=r("./dist/tanimoto"),n.tanimotoS=r("./dist/tanimotoS"),n.innerProduct=r("./dist/innerProduct"),n.harmonicMean=r("./dist/harmonicMean"),n.cosine=r("./dist/cosine"),n.kumarHassebrook=r("./dist/kumarHassebrook"),n.jaccard=r("./dist/jaccard"),n.jaccardS=r("./dist/jaccardS"),n.dice=r("./dist/dice"),n.diceS=r("./dist/diceS"),n.fidelity=r("./dist/fidelity"),n.bhattacharyya=r("./dist/bhattacharyya"),n.hellinger=r("./dist/hellinger"),n.matusita=r("./dist/matusita"),n.squaredChord=r("./dist/squaredChord"),n.squaredChordS=r("./dist/squaredChordS"),n.pearson=r("./dist/pearson"),n.neyman=r("./dist/neyman"),n.squared=r("./dist/squared"),n.probabilisticSymmetric=r("./dist/probabilisticSymmetric"),n.divergence=r("./dist/divergence"),n.clark=r("./dist/clark"),n.additiveSymmetric=r("./dist/additiveSymmetric"),n.kullbackLeibler=r("./dist/kullbackLeibler"),n.jeffreys=r("./dist/jeffreys"),n.kdivergence=r("./dist/kdivergence"),n.topsoe=r("./dist/topsoe"),n.jensenShannon=r("./dist/jensenShannon"),n.jensenDifference=r("./dist/jensenDifference"),n.taneja=r("./dist/taneja"),n.kumarJohnson=r("./dist/kumarJohnson"),n.avg=r("./dist/avg"),n.tree=r("./dist/tree")},{"./dist/additiveSymmetric":5,"./dist/avg":6,"./dist/bhattacharyya":7,"./dist/canberra":8,"./dist/chebyshev":9,"./dist/clark":10,"./dist/cosine":11,"./dist/czekanowski":12,"./dist/czekanowskiS":13,"./dist/dice":14,"./dist/diceS":15,"./dist/divergence":16,"./dist/euclidean":17,"./dist/fidelity":18,"./dist/gower":19,"./dist/harmonicMean":20,"./dist/hellinger":21,"./dist/innerProduct":22,"./dist/intersection":23,"./dist/intersectionS":24,"./dist/jaccard":25,"./dist/jaccardS":26,"./dist/jeffreys":27,"./dist/jensenDifference":28,"./dist/jensenShannon":29,"./dist/kdivergence":30,"./dist/kulczynski":31,"./dist/kulczynskiS":32,"./dist/kullbackLeibler":33,"./dist/kumarHassebrook":34,"./dist/kumarJohnson":35,"./dist/lorentzian":36,"./dist/manhattan":37,"./dist/matusita":38,"./dist/minkowski":39,"./dist/motyka":40,"./dist/neyman":41,"./dist/pearson":42,"./dist/probabilisticSymmetric":43,"./dist/ruzicka":44,"./dist/soergel":45,"./dist/sorensen":46,"./dist/squared":48,"./dist/squared-euclidean":47,"./dist/squaredChord":49,"./dist/squaredChordS":50,"./dist/taneja":51,"./dist/tanimoto":52,"./dist/tanimotoS":53,"./dist/topsoe":54,"./dist/tree":55,"./dist/waveHedges":56}],58:[function(r,t){"use strict";function n(r,t){for(var n=0,e=r.length,i=0;e>n;n++)i+=(r[n]-t[n])*(r[n]-t[n]);return Math.sqrt(i)}function e(r){for(var t=r.concat(),n=0;n<t.length;++n)for(var e=n+1;e<t.length;++e)t[n]===t[e]&&t.splice(e--,1);return t}function i(r,t,n){for(var e=1e101,i=0;i<r.length;i++)for(var o=i;o<t.length;o++){var a=n(r[i],t[o]);e=Math.min(a,e)}return e}function o(r,t,n){for(var e=-1,i=0;i<r.length;i++)for(var o=i;o<t.length;o++){var a=n(r[i],t[o]);e=Math.max(a,e)}return e}function a(r,t,n){for(var e=0,i=0;i<r.length;i++)for(var o=0;o<t.length;o++)e+=n(r[i],t[o]);return e/(r.length*t.length)}function s(r,t,n){for(var e=0,i=0,o=0,a=0,s=0;s<r.length;s++)e+=r[s][0],i+=r[s][1];for(var u=0;u<t.length;u++)o+=t[u][0],a+=t[u][1];return e/=r.length,i/=r.length,o/=t.length,a/=t.length,n([e,i],[o,a])}function u(r,t,n){for(var e=0,i=0,o=0,a=0,s=0;s<r.length;s++)e+=r[s][0],i+=r[s][1];for(var u=0;u<t.length;u++)o+=t[u][0],a+=t[u][1];return e/=r.length,i/=r.length,o/=t.length,a/=t.length,n([e,i],[o,a])*r.length*t.length/(r.length+t.length)}function f(r,t){t=t||{},this.options={};for(var n in c)this.options[n]=t.hasOwnProperty(n)?t[n]:c[n];this.len=r.length;for(var f=new Array(this.len),h=0;h<this.len;h++)f[h]=[r[h]];if(r=f.concat(),"string"==typeof this.options.kind)switch(this.options.kind){case"single":this.options.kind=i;break;case"complete":this.options.kind=o;break;case"average":this.options.kind=a;break;case"centroid":this.options.kind=s;break;case"ward":this.options.kind=u;break;default:throw new RangeError("Unknown kind of similarity")}else if("function"!=typeof this.options.kind)throw new TypeError("Undefined kind of similarity");for(var m=new Array(r.length),l=0;l<r.length;l++)m[l]={index:l,dis:void 0,data:r[l].concat(),children:[]};for(var p=1e6,d={},g=0;m.length>1;){d={},p=1e6;for(var v=0;v<m.length;v++)for(var y=v+1;y<m.length;y++)g=this.options.kind(m[v].data,m[y].data,this.options.sim).toFixed(4),g in d?d[g].push([v,y]):d[g]=[[v,y]],p=Math.min(g,p);for(var w,x,M=d[p.toFixed(4)],b=[];M.length>0;){w=M.shift();for(var k=M.length-1;k>=0;k--)x=M[k].filter(function(r){return-1!=w.indexOf(r)}),x.length>0&&(w=e(w.concat(M[k])),k=M.length-1,M.splice(k,1));b.push(w)}for(var A=0;A<b.length;A++){for(var S={dis:void 0,data:void 0,children:[]},j=[],q=0;q<b[A].length;q++){var T=b[A][q];j=j.concat(m[T].data),m[T].dis=p,S.children.push(m[T]),delete m[T]}S.data=j.concat(),m.push(S)}for(var V=0;V<m.length;V++)void 0===m[V]&&(m.splice(V,1),V--)}m[0].dis=0,this.tree=m[0]}var c={sim:n,kind:"single"};f.prototype.getDendogram=function(r){if(r=r||{length:this.len,ND:!0},r.length!==this.len)throw new Error("Invalid input size");for(var t=JSON.parse(JSON.stringify(this.tree)),n=[t];n.length>0;){var e=n.shift();if(1===e.data.length)e.data=r.ND?e.data[0]:r[e.index],delete e.index;else{delete e.data,delete e.index;for(var i=0;i<e.children.length;i++)n.push(e.children[i])}}return t},f.prototype.nClusters=function(r){if(r>=this.len)throw new RangeError("Too many clusters");for(var t=[this.tree];t.length<r;)for(var n=t.shift(),e=0;e<n.children.length;e++)t.push(n.children[e]);for(var i=new Array(t.length),o=0;o<t.length;o++){var a=t[o];i[o]=a.data.concat()}return i},t.exports=f},{}],59:[function(r,t){"use strict";function n(r,t){for(var n=0,e=r.length,i=0;e>n;n++)i+=(r[n]-t[n])*(r[n]-t[n]);return Math.sqrt(i)}function e(r,t,n){for(var e=1e101,i=0;i<r.length;i++)for(var o=i;o<t.length;o++){var a=n(r[i],t[o]);e=Math.min(a,e)}return e}function i(r,t,n){for(var e=-1,i=0;i<r.length;i++)for(var o=i;o<t.length;o++){var a=n(r[i],t[o]);e=Math.max(a,e)}return e}function o(r,t,n){for(var e=0,i=0;i<r.length;i++)for(var o=0;o<t.length;o++)e+=n(r[i],t[o]);return e/(r.length*t.length)}function a(r,t,n){for(var e=0,i=0,o=0,a=0,s=0;s<r.length;s++)e+=r[s][0],i+=r[s][1];for(var u=0;u<t.length;u++)o+=t[u][0],a+=t[u][1];return e/=r.length,i/=r.length,o/=t.length,a/=t.length,n([e,i],[o,a])}function s(r,t,n){for(var e=0,i=0,o=0,a=0,s=0;s<r.length;s++)e+=r[s][0],i+=r[s][1];for(var u=0;u<t.length;u++)o+=t[u][0],a+=t[u][1];return e/=r.length,i/=r.length,o/=t.length,a/=t.length,n([e,i],[o,a])*r.length*t.length/(r.length+t.length)}function u(r,t,n){for(var e,i,o={d:0,p:0},a=0;a<r.length;a++){e=0;for(var s=0;s<r.length;s++)a!==s&&(e+=n(r[a],r[s]));e/=r.length-1,i=0;for(var u=0;u<t.length;u++)i+=n(r[a],t[u]);i/=t.length,e-i>o.d&&(o.d=e-i,o.p=a)}return o}function f(r,t){t=t||{},this.options={};for(var n in c)this.options[n]=t.hasOwnProperty(n)?t[n]:c[n];if(this.len=r.length,"string"==typeof this.options.kind)switch(this.options.kind){case"single":this.options.kind=e;break;case"complete":this.options.kind=i;break;case"average":this.options.kind=o;break;case"centroid":this.options.kind=a;break;case"ward":this.options.kind=s;break;default:throw new RangeError("Unknown kind of similarity")}else if("function"!=typeof this.options.kind)throw new TypeError("Undefined kind of similarity");for(var f={},h=0;h<r.length;h++)f[r[h][0]]?f[r[h][0]][r[h][1]]=h:(f[r[h][0]]={},f[r[h][0]][r[h][1]]=h);this.tree={dis:0,data:r,children:[]};for(var m,l,p,d,g,v=[this.tree];0!==v.length;){l=0,p=0;for(var y=0;y<v.length;y++){m=0;for(var w=0;w<v[y].length;w++)for(var x=w+1;x<v[y].length;x++)m=Math.max(this.options.sim(v[y].data[w],v[y].data[x]),m);m>l&&(l=m,p=y)}l=0;var M={dis:void 0,data:v[p].data.concat(),children:[]},b={dis:void 0,data:[],children:[]};v[p].children=[M,b],v.splice(p,1);for(var k=0;k<M.data.length;k++){d=0;for(var A=0;A<M.data.length;A++)k!==A&&(d+=this.options.sim(M.data[A],M.data[k]));d/=M.data.length-1,d>l&&(l=d,g=k)}for(b.data=[M.data[g]],M.data.splice(g,1),d=u(M.data,b.data,this.options.sim);d.d>0;)b.data.push(M.data[d.p]),M.data.splice(d.p,1),d=u(M.data,b.data,this.options.sim);M.dis=this.options.kind(M.data,b.data,this.options.sim),b.dis=M.dis,1===M.data.length?M.index=f[M.data[0][0]][M.data[0][1]]:v.push(M),1===b.data.length?b.index=f[b.data[0][0]][b.data[0][1]]:v.push(b)}}var c={sim:n,kind:"single"};f.prototype.getDendogram=function(r){if(r=r||{length:this.len,ND:!0},r.length!==this.len)throw new Error("Invalid input size");for(var t=JSON.parse(JSON.stringify(this.tree)),n=[t];n.length>0;){var e=n.shift();if(1===e.data.length)e.data=r.ND?e.data[0]:r[e.index],delete e.index;else{delete e.data,delete e.index;for(var i=0;i<e.children.length;i++)n.push(e.children[i])}}return t},f.prototype.nClusters=function(r){if(r>=this.len)throw new RangeError("Too many clusters");for(var t=[this.tree];t.length<r;)for(var n=t.shift(),e=0;e<n.children.length;e++)t.push(n.children[e]);for(var i=new Array(t.length),o=0;o<t.length;o++){var a=t[o];i[o]=a.data.concat()}return i},t.exports=f},{}],60:[function(r,t,n){n.agnes=r("./agnes"),n.diana=r("./diana")},{"./agnes":58,"./diana":59}],61:[function(r,t){t.exports=r("./kmeans")},{"./kmeans":62}],62:[function(r,t){"use strict";function n(r,t){for(var n=0,e=r.length,i=0;e>i;i++)n+=(r[i]-t[i])*(r[i]-t[i]);return n}function e(r,t,e){for(var i=0,o=r.length,a=0,s=0;o>s;s++)a=e[s],i+=n(r[s],t[a]);return i}function i(r,t){for(var e=r.length,i=t.length,o=0,a=new Array(e),s=0;e>s;s++)a[s]=0;for(var u=new Array(e),s=0;e>s;s++){u[s]=new Array(i);for(var f=0;i>f;f++)o=n(r[s],t[f]),u[s][f]=new Array(2),u[s][f][0]=o,u[s][f][1]=f;for(var c=u[s][0][0],h=0,f=0;i>f;f++)u[s][f][0]<c&&(c=u[s][f][0],h=u[s][f][1]);a[s]=h}return a}function o(r,t,n){for(var e=r[0].length,i=r.length,o=new Array(n),a=0;n>a;a++){o[a]=new Array(e);for(var s=0;e>s;s++)o[a][s]=0}for(var u=0;n>u;u++){for(var f=[],a=0;i>a;a++)t[a]==u&&f.push(r[a]);for(var c=0;e>c;c++){for(var h=[],a=0;i>a;a++)t[a]==u&&h.push(r[a][c]);for(var m=0,l=h.length,a=0;l>a;a++)m+=h[a];o[u][c]=m/l}}return o}function a(r,t,n,a){n="undefined"==typeof n?100:n,a="undefined"==typeof a?1e-6:a;var s=r.length;if(0==s)return[];for(var u=t.length,f=new Array(s),c=0;s>c;c++)f[c]=0;if(u>=s){for(var c=0;s>c;c++)f[c]=c;return f}var h;h=1e100;for(var m=0,l=0;n>l;l++){if(f=i(r,t),t=o(r,f,u),m=e(r,t,f),a>h-m||a>(h-m)/h)return f;h=m}return f}t.exports=a},{}],63:[function(r,t){"use strict";function n(r){if(!(this instanceof n))return new n(r);if(r=e.checkMatrix(r),!r.isSymmetric())throw new Error("Matrix is not symmetric");var t,i,o,a=r,s=a.rows,u=new e(s,s),f=!0;for(i=0;s>i;i++){var c=u[i],h=0;for(o=0;i>o;o++){var m=u[o],l=0;for(t=0;o>t;t++)l+=m[t]*c[t];c[o]=l=(a[i][o]-l)/u[o][o],h+=l*l}for(h=a[i][i]-h,f&=h>0,u[i][i]=Math.sqrt(Math.max(h,0)),o=i+1;s>o;o++)u[i][o]=0}if(!f)throw new Error("Matrix is not positive definite");this.L=u}var e=r("../matrix");n.prototype={get leftTriangularFactor(){return this.L},solve:function(r){r=e.checkMatrix(r);var t=this.L,n=t.rows;if(r.rows!==n)throw new Error("Matrix dimensions do not match");var i,o,a,s=r.columns,u=r.clone();for(a=0;n>a;a++)for(o=0;s>o;o++){for(i=0;a>i;i++)u[a][o]-=u[i][o]*t[a][i];u[a][o]/=t[a][a]}for(a=n-1;a>=0;a--)for(o=0;s>o;o++){for(i=a+1;n>i;i++)u[a][o]-=u[i][o]*t[i][a];u[a][o]/=t[a][a]}return u}},t.exports=n},{"../matrix":71}],64:[function(r,t){"use strict";function n(r){if(!(this instanceof n))return new n(r);if(r=u.checkMatrix(r),!r.isSquare())throw new Error("Matrix is not a square matrix");var t,s,f=r.columns,c=u.zeros(f,f),h=new Array(f),m=new Array(f),l=r;if(r.isSymmetric()){for(t=0;f>t;t++)for(s=0;f>s;s++)c[t][s]=l[t][s];e(f,m,h,c),i(f,m,h,c)}else{var p=u.zeros(f,f),d=new Array(f);for(s=0;f>s;s++)for(t=0;f>t;t++)p[t][s]=l[t][s];o(f,p,d,c),a(f,m,h,c,p)}this.n=f,this.e=m,this.d=h,this.V=c}function e(r,t,n,e){var i,o,a,s,u,f,c,h;for(u=0;r>u;u++)n[u]=e[r-1][u];for(s=r-1;s>0;s--){for(h=0,a=0,f=0;s>f;f++)h+=Math.abs(n[f]);if(0===h)for(t[s]=n[s-1],u=0;s>u;u++)n[u]=e[s-1][u],e[s][u]=0,e[u][s]=0;else{for(f=0;s>f;f++)n[f]/=h,a+=n[f]*n[f];for(i=n[s-1],o=Math.sqrt(a),i>0&&(o=-o),t[s]=h*o,a-=i*o,n[s-1]=i-o,u=0;s>u;u++)t[u]=0;for(u=0;s>u;u++){for(i=n[u],e[u][s]=i,o=t[u]+e[u][u]*i,f=u+1;s-1>=f;f++)o+=e[f][u]*n[f],t[f]+=e[f][u]*i;t[u]=o}for(i=0,u=0;s>u;u++)t[u]/=a,i+=t[u]*n[u];for(c=i/(a+a),u=0;s>u;u++)t[u]-=c*n[u];for(u=0;s>u;u++){for(i=n[u],o=t[u],f=u;s-1>=f;f++)e[f][u]-=i*t[f]+o*n[f];n[u]=e[s-1][u],e[s][u]=0}}n[s]=a}for(s=0;r-1>s;s++){if(e[r-1][s]=e[s][s],e[s][s]=1,a=n[s+1],0!==a){for(f=0;s>=f;f++)n[f]=e[f][s+1]/a;for(u=0;s>=u;u++){for(o=0,f=0;s>=f;f++)o+=e[f][s+1]*e[f][u];for(f=0;s>=f;f++)e[f][u]-=o*n[f]}}for(f=0;s>=f;f++)e[f][s+1]=0}for(u=0;r>u;u++)n[u]=e[r-1][u],e[r-1][u]=0;e[r-1][r-1]=1,t[0]=0}function i(r,t,n,e){var i,o,a,s,u,c,h,m,l,p,d,g,v,y,w,x,M;for(a=1;r>a;a++)t[a-1]=t[a];t[r-1]=0;var b=0,k=0,A=Math.pow(2,-52);for(c=0;r>c;c++){for(k=Math.max(k,Math.abs(n[c])+Math.abs(t[c])),h=c;r>h&&!(Math.abs(t[h])<=A*k);)h++;if(h>c){M=0;do{for(M+=1,i=n[c],m=(n[c+1]-i)/(2*t[c]),l=f(m,1),0>m&&(l=-l),n[c]=t[c]/(m+l),n[c+1]=t[c]*(m+l),p=n[c+1],o=i-n[c],a=c+2;r>a;a++)n[a]-=o;for(b+=o,m=n[h],d=1,g=d,v=d,y=t[c+1],w=0,x=0,a=h-1;a>=c;a--)for(v=g,g=d,x=w,i=d*t[a],o=d*m,l=f(m,t[a]),t[a+1]=w*l,w=t[a]/l,d=m/l,m=d*n[a]-w*i,n[a+1]=o+w*(d*i+w*n[a]),u=0;r>u;u++)o=e[u][a+1],e[u][a+1]=w*e[u][a]+d*o,e[u][a]=d*e[u][a]-w*o;m=-w*x*v*y*t[c]/p,t[c]=w*m,n[c]=d*m}while(Math.abs(t[c])>A*k)}n[c]=n[c]+b,t[c]=0}for(a=0;r-1>a;a++){for(u=a,m=n[a],s=a+1;r>s;s++)n[s]<m&&(u=s,m=n[s]);if(u!==a)for(n[u]=n[a],n[a]=m,s=0;r>s;s++)m=e[s][a],e[s][a]=e[s][u],e[s][u]=m}}function o(r,t,n,e){var i,o,a,s,u,f,c,h=0,m=r-1;for(f=h+1;m-1>=f;f++){for(c=0,s=f;m>=s;s++)c+=Math.abs(t[s][f-1]);if(0!==c){for(a=0,s=m;s>=f;s--)n[s]=t[s][f-1]/c,a+=n[s]*n[s];for(o=Math.sqrt(a),n[f]>0&&(o=-o),a-=n[f]*o,n[f]=n[f]-o,u=f;r>u;u++){for(i=0,s=m;s>=f;s--)i+=n[s]*t[s][u];for(i/=a,s=f;m>=s;s++)t[s][u]-=i*n[s]}for(s=0;m>=s;s++){for(i=0,u=m;u>=f;u--)i+=n[u]*t[s][u];for(i/=a,u=f;m>=u;u++)t[s][u]-=i*n[u]}n[f]=c*n[f],t[f][f-1]=c*o}}for(s=0;r>s;s++)for(u=0;r>u;u++)e[s][u]=s===u?1:0;for(f=m-1;f>=h+1;f--)if(0!==t[f][f-1]){for(s=f+1;m>=s;s++)n[s]=t[s][f-1];for(u=f;m>=u;u++){for(o=0,s=f;m>=s;s++)o+=n[s]*e[s][u];for(o=o/n[f]/t[f][f-1],s=f;m>=s;s++)e[s][u]+=o*n[s]}}}function a(r,t,n,e,i){var o,a,u,f,c,h,m,l,p,d,g,v,y,w,x,M=r-1,b=0,k=r-1,A=Math.pow(2,-52),S=0,j=0,q=0,T=0,V=0,D=0,O=0,R=0;for(o=0;r>o;o++)for((b>o||o>k)&&(n[o]=i[o][o],t[o]=0),a=Math.max(o-1,0);r>a;a++)j+=Math.abs(i[o][a]);for(;M>=b;){for(f=M;f>b&&(D=Math.abs(i[f-1][f-1])+Math.abs(i[f][f]),0===D&&(D=j),!(Math.abs(i[f][f-1])<A*D));)f--;if(f===M)i[M][M]=i[M][M]+S,n[M]=i[M][M],t[M]=0,M--,R=0;else if(f===M-1){if(m=i[M][M-1]*i[M-1][M],q=(i[M-1][M-1]-i[M][M])/2,T=q*q+m,O=Math.sqrt(Math.abs(T)),i[M][M]=i[M][M]+S,i[M-1][M-1]=i[M-1][M-1]+S,l=i[M][M],T>=0){for(O=q>=0?q+O:q-O,n[M-1]=l+O,n[M]=n[M-1],0!==O&&(n[M]=l-m/O),t[M-1]=0,t[M]=0,l=i[M][M-1],D=Math.abs(l)+Math.abs(O),q=l/D,T=O/D,V=Math.sqrt(q*q+T*T),q/=V,T/=V,a=M-1;r>a;a++)O=i[M-1][a],i[M-1][a]=T*O+q*i[M][a],i[M][a]=T*i[M][a]-q*O;for(o=0;M>=o;o++)O=i[o][M-1],i[o][M-1]=T*O+q*i[o][M],i[o][M]=T*i[o][M]-q*O;for(o=b;k>=o;o++)O=e[o][M-1],e[o][M-1]=T*O+q*e[o][M],e[o][M]=T*e[o][M]-q*O}else n[M-1]=l+q,n[M]=l+q,t[M-1]=O,t[M]=-O;M-=2,R=0}else{if(l=i[M][M],p=0,m=0,M>f&&(p=i[M-1][M-1],m=i[M][M-1]*i[M-1][M]),10===R){for(S+=l,o=b;M>=o;o++)i[o][o]-=l;D=Math.abs(i[M][M-1])+Math.abs(i[M-1][M-2]),l=p=.75*D,m=-.4375*D*D}if(30===R&&(D=(p-l)/2,D=D*D+m,D>0)){for(D=Math.sqrt(D),l>p&&(D=-D),D=l-m/((p-l)/2+D),o=b;M>=o;o++)i[o][o]-=D;S+=D,l=p=m=.964}for(R+=1,c=M-2;c>=f&&(O=i[c][c],V=l-O,D=p-O,q=(V*D-m)/i[c+1][c]+i[c][c+1],T=i[c+1][c+1]-O-V-D,V=i[c+2][c+1],D=Math.abs(q)+Math.abs(T)+Math.abs(V),q/=D,T/=D,V/=D,c!==f)&&!(Math.abs(i[c][c-1])*(Math.abs(T)+Math.abs(V))<A*Math.abs(q)*(Math.abs(i[c-1][c-1])+Math.abs(O)+Math.abs(i[c+1][c+1])));)c--;for(o=c+2;M>=o;o++)i[o][o-2]=0,o>c+2&&(i[o][o-3]=0);for(u=c;M-1>=u&&(w=u!==M-1,u!==c&&(q=i[u][u-1],T=i[u+1][u-1],V=w?i[u+2][u-1]:0,l=Math.abs(q)+Math.abs(T)+Math.abs(V),0!==l&&(q/=l,T/=l,V/=l)),0!==l);u++)if(D=Math.sqrt(q*q+T*T+V*V),0>q&&(D=-D),0!==D){for(u!==c?i[u][u-1]=-D*l:f!==c&&(i[u][u-1]=-i[u][u-1]),q+=D,l=q/D,p=T/D,O=V/D,T/=q,V/=q,a=u;r>a;a++)q=i[u][a]+T*i[u+1][a],w&&(q+=V*i[u+2][a],i[u+2][a]=i[u+2][a]-q*O),i[u][a]=i[u][a]-q*l,i[u+1][a]=i[u+1][a]-q*p;for(o=0;o<=Math.min(M,u+3);o++)q=l*i[o][u]+p*i[o][u+1],w&&(q+=O*i[o][u+2],i[o][u+2]=i[o][u+2]-q*V),i[o][u]=i[o][u]-q,i[o][u+1]=i[o][u+1]-q*T;for(o=b;k>=o;o++)q=l*e[o][u]+p*e[o][u+1],w&&(q+=O*e[o][u+2],e[o][u+2]=e[o][u+2]-q*V),e[o][u]=e[o][u]-q,e[o][u+1]=e[o][u+1]-q*T}}}if(0!==j){for(M=r-1;M>=0;M--)if(q=n[M],T=t[M],0===T)for(f=M,i[M][M]=1,o=M-1;o>=0;o--){for(m=i[o][o]-q,V=0,a=f;M>=a;a++)V+=i[o][a]*i[a][M];if(t[o]<0)O=m,D=V;else if(f=o,0===t[o]?i[o][M]=0!==m?-V/m:-V/(A*j):(l=i[o][o+1],p=i[o+1][o],T=(n[o]-q)*(n[o]-q)+t[o]*t[o],h=(l*D-O*V)/T,i[o][M]=h,i[o+1][M]=Math.abs(l)>Math.abs(O)?(-V-m*h)/l:(-D-p*h)/O),h=Math.abs(i[o][M]),A*h*h>1)for(a=o;M>=a;a++)i[a][M]=i[a][M]/h}else if(0>T)for(f=M-1,Math.abs(i[M][M-1])>Math.abs(i[M-1][M])?(i[M-1][M-1]=T/i[M][M-1],i[M-1][M]=-(i[M][M]-q)/i[M][M-1]):(x=s(0,-i[M-1][M],i[M-1][M-1]-q,T),i[M-1][M-1]=x[0],i[M-1][M]=x[1]),i[M][M-1]=0,i[M][M]=1,o=M-2;o>=0;o--){for(d=0,g=0,a=f;M>=a;a++)d+=i[o][a]*i[a][M-1],g+=i[o][a]*i[a][M];if(m=i[o][o]-q,t[o]<0)O=m,V=d,D=g;else if(f=o,0===t[o]?(x=s(-d,-g,m,T),i[o][M-1]=x[0],i[o][M]=x[1]):(l=i[o][o+1],p=i[o+1][o],v=(n[o]-q)*(n[o]-q)+t[o]*t[o]-T*T,y=2*(n[o]-q)*T,0===v&&0===y&&(v=A*j*(Math.abs(m)+Math.abs(T)+Math.abs(l)+Math.abs(p)+Math.abs(O))),x=s(l*V-O*d+T*g,l*D-O*g-T*d,v,y),i[o][M-1]=x[0],i[o][M]=x[1],Math.abs(l)>Math.abs(O)+Math.abs(T)?(i[o+1][M-1]=(-d-m*i[o][M-1]+T*i[o][M])/l,i[o+1][M]=(-g-m*i[o][M]-T*i[o][M-1])/l):(x=s(-V-p*i[o][M-1],-D-p*i[o][M],O,T),i[o+1][M-1]=x[0],i[o+1][M]=x[1])),h=Math.max(Math.abs(i[o][M-1]),Math.abs(i[o][M])),A*h*h>1)for(a=o;M>=a;a++)i[a][M-1]=i[a][M-1]/h,i[a][M]=i[a][M]/h}for(o=0;r>o;o++)if(b>o||o>k)for(a=o;r>a;a++)e[o][a]=i[o][a];for(a=r-1;a>=b;a--)for(o=b;k>=o;o++){for(O=0,u=b;u<=Math.min(a,k);u++)O+=e[o][u]*i[u][a];e[o][a]=O}}}function s(r,t,n,e){var i,o;return Math.abs(n)>Math.abs(e)?(i=e/n,o=n+i*e,[(r+i*t)/o,(t-i*r)/o]):(i=n/e,o=e+i*n,[(i*r+t)/o,(i*t-r)/o])}var u=r("../matrix"),f=r("./util").hypotenuse;n.prototype={get realEigenvalues(){return this.d},get imaginaryEigenvalues(){return this.e},get eigenvectorMatrix(){return this.V},get diagonalMatrix(){var r,t,n=this.n,e=this.e,i=this.d,o=new u(n,n);for(r=0;n>r;r++){for(t=0;n>t;t++)o[r][t]=0;o[r][r]=i[r],e[r]>0?o[r][r+1]=e[r]:e[r]<0&&(o[r][r-1]=e[r])}return o}},t.exports=n},{"../matrix":71,"./util":68}],65:[function(r,t){"use strict";function n(r){if(!(this instanceof n))return new n(r);r=e.checkMatrix(r);var t,i,o,a,s,u,f,c,h,m,l=r.clone(),p=l.rows,d=l.columns,g=new Array(p),v=1;for(t=0;p>t;t++)g[t]=t;for(h=new Array(p),i=0;d>i;i++){for(t=0;p>t;t++)h[t]=l[t][i];for(t=0;p>t;t++){for(c=l[t],m=Math.min(t,i),s=0,o=0;m>o;o++)s+=c[o]*h[o];c[i]=h[t]-=s}for(a=i,t=i+1;p>t;t++)Math.abs(h[t])>Math.abs(h[a])&&(a=t);if(a!==i){for(o=0;d>o;o++)u=l[a][o],l[a][o]=l[i][o],l[i][o]=u;f=g[a],g[a]=g[i],g[i]=f,v=-v}if(p>i&&0!==l[i][i])for(t=i+1;p>t;t++)l[t][i]/=l[i][i]}this.LU=l,this.pivotVector=g,this.pivotSign=v}var e=r("../matrix");n.prototype={isSingular:function(){for(var r=this.LU,t=r.columns,n=0;t>n;n++)if(0===r[n][n])return!0;return!1},get determinant(){var r=this.LU;if(!r.isSquare())throw new Error("Matrix must be square");for(var t=this.pivotSign,n=r.columns,e=0;n>e;e++)t*=r[e][e];
return t},get lowerTriangularFactor(){for(var r=this.LU,t=r.rows,n=r.columns,i=new e(t,n),o=0;t>o;o++)for(var a=0;n>a;a++)i[o][a]=o>a?r[o][a]:o===a?1:0;return i},get upperTriangularFactor(){for(var r=this.LU,t=r.rows,n=r.columns,i=new e(t,n),o=0;t>o;o++)for(var a=0;n>a;a++)i[o][a]=a>=o?r[o][a]:0;return i},get pivotPermutationVector(){return this.pivotVector.slice()},solve:function(r){r=e.checkMatrix(r);var t=this.LU,n=t.rows;if(n!==r.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");var i,o,a,s=r.columns,u=r.subMatrixRow(this.pivotVector,0,s-1),f=t.columns;for(a=0;f>a;a++)for(i=a+1;f>i;i++)for(o=0;s>o;o++)u[i][o]-=u[a][o]*t[i][a];for(a=f-1;a>=0;a--){for(o=0;s>o;o++)u[a][o]/=t[a][a];for(i=0;a>i;i++)for(o=0;s>o;o++)u[i][o]-=u[a][o]*t[i][a]}return u}},t.exports=n},{"../matrix":71}],66:[function(r,t){"use strict";function n(r){if(!(this instanceof n))return new n(r);r=e.checkMatrix(r);var t,o,a,s,u=r.clone(),f=r.rows,c=r.columns,h=new Array(c);for(a=0;c>a;a++){var m=0;for(t=a;f>t;t++)m=i(m,u[t][a]);if(0!==m){for(u[a][a]<0&&(m=-m),t=a;f>t;t++)u[t][a]/=m;for(u[a][a]+=1,o=a+1;c>o;o++){for(s=0,t=a;f>t;t++)s+=u[t][a]*u[t][o];for(s=-s/u[a][a],t=a;f>t;t++)u[t][o]+=s*u[t][a]}}h[a]=-m}this.QR=u,this.Rdiag=h}var e=r("../matrix"),i=r("./util").hypotenuse;n.prototype={solve:function(r){r=e.checkMatrix(r);var t=this.QR,n=t.rows;if(r.rows!==n)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");var i,o,a,s,u=r.columns,f=r.clone(),c=t.columns;for(a=0;c>a;a++)for(o=0;u>o;o++){for(s=0,i=a;n>i;i++)s+=t[i][a]*f[i][o];for(s=-s/t[a][a],i=a;n>i;i++)f[i][o]+=s*t[i][a]}for(a=c-1;a>=0;a--){for(o=0;u>o;o++)f[a][o]/=this.Rdiag[a];for(i=0;a>i;i++)for(o=0;u>o;o++)f[i][o]-=f[a][o]*t[i][a]}return f.subMatrix(0,c-1,0,u-1)},isFullRank:function(){for(var r=this.QR.columns,t=0;r>t;t++)if(0===this.Rdiag[t])return!1;return!0},get upperTriangularFactor(){var r,t,n=this.QR,i=n.columns,o=new e(i,i);for(r=0;i>r;r++)for(t=0;i>t;t++)o[r][t]=t>r?n[r][t]:r===t?this.Rdiag[r]:0;return o},get orthogonalFactor(){var r,t,n,i,o=this.QR,a=o.rows,s=o.columns,u=new e(a,s);for(n=s-1;n>=0;n--){for(r=0;a>r;r++)u[r][n]=0;for(u[n][n]=1,t=n;s>t;t++)if(0!==o[n][n]){for(i=0,r=n;a>r;r++)i+=o[r][n]*u[r][t];for(i=-i/o[n][n],r=n;a>r;r++)u[r][t]+=i*o[r][n]}}return u}},t.exports=n},{"../matrix":71,"./util":68}],67:[function(r,t){"use strict";function n(r,t){if(!(this instanceof n))return new n(r,t);r=e.checkMatrix(r),t=t||{};var o=r.clone(),a=r.rows,s=r.columns,u=Math.min(a,s),f=!0,c=!0;t.computeLeftSingularVectors===!1&&(f=!1),t.computeRightSingularVectors===!1&&(c=!1);var h=t.autoTranspose===!0,m=!1;if(s>a)if(h){o=o.transpose(),a=o.rows,s=o.columns,m=!0;var l=f;f=c,c=l}else console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");var p,d,g,v,y,w,x,M,b,k,A,S,j,q,T,V,D,O,R,_,z,C=new Array(Math.min(a+1,s)),P=e.zeros(a,u),E=e.zeros(s,s),N=new Array(s),L=new Array(a),I=Math.min(a-1,s),U=Math.max(0,Math.min(s-2,a));for(g=0,k=Math.max(I,U);k>g;g++){if(I>g){for(C[g]=0,p=g;a>p;p++)C[g]=i(C[g],o[p][g]);if(0!==C[g]){for(o[g][g]<0&&(C[g]=-C[g]),p=g;a>p;p++)o[p][g]/=C[g];o[g][g]+=1}C[g]=-C[g]}for(d=g+1;s>d;d++){if(I>g&&0!==C[g]){for(y=0,p=g;a>p;p++)y+=o[p][g]*o[p][d];for(y=-y/o[g][g],p=g;a>p;p++)o[p][d]+=y*o[p][g]}N[d]=o[g][d]}if(f&&I>g)for(p=g;a>p;p++)P[p][g]=o[p][g];if(U>g){for(N[g]=0,p=g+1;s>p;p++)N[g]=i(N[g],N[p]);if(0!==N[g]){for(N[g+1]<0&&(N[g]=-N[g]),p=g+1;s>p;p++)N[p]/=N[g];N[g+1]+=1}if(N[g]=-N[g],a>g+1&&0!==N[g]){for(p=g+1;a>p;p++)L[p]=0;for(d=g+1;s>d;d++)for(p=g+1;a>p;p++)L[p]+=N[d]*o[p][d];for(d=g+1;s>d;d++)for(y=-N[d]/N[g+1],p=g+1;a>p;p++)o[p][d]+=y*L[p]}if(c)for(p=g+1;s>p;p++)E[p][g]=N[p]}}if(v=Math.min(s,a+1),s>I&&(C[I]=o[I][I]),v>a&&(C[v-1]=0),v>U+1&&(N[U]=o[U][v-1]),N[v-1]=0,f){for(d=I;u>d;d++){for(p=0;a>p;p++)P[p][d]=0;P[d][d]=1}for(g=I-1;g>=0;g--)if(0!==C[g]){for(d=g+1;u>d;d++){for(y=0,p=g;a>p;p++)y+=P[p][g]*P[p][d];for(y=-y/P[g][g],p=g;a>p;p++)P[p][d]+=y*P[p][g]}for(p=g;a>p;p++)P[p][g]=-P[p][g];for(P[g][g]=1+P[g][g],p=0;g-1>p;p++)P[p][g]=0}else{for(p=0;a>p;p++)P[p][g]=0;P[g][g]=1}}if(c)for(g=s-1;g>=0;g--){if(U>g&&0!==N[g])for(d=g+1;s>d;d++){for(y=0,p=g+1;s>p;p++)y+=E[p][g]*E[p][d];for(y=-y/E[g+1][g],p=g+1;s>p;p++)E[p][d]+=y*E[p][g]}for(p=0;s>p;p++)E[p][g]=0;E[g][g]=1}for(var F=v-1,B=0,X=Math.pow(2,-52);v>0;){for(g=v-2;g>=-1&&-1!==g;g--)if(Math.abs(N[g])<=X*(Math.abs(C[g])+Math.abs(C[g+1]))){N[g]=0;break}if(g===v-2)A=4;else{for(w=v-1;w>=g&&w!==g;w--)if(y=(w!==v?Math.abs(N[w]):0)+(w!==g+1?Math.abs(N[w-1]):0),Math.abs(C[w])<=X*y){C[w]=0;break}w===g?A=3:w===v-1?A=1:(A=2,g=w)}switch(g++,A){case 1:for(x=N[v-2],N[v-2]=0,d=v-2;d>=g;d--)if(y=i(C[d],x),M=C[d]/y,b=x/y,C[d]=y,d!==g&&(x=-b*N[d-1],N[d-1]=M*N[d-1]),c)for(p=0;s>p;p++)y=M*E[p][d]+b*E[p][v-1],E[p][v-1]=-b*E[p][d]+M*E[p][v-1],E[p][d]=y;break;case 2:for(x=N[g-1],N[g-1]=0,d=g;v>d;d++)if(y=i(C[d],x),M=C[d]/y,b=x/y,C[d]=y,x=-b*N[d],N[d]=M*N[d],f)for(p=0;a>p;p++)y=M*P[p][d]+b*P[p][g-1],P[p][g-1]=-b*P[p][d]+M*P[p][g-1],P[p][d]=y;break;case 3:for(S=Math.max(Math.max(Math.max(Math.max(Math.abs(C[v-1]),Math.abs(C[v-2])),Math.abs(N[v-2])),Math.abs(C[g])),Math.abs(N[g])),j=C[v-1]/S,q=C[v-2]/S,T=N[v-2]/S,V=C[g]/S,D=N[g]/S,O=((q+j)*(q-j)+T*T)/2,R=j*T*j*T,_=0,(0!==O||0!==R)&&(_=Math.sqrt(O*O+R),0>O&&(_=-_),_=R/(O+_)),x=(V+j)*(V-j)+_,z=V*D,d=g;v-1>d;d++){if(y=i(x,z),M=x/y,b=z/y,d!==g&&(N[d-1]=y),x=M*C[d]+b*N[d],N[d]=M*N[d]-b*C[d],z=b*C[d+1],C[d+1]=M*C[d+1],c)for(p=0;s>p;p++)y=M*E[p][d]+b*E[p][d+1],E[p][d+1]=-b*E[p][d]+M*E[p][d+1],E[p][d]=y;if(y=i(x,z),M=x/y,b=z/y,C[d]=y,x=M*N[d]+b*C[d+1],C[d+1]=-b*N[d]+M*C[d+1],z=b*N[d+1],N[d+1]=M*N[d+1],f&&a-1>d)for(p=0;a>p;p++)y=M*P[p][d]+b*P[p][d+1],P[p][d+1]=-b*P[p][d]+M*P[p][d+1],P[p][d]=y}N[v-2]=x,B+=1;break;case 4:if(C[g]<=0&&(C[g]=C[g]<0?-C[g]:0,c))for(p=0;F>=p;p++)E[p][g]=-E[p][g];for(;F>g&&!(C[g]>=C[g+1]);){if(y=C[g],C[g]=C[g+1],C[g+1]=y,c&&s-1>g)for(p=0;s>p;p++)y=E[p][g+1],E[p][g+1]=E[p][g],E[p][g]=y;if(f&&a-1>g)for(p=0;a>p;p++)y=P[p][g+1],P[p][g+1]=P[p][g],P[p][g]=y;g++}B=0,v--}}if(m){var Q=E;E=P,P=Q}this.m=a,this.n=s,this.s=C,this.U=P,this.V=E}var e=r("../matrix"),i=r("./util").hypotenuse;n.prototype={get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]},get norm2(){return this.s[0]},get rank(){for(var r=Math.pow(2,-52),t=Math.max(this.m,this.n)*this.s[0]*r,n=0,e=this.s,i=0,o=e.length;o>i;i++)e[i]>t&&n++;return n},get diagonal(){return this.s},get threshold(){return Math.pow(2,-52)/2*Math.max(this.m,this.n)*this.s[0]},get leftSingularVectors(){return this.U},get rightSingularVectors(){return this.V},get diagonalMatrix(){return e.diag(this.s)},solve:function(r){var t,n=r,i=this.threshold,o=this.s.length,a=e.zeros(o,o);for(t=0;o>t;t++)a[t][t]=Math.abs(this.s[t])<=i?0:1/this.s[t];var s,u,f,c=this.V.mmul(a),h=this.V.rows,m=this.U.rows,l=e.zeros(h,m);for(t=0;h>t;t++)for(s=0;m>s;s++){for(f=0,u=0;o>u;u++)f+=c[t][u]*this.U[s][u];l[t][s]=f}return l.mmul(n)},solveForDiagonal:function(r){return this.solve(e.diag(r))},inverse:function(){var r,t,n=this.threshold,i=this.V.rows,o=this.V.columns,a=new e(i,this.s.length);for(r=0;i>r;r++)for(t=0;o>t;t++)a[r][t]=Math.abs(this.s[t])>n?this.V[r][t]/this.s[t]:0;var s,u,f=this.U.rows,c=this.U.columns,h=new e(i,f);for(r=0;i>r;r++)for(t=0;f>t;t++){for(u=0,s=0;c>s;s++)u+=a[r][s]*this.U[t][s];h[r][t]=u}return h}},t.exports=n},{"../matrix":71,"./util":68}],68:[function(r,t,n){"use strict";n.hypotenuse=function(r,t){var n;return Math.abs(r)>Math.abs(t)?(n=t/r,Math.abs(r)*Math.sqrt(1+n*n)):0!==t?(n=r/t,Math.abs(t)*Math.sqrt(1+n*n)):0}},{}],69:[function(r,t){"use strict";function n(r){return e(r,i.eye(r.rows))}function e(r,t){return r.isSquare()?new s(r).solve(t):new u(r).solve(t)}var i=r("./matrix"),o=r("./dc/svd"),a=r("./dc/evd"),s=r("./dc/lu"),u=r("./dc/qr"),f=r("./dc/cholesky");i.prototype.inverse=function(){return n(this)},i.prototype.solve=function(r){return e(this,r)},t.exports={SingularValueDecomposition:o,SVD:o,EigenvalueDecomposition:a,EVD:a,LuDecomposition:s,LU:s,QrDecomposition:u,QR:u,CholeskyDecomposition:f,CHO:f,inverse:n,solve:e}},{"./dc/cholesky":63,"./dc/evd":64,"./dc/lu":65,"./dc/qr":66,"./dc/svd":67,"./matrix":71}],70:[function(r,t){"use strict";t.exports=r("./matrix"),t.exports.Decompositions=t.exports.DC=r("./decompositions")},{"./decompositions":69,"./matrix":71}],71:[function(r,t){"use strict";function n(r){for(var t=0,n=r.length,e=new Array(n);n>t;t++)e[t]=r[t];return e}function e(r){this.message=r||"Unknown matrix error"}function i(r,t){var o,a,s=0;if(Array.isArray(r)){if(a=t,o=a?n(r):r,r=o.length,t=o[0].length,"undefined"==typeof t)throw new e("Data must be a 2D array");if(!(r>0&&t>0))throw new e("Invalid dimensions: "+r+"x"+t);for(;r>s;s++){if(o[s].length!==t)throw new e("Inconsistent array dimensions");a&&(o[s]=n(o[s]))}}else{if("number"!=typeof r)throw new e("Invalid arguments");if(!(r>0&&t>0))throw new e("Invalid dimensions: "+r+"x"+t);for(o=new Array(r);r>s;s++)o[s]=new Array(t)}return Object.defineProperty(o,"rows",{writable:!0,value:r}),Object.defineProperty(o,"columns",{writable:!0,value:t}),o.__proto__=i.prototype,o}var o=Array.prototype.splice,a=Array.prototype.concat;e.prototype=Object.create(Error.prototype),e.prototype.name="MatrixError",e.prototype.constructor=e,i.from1DArray=function(r,t,n){var o,a,s=0;if(o=r*t,o!==n.length)throw new e("Data length does not match given dimensions");for(a=new Array(r);r>s;s++)a[s]=n.slice(s*t,(s+1)*t);return new i(a)},i.rowVector=function(r){return new i([r])},i.columnVector=function(r){for(var t=r.length,n=new Array(t),e=0;t>e;e++)n[e]=[r[e]];return new i(n)},i.empty=function(r,t){return new i(r,t)},i.zeros=function(r,t){return i.empty(r,t).fill(0)},i.ones=function(r,t){return i.empty(r,t).fill(1)},i.rand=function(r,t){for(var n=i.empty(r,t),e=0,o=n.rows;o>e;e++)for(var a=0,s=n.columns;s>a;a++)n[e][a]=Math.random();return n},i.eye=function(r){for(var t=i.zeros(r,r),n=t.rows,e=0;n>e;e++)t[e][e]=1;return t},i.diag=function(r){for(var t=r.length,n=i.zeros(t,t),e=0;t>e;e++)n[e][e]=r[e];return n},i.indices=function(r,t){for(var n=new Array(t-r),e=0;e<n.length;e++)n[e]=r++;return n},i.stack=function(r){var t,n,e;if(i.isMatrix(r)){var o=0,a=0;for(t=0;t<arguments.length;t++)o+=arguments[t].rows,arguments[t].columns>a&&(a=arguments[t].columns);var s=i.zeros(o,a),u=0;for(t=0;t<arguments.length;t++){var f=arguments[t];for(n=0;n<f.rows;n++){for(e=0;e<f.columns;e++)s[u][e]=f[n][e];u++}}return s}if(Array.isArray(r)){var c=i.empty(arguments.length,r.length);for(t=0;t<arguments.length;t++)c.setRow(t,arguments[t]);return c}},i.expand=function(r,t){for(var n=[],e=0;e<t.length;e++)for(var o=0;o<t[e];o++)n.push(r[e]);return new i(n)},i.checkMatrix=function(r){if(!r)throw new e("Argument has to be a matrix");return"Matrix"!==r.klass&&(r=new i(r)),r},i.isMatrix=function(r){return r?"Matrix"===r.klass:!1},Object.defineProperty(i.prototype,"klass",{get:function(){return"Matrix"}}),Object.defineProperty(i.prototype,"size",{get:function(){return this.rows*this.columns}}),i.prototype.checkRowIndex=function(r){if(0>r||r>this.rows-1)throw new e("Row index out of range.")},i.prototype.checkColumnIndex=function(r){if(0>r||r>this.columns-1)throw new e("Column index out of range.")},i.prototype.checkDimensions=function(r){if(this.rows!==r.rows||this.columns!==r.columns)throw new e("Matrices dimensions must be equal.")},i.prototype.apply=function(r){for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)r.call(this,e,i);return this},i.prototype.clone=function(){return new i(this.to2DArray())},i.prototype.to1DArray=function(){return a.apply([],this)},i.prototype.to2DArray=function(){for(var r=this.rows,t=new Array(r),e=0;r>e;e++)t[e]=n(this[e]);return t},i.prototype.isRowVector=function(){return 1===this.rows},i.prototype.isColumnVector=function(){return 1===this.columns},i.prototype.isVector=function(){return 1===this.rows||1===this.columns},i.prototype.isSquare=function(){return this.rows===this.columns},i.prototype.isSymmetric=function(){if(this.isSquare()){for(var r=this.rows,t=0;r>t;t++)for(var n=0;t>=n;n++)if(this[t][n]!==this[n][t])return!1;return!0}return!1},i.prototype.set=function(r,t,n){return this[r][t]=n,this},i.prototype.get=function(r,t){return this[r][t]},i.prototype.fill=function(r){for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]=r;return this},i.prototype.neg=function(){return this.mulS(-1)},i.prototype.add=function(r){return"number"==typeof r?this.addS(r):(r=i.checkMatrix(r),this.addM(r))},i.prototype.addS=function(r){for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]+=r;return this},i.prototype.addM=function(r){this.checkDimensions(r);for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]+=r[e][i];return this},i.prototype.sub=function(r){return"number"==typeof r?this.subS(r):(r=i.checkMatrix(r),this.subM(r))},i.prototype.subS=function(r){for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]-=r;return this},i.prototype.subM=function(r){this.checkDimensions(r);for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]-=r[e][i];return this},i.prototype.mul=function(r){return"number"==typeof r?this.mulS(r):(r=i.checkMatrix(r),this.mulM(r))},i.prototype.mulS=function(r){for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]*=r;return this},i.prototype.mulM=function(r){this.checkDimensions(r);for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]*=r[e][i];return this},i.prototype.div=function(r){return"number"==typeof r?this.divS(r):(r=i.checkMatrix(r),this.divM(r))},i.prototype.divS=function(r){for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]/=r;return this},i.prototype.divM=function(r){this.checkDimensions(r);for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]/=r[e][i];return this},i.prototype.getRow=function(r){return this.checkRowIndex(r),n(this[r])},i.prototype.setRow=function(r,t){if(this.checkRowIndex(r),i.isMatrix(t)&&(t=t.to1DArray()),t.length!==this.columns)throw new e("Invalid row size");return this[r]=n(t),this},i.prototype.removeRow=function(r){if(this.checkRowIndex(r),1===this.rows)throw new e("A matrix cannot have less than one row");return o.call(this,r,1),this.rows-=1,this},i.prototype.addRow=function(r,t){if("undefined"==typeof t&&(t=r,r=this.rows),0>r||r>this.rows)throw new e("Row index out of range.");if(i.isMatrix(t)&&(t=t.to1DArray()),t.length!==this.columns)throw new e("Invalid row size");return o.call(this,r,0,n(t)),this.rows+=1,this},i.prototype.swapRows=function(r,t){this.checkRowIndex(r),this.checkRowIndex(t);var n=this[r];return this[r]=this[t],this[t]=n,this},i.prototype.getColumn=function(r){this.checkColumnIndex(r);for(var t=this.rows,n=new Array(t),e=0;t>e;e++)n[e]=this[e][r];return n},i.prototype.setColumn=function(r,t){this.checkColumnIndex(r),i.isMatrix(t)&&(t=t.to1DArray());var n=this.rows;if(t.length!==n)throw new e("Invalid column size");for(var o=0;n>o;o++)this[o][r]=t[o];return this},i.prototype.removeColumn=function(r){if(this.checkColumnIndex(r),1===this.columns)throw new e("A matrix cannot have less than one column");for(var t=0,n=this.rows;n>t;t++)this[t].splice(r,1);return this.columns-=1,this},i.prototype.addColumn=function(r,t){if("undefined"==typeof t&&(t=r,r=this.columns),0>r||r>this.columns)throw new e("Column index out of range.");i.isMatrix(t)&&(t=t.to1DArray());var n=this.rows;if(t.length!==n)throw new e("Invalid column size");for(var o=0;n>o;o++)this[o].splice(r,0,t[o]);return this.columns+=1,this},i.prototype.swapColumns=function(r,t){this.checkRowIndex(r),this.checkRowIndex(t);for(var n,e,i=this.rows,o=0;i>o;o++)e=this[o],n=e[r],e[r]=e[t],e[t]=n;return this},i.prototype.checkRowVector=function(r){if(i.isMatrix(r)&&(r=r.to1DArray()),r.length!==this.columns)throw new e("vector size must be the same as the number of columns");return r},i.prototype.checkColumnVector=function(r){if(i.isMatrix(r)&&(r=r.to1DArray()),r.length!==this.rows)throw new e("vector size must be the same as the number of rows");return r},i.prototype.addRowVector=function(r){r=this.checkRowVector(r);for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]+=r[i];return this},i.prototype.subRowVector=function(r){r=this.checkRowVector(r);for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]-=r[i];return this},i.prototype.mulRowVector=function(r){r=this.checkRowVector(r);for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]*=r[i];return this},i.prototype.divRowVector=function(r){r=this.checkRowVector(r);for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]/=r[i];return this},i.prototype.addColumnVector=function(r){r=this.checkColumnVector(r);for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]+=r[e];return this},i.prototype.subColumnVector=function(r){r=this.checkColumnVector(r);for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]-=r[e];return this},i.prototype.mulColumnVector=function(r){r=this.checkColumnVector(r);for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]*=r[e];return this},i.prototype.divColumnVector=function(r){r=this.checkColumnVector(r);for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]/=r[e];return this},i.prototype.mulRow=function(r,t){this.checkRowIndex(r);for(var n=0,e=this.columns;e>n;n++)this[r][n]*=t;return this},i.prototype.mulColumn=function(r,t){this.checkColumnIndex(r);for(var n=0,e=this.rows;e>n;n++)this[n][r]*=t},i.prototype.max=function(){for(var r=-1/0,t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]>r&&(r=this[e][i]);return r},i.prototype.maxIndex=function(){for(var r=-1/0,t={},n=this.rows,e=this.columns,i=0;n>i;i++)for(var o=0;e>o;o++)this[i][o]>r&&(r=this[i][o],t.row=i,t.column=o);return t},i.prototype.min=function(){for(var r=1/0,t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]<r&&(r=this[e][i]);return r},i.prototype.minIndex=function(){for(var r=1/0,t={},n=this.rows,e=this.columns,i=0;n>i;i++)for(var o=0;e>o;o++)this[i][o]<r&&(r=this[i][o],t.row=i,t.column=o);return t},i.prototype.maxRow=function(r){this.checkRowIndex(r);for(var t=-1/0,n=0,e=this.columns;e>n;n++)this[r][n]>t&&(t=this[r][n]);return t},i.prototype.maxRowIndex=function(r){this.checkRowIndex(r);for(var t=-1/0,n={row:r},e=0,i=this.columns;i>e;e++)this[r][e]>t&&(t=this[r][e],n.column=e);return n},i.prototype.minRow=function(r){this.checkRowIndex(r);for(var t=1/0,n=0,e=this.columns;e>n;n++)this[r][n]<t&&(t=this[r][n]);return t},i.prototype.minRowIndex=function(r){this.checkRowIndex(r);for(var t=1/0,n={row:r,column:0},e=0,i=this.columns;i>e;e++)this[r][e]<t&&(t=this[r][e],n.column=e);return n},i.prototype.maxColumn=function(r){this.checkColumnIndex(r);for(var t=-1/0,n=0,e=this.rows;e>n;n++)this[n][r]>t&&(t=this[n][r]);return t},i.prototype.maxColumnIndex=function(r){this.checkColumnIndex(r);for(var t=-1/0,n={row:0,column:r},e=0,i=this.rows;i>e;e++)this[e][r]>t&&(t=this[e][r],n.row=e);return n},i.prototype.minColumn=function(r){this.checkColumnIndex(r);for(var t=1/0,n=0,e=this.rows;e>n;n++)this[n][r]<t&&(t=this[n][r]);return t},i.prototype.minColumnIndex=function(r){this.checkColumnIndex(r);for(var t=1/0,n={row:0,column:r},e=0,i=this.rows;i>e;e++)this[e][r]<t&&(t=this[e][r],n.row=e);return n},i.prototype.diag=function s(){if(!this.isSquare())throw new e("Only square matrices have a diagonal.");for(var s=new Array(this.rows),r=0,t=this.rows;t>r;r++)s[r]=this[r][r];return s},i.prototype.sum=function(){for(var r=0,t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)r+=this[e][i];return r},i.prototype.mean=function(){return this.sum()/this.size},i.prototype.prod=function u(){for(var u=1,r=this.rows,t=this.columns,n=0;r>n;n++)for(var e=0;t>e;e++)u*=this[n][e];return u},i.prototype.cumulativeSum=function(){for(var r=0,t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)r+=this[e][i],this[e][i]=r;return this},i.prototype.dot=function f(r){if(this.size!==r.size)throw new e("vectors do not have the same size");for(var t=this.to1DArray(),n=r.to1DArray(),f=0,i=t.length,o=0;i>o;o++)f+=t[o]*n[o];return f},i.prototype.mmul=function(r){if(!i.isMatrix(r))throw new e('parameter "other" must be a matrix');this.columns!==r.rows&&console.warn("Number of columns of left matrix are not equal to number of rows of right matrix.");var t,n,o,a=this.rows,s=this.columns,u=r.columns,f=new i(a,u),c=new Array(s);for(n=0;u>n;n++){for(o=0;s>o;o++)c[o]=r[o][n];for(t=0;a>t;t++){var h=this[t],m=0;for(o=0;s>o;o++)m+=h[o]*c[o];f[t][n]=m}}return f},i.prototype.sortRows=function(r){for(var t=0,n=this.rows;n>t;t++)this[t].sort(r);return this},i.prototype.sortColumns=function(r){for(var t=0,n=this.columns;n>t;t++)this.setColumn(t,this.getColumn(t).sort(r));return this},i.prototype.transpose=function(){for(var r=new i(this.columns,this.rows),t=this.rows,n=this.columns,e=0;t>e;e++)for(var o=0;n>o;o++)r[o][e]=this[e][o];return r},i.prototype.subMatrix=function(r,t,n,o){if(r>t||n>o||0>r||r>=this.rows||0>t||t>=this.rows||0>n||n>=this.columns||0>o||o>=this.columns)throw new e("Argument out of range");for(var a=new i(t-r+1,o-n+1),s=r;t>=s;s++)for(var u=n;o>=u;u++)a[s-r][u-n]=this[s][u];return a},i.prototype.subMatrixRow=function(r,t,n){if("undefined"==typeof t?(t=0,n=this.columns-1):"undefined"==typeof n&&(n=this.columns-1),t>n||0>t||t>=this.columns||0>n||n>=this.columns)throw new e("Argument out of range.");for(var o=r.length,a=this.rows,s=new i(o,n-t+1),u=0;o>u;u++)for(var f=t;n>=f;f++){if(r[u]<0||r[u]>=a)throw new e("Argument out of range.");s[u][f-t]=this[r[u]][f]}return s},i.prototype.subMatrixColumn=function(r,t,n){if("undefined"==typeof t?(t=0,n=this.rows-1):"undefined"==typeof n&&(n=this.rows-1),t>n||0>t||t>=this.rows||0>n||n>=this.rows)throw new e("Argument out of range.");for(var o=r.length,a=this.columns,s=new i(n-t+1,o),u=0;o>u;u++)for(var f=t;n>=f;f++){if(r[u]<0||r[u]>=a)throw new e("Argument out of range.");s[f-t][u]=this[f][r[u]]}return s},i.prototype.trace=function c(){if(!this.isSquare())throw new e("The matrix is not square");for(var c=0,r=0,t=this.rows;t>r;r++)c+=this[r][r];return c},i.prototype.abs=function(){for(var r=this.rows,t=this.columns,n=0;r>n;n++)for(var e=0;t>e;e++)this[n][e]=Math.abs(this[n][e])},i.MatrixError=e,t.exports=i},{}],72:[function(require,module,exports){(function(global){"use strict";var numeric="undefined"==typeof exports?function(){}:exports;"undefined"!=typeof global&&(global.numeric=numeric),numeric.version="1.2.6",numeric.bench=function(r,t){var n,e,i,o;for("undefined"==typeof t&&(t=15),i=.5,n=new Date;;){for(i*=2,o=i;o>3;o-=4)r(),r(),r(),r();for(;o>0;)r(),o--;if(e=new Date,e-n>t)break}for(o=i;o>3;o-=4)r(),r(),r(),r();for(;o>0;)r(),o--;return e=new Date,1e3*(3*i-1)/(e-n)},numeric._myIndexOf=function(r){var t,n=this.length;for(t=0;n>t;++t)if(this[t]===r)return t;return-1},numeric.myIndexOf=Array.prototype.indexOf?Array.prototype.indexOf:numeric._myIndexOf,numeric.Function=Function,numeric.precision=4,numeric.largeArray=50,numeric.prettyPrint=function(r){function t(r){if(0===r)return"0";if(isNaN(r))return"NaN";if(0>r)return"-"+t(-r);if(isFinite(r)){var n=Math.floor(Math.log(r)/Math.log(10)),e=r/Math.pow(10,n),i=e.toPrecision(numeric.precision);return 10===parseFloat(i)&&(n++,e=1,i=e.toPrecision(numeric.precision)),parseFloat(i).toString()+"e"+n.toString()}return"Infinity"}function n(r){var i;if("undefined"==typeof r)return e.push(Array(numeric.precision+8).join(" ")),!1;if("string"==typeof r)return e.push('"'+r+'"'),!1;if("boolean"==typeof r)return e.push(r.toString()),!1;if("number"==typeof r){var o=t(r),a=r.toPrecision(numeric.precision),s=parseFloat(r.toString()).toString(),u=[o,a,s,parseFloat(a).toString(),parseFloat(s).toString()];for(i=1;i<u.length;i++)u[i].length<o.length&&(o=u[i]);return e.push(Array(numeric.precision+8-o.length).join(" ")+o),!1}if(null===r)return e.push("null"),!1;if("function"==typeof r){e.push(r.toString());var f=!1;for(i in r)r.hasOwnProperty(i)&&(e.push(f?",\n":"\n{"),f=!0,e.push(i),e.push(": \n"),n(r[i]));return f&&e.push("}\n"),!0}if(r instanceof Array){if(r.length>numeric.largeArray)return e.push("...Large Array..."),!0;var f=!1;for(e.push("["),i=0;i<r.length;i++)i>0&&(e.push(","),f&&e.push("\n ")),f=n(r[i]);return e.push("]"),!0}e.push("{");var f=!1;for(i in r)r.hasOwnProperty(i)&&(f&&e.push(",\n"),f=!0,e.push(i),e.push(": \n"),n(r[i]));return e.push("}"),!0}var e=[];return n(r),e.join("")},numeric.parseDate=function(r){function t(r){if("string"==typeof r)return Date.parse(r.replace(/-/g,"/"));if(!(r instanceof Array))throw new Error("parseDate: parameter must be arrays of strings");var n,e=[];for(n=0;n<r.length;n++)e[n]=t(r[n]);return e}return t(r)},numeric.parseFloat=function(r){function t(r){if("string"==typeof r)return parseFloat(r);if(!(r instanceof Array))throw new Error("parseFloat: parameter must be arrays of strings");var n,e=[];for(n=0;n<r.length;n++)e[n]=t(r[n]);return e}return t(r)},numeric.parseCSV=function(r){var t,n,e=r.split("\n"),i=[],o=/(([^'",]*)|('[^']*')|("[^"]*")),/g,a=/^\s*(([+-]?[0-9]+(\.[0-9]*)?(e[+-]?[0-9]+)?)|([+-]?[0-9]*(\.[0-9]+)?(e[+-]?[0-9]+)?))\s*$/,s=function(r){return r.substr(0,r.length-1)},u=0;for(n=0;n<e.length;n++){var f,c=(e[n]+",").match(o);if(c.length>0){for(i[u]=[],t=0;t<c.length;t++)f=s(c[t]),i[u][t]=a.test(f)?parseFloat(f):f;u++}}return i},numeric.toCSV=function(r){var t,n,e,i,o,a,s=numeric.dim(r);for(e=s[0],i=s[1],a=[],t=0;e>t;t++){for(o=[],n=0;e>n;n++)o[n]=r[t][n].toString();a[t]=o.join(", ")}return a.join("\n")+"\n"},numeric.getURL=function(r){var t=new XMLHttpRequest;return t.open("GET",r,!1),t.send(),t},numeric.imageURL=function(r){function t(r){var t,n,e,i,o,a,s,u,f=r.length,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",h="";for(t=0;f>t;t+=3)n=r[t],e=r[t+1],i=r[t+2],o=n>>2,a=((3&n)<<4)+(e>>4),s=((15&e)<<2)+(i>>6),u=63&i,t+1>=f?s=u=64:t+2>=f&&(u=64),h+=c.charAt(o)+c.charAt(a)+c.charAt(s)+c.charAt(u);return h}function n(r,t,n){"undefined"==typeof t&&(t=0),"undefined"==typeof n&&(n=r.length);{var e,i=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],o=-1,a=0;r.length}for(e=t;n>e;e++)a=255&(o^r[e]),o=o>>>8^i[a];return-1^o}var e,i,o,a,s,u,f,c,h,m,l=r[0].length,p=r[0][0].length,d=[137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,p>>24&255,p>>16&255,p>>8&255,255&p,l>>24&255,l>>16&255,l>>8&255,255&l,8,2,0,0,0,-1,-2,-3,-4,-5,-6,-7,-8,73,68,65,84,8,29];for(m=n(d,12,29),d[29]=m>>24&255,d[30]=m>>16&255,d[31]=m>>8&255,d[32]=255&m,e=1,i=0,f=0;l>f;f++){for(d.push(l-1>f?0:1),s=3*p+1+(0===f)&255,u=3*p+1+(0===f)>>8&255,d.push(s),d.push(u),d.push(255&~s),d.push(255&~u),0===f&&d.push(0),c=0;p>c;c++)for(o=0;3>o;o++)s=r[o][f][c],s=s>255?255:0>s?0:Math.round(s),e=(e+s)%65521,i=(i+e)%65521,d.push(s);d.push(0)}return h=(i<<16)+e,d.push(h>>24&255),d.push(h>>16&255),d.push(h>>8&255),d.push(255&h),a=d.length-41,d[33]=a>>24&255,d[34]=a>>16&255,d[35]=a>>8&255,d[36]=255&a,m=n(d,37),d.push(m>>24&255),d.push(m>>16&255),d.push(m>>8&255),d.push(255&m),d.push(0),d.push(0),d.push(0),d.push(0),d.push(73),d.push(69),d.push(78),d.push(68),d.push(174),d.push(66),d.push(96),d.push(130),"data:image/png;base64,"+t(d)},numeric._dim=function(r){for(var t=[];"object"==typeof r;)t.push(r.length),r=r[0];return t},numeric.dim=function(r){var t,n;return"object"==typeof r?(t=r[0],"object"==typeof t?(n=t[0],"object"==typeof n?numeric._dim(r):[r.length,t.length]):[r.length]):[]},numeric.mapreduce=function(r,t){return Function("x","accum","_s","_k",'if(typeof accum === "undefined") accum = '+t+';\nif(typeof x === "number") { var xi = x; '+r+'; return accum; }\nif(typeof _s === "undefined") _s = numeric.dim(x);\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i,xi;\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) {\n        accum = arguments.callee(x[i],accum,_s,_k+1);\n    }    return accum;\n}\nfor(i=_n-1;i>=1;i-=2) { \n    xi = x[i];\n    '+r+";\n    xi = x[i-1];\n    "+r+";\n}\nif(i === 0) {\n    xi = x[i];\n    "+r+"\n}\nreturn accum;")},numeric.mapreduce2=function(r,t){return Function("x","var n = x.length;\nvar i,xi;\n"+t+";\nfor(i=n-1;i!==-1;--i) { \n    xi = x[i];\n    "+r+";\n}\nreturn accum;")},numeric.same=function r(t,n){var e,i;if(!(t instanceof Array&&n instanceof Array))return!1;if(i=t.length,i!==n.length)return!1;for(e=0;i>e;e++)if(t[e]!==n[e]){if("object"!=typeof t[e])return!1;if(!r(t[e],n[e]))return!1}return!0},numeric.rep=function(r,t,n){"undefined"==typeof n&&(n=0);var e,i=r[n],o=Array(i);if(n===r.length-1){for(e=i-2;e>=0;e-=2)o[e+1]=t,o[e]=t;return-1===e&&(o[0]=t),o}for(e=i-1;e>=0;e--)o[e]=numeric.rep(r,t,n+1);return o},numeric.dotMMsmall=function(r,t){var n,e,i,o,a,s,u,f,c,h,m;for(o=r.length,a=t.length,s=t[0].length,u=Array(o),n=o-1;n>=0;n--){for(f=Array(s),c=r[n],i=s-1;i>=0;i--){for(h=c[a-1]*t[a-1][i],e=a-2;e>=1;e-=2)m=e-1,h+=c[e]*t[e][i]+c[m]*t[m][i];0===e&&(h+=c[0]*t[0][i]),f[i]=h}u[n]=f}return u},numeric._getCol=function(r,t,n){var e,i=r.length;for(e=i-1;e>0;--e)n[e]=r[e][t],--e,n[e]=r[e][t];0===e&&(n[0]=r[0][t])},numeric.dotMMbig=function(r,t){var n,e,i,o,a=numeric._getCol,s=t.length,u=Array(s),f=r.length,c=t[0].length,h=new Array(f),m=numeric.dotVV;
for(--s,--f,e=f;-1!==e;--e)h[e]=Array(c);for(--c,e=c;-1!==e;--e)for(a(t,e,u),i=f;-1!==i;--i)o=0,n=r[i],h[i][e]=m(n,u);return h},numeric.dotMV=function(r,t){var n,e=r.length,i=(t.length,Array(e)),o=numeric.dotVV;for(n=e-1;n>=0;n--)i[n]=o(r[n],t);return i},numeric.dotVM=function(r,t){var n,e,i,o,a,s,u;for(i=r.length,o=t[0].length,a=Array(o),e=o-1;e>=0;e--){for(s=r[i-1]*t[i-1][e],n=i-2;n>=1;n-=2)u=n-1,s+=r[n]*t[n][e]+r[u]*t[u][e];0===n&&(s+=r[0]*t[0][e]),a[e]=s}return a},numeric.dotVV=function(r,t){var n,e,i=r.length,o=r[i-1]*t[i-1];for(n=i-2;n>=1;n-=2)e=n-1,o+=r[n]*t[n]+r[e]*t[e];return 0===n&&(o+=r[0]*t[0]),o},numeric.dot=function(r,t){var n=numeric.dim;switch(1e3*n(r).length+n(t).length){case 2002:return t.length<10?numeric.dotMMsmall(r,t):numeric.dotMMbig(r,t);case 2001:return numeric.dotMV(r,t);case 1002:return numeric.dotVM(r,t);case 1001:return numeric.dotVV(r,t);case 1e3:return numeric.mulVS(r,t);case 1:return numeric.mulSV(r,t);case 0:return r*t;default:throw new Error("numeric.dot only works on vectors and matrices")}},numeric.diag=function(r){var t,n,e,i,o=r.length,a=Array(o);for(t=o-1;t>=0;t--){for(i=Array(o),n=t+2,e=o-1;e>=n;e-=2)i[e]=0,i[e-1]=0;for(e>t&&(i[e]=0),i[t]=r[t],e=t-1;e>=1;e-=2)i[e]=0,i[e-1]=0;0===e&&(i[0]=0),a[t]=i}return a},numeric.getDiag=function(r){var t,n=Math.min(r.length,r[0].length),e=Array(n);for(t=n-1;t>=1;--t)e[t]=r[t][t],--t,e[t]=r[t][t];return 0===t&&(e[0]=r[0][0]),e},numeric.identity=function(r){return numeric.diag(numeric.rep([r],1))},numeric.pointwise=function(r,t,n){"undefined"==typeof n&&(n="");var e,i,o=[],a=/\[i\]$/,s="",u=!1;for(e=0;e<r.length;e++)a.test(r[e])?(i=r[e].substring(0,r[e].length-3),s=i):i=r[e],"ret"===i&&(u=!0),o.push(i);return o[r.length]="_s",o[r.length+1]="_k",o[r.length+2]='if(typeof _s === "undefined") _s = numeric.dim('+s+');\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i'+(u?"":", ret = Array(_n)")+";\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) ret[i] = arguments.callee("+r.join(",")+",_s,_k+1);\n    return ret;\n}\n"+n+"\nfor(i=_n-1;i!==-1;--i) {\n    "+t+"\n}\nreturn ret;",Function.apply(null,o)},numeric.pointwise2=function(r,t,n){"undefined"==typeof n&&(n="");var e,i,o=[],a=/\[i\]$/,s="",u=!1;for(e=0;e<r.length;e++)a.test(r[e])?(i=r[e].substring(0,r[e].length-3),s=i):i=r[e],"ret"===i&&(u=!0),o.push(i);return o[r.length]="var _n = "+s+".length;\nvar i"+(u?"":", ret = Array(_n)")+";\n"+n+"\nfor(i=_n-1;i!==-1;--i) {\n"+t+"\n}\nreturn ret;",Function.apply(null,o)},numeric._biforeach=function t(r,n,e,i,o){if(i===e.length-1)return void o(r,n);var a,s=e[i];for(a=s-1;a>=0;a--)t("object"==typeof r?r[a]:r,"object"==typeof n?n[a]:n,e,i+1,o)},numeric._biforeach2=function n(r,t,e,i,o){if(i===e.length-1)return o(r,t);var a,s=e[i],u=Array(s);for(a=s-1;a>=0;--a)u[a]=n("object"==typeof r?r[a]:r,"object"==typeof t?t[a]:t,e,i+1,o);return u},numeric._foreach=function e(r,t,n,i){if(n===t.length-1)return void i(r);var o,a=t[n];for(o=a-1;o>=0;o--)e(r[o],t,n+1,i)},numeric._foreach2=function i(r,t,n,e){if(n===t.length-1)return e(r);var o,a=t[n],s=Array(a);for(o=a-1;o>=0;o--)s[o]=i(r[o],t,n+1,e);return s},numeric.ops2={add:"+",sub:"-",mul:"*",div:"/",mod:"%",and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">=",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"},numeric.opseq={addeq:"+=",subeq:"-=",muleq:"*=",diveq:"/=",modeq:"%=",lshifteq:"<<=",rshifteq:">>=",rrshifteq:">>>=",bandeq:"&=",boreq:"|=",bxoreq:"^="},numeric.mathfuns=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan","isNaN","isFinite"],numeric.mathfuns2=["atan2","pow","max","min"],numeric.ops1={neg:"-",not:"!",bnot:"~",clone:""},numeric.mapreducers={any:["if(xi) return true;","var accum = false;"],all:["if(!xi) return false;","var accum = true;"],sum:["accum += xi;","var accum = 0;"],prod:["accum *= xi;","var accum = 1;"],norm2Squared:["accum += xi*xi;","var accum = 0;"],norminf:["accum = max(accum,abs(xi));","var accum = 0, max = Math.max, abs = Math.abs;"],norm1:["accum += abs(xi)","var accum = 0, abs = Math.abs;"],sup:["accum = max(accum,xi);","var accum = -Infinity, max = Math.max;"],inf:["accum = min(accum,xi);","var accum = Infinity, min = Math.min;"]},function(){var r,t;for(r=0;r<numeric.mathfuns2.length;++r)t=numeric.mathfuns2[r],numeric.ops2[t]=t;for(r in numeric.ops2)if(numeric.ops2.hasOwnProperty(r)){t=numeric.ops2[r];var n,e,i="";-1!==numeric.myIndexOf.call(numeric.mathfuns2,r)?(i="var "+t+" = Math."+t+";\n",n=function(r,n,e){return r+" = "+t+"("+n+","+e+")"},e=function(r,n){return r+" = "+t+"("+r+","+n+")"}):(n=function(r,n,e){return r+" = "+n+" "+t+" "+e},e=numeric.opseq.hasOwnProperty(r+"eq")?function(r,n){return r+" "+t+"= "+n}:function(r,n){return r+" = "+r+" "+t+" "+n}),numeric[r+"VV"]=numeric.pointwise2(["x[i]","y[i]"],n("ret[i]","x[i]","y[i]"),i),numeric[r+"SV"]=numeric.pointwise2(["x","y[i]"],n("ret[i]","x","y[i]"),i),numeric[r+"VS"]=numeric.pointwise2(["x[i]","y"],n("ret[i]","x[i]","y"),i),numeric[r]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar VV = numeric."+r+"VV, VS = numeric."+r+"VS, SV = numeric."+r+'SV;\nvar dim = numeric.dim;\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof x === "object") {\n      if(typeof y === "object") x = numeric._biforeach2(x,y,dim(x),0,VV);\n      else x = numeric._biforeach2(x,y,dim(x),0,VS);\n  } else if(typeof y === "object") x = numeric._biforeach2(x,y,dim(y),0,SV);\n  else '+e("x","y")+"\n}\nreturn x;\n"),numeric[t]=numeric[r],numeric[r+"eqV"]=numeric.pointwise2(["ret[i]","x[i]"],e("ret[i]","x[i]"),i),numeric[r+"eqS"]=numeric.pointwise2(["ret[i]","x"],e("ret[i]","x"),i),numeric[r+"eq"]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar V = numeric."+r+"eqV, S = numeric."+r+'eqS\nvar s = numeric.dim(x);\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof y === "object") numeric._biforeach(x,y,s,0,V);\n  else numeric._biforeach(x,y,s,0,S);\n}\nreturn x;\n')}for(r=0;r<numeric.mathfuns2.length;++r)t=numeric.mathfuns2[r],delete numeric.ops2[t];for(r=0;r<numeric.mathfuns.length;++r)t=numeric.mathfuns[r],numeric.ops1[t]=t;for(r in numeric.ops1)numeric.ops1.hasOwnProperty(r)&&(i="",t=numeric.ops1[r],-1!==numeric.myIndexOf.call(numeric.mathfuns,r)&&Math.hasOwnProperty(t)&&(i="var "+t+" = Math."+t+";\n"),numeric[r+"eqV"]=numeric.pointwise2(["ret[i]"],"ret[i] = "+t+"(ret[i]);",i),numeric[r+"eq"]=Function("x",'if(typeof x !== "object") return '+t+"x\nvar i;\nvar V = numeric."+r+"eqV;\nvar s = numeric.dim(x);\nnumeric._foreach(x,s,0,V);\nreturn x;\n"),numeric[r+"V"]=numeric.pointwise2(["x[i]"],"ret[i] = "+t+"(x[i]);",i),numeric[r]=Function("x",'if(typeof x !== "object") return '+t+"(x)\nvar i;\nvar V = numeric."+r+"V;\nvar s = numeric.dim(x);\nreturn numeric._foreach2(x,s,0,V);\n"));for(r=0;r<numeric.mathfuns.length;++r)t=numeric.mathfuns[r],delete numeric.ops1[t];for(r in numeric.mapreducers)numeric.mapreducers.hasOwnProperty(r)&&(t=numeric.mapreducers[r],numeric[r+"V"]=numeric.mapreduce2(t[0],t[1]),numeric[r]=Function("x","s","k",t[1]+'if(typeof x !== "object") {    xi = x;\n'+t[0]+';\n    return accum;\n}if(typeof s === "undefined") s = numeric.dim(x);\nif(typeof k === "undefined") k = 0;\nif(k === s.length-1) return numeric.'+r+"V(x);\nvar xi;\nvar n = x.length, i;\nfor(i=n-1;i!==-1;--i) {\n   xi = arguments.callee(x[i]);\n"+t[0]+";\n}\nreturn accum;\n"))}(),numeric.truncVV=numeric.pointwise(["x[i]","y[i]"],"ret[i] = round(x[i]/y[i])*y[i];","var round = Math.round;"),numeric.truncVS=numeric.pointwise(["x[i]","y"],"ret[i] = round(x[i]/y)*y;","var round = Math.round;"),numeric.truncSV=numeric.pointwise(["x","y[i]"],"ret[i] = round(x/y[i])*y[i];","var round = Math.round;"),numeric.trunc=function(r,t){return"object"==typeof r?"object"==typeof t?numeric.truncVV(r,t):numeric.truncVS(r,t):"object"==typeof t?numeric.truncSV(r,t):Math.round(r/t)*t},numeric.inv=function(r){var t,n,e,i,o,a,s,r,u=numeric.dim(r),f=Math.abs,c=u[0],h=u[1],m=numeric.clone(r),l=numeric.identity(c);for(a=0;h>a;++a){var p=-1,d=-1;for(o=a;o!==c;++o)s=f(m[o][a]),s>d&&(p=o,d=s);for(n=m[p],m[p]=m[a],m[a]=n,i=l[p],l[p]=l[a],l[a]=i,r=n[a],s=a;s!==h;++s)n[s]/=r;for(s=h-1;-1!==s;--s)i[s]/=r;for(o=c-1;-1!==o;--o)if(o!==a){for(t=m[o],e=l[o],r=t[a],s=a+1;s!==h;++s)t[s]-=n[s]*r;for(s=h-1;s>0;--s)e[s]-=i[s]*r,--s,e[s]-=i[s]*r;0===s&&(e[0]-=i[0]*r)}}return l},numeric.det=function(r){var t=numeric.dim(r);if(2!==t.length||t[0]!==t[1])throw new Error("numeric: det() only works on square matrices");var n,e,i,o,a,s,u,f,c=t[0],h=1,m=numeric.clone(r);for(e=0;c-1>e;e++){for(i=e,n=e+1;c>n;n++)Math.abs(m[n][e])>Math.abs(m[i][e])&&(i=n);for(i!==e&&(u=m[i],m[i]=m[e],m[e]=u,h*=-1),o=m[e],n=e+1;c>n;n++){for(a=m[n],s=a[e]/o[e],i=e+1;c-1>i;i+=2)f=i+1,a[i]-=o[i]*s,a[f]-=o[f]*s;i!==c&&(a[i]-=o[i]*s)}if(0===o[e])return 0;h*=o[e]}return h*m[e][e]},numeric.transpose=function(r){var t,n,e,i,o,a=r.length,s=r[0].length,u=Array(s);for(n=0;s>n;n++)u[n]=Array(a);for(t=a-1;t>=1;t-=2){for(i=r[t],e=r[t-1],n=s-1;n>=1;--n)o=u[n],o[t]=i[n],o[t-1]=e[n],--n,o=u[n],o[t]=i[n],o[t-1]=e[n];0===n&&(o=u[0],o[t]=i[0],o[t-1]=e[0])}if(0===t){for(e=r[0],n=s-1;n>=1;--n)u[n][0]=e[n],--n,u[n][0]=e[n];0===n&&(u[0][0]=e[0])}return u},numeric.negtranspose=function(r){var t,n,e,i,o,a=r.length,s=r[0].length,u=Array(s);for(n=0;s>n;n++)u[n]=Array(a);for(t=a-1;t>=1;t-=2){for(i=r[t],e=r[t-1],n=s-1;n>=1;--n)o=u[n],o[t]=-i[n],o[t-1]=-e[n],--n,o=u[n],o[t]=-i[n],o[t-1]=-e[n];0===n&&(o=u[0],o[t]=-i[0],o[t-1]=-e[0])}if(0===t){for(e=r[0],n=s-1;n>=1;--n)u[n][0]=-e[n],--n,u[n][0]=-e[n];0===n&&(u[0][0]=-e[0])}return u},numeric._random=function o(r,t){var n,e,i=r[t],a=Array(i);if(t===r.length-1){for(e=Math.random,n=i-1;n>=1;n-=2)a[n]=e(),a[n-1]=e();return 0===n&&(a[0]=e()),a}for(n=i-1;n>=0;n--)a[n]=o(r,t+1);return a},numeric.random=function(r){return numeric._random(r,0)},numeric.norm2=function(r){return Math.sqrt(numeric.norm2Squared(r))},numeric.linspace=function(r,t,n){if("undefined"==typeof n&&(n=Math.max(Math.round(t-r)+1,1)),2>n)return 1===n?[r]:[];var e,i=Array(n);for(n--,e=n;e>=0;e--)i[e]=(e*t+(n-e)*r)/n;return i},numeric.getBlock=function(r,t,n){function e(r,o){var a,s=t[o],u=n[o]-s,f=Array(u);if(o===i.length-1){for(a=u;a>=0;a--)f[a]=r[a+s];return f}for(a=u;a>=0;a--)f[a]=e(r[a+s],o+1);return f}var i=numeric.dim(r);return e(r,0)},numeric.setBlock=function(r,t,n,e){function i(r,e,a){var s,u=t[a],f=n[a]-u;if(a===o.length-1)for(s=f;s>=0;s--)r[s+u]=e[s];for(s=f;s>=0;s--)i(r[s+u],e[s],a+1)}var o=numeric.dim(r);return i(r,e,0),r},numeric.getRange=function(r,t,n){var e,i,o,a,s=t.length,u=n.length,f=Array(s);for(e=s-1;-1!==e;--e)for(f[e]=Array(u),o=f[e],a=r[t[e]],i=u-1;-1!==i;--i)o[i]=a[n[i]];return f},numeric.blockMatrix=function(r){var t=numeric.dim(r);if(t.length<4)return numeric.blockMatrix([r]);var n,e,i,o,a,s=t[0],u=t[1];for(n=0,e=0,i=0;s>i;++i)n+=r[i][0].length;for(o=0;u>o;++o)e+=r[0][o][0].length;var f=Array(n);for(i=0;n>i;++i)f[i]=Array(e);var c,h,m,l,p,d=0;for(i=0;s>i;++i){for(c=e,o=u-1;-1!==o;--o)for(a=r[i][o],c-=a[0].length,m=a.length-1;-1!==m;--m)for(p=a[m],h=f[d+m],l=p.length-1;-1!==l;--l)h[c+l]=p[l];d+=r[i][0].length}return f},numeric.tensor=function(r,t){if("number"==typeof r||"number"==typeof t)return numeric.mul(r,t);var n=numeric.dim(r),e=numeric.dim(t);if(1!==n.length||1!==e.length)throw new Error("numeric: tensor product is only defined for vectors");var i,o,a,s,u=n[0],f=e[0],c=Array(u);for(o=u-1;o>=0;o--){for(i=Array(f),s=r[o],a=f-1;a>=3;--a)i[a]=s*t[a],--a,i[a]=s*t[a],--a,i[a]=s*t[a],--a,i[a]=s*t[a];for(;a>=0;)i[a]=s*t[a],--a;c[o]=i}return c},numeric.T=function(r,t){this.x=r,this.y=t},numeric.t=function(r,t){return new numeric.T(r,t)},numeric.Tbinop=function(r,t,n,e,i){numeric.indexOf;if("string"!=typeof i){var o;i="";for(o in numeric)numeric.hasOwnProperty(o)&&(r.indexOf(o)>=0||t.indexOf(o)>=0||n.indexOf(o)>=0||e.indexOf(o)>=0)&&o.length>1&&(i+="var "+o+" = numeric."+o+";\n")}return Function(["y"],"var x = this;\nif(!(y instanceof numeric.T)) { y = new numeric.T(y); }\n"+i+"\nif(x.y) {  if(y.y) {    return new numeric.T("+e+");\n  }\n  return new numeric.T("+n+");\n}\nif(y.y) {\n  return new numeric.T("+t+");\n}\nreturn new numeric.T("+r+");\n")},numeric.T.prototype.add=numeric.Tbinop("add(x.x,y.x)","add(x.x,y.x),y.y","add(x.x,y.x),x.y","add(x.x,y.x),add(x.y,y.y)"),numeric.T.prototype.sub=numeric.Tbinop("sub(x.x,y.x)","sub(x.x,y.x),neg(y.y)","sub(x.x,y.x),x.y","sub(x.x,y.x),sub(x.y,y.y)"),numeric.T.prototype.mul=numeric.Tbinop("mul(x.x,y.x)","mul(x.x,y.x),mul(x.x,y.y)","mul(x.x,y.x),mul(x.y,y.x)","sub(mul(x.x,y.x),mul(x.y,y.y)),add(mul(x.x,y.y),mul(x.y,y.x))"),numeric.T.prototype.reciprocal=function(){var r=numeric.mul,t=numeric.div;if(this.y){var n=numeric.add(r(this.x,this.x),r(this.y,this.y));return new numeric.T(t(this.x,n),t(numeric.neg(this.y),n))}return new T(t(1,this.x))},numeric.T.prototype.div=function a(r){if(r instanceof numeric.T||(r=new numeric.T(r)),r.y)return this.mul(r.reciprocal());var a=numeric.div;return this.y?new numeric.T(a(this.x,r.x),a(this.y,r.x)):new numeric.T(a(this.x,r.x))},numeric.T.prototype.dot=numeric.Tbinop("dot(x.x,y.x)","dot(x.x,y.x),dot(x.x,y.y)","dot(x.x,y.x),dot(x.y,y.x)","sub(dot(x.x,y.x),dot(x.y,y.y)),add(dot(x.x,y.y),dot(x.y,y.x))"),numeric.T.prototype.transpose=function(){var r=numeric.transpose,t=this.x,n=this.y;return n?new numeric.T(r(t),r(n)):new numeric.T(r(t))},numeric.T.prototype.transjugate=function(){var r=numeric.transpose,t=this.x,n=this.y;return n?new numeric.T(r(t),numeric.negtranspose(n)):new numeric.T(r(t))},numeric.Tunop=function(r,t,n){return"string"!=typeof n&&(n=""),Function("var x = this;\n"+n+"\nif(x.y) {  "+t+";\n}\n"+r+";\n")},numeric.T.prototype.exp=numeric.Tunop("return new numeric.T(ex)","return new numeric.T(mul(cos(x.y),ex),mul(sin(x.y),ex))","var ex = numeric.exp(x.x), cos = numeric.cos, sin = numeric.sin, mul = numeric.mul;"),numeric.T.prototype.conj=numeric.Tunop("return new numeric.T(x.x);","return new numeric.T(x.x,numeric.neg(x.y));"),numeric.T.prototype.neg=numeric.Tunop("return new numeric.T(neg(x.x));","return new numeric.T(neg(x.x),neg(x.y));","var neg = numeric.neg;"),numeric.T.prototype.sin=numeric.Tunop("return new numeric.T(numeric.sin(x.x))","return x.exp().sub(x.neg().exp()).div(new numeric.T(0,2));"),numeric.T.prototype.cos=numeric.Tunop("return new numeric.T(numeric.cos(x.x))","return x.exp().add(x.neg().exp()).div(2);"),numeric.T.prototype.abs=numeric.Tunop("return new numeric.T(numeric.abs(x.x));","return new numeric.T(numeric.sqrt(numeric.add(mul(x.x,x.x),mul(x.y,x.y))));","var mul = numeric.mul;"),numeric.T.prototype.log=numeric.Tunop("return new numeric.T(numeric.log(x.x));","var theta = new numeric.T(numeric.atan2(x.y,x.x)), r = x.abs();\nreturn new numeric.T(numeric.log(r.x),theta.x);"),numeric.T.prototype.norm2=numeric.Tunop("return numeric.norm2(x.x);","var f = numeric.norm2Squared;\nreturn Math.sqrt(f(x.x)+f(x.y));"),numeric.T.prototype.inv=function(){var r=this;if("undefined"==typeof r.y)return new numeric.T(numeric.inv(r.x));var t,n,e,i,o,a,s,u,f,c,h,t,n,e,m,l,p,d,g,v,y,w=r.x.length,x=numeric.identity(w),M=numeric.rep([w,w],0),b=numeric.clone(r.x),k=numeric.clone(r.y);for(t=0;w>t;t++){for(p=b[t][t],d=k[t][t],m=p*p+d*d,e=t,n=t+1;w>n;n++)p=b[n][t],d=k[n][t],l=p*p+d*d,l>m&&(e=n,m=l);for(e!==t&&(y=b[t],b[t]=b[e],b[e]=y,y=k[t],k[t]=k[e],k[e]=y,y=x[t],x[t]=x[e],x[e]=y,y=M[t],M[t]=M[e],M[e]=y),i=b[t],o=k[t],u=x[t],f=M[t],p=i[t],d=o[t],n=t+1;w>n;n++)g=i[n],v=o[n],i[n]=(g*p+v*d)/m,o[n]=(v*p-g*d)/m;for(n=0;w>n;n++)g=u[n],v=f[n],u[n]=(g*p+v*d)/m,f[n]=(v*p-g*d)/m;for(n=t+1;w>n;n++){for(a=b[n],s=k[n],c=x[n],h=M[n],p=a[t],d=s[t],e=t+1;w>e;e++)g=i[e],v=o[e],a[e]-=g*p-v*d,s[e]-=v*p+g*d;for(e=0;w>e;e++)g=u[e],v=f[e],c[e]-=g*p-v*d,h[e]-=v*p+g*d}}for(t=w-1;t>0;t--)for(u=x[t],f=M[t],n=t-1;n>=0;n--)for(c=x[n],h=M[n],p=b[n][t],d=k[n][t],e=w-1;e>=0;e--)g=u[e],v=f[e],c[e]-=p*g-d*v,h[e]-=p*v+d*g;return new numeric.T(x,M)},numeric.T.prototype.get=function(r){var t,n=this.x,e=this.y,i=0,o=r.length;if(e){for(;o>i;)t=r[i],n=n[t],e=e[t],i++;return new numeric.T(n,e)}for(;o>i;)t=r[i],n=n[t],i++;return new numeric.T(n)},numeric.T.prototype.set=function(r,t){var n,e=this.x,i=this.y,o=0,a=r.length,s=t.x,u=t.y;if(0===a)return u?this.y=u:i&&(this.y=void 0),this.x=e,this;if(u){for(i||(i=numeric.rep(numeric.dim(e),0),this.y=i);a-1>o;)n=r[o],e=e[n],i=i[n],o++;return n=r[o],e[n]=s,i[n]=u,this}if(i){for(;a-1>o;)n=r[o],e=e[n],i=i[n],o++;return n=r[o],e[n]=s,i[n]=s instanceof Array?numeric.rep(numeric.dim(s),0):0,this}for(;a-1>o;)n=r[o],e=e[n],o++;return n=r[o],e[n]=s,this},numeric.T.prototype.getRows=function(r,t){var n,e,i=t-r+1,o=Array(i),a=this.x,s=this.y;for(n=r;t>=n;n++)o[n-r]=a[n];if(s){for(e=Array(i),n=r;t>=n;n++)e[n-r]=s[n];return new numeric.T(o,e)}return new numeric.T(o)},numeric.T.prototype.setRows=function(r,t,n){var e,i=this.x,o=this.y,a=n.x,s=n.y;for(e=r;t>=e;e++)i[e]=a[e-r];if(s)for(o||(o=numeric.rep(numeric.dim(i),0),this.y=o),e=r;t>=e;e++)o[e]=s[e-r];else if(o)for(e=r;t>=e;e++)o[e]=numeric.rep([a[e-r].length],0);return this},numeric.T.prototype.getRow=function(r){var t=this.x,n=this.y;return n?new numeric.T(t[r],n[r]):new numeric.T(t[r])},numeric.T.prototype.setRow=function(r,t){var n=this.x,e=this.y,i=t.x,o=t.y;return n[r]=i,o?(e||(e=numeric.rep(numeric.dim(n),0),this.y=e),e[r]=o):e&&(e=numeric.rep([i.length],0)),this},numeric.T.prototype.getBlock=function(r,t){var n=this.x,e=this.y,i=numeric.getBlock;return e?new numeric.T(i(n,r,t),i(e,r,t)):new numeric.T(i(n,r,t))},numeric.T.prototype.setBlock=function(r,t,n){n instanceof numeric.T||(n=new numeric.T(n));var e=this.x,i=this.y,o=numeric.setBlock,a=n.x,s=n.y;return s?(i||(this.y=numeric.rep(numeric.dim(this),0),i=this.y),o(e,r,t,a),o(i,r,t,s),this):(o(e,r,t,a),void(i&&o(i,r,t,numeric.rep(numeric.dim(a),0))))},numeric.T.rep=function(r,t){var n=numeric.T;t instanceof n||(t=new n(t));var e=t.x,i=t.y,o=numeric.rep;return i?new n(o(r,e),o(r,i)):new n(o(r,e))},numeric.T.diag=function s(r){r instanceof numeric.T||(r=new numeric.T(r));var t=r.x,n=r.y,s=numeric.diag;return n?new numeric.T(s(t),s(n)):new numeric.T(s(t))},numeric.T.eig=function(){if(this.y)throw new Error("eig: not implemented for complex matrices.");return numeric.eig(this.x)},numeric.T.identity=function(r){return new numeric.T(numeric.identity(r))},numeric.T.prototype.getDiag=function(){var r=numeric,t=this.x,n=this.y;return n?new r.T(r.getDiag(t),r.getDiag(n)):new r.T(r.getDiag(t))},numeric.house=function(r){var t=numeric.clone(r),n=r[0]>=0?1:-1,e=n*numeric.norm2(r);t[0]+=e;var i=numeric.norm2(t);if(0===i)throw new Error("eig: internal error");return numeric.div(t,i)},numeric.toUpperHessenberg=function(r){var t=numeric.dim(r);if(2!==t.length||t[0]!==t[1])throw new Error("numeric: toUpperHessenberg() only works on square matrices");var n,e,i,o,a,s,u,f,c,h,m=t[0],l=numeric.clone(r),p=numeric.identity(m);for(e=0;m-2>e;e++){for(o=Array(m-e-1),n=e+1;m>n;n++)o[n-e-1]=l[n][e];if(numeric.norm2(o)>0){for(a=numeric.house(o),s=numeric.getBlock(l,[e+1,e],[m-1,m-1]),u=numeric.tensor(a,numeric.dot(a,s)),n=e+1;m>n;n++)for(f=l[n],c=u[n-e-1],i=e;m>i;i++)f[i]-=2*c[i-e];for(s=numeric.getBlock(l,[0,e+1],[m-1,m-1]),u=numeric.tensor(numeric.dot(s,a),a),n=0;m>n;n++)for(f=l[n],c=u[n],i=e+1;m>i;i++)f[i]-=2*c[i-e-1];for(s=Array(m-e-1),n=e+1;m>n;n++)s[n-e-1]=p[n];for(u=numeric.tensor(a,numeric.dot(a,s)),n=e+1;m>n;n++)for(h=p[n],c=u[n-e-1],i=0;m>i;i++)h[i]-=2*c[i]}}return{H:l,Q:p}},numeric.epsilon=2.220446049250313e-16,numeric.QRFrancis=function(r,t){"undefined"==typeof t&&(t=1e4),r=numeric.clone(r);var n,e,i,o,a,s,u,f,c,h,m,l,p,d,g,v,y,w,x=(numeric.clone(r),numeric.dim(r)),M=x[0],b=numeric.identity(M);if(3>M)return{Q:b,B:[[0,M-1]]};var k=numeric.epsilon;for(w=0;t>w;w++){for(v=0;M-1>v;v++)if(Math.abs(r[v+1][v])<k*(Math.abs(r[v][v])+Math.abs(r[v+1][v+1]))){var A=numeric.QRFrancis(numeric.getBlock(r,[0,0],[v,v]),t),S=numeric.QRFrancis(numeric.getBlock(r,[v+1,v+1],[M-1,M-1]),t);for(l=Array(v+1),g=0;v>=g;g++)l[g]=b[g];for(p=numeric.dot(A.Q,l),g=0;v>=g;g++)b[g]=p[g];for(l=Array(M-v-1),g=v+1;M>g;g++)l[g-v-1]=b[g];for(p=numeric.dot(S.Q,l),g=v+1;M>g;g++)b[g]=p[g-v-1];return{Q:b,B:A.B.concat(numeric.add(S.B,v+1))}}if(i=r[M-2][M-2],o=r[M-2][M-1],a=r[M-1][M-2],s=r[M-1][M-1],f=i+s,u=i*s-o*a,c=numeric.getBlock(r,[0,0],[2,2]),f*f>=4*u){var j,q;j=.5*(f+Math.sqrt(f*f-4*u)),q=.5*(f-Math.sqrt(f*f-4*u)),c=numeric.add(numeric.sub(numeric.dot(c,c),numeric.mul(c,j+q)),numeric.diag(numeric.rep([3],j*q)))}else c=numeric.add(numeric.sub(numeric.dot(c,c),numeric.mul(c,f)),numeric.diag(numeric.rep([3],u)));for(n=[c[0][0],c[1][0],c[2][0]],e=numeric.house(n),l=[r[0],r[1],r[2]],p=numeric.tensor(e,numeric.dot(e,l)),g=0;3>g;g++)for(m=r[g],d=p[g],y=0;M>y;y++)m[y]-=2*d[y];for(l=numeric.getBlock(r,[0,0],[M-1,2]),p=numeric.tensor(numeric.dot(l,e),e),g=0;M>g;g++)for(m=r[g],d=p[g],y=0;3>y;y++)m[y]-=2*d[y];for(l=[b[0],b[1],b[2]],p=numeric.tensor(e,numeric.dot(e,l)),g=0;3>g;g++)for(h=b[g],d=p[g],y=0;M>y;y++)h[y]-=2*d[y];var T;for(v=0;M-2>v;v++){for(y=v;v+1>=y;y++)if(Math.abs(r[y+1][y])<k*(Math.abs(r[y][y])+Math.abs(r[y+1][y+1]))){var A=numeric.QRFrancis(numeric.getBlock(r,[0,0],[y,y]),t),S=numeric.QRFrancis(numeric.getBlock(r,[y+1,y+1],[M-1,M-1]),t);for(l=Array(y+1),g=0;y>=g;g++)l[g]=b[g];for(p=numeric.dot(A.Q,l),g=0;y>=g;g++)b[g]=p[g];for(l=Array(M-y-1),g=y+1;M>g;g++)l[g-y-1]=b[g];for(p=numeric.dot(S.Q,l),g=y+1;M>g;g++)b[g]=p[g-y-1];return{Q:b,B:A.B.concat(numeric.add(S.B,y+1))}}for(T=Math.min(M-1,v+3),n=Array(T-v),g=v+1;T>=g;g++)n[g-v-1]=r[g][v];for(e=numeric.house(n),l=numeric.getBlock(r,[v+1,v],[T,M-1]),p=numeric.tensor(e,numeric.dot(e,l)),g=v+1;T>=g;g++)for(m=r[g],d=p[g-v-1],y=v;M>y;y++)m[y]-=2*d[y-v];for(l=numeric.getBlock(r,[0,v+1],[M-1,T]),p=numeric.tensor(numeric.dot(l,e),e),g=0;M>g;g++)for(m=r[g],d=p[g],y=v+1;T>=y;y++)m[y]-=2*d[y-v-1];for(l=Array(T-v),g=v+1;T>=g;g++)l[g-v-1]=b[g];for(p=numeric.tensor(e,numeric.dot(e,l)),g=v+1;T>=g;g++)for(h=b[g],d=p[g-v-1],y=0;M>y;y++)h[y]-=2*d[y]}}throw new Error("numeric: eigenvalue iteration does not converge -- increase maxiter?")},numeric.eig=function(r,t){var n,e,i,o,a,s,u,f,c,h,m,l,p,d,g,v,y,w=numeric.toUpperHessenberg(r),x=numeric.QRFrancis(w.H,t),M=numeric.T,b=r.length,k=x.B,A=numeric.dot(x.Q,numeric.dot(w.H,numeric.transpose(x.Q))),S=new M(numeric.dot(x.Q,w.Q)),j=k.length,q=Math.sqrt;for(e=0;j>e;e++)if(n=k[e][0],n===k[e][1]);else{if(o=n+1,a=A[n][n],s=A[n][o],u=A[o][n],f=A[o][o],0===s&&0===u)continue;c=-a-f,h=a*f-s*u,m=c*c-4*h,m>=0?(l=0>c?-.5*(c-q(m)):-.5*(c+q(m)),v=(a-l)*(a-l)+s*s,y=u*u+(f-l)*(f-l),v>y?(v=q(v),d=(a-l)/v,g=s/v):(y=q(y),d=u/y,g=(f-l)/y),i=new M([[g,-d],[d,g]]),S.setRows(n,o,i.dot(S.getRows(n,o)))):(l=-.5*c,p=.5*q(-m),v=(a-l)*(a-l)+s*s,y=u*u+(f-l)*(f-l),v>y?(v=q(v+p*p),d=(a-l)/v,g=s/v,l=0,p/=v):(y=q(y+p*p),d=u/y,g=(f-l)/y,l=p/y,p=0),i=new M([[g,-d],[d,g]],[[l,p],[p,-l]]),S.setRows(n,o,i.dot(S.getRows(n,o))))}var T=S.dot(r).dot(S.transjugate()),b=r.length,V=numeric.T.identity(b);for(o=0;b>o;o++)if(o>0)for(e=o-1;e>=0;e--){var D=T.get([e,e]),O=T.get([o,o]);numeric.neq(D.x,O.x)||numeric.neq(D.y,O.y)?(l=T.getRow(e).getBlock([e],[o-1]),p=V.getRow(o).getBlock([e],[o-1]),V.set([o,e],T.get([e,o]).neg().sub(l.dot(p)).div(D.sub(O)))):V.setRow(o,V.getRow(e))}for(o=0;b>o;o++)l=V.getRow(o),V.setRow(o,l.div(l.norm2()));return V=V.transpose(),V=S.transjugate().dot(V),{lambda:T.getDiag(),E:V}},numeric.ccsSparse=function(r){var t,n,e,i,o=r.length,a=[];for(e=o-1;-1!==e;--e){n=r[e];for(i in n){for(i=parseInt(i);i>=a.length;)a[a.length]=0;0!==n[i]&&a[i]++}}var t=a.length,s=Array(t+1);for(s[0]=0,e=0;t>e;++e)s[e+1]=s[e]+a[e];var u=Array(s[t]),f=Array(s[t]);for(e=o-1;-1!==e;--e){n=r[e];for(i in n)0!==n[i]&&(a[i]--,u[s[i]+a[i]]=e,f[s[i]+a[i]]=n[i])}return[s,u,f]},numeric.ccsFull=function(r){var t,n,e,i,o=r[0],a=r[1],s=r[2],u=numeric.ccsDim(r),f=u[0],c=u[1],h=numeric.rep([f,c],0);for(t=0;c>t;t++)for(e=o[t],i=o[t+1],n=e;i>n;++n)h[a[n]][t]=s[n];return h},numeric.ccsTSolve=function(r,t,n,e,i){function o(r){var t;if(0===n[r]){for(n[r]=1,t=a[r];t<a[r+1];++t)o(s[t]);i[h]=r,++h}}var a=r[0],s=r[1],u=r[2],f=a.length-1,c=Math.max,h=0;"undefined"==typeof e&&(n=numeric.rep([f],0)),"undefined"==typeof e&&(e=numeric.linspace(0,n.length-1)),"undefined"==typeof i&&(i=[]);var m,l,p,d,g,v,y;for(m=e.length-1;-1!==m;--m)o(e[m]);for(i.length=h,m=i.length-1;-1!==m;--m)n[i[m]]=0;for(m=e.length-1;-1!==m;--m)l=e[m],n[l]=t[l];for(m=i.length-1;-1!==m;--m){for(l=i[m],p=a[l],d=c(a[l+1],p),g=p;g!==d;++g)if(s[g]===l){n[l]/=u[g];break}for(y=n[l],g=p;g!==d;++g)v=s[g],v!==l&&(n[v]-=y*u[g])}return n},numeric.ccsDFS=function(r){this.k=Array(r),this.k1=Array(r),this.j=Array(r)},numeric.ccsDFS.prototype.dfs=function(r,t,n,e,i,o){var a,s,u,f=0,c=i.length,h=this.k,m=this.k1,l=this.j;if(0===e[r])for(e[r]=1,l[0]=r,h[0]=s=t[r],m[0]=u=t[r+1];;)if(s>=u){if(i[c]=l[f],0===f)return;++c,--f,s=h[f],u=m[f]}else a=o[n[s]],0===e[a]?(e[a]=1,h[f]=s,++f,l[f]=a,s=t[a],m[f]=u=t[a+1]):++s},numeric.ccsLPSolve=function(r,t,n,e,i,o,a){var s,u,f,c,h,m,l,p,d,g=r[0],v=r[1],y=r[2],w=(g.length-1,t[0]),x=t[1],M=t[2];for(u=w[i],f=w[i+1],e.length=0,s=u;f>s;++s)a.dfs(o[x[s]],g,v,n,e,o);for(s=e.length-1;-1!==s;--s)n[e[s]]=0;for(s=u;s!==f;++s)c=o[x[s]],n[c]=M[s];for(s=e.length-1;-1!==s;--s){for(c=e[s],h=g[c],m=g[c+1],l=h;m>l;++l)if(o[v[l]]===c){n[c]/=y[l];break}for(d=n[c],l=h;m>l;++l)p=o[v[l]],p!==c&&(n[p]-=d*y[l])}return n},numeric.ccsLUP1=function(r,t){var n,e,i,o,a,s,u,f=r[0].length-1,c=[numeric.rep([f+1],0),[],[]],h=[numeric.rep([f+1],0),[],[]],m=c[0],l=c[1],p=c[2],d=h[0],g=h[1],v=h[2],y=numeric.rep([f],0),w=numeric.rep([f],0),x=numeric.ccsLPSolve,M=(Math.max,Math.abs),b=numeric.linspace(0,f-1),k=numeric.linspace(0,f-1),A=new numeric.ccsDFS(f);for("undefined"==typeof t&&(t=1),n=0;f>n;++n){for(x(c,r,y,w,n,k,A),o=-1,a=-1,e=w.length-1;-1!==e;--e)i=w[e],n>=i||(s=M(y[i]),s>o&&(a=i,o=s));for(M(y[n])<t*o&&(e=b[n],o=b[a],b[n]=o,k[o]=n,b[a]=e,k[e]=a,o=y[n],y[n]=y[a],y[a]=o),o=m[n],a=d[n],u=y[n],l[o]=b[n],p[o]=1,++o,e=w.length-1;-1!==e;--e)i=w[e],s=y[i],w[e]=0,y[i]=0,n>=i?(g[a]=i,v[a]=s,++a):(l[o]=b[i],p[o]=s/u,++o);m[n+1]=o,d[n+1]=a}for(e=l.length-1;-1!==e;--e)l[e]=k[l[e]];return{L:c,U:h,P:b,Pinv:k}},numeric.ccsDFS0=function(r){this.k=Array(r),this.k1=Array(r),this.j=Array(r)},numeric.ccsDFS0.prototype.dfs=function(r,t,n,e,i,o){var a,s,u,f=0,c=i.length,h=this.k,m=this.k1,l=this.j;if(0===e[r])for(e[r]=1,l[0]=r,h[0]=s=t[o[r]],m[0]=u=t[o[r]+1];;){if(isNaN(s))throw new Error("Ow!");if(s>=u){if(i[c]=o[l[f]],0===f)return;++c,--f,s=h[f],u=m[f]}else a=n[s],0===e[a]?(e[a]=1,h[f]=s,++f,l[f]=a,a=o[a],s=t[a],m[f]=u=t[a+1]):++s}},numeric.ccsLPSolve0=function(r,t,n,e,i,o,a,s){var u,f,c,h,m,l,p,d,g,v=r[0],y=r[1],w=r[2],x=(v.length-1,t[0]),M=t[1],b=t[2];for(f=x[i],c=x[i+1],e.length=0,u=f;c>u;++u)s.dfs(M[u],v,y,n,e,o,a);for(u=e.length-1;-1!==u;--u)h=e[u],n[a[h]]=0;for(u=f;u!==c;++u)h=M[u],n[h]=b[u];for(u=e.length-1;-1!==u;--u){for(h=e[u],d=a[h],m=v[h],l=v[h+1],p=m;l>p;++p)if(y[p]===d){n[d]/=w[p];break}for(g=n[d],p=m;l>p;++p)n[y[p]]-=g*w[p];n[d]=g}},numeric.ccsLUP0=function(r,t){var n,e,i,o,a,s,u,f=r[0].length-1,c=[numeric.rep([f+1],0),[],[]],h=[numeric.rep([f+1],0),[],[]],m=c[0],l=c[1],p=c[2],d=h[0],g=h[1],v=h[2],y=numeric.rep([f],0),w=numeric.rep([f],0),x=numeric.ccsLPSolve0,M=(Math.max,Math.abs),b=numeric.linspace(0,f-1),k=numeric.linspace(0,f-1),A=new numeric.ccsDFS0(f);for("undefined"==typeof t&&(t=1),n=0;f>n;++n){for(x(c,r,y,w,n,k,b,A),o=-1,a=-1,e=w.length-1;-1!==e;--e)i=w[e],n>=i||(s=M(y[b[i]]),s>o&&(a=i,o=s));for(M(y[b[n]])<t*o&&(e=b[n],o=b[a],b[n]=o,k[o]=n,b[a]=e,k[e]=a),o=m[n],a=d[n],u=y[b[n]],l[o]=b[n],p[o]=1,++o,e=w.length-1;-1!==e;--e)i=w[e],s=y[b[i]],w[e]=0,y[b[i]]=0,n>=i?(g[a]=i,v[a]=s,++a):(l[o]=b[i],p[o]=s/u,++o);m[n+1]=o,d[n+1]=a}for(e=l.length-1;-1!==e;--e)l[e]=k[l[e]];return{L:c,U:h,P:b,Pinv:k}},numeric.ccsLUP=numeric.ccsLUP0,numeric.ccsDim=function(r){return[numeric.sup(r[1])+1,r[0].length-1]},numeric.ccsGetBlock=function(r,t,n){var e=numeric.ccsDim(r),i=e[0],o=e[1];"undefined"==typeof t?t=numeric.linspace(0,i-1):"number"==typeof t&&(t=[t]),"undefined"==typeof n?n=numeric.linspace(0,o-1):"number"==typeof n&&(n=[n]);var a,s,u,f,c,h=t.length,m=n.length,l=numeric.rep([o],0),p=[],d=[],g=[l,p,d],v=r[0],y=r[1],w=r[2],x=numeric.rep([i],0),M=0,b=numeric.rep([i],0);for(s=0;m>s;++s){f=n[s];var k=v[f],A=v[f+1];for(a=k;A>a;++a)u=y[a],b[u]=1,x[u]=w[a];for(a=0;h>a;++a)c=t[a],b[c]&&(p[M]=a,d[M]=x[t[a]],++M);for(a=k;A>a;++a)u=y[a],b[u]=0;l[s+1]=M}return g},numeric.ccsDot=function(r,t){var n,e,i,o,a,s,u,f,c,h,m,l=r[0],p=r[1],d=r[2],g=t[0],v=t[1],y=t[2],w=numeric.ccsDim(r),x=numeric.ccsDim(t),M=w[0],b=(w[1],x[1]),k=numeric.rep([M],0),A=numeric.rep([M],0),S=Array(M),j=numeric.rep([b],0),q=[],T=[],V=[j,q,T];for(i=0;i!==b;++i){for(o=g[i],a=g[i+1],c=0,e=o;a>e;++e)for(h=v[e],m=y[e],s=l[h],u=l[h+1],n=s;u>n;++n)f=p[n],0===A[f]&&(S[c]=f,A[f]=1,c+=1),k[f]=k[f]+d[n]*m;for(o=j[i],a=o+c,j[i+1]=a,e=c-1;-1!==e;--e)m=o+e,n=S[e],q[m]=n,T[m]=k[n],A[n]=0,k[n]=0;j[i+1]=j[i]+c}return V},numeric.ccsLUPSolve=function(r,t){var n=r.L,e=r.U,i=(r.P,t[0]),o=!1;"object"!=typeof i&&(t=[[0,t.length],numeric.linspace(0,t.length-1),t],i=t[0],o=!0);var a,s,u,f,c,h,m=t[1],l=t[2],p=n[0].length-1,d=i.length-1,g=numeric.rep([p],0),v=Array(p),y=numeric.rep([p],0),w=Array(p),x=numeric.rep([d+1],0),M=[],b=[],k=numeric.ccsTSolve,A=0;for(a=0;d>a;++a){for(c=0,u=i[a],f=i[a+1],s=u;f>s;++s)h=r.Pinv[m[s]],w[c]=h,y[h]=l[s],++c;for(w.length=c,k(n,y,g,w,v),s=w.length-1;-1!==s;--s)y[w[s]]=0;if(k(e,g,y,v,w),o)return y;for(s=v.length-1;-1!==s;--s)g[v[s]]=0;for(s=w.length-1;-1!==s;--s)h=w[s],M[A]=h,b[A]=y[h],y[h]=0,++A;x[a+1]=A}return[x,M,b]},numeric.ccsbinop=function(r,t){return"undefined"==typeof t&&(t=""),Function("X","Y","var Xi = X[0], Xj = X[1], Xv = X[2];\nvar Yi = Y[0], Yj = Y[1], Yv = Y[2];\nvar n = Xi.length-1,m = Math.max(numeric.sup(Xj),numeric.sup(Yj))+1;\nvar Zi = numeric.rep([n+1],0), Zj = [], Zv = [];\nvar x = numeric.rep([m],0),y = numeric.rep([m],0);\nvar xk,yk,zk;\nvar i,j,j0,j1,k,p=0;\n"+t+"for(i=0;i<n;++i) {\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Xj[j];\n    x[k] = 1;\n    Zj[p] = k;\n    ++p;\n  }\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Yj[j];\n    y[k] = Yv[j];\n    if(x[k] === 0) {\n      Zj[p] = k;\n      ++p;\n    }\n  }\n  Zi[i+1] = p;\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = Xv[j];\n  j0 = Zi[i]; j1 = Zi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Zj[j];\n    xk = x[k];\n    yk = y[k];\n"+r+"\n    Zv[j] = zk;\n  }\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = 0;\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) y[Yj[j]] = 0;\n}\nreturn [Zi,Zj,Zv];")},function(){var k,A,B,C;for(k in numeric.ops2)A=isFinite(eval("1"+numeric.ops2[k]+"0"))?"[Y[0],Y[1],numeric."+k+"(X,Y[2])]":"NaN",B=isFinite(eval("0"+numeric.ops2[k]+"1"))?"[X[0],X[1],numeric."+k+"(X[2],Y)]":"NaN",C=isFinite(eval("1"+numeric.ops2[k]+"0"))&&isFinite(eval("0"+numeric.ops2[k]+"1"))?"numeric.ccs"+k+"MM(X,Y)":"NaN",numeric["ccs"+k+"MM"]=numeric.ccsbinop("zk = xk "+numeric.ops2[k]+"yk;"),numeric["ccs"+k]=Function("X","Y",'if(typeof X === "number") return '+A+';\nif(typeof Y === "number") return '+B+";\nreturn "+C+";\n")}(),numeric.ccsScatter=function(r){var t,n=r[0],e=r[1],i=r[2],o=numeric.sup(e)+1,a=n.length,s=numeric.rep([o],0),u=Array(a),f=Array(a),c=numeric.rep([o],0);for(t=0;a>t;++t)c[e[t]]++;for(t=0;o>t;++t)s[t+1]=s[t]+c[t];var h,m,l=s.slice(0);for(t=0;a>t;++t)m=e[t],h=l[m],u[h]=n[t],f[h]=i[t],l[m]=l[m]+1;return[s,u,f]},numeric.ccsGather=function(r){var t,n,e,i,o,a=r[0],s=r[1],u=r[2],f=a.length-1,c=s.length,h=Array(c),m=Array(c),l=Array(c);for(o=0,t=0;f>t;++t)for(e=a[t],i=a[t+1],n=e;n!==i;++n)m[o]=t,h[o]=s[n],l[o]=u[n],++o;return[h,m,l]},numeric.sdim=function u(r,t,n){if("undefined"==typeof t&&(t=[]),"object"!=typeof r)return t;"undefined"==typeof n&&(n=0),n in t||(t[n]=0),r.length>t[n]&&(t[n]=r.length);var e;for(e in r)r.hasOwnProperty(e)&&u(r[e],t,n+1);return t},numeric.sclone=function f(r,t,n){"undefined"==typeof t&&(t=0),"undefined"==typeof n&&(n=numeric.sdim(r).length);var e,i=Array(r.length);
if(t===n-1){for(e in r)r.hasOwnProperty(e)&&(i[e]=r[e]);return i}for(e in r)r.hasOwnProperty(e)&&(i[e]=f(r[e],t+1,n));return i},numeric.sdiag=function(r){var t,n,e=r.length,i=Array(e);for(t=e-1;t>=1;t-=2)n=t-1,i[t]=[],i[t][t]=r[t],i[n]=[],i[n][n]=r[n];return 0===t&&(i[0]=[],i[0][0]=r[t]),i},numeric.sidentity=function(r){return numeric.sdiag(numeric.rep([r],1))},numeric.stranspose=function(r){{var t,n,e,i=[];r.length}for(t in r)if(r.hasOwnProperty(t)){e=r[t];for(n in e)e.hasOwnProperty(n)&&("object"!=typeof i[n]&&(i[n]=[]),i[n][t]=e[n])}return i},numeric.sLUP=function(){throw new Error("The function numeric.sLUP had a bug in it and has been removed. Please use the new numeric.ccsLUP function instead.")},numeric.sdotMM=function(r,t){var n,e,i,o,a,s,u,f=r.length,c=(t.length,numeric.stranspose(t)),h=c.length,m=Array(f);for(i=f-1;i>=0;i--){for(u=[],n=r[i],a=h-1;a>=0;a--){s=0,e=c[a];for(o in n)n.hasOwnProperty(o)&&o in e&&(s+=n[o]*e[o]);s&&(u[a]=s)}m[i]=u}return m},numeric.sdotMV=function(r,t){var n,e,i,o,a=r.length,s=Array(a);for(e=a-1;e>=0;e--){n=r[e],o=0;for(i in n)n.hasOwnProperty(i)&&t[i]&&(o+=n[i]*t[i]);o&&(s[e]=o)}return s},numeric.sdotVM=function(r,t){var n,e,i,o,a=[];for(n in r)if(r.hasOwnProperty(n)){i=t[n],o=r[n];for(e in i)i.hasOwnProperty(e)&&(a[e]||(a[e]=0),a[e]+=o*i[e])}return a},numeric.sdotVV=function(r,t){var n,e=0;for(n in r)r[n]&&t[n]&&(e+=r[n]*t[n]);return e},numeric.sdot=function(r,t){var n=numeric.sdim(r).length,e=numeric.sdim(t).length,i=1e3*n+e;switch(i){case 0:return r*t;case 1001:return numeric.sdotVV(r,t);case 2001:return numeric.sdotMV(r,t);case 1002:return numeric.sdotVM(r,t);case 2002:return numeric.sdotMM(r,t);default:throw new Error("numeric.sdot not implemented for tensors of order "+n+" and "+e)}},numeric.sscatter=function(r){var t,n,e,i,o=r[0].length,a=r.length,s=[];for(n=o-1;n>=0;--n)if(r[a-1][n]){for(i=s,e=0;a-2>e;e++)t=r[e][n],i[t]||(i[t]=[]),i=i[t];i[r[e][n]]=r[e+1][n]}return s},numeric.sgather=function c(r,t,n){"undefined"==typeof t&&(t=[]),"undefined"==typeof n&&(n=[]);var e,i,o;e=n.length;for(i in r)if(r.hasOwnProperty(i))if(n[e]=parseInt(i),o=r[i],"number"==typeof o){if(o){if(0===t.length)for(i=e+1;i>=0;--i)t[i]=[];for(i=e;i>=0;--i)t[i].push(n[i]);t[e+1].push(o)}}else c(o,t,n);return n.length>e&&n.pop(),t},numeric.cLU=function(r){var t,n,e,i,o,a,s=r[0],u=r[1],f=r[2],c=s.length,h=0;for(t=0;c>t;t++)s[t]>h&&(h=s[t]);h++;var m,l,p,d=Array(h),g=Array(h),v=numeric.rep([h],1/0),y=numeric.rep([h],-1/0);for(e=0;c>e;e++)t=s[e],n=u[e],n<v[t]&&(v[t]=n),n>y[t]&&(y[t]=n);for(t=0;h-1>t;t++)y[t]>y[t+1]&&(y[t+1]=y[t]);for(t=h-1;t>=1;t--)v[t]<v[t-1]&&(v[t-1]=v[t]);var w=0,x=0;for(t=0;h>t;t++)g[t]=numeric.rep([y[t]-v[t]+1],0),d[t]=numeric.rep([t-v[t]],0),w+=t-v[t]+1,x+=y[t]-t+1;for(e=0;c>e;e++)t=s[e],g[t][u[e]-v[t]]=f[e];for(t=0;h-1>t;t++)for(i=t-v[t],m=g[t],n=t+1;v[n]<=t&&h>n;n++)if(o=t-v[n],a=y[t]-t,l=g[n],p=l[o]/m[i]){for(e=1;a>=e;e++)l[e+o]-=p*m[e+i];d[n][t-v[n]]=p}var c,M,b,m=[],l=[],k=[],A=[],S=[],j=[];for(c=0,M=0,t=0;h>t;t++){for(i=v[t],o=y[t],b=g[t],n=t;o>=n;n++)b[n-i]&&(m[c]=t,l[c]=n,k[c]=b[n-i],c++);for(b=d[t],n=i;t>n;n++)b[n-i]&&(A[M]=t,S[M]=n,j[M]=b[n-i],M++);A[M]=t,S[M]=t,j[M]=1,M++}return{U:[m,l,k],L:[A,S,j]}},numeric.cLUsolve=function(r,t){var n,e,i=r.L,o=r.U,a=numeric.clone(t),s=i[0],u=i[1],f=i[2],c=o[0],h=o[1],m=o[2],l=c.length,p=(s.length,a.length);for(e=0,n=0;p>n;n++){for(;u[e]<n;)a[n]-=f[e]*a[u[e]],e++;e++}for(e=l-1,n=p-1;n>=0;n--){for(;h[e]>n;)a[n]-=m[e]*a[h[e]],e--;a[n]/=m[e],e--}return a},numeric.cgrid=function(r,t){"number"==typeof r&&(r=[r,r]);var n,e,i,o=numeric.rep(r,-1);if("function"!=typeof t)switch(t){case"L":t=function(t,n){return t>=r[0]/2||n<r[1]/2};break;default:t=function(){return!0}}for(i=0,n=1;n<r[0]-1;n++)for(e=1;e<r[1]-1;e++)t(n,e)&&(o[n][e]=i,i++);return o},numeric.cdelsq=function(r){var t,n,e,i,o,a=[[-1,0],[0,-1],[0,1],[1,0]],s=numeric.dim(r),u=s[0],f=s[1],c=[],h=[],m=[];for(t=1;u-1>t;t++)for(n=1;f-1>n;n++)if(!(r[t][n]<0)){for(e=0;4>e;e++)i=t+a[e][0],o=n+a[e][1],r[i][o]<0||(c.push(r[t][n]),h.push(r[i][o]),m.push(-1));c.push(r[t][n]),h.push(r[t][n]),m.push(4)}return[c,h,m]},numeric.cdotMV=function(r,t){var n,e,i,o=r[0],a=r[1],s=r[2],u=o.length;for(i=0,e=0;u>e;e++)o[e]>i&&(i=o[e]);for(i++,n=numeric.rep([i],0),e=0;u>e;e++)n[o[e]]+=s[e]*t[a[e]];return n},numeric.Spline=function(r,t,n,e,i){this.x=r,this.yl=t,this.yr=n,this.kl=e,this.kr=i},numeric.Spline.prototype._at=function(r,t){var r,n,e,i,o=this.x,a=this.yl,s=this.yr,u=this.kl,f=this.kr,c=numeric.add,h=numeric.sub,m=numeric.mul;n=h(m(u[t],o[t+1]-o[t]),h(s[t+1],a[t])),e=c(m(f[t+1],o[t]-o[t+1]),h(s[t+1],a[t])),i=(r-o[t])/(o[t+1]-o[t]);var l=i*(1-i);return c(c(c(m(1-i,a[t]),m(i,s[t+1])),m(n,l*(1-i))),m(e,l*i))},numeric.Spline.prototype.at=function(r){if("number"==typeof r){var t,n,e,i=this.x,o=i.length,a=Math.floor;for(t=0,n=o-1;n-t>1;)e=a((t+n)/2),i[e]<=r?t=e:n=e;return this._at(r,t)}var s,o=r.length,u=Array(o);for(s=o-1;-1!==s;--s)u[s]=this.at(r[s]);return u},numeric.Spline.prototype.diff=function(){var r,t,n,e=this.x,i=this.yl,o=this.yr,a=this.kl,s=this.kr,u=i.length,f=a,c=s,h=Array(u),m=Array(u),l=numeric.add,p=numeric.mul,d=numeric.div,g=numeric.sub;for(r=u-1;-1!==r;--r)t=e[r+1]-e[r],n=g(o[r+1],i[r]),h[r]=d(l(p(n,6),p(a[r],-4*t),p(s[r+1],-2*t)),t*t),m[r+1]=d(l(p(n,-6),p(a[r],2*t),p(s[r+1],4*t)),t*t);return new numeric.Spline(e,f,c,h,m)},numeric.Spline.prototype.roots=function(){function r(r){return r*r}var t=[],n=this.x,e=this.yl,i=this.yr,o=this.kl,a=this.kr;"number"==typeof e[0]&&(e=[e],i=[i],o=[o],a=[a]);var s,u,f,c,h,m,l,p,d,g,v,y,w,x,M,b,k,A,S,j,q,T,V,D,O=e.length,R=n.length-1,t=Array(O),_=Math.sqrt;for(s=0;s!==O;++s){for(c=e[s],h=i[s],m=o[s],l=a[s],p=[],u=0;u!==R;u++){for(u>0&&h[u]*c[u]<0&&p.push(n[u]),b=n[u+1]-n[u],k=n[u],v=c[u],y=h[u+1],d=m[u]/b,g=l[u+1]/b,M=r(d-g+3*(v-y))+12*g*v,w=g+3*v+2*d-3*y,x=3*(g+d+2*(v-y)),0>=M?(S=w/x,A=S>n[u]&&S<n[u+1]?[n[u],S,n[u+1]]:[n[u],n[u+1]]):(S=(w-_(M))/x,j=(w+_(M))/x,A=[n[u]],S>n[u]&&S<n[u+1]&&A.push(S),j>n[u]&&j<n[u+1]&&A.push(j),A.push(n[u+1])),T=A[0],S=this._at(T,u),f=0;f<A.length-1;f++)if(V=A[f+1],j=this._at(V,u),0!==S)if(0===j||S*j>0)T=V,S=j;else{for(var z=0;;){if(D=(S*V-j*T)/(S-j),T>=D||D>=V)break;if(q=this._at(D,u),q*j>0)V=D,j=q,-1===z&&(S*=.5),z=-1;else{if(!(q*S>0))break;T=D,S=q,1===z&&(j*=.5),z=1}}p.push(D),T=A[f+1],S=this._at(T,u)}else p.push(T),T=V,S=j;0===j&&p.push(V)}t[s]=p}return"number"==typeof this.yl[0]?t[0]:t},numeric.spline=function(r,t,n,e){var i,o=r.length,a=[],s=[],u=[],f=numeric.sub,c=numeric.mul,h=numeric.add;for(i=o-2;i>=0;i--)s[i]=r[i+1]-r[i],u[i]=f(t[i+1],t[i]);("string"==typeof n||"string"==typeof e)&&(n=e="periodic");var m=[[],[],[]];switch(typeof n){case"undefined":a[0]=c(3/(s[0]*s[0]),u[0]),m[0].push(0,0),m[1].push(0,1),m[2].push(2/s[0],1/s[0]);break;case"string":a[0]=h(c(3/(s[o-2]*s[o-2]),u[o-2]),c(3/(s[0]*s[0]),u[0])),m[0].push(0,0,0),m[1].push(o-2,0,1),m[2].push(1/s[o-2],2/s[o-2]+2/s[0],1/s[0]);break;default:a[0]=n,m[0].push(0),m[1].push(0),m[2].push(1)}for(i=1;o-1>i;i++)a[i]=h(c(3/(s[i-1]*s[i-1]),u[i-1]),c(3/(s[i]*s[i]),u[i])),m[0].push(i,i,i),m[1].push(i-1,i,i+1),m[2].push(1/s[i-1],2/s[i-1]+2/s[i],1/s[i]);switch(typeof e){case"undefined":a[o-1]=c(3/(s[o-2]*s[o-2]),u[o-2]),m[0].push(o-1,o-1),m[1].push(o-2,o-1),m[2].push(1/s[o-2],2/s[o-2]);break;case"string":m[1][m[1].length-1]=0;break;default:a[o-1]=e,m[0].push(o-1),m[1].push(o-1),m[2].push(1)}a="number"!=typeof a[0]?numeric.transpose(a):[a];var l=Array(a.length);if("string"==typeof n)for(i=l.length-1;-1!==i;--i)l[i]=numeric.ccsLUPSolve(numeric.ccsLUP(numeric.ccsScatter(m)),a[i]),l[i][o-1]=l[i][0];else for(i=l.length-1;-1!==i;--i)l[i]=numeric.cLUsolve(numeric.cLU(m),a[i]);return l="number"==typeof t[0]?l[0]:numeric.transpose(l),new numeric.Spline(r,t,t,l,l)},numeric.fftpow2=function h(r,t){var n=r.length;if(1!==n){var e,i,o=Math.cos,a=Math.sin,s=Array(n/2),u=Array(n/2),f=Array(n/2),c=Array(n/2);for(i=n/2,e=n-1;-1!==e;--e)--i,f[i]=r[e],c[i]=t[e],--e,s[i]=r[e],u[i]=t[e];h(s,u),h(f,c),i=n/2;var m,l,p,d=-6.283185307179586/n;for(e=n-1;-1!==e;--e)--i,-1===i&&(i=n/2-1),m=d*e,l=o(m),p=a(m),r[e]=s[i]+l*f[i]-p*c[i],t[e]=u[i]+l*c[i]+p*f[i]}},numeric._ifftpow2=function m(r,t){var n=r.length;if(1!==n){var e,i,o=Math.cos,a=Math.sin,s=Array(n/2),u=Array(n/2),f=Array(n/2),c=Array(n/2);for(i=n/2,e=n-1;-1!==e;--e)--i,f[i]=r[e],c[i]=t[e],--e,s[i]=r[e],u[i]=t[e];m(s,u),m(f,c),i=n/2;var h,l,p,d=6.283185307179586/n;for(e=n-1;-1!==e;--e)--i,-1===i&&(i=n/2-1),h=d*e,l=o(h),p=a(h),r[e]=s[i]+l*f[i]-p*c[i],t[e]=u[i]+l*c[i]+p*f[i]}},numeric.ifftpow2=function(r,t){numeric._ifftpow2(r,t),numeric.diveq(r,r.length),numeric.diveq(t,t.length)},numeric.convpow2=function(r,t,n,e){numeric.fftpow2(r,t),numeric.fftpow2(n,e);var i,o,a,s,u,f=r.length;for(i=f-1;-1!==i;--i)o=r[i],s=t[i],a=n[i],u=e[i],r[i]=o*a-s*u,t[i]=o*u+s*a;numeric.ifftpow2(r,t)},numeric.T.prototype.fft=function(){{var r,t,n=this.x,e=this.y,i=n.length,o=Math.log,a=o(2),s=Math.ceil(o(2*i-1)/a),u=Math.pow(2,s),f=numeric.rep([u],0),c=numeric.rep([u],0),h=Math.cos,m=Math.sin,l=-3.141592653589793/i,p=numeric.rep([u],0),d=numeric.rep([u],0);Math.floor(i/2)}for(r=0;i>r;r++)p[r]=n[r];if("undefined"!=typeof e)for(r=0;i>r;r++)d[r]=e[r];for(f[0]=1,r=1;u/2>=r;r++)t=l*r*r,f[r]=h(t),c[r]=m(t),f[u-r]=h(t),c[u-r]=m(t);var g=new numeric.T(p,d),v=new numeric.T(f,c);return g=g.mul(v),numeric.convpow2(g.x,g.y,numeric.clone(v.x),numeric.neg(v.y)),g=g.mul(v),g.x.length=i,g.y.length=i,g},numeric.T.prototype.ifft=function(){{var r,t,n=this.x,e=this.y,i=n.length,o=Math.log,a=o(2),s=Math.ceil(o(2*i-1)/a),u=Math.pow(2,s),f=numeric.rep([u],0),c=numeric.rep([u],0),h=Math.cos,m=Math.sin,l=3.141592653589793/i,p=numeric.rep([u],0),d=numeric.rep([u],0);Math.floor(i/2)}for(r=0;i>r;r++)p[r]=n[r];if("undefined"!=typeof e)for(r=0;i>r;r++)d[r]=e[r];for(f[0]=1,r=1;u/2>=r;r++)t=l*r*r,f[r]=h(t),c[r]=m(t),f[u-r]=h(t),c[u-r]=m(t);var g=new numeric.T(p,d),v=new numeric.T(f,c);return g=g.mul(v),numeric.convpow2(g.x,g.y,numeric.clone(v.x),numeric.neg(v.y)),g=g.mul(v),g.x.length=i,g.y.length=i,g.div(i)},numeric.gradient=function(r,t){var n=t.length,e=r(t);if(isNaN(e))throw new Error("gradient: f(x) is a NaN!");var i,o,a,s,u,f,c,h,m,l,p=Math.max,d=numeric.clone(t),g=Array(n),p=(numeric.div,numeric.sub,Math.max),v=.001,y=Math.abs,w=Math.min,x=0;for(i=0;n>i;i++)for(var M=p(1e-6*e,1e-8);;){if(++x,x>20)throw new Error("Numerical gradient fails");if(d[i]=t[i]+M,o=r(d),d[i]=t[i]-M,a=r(d),d[i]=t[i],isNaN(o)||isNaN(a))M/=16;else{if(g[i]=(o-a)/(2*M),u=t[i]-M,f=t[i],c=t[i]+M,h=(o-e)/M,m=(e-a)/M,l=p(y(g[i]),y(e),y(o),y(a),y(u),y(f),y(c),1e-8),s=w(p(y(h-g[i]),y(m-g[i]),y(h-m))/l,M/l),!(s>v))break;M/=16}}return g},numeric.uncmin=function(r,t,n,e,i,o,a){var s=numeric.gradient;"undefined"==typeof a&&(a={}),"undefined"==typeof n&&(n=1e-8),"undefined"==typeof e&&(e=function(t){return s(r,t)}),"undefined"==typeof i&&(i=1e3),t=numeric.clone(t);var u,f,c=t.length,h=r(t);if(isNaN(h))throw new Error("uncmin: f(x0) is a NaN!");var m=Math.max,l=numeric.norm2;n=m(n,numeric.epsilon);var p,d,g,v,y,w,x,M,b,k,A=a.Hinv||numeric.identity(c),S=numeric.dot,j=(numeric.inv,numeric.sub),q=numeric.add,T=numeric.tensor,V=numeric.div,D=numeric.mul,O=numeric.all,R=numeric.isFinite,_=numeric.neg,z=0,C="";for(d=e(t);i>z;){if("function"==typeof o&&o(z,t,h,d,A)){C="Callback returned true";break}if(!O(R(d))){C="Gradient has Infinity or NaN";break}if(p=_(S(A,d)),!O(R(p))){C="Search direction has Infinity or NaN";break}if(k=l(p),n>k){C="Newton step smaller than tol";break}for(b=1,f=S(d,p),y=t;i>z&&!(n>b*k)&&(v=D(p,b),y=q(t,v),u=r(y),u-h>=.1*b*f||isNaN(u));)b*=.5,++z;if(n>b*k){C="Line search step size smaller than tol";break}if(z===i){C="maxit reached during line search";break}g=e(y),w=j(g,d),M=S(w,v),x=S(A,w),A=j(q(A,D((M+S(w,x))/(M*M),T(v,v))),V(q(T(x,v),T(v,x)),M)),t=y,h=u,d=g,++z}return{solution:t,f:h,gradient:d,invHessian:A,iterations:z,message:C}},numeric.Dopri=function(r,t,n,e,i,o,a){this.x=r,this.y=t,this.f=n,this.ymid=e,this.iterations=i,this.events=a,this.message=o},numeric.Dopri.prototype._at=function(r,t){function n(r){return r*r}var e,i,o,a,s,u,r,f,c,h,m,l=this,p=l.x,d=l.y,g=l.f,v=l.ymid,y=(p.length,Math.floor,.5),w=numeric.add,x=numeric.mul,M=numeric.sub;return e=p[t],i=p[t+1],a=d[t],s=d[t+1],f=i-e,o=e+y*f,u=v[t],c=M(g[t],x(a,1/(e-o)+2/(e-i))),h=M(g[t+1],x(s,1/(i-o)+2/(i-e))),m=[n(r-i)*(r-o)/n(e-i)/(e-o),n(r-e)*n(r-i)/n(e-o)/n(i-o),n(r-e)*(r-o)/n(i-e)/(i-o),(r-e)*n(r-i)*(r-o)/n(e-i)/(e-o),(r-i)*n(r-e)*(r-o)/n(e-i)/(i-o)],w(w(w(w(x(a,m[0]),x(u,m[1])),x(s,m[2])),x(c,m[3])),x(h,m[4]))},numeric.Dopri.prototype.at=function(r){var t,n,e,i=Math.floor;if("number"!=typeof r){var o=r.length,a=Array(o);for(t=o-1;-1!==t;--t)a[t]=this.at(r[t]);return a}var s=this.x;for(t=0,n=s.length-1;n-t>1;)e=i(.5*(t+n)),s[e]<=r?t=e:n=e;return this._at(r,t)},numeric.dopri=function(r,t,n,e,i,o,a){"undefined"==typeof i&&(i=1e-6),"undefined"==typeof o&&(o=1e3);var s,u,f,c,h,m,l,p,d,g,v,y,w,x=[r],M=[n],b=[e(r,n)],k=[],A=.2,S=[.075,.225],j=[44/45,-56/15,32/9],q=[19372/6561,-25360/2187,64448/6561,-212/729],T=[9017/3168,-355/33,46732/5247,49/176,-5103/18656],V=[35/384,0,500/1113,125/192,-2187/6784,11/84],D=[.10013431883002395,0,.3918321794184259,-0.02982460176594817,.05893268337240795,-0.04497888809104361,.023904308236133973],O=[.2,.3,.8,8/9,1,1],R=[-71/57600,0,71/16695,-71/1920,17253/339200,-22/525,.025],_=0,z=(t-r)/10,C=0,P=numeric.add,E=numeric.mul,N=(Math.max,Math.min),L=Math.abs,I=numeric.norminf,U=Math.pow,F=numeric.any,B=numeric.lt,X=numeric.and,Q=(numeric.sub,new numeric.Dopri(x,M,b,k,-1,""));for("function"==typeof a&&(v=a(r,n));t>r&&o>C;)if(++C,r+z>t&&(z=t-r),s=e(r+O[0]*z,P(n,E(A*z,b[_]))),u=e(r+O[1]*z,P(P(n,E(S[0]*z,b[_])),E(S[1]*z,s))),f=e(r+O[2]*z,P(P(P(n,E(j[0]*z,b[_])),E(j[1]*z,s)),E(j[2]*z,u))),c=e(r+O[3]*z,P(P(P(P(n,E(q[0]*z,b[_])),E(q[1]*z,s)),E(q[2]*z,u)),E(q[3]*z,f))),h=e(r+O[4]*z,P(P(P(P(P(n,E(T[0]*z,b[_])),E(T[1]*z,s)),E(T[2]*z,u)),E(T[3]*z,f)),E(T[4]*z,c))),d=P(P(P(P(P(n,E(b[_],z*V[0])),E(u,z*V[2])),E(f,z*V[3])),E(c,z*V[4])),E(h,z*V[5])),m=e(r+z,d),l=P(P(P(P(P(E(b[_],z*R[0]),E(u,z*R[2])),E(f,z*R[3])),E(c,z*R[4])),E(h,z*R[5])),E(m,z*R[6])),g="number"==typeof l?L(l):I(l),g>i){if(z=.2*z*U(i/g,.25),r+z===r){Q.msg="Step size became too small";break}}else{if(k[_]=P(P(P(P(P(P(n,E(b[_],z*D[0])),E(u,z*D[2])),E(f,z*D[3])),E(c,z*D[4])),E(h,z*D[5])),E(m,z*D[6])),++_,x[_]=r+z,M[_]=d,b[_]=m,"function"==typeof a){var W,Y,H=r,Z=r+.5*z;if(y=a(Z,k[_-1]),w=X(B(v,0),B(0,y)),F(w)||(H=Z,Z=r+z,v=y,y=a(Z,d),w=X(B(v,0),B(0,y))),F(w)){for(var G,J,K=0,$=1,rt=1;;){if("number"==typeof v)Y=(rt*y*H-$*v*Z)/(rt*y-$*v);else for(Y=Z,p=v.length-1;-1!==p;--p)v[p]<0&&y[p]>0&&(Y=N(Y,(rt*y[p]*H-$*v[p]*Z)/(rt*y[p]-$*v[p])));if(H>=Y||Y>=Z)break;W=Q._at(Y,_-1),J=a(Y,W),G=X(B(v,0),B(0,J)),F(G)?(Z=Y,y=J,w=G,rt=1,-1===K?$*=.5:$=1,K=-1):(H=Y,v=J,$=1,1===K?rt*=.5:rt=1,K=1)}return d=Q._at(.5*(r+Y),_-1),Q.f[_]=e(Y,W),Q.x[_]=Y,Q.y[_]=W,Q.ymid[_-1]=d,Q.events=w,Q.iterations=C,Q}}r+=z,n=d,v=y,z=N(.8*z*U(i/g,.25),4*z)}return Q.iterations=C,Q},numeric.LU=function(r,t){t=t||!1;var n,e,i,o,a,s,u,f,c,h=Math.abs,m=r.length,l=m-1,p=new Array(m);for(t||(r=numeric.clone(r)),i=0;m>i;++i){for(u=i,s=r[i],c=h(s[i]),e=i+1;m>e;++e)o=h(r[e][i]),o>c&&(c=o,u=e);for(p[i]=u,u!=i&&(r[i]=r[u],r[u]=s,s=r[i]),a=s[i],n=i+1;m>n;++n)r[n][i]/=a;for(n=i+1;m>n;++n){for(f=r[n],e=i+1;l>e;++e)f[e]-=f[i]*s[e],++e,f[e]-=f[i]*s[e];e===l&&(f[e]-=f[i]*s[e])}}return{LU:r,P:p}},numeric.LUsolve=function(r,t){var n,e,i,o,a,s=r.LU,u=s.length,f=numeric.clone(t),c=r.P;for(n=u-1;-1!==n;--n)f[n]=t[n];for(n=0;u>n;++n)for(i=c[n],c[n]!==n&&(a=f[n],f[n]=f[i],f[i]=a),o=s[n],e=0;n>e;++e)f[n]-=f[e]*o[e];for(n=u-1;n>=0;--n){for(o=s[n],e=n+1;u>e;++e)f[n]-=f[e]*o[e];f[n]/=o[n]}return f},numeric.solve=function(r,t,n){return numeric.LUsolve(numeric.LU(r,n),t)},numeric.echelonize=function(r){var t,n,e,i,o,a,s,u,f=numeric.dim(r),c=f[0],h=f[1],m=numeric.identity(c),l=Array(c),p=Math.abs,d=numeric.diveq;for(r=numeric.clone(r),t=0;c>t;++t){for(e=0,o=r[t],a=m[t],n=1;h>n;++n)p(o[e])<p(o[n])&&(e=n);for(l[t]=e,d(a,o[e]),d(o,o[e]),n=0;c>n;++n)if(n!==t){for(s=r[n],u=s[e],i=h-1;-1!==i;--i)s[i]-=o[i]*u;for(s=m[n],i=c-1;-1!==i;--i)s[i]-=a[i]*u}}return{I:m,A:r,P:l}},numeric.__solveLP=function(r,t,n,e,i,o,a){var s,u,f,c,h=numeric.sum,m=(numeric.log,numeric.mul),l=numeric.sub,p=numeric.dot,d=numeric.div,g=numeric.add,v=r.length,y=n.length,w=!1,x=0,M=1,b=(numeric.transpose(t),numeric.svd,numeric.transpose),k=(numeric.leq,Math.sqrt),A=Math.abs,S=(numeric.muleq,numeric.norminf,numeric.any,Math.min),j=numeric.all,q=numeric.gt,T=Array(v),V=Array(y),D=(numeric.rep([y],1),numeric.solve),O=l(n,p(t,o)),R=p(r,r);for(f=x;i>f;++f){var _,z;for(_=y-1;-1!==_;--_)V[_]=d(t[_],O[_]);var C=b(V);for(_=v-1;-1!==_;--_)T[_]=h(C[_]);M=.25*A(R/p(r,T));var P=100*k(R/p(T,T));for((!isFinite(M)||M>P)&&(M=P),c=g(r,m(M,T)),u=p(C,V),_=v-1;-1!==_;--_)u[_][_]+=1;z=D(u,d(c,M),!0);var E=d(O,p(t,z)),N=1;for(_=y-1;-1!==_;--_)E[_]<0&&(N=S(N,-.999*E[_]));if(s=l(o,m(z,N)),O=l(n,p(t,s)),!j(q(O,0)))return{solution:o,message:"",iterations:f};if(o=s,e>M)return{solution:s,message:"",iterations:f};if(a){var L=p(r,c),I=p(t,c);for(w=!0,_=y-1;-1!==_;--_)if(L*I[_]<0){w=!1;break}}else w=o[v-1]>=0?!1:!0;if(w)return{solution:s,message:"Unbounded",iterations:f}}return{solution:o,message:"maximum iteration count exceeded",iterations:f}},numeric._solveLP=function(r,t,n,e,i){var o,a=r.length,s=n.length,u=(numeric.sum,numeric.log,numeric.mul,numeric.sub),f=numeric.dot,c=(numeric.div,numeric.add,numeric.rep([a],0).concat([1])),h=numeric.rep([s,1],-1),m=numeric.blockMatrix([[t,h]]),l=n,o=numeric.rep([a],0).concat(Math.max(0,numeric.sup(numeric.neg(n)))+1),p=numeric.__solveLP(c,m,l,e,i,o,!1),d=numeric.clone(p.solution);d.length=a;var g=numeric.inf(u(n,f(t,d)));if(0>g)return{solution:0/0,message:"Infeasible",iterations:p.iterations};var v=numeric.__solveLP(r,t,n,e,i-p.iterations,d,!0);return v.iterations+=p.iterations,v},numeric.solveLP=function(r,t,n,e,i,o,a){if("undefined"==typeof a&&(a=1e3),"undefined"==typeof o&&(o=numeric.epsilon),"undefined"==typeof e)return numeric._solveLP(r,t,n,o,a);var s,u=e.length,f=e[0].length,c=t.length,h=numeric.echelonize(e),m=numeric.rep([f],0),l=h.P,p=[];for(s=l.length-1;-1!==s;--s)m[l[s]]=1;for(s=f-1;-1!==s;--s)0===m[s]&&p.push(s);var d=numeric.getRange,g=numeric.linspace(0,u-1),v=numeric.linspace(0,c-1),y=d(e,g,p),w=d(t,v,l),x=d(t,v,p),M=numeric.dot,b=numeric.sub,k=M(w,h.I),A=b(x,M(k,y)),S=b(n,M(k,i)),j=Array(l.length),q=Array(p.length);for(s=l.length-1;-1!==s;--s)j[s]=r[l[s]];for(s=p.length-1;-1!==s;--s)q[s]=r[p[s]];var T=b(q,M(j,M(h.I,y))),V=numeric._solveLP(T,A,S,o,a),D=V.solution;if(D!==D)return V;var O=M(h.I,b(i,M(y,D))),R=Array(r.length);for(s=l.length-1;-1!==s;--s)R[l[s]]=O[s];for(s=p.length-1;-1!==s;--s)R[p[s]]=D[s];return{solution:R,message:V.message,iterations:V.iterations}},numeric.MPStoLP=function(r){function t(t){throw new Error("MPStoLP: "+t+"\nLine "+n+": "+r[n]+"\nCurrent state: "+s[a]+"\n")}r instanceof String&&r.split("\n");var n,e,i,o,a=0,s=["Initial state","NAME","ROWS","COLUMNS","RHS","BOUNDS","ENDATA"],u=r.length,f=0,c={},h=[],m=0,l={},p=0,d=[],g=[],v=[];for(n=0;u>n;++n){i=r[n];var y=i.match(/\S*/g),w=[];for(e=0;e<y.length;++e)""!==y[e]&&w.push(y[e]);if(0!==w.length){for(e=0;e<s.length&&i.substr(0,s[e].length)!==s[e];++e);if(e<s.length){if(a=e,1===e&&(o=w[1]),6===e)return{name:o,c:d,A:numeric.transpose(g),b:v,rows:c,vars:l}}else switch(a){case 0:case 1:t("Unexpected line");case 2:switch(w[0]){case"N":0===f?f=w[1]:t("Two or more N rows");break;case"L":c[w[1]]=m,h[m]=1,v[m]=0,++m;break;case"G":c[w[1]]=m,h[m]=-1,v[m]=0,++m;break;case"E":c[w[1]]=m,h[m]=0,v[m]=0,++m;break;default:t("Parse error "+numeric.prettyPrint(w))}break;case 3:l.hasOwnProperty(w[0])||(l[w[0]]=p,d[p]=0,g[p]=numeric.rep([m],0),++p);var x=l[w[0]];for(e=1;e<w.length;e+=2)if(w[e]!==f){var M=c[w[e]];g[x][M]=(h[M]<0?-1:1)*parseFloat(w[e+1])}else d[x]=parseFloat(w[e+1]);break;case 4:for(e=1;e<w.length;e+=2)v[c[w[e]]]=(h[c[w[e]]]<0?-1:1)*parseFloat(w[e+1]);break;case 5:break;case 6:t("Internal error")}}}t("Reached end of file without ENDATA")},numeric.seedrandom={pow:Math.pow,random:Math.random},function(r,t,n,e,i,o,a){function s(r){var t,e,i=this,o=r.length,a=0,s=i.i=i.j=i.m=0;for(i.S=[],i.c=[],o||(r=[o++]);n>a;)i.S[a]=a++;for(a=0;n>a;a++)t=i.S[a],s=c(s+t+r[a%o]),e=i.S[s],i.S[a]=e,i.S[s]=t;i.g=function(r){var t=i.S,e=c(i.i+1),o=t[e],a=c(i.j+o),s=t[a];t[e]=s,t[a]=o;for(var u=t[c(o+s)];--r;)e=c(e+1),o=t[e],a=c(a+o),s=t[a],t[e]=s,t[a]=o,u=u*n+t[c(o+s)];return i.i=e,i.j=a,u},i.g(n)}function u(r,t,n,e,i){if(n=[],i=typeof r,t&&"object"==i)for(e in r)if(e.indexOf("S")<5)try{n.push(u(r[e],t-1))}catch(o){}return n.length?n:r+("string"!=i?"\x00":"")}function f(r,t,n,e){for(r+="",n=0,e=0;e<r.length;e++)t[c(e)]=c((n^=19*t[c(e)])+r.charCodeAt(e));r="";for(e in t)r+=String.fromCharCode(t[e]);return r}function c(r){return r&n-1}t.seedrandom=function(c,h){var m,l=[];return c=f(u(h?[c,r]:arguments.length?c:[(new Date).getTime(),r,window],3),l),m=new s(l),f(m.S,r),t.random=function(){for(var r=m.g(e),t=a,s=0;i>r;)r=(r+s)*n,t*=n,s=m.g(1);for(;r>=o;)r/=2,t/=2,s>>>=1;return(r+s)/t},c},a=t.pow(n,e),i=t.pow(2,i),o=2*i,f(t.random(),r)}([],numeric.seedrandom,256,6,52),function(r){function t(r){if("object"!=typeof r)return r;var n,e=[],i=r.length;for(n=0;i>n;n++)e[n+1]=t(r[n]);return e}function n(r){if("object"!=typeof r)return r;var t,e=[],i=r.length;for(t=1;i>t;t++)e[t-1]=n(r[t]);return e}function e(r,t,n){var e,i,o,a,s;for(o=1;n>=o;o+=1){for(r[o][o]=1/r[o][o],s=-r[o][o],e=1;o>e;e+=1)r[e][o]=s*r[e][o];if(a=o+1,a>n)break;for(i=a;n>=i;i+=1)for(s=r[o][i],r[o][i]=0,e=1;o>=e;e+=1)r[e][i]=r[e][i]+s*r[e][o]}}function i(r,t,n,e){var i,o,a,s;for(o=1;n>=o;o+=1){for(s=0,i=1;o>i;i+=1)s+=r[i][o]*e[i];e[o]=(e[o]-s)/r[o][o]}for(a=1;n>=a;a+=1)for(o=n+1-a,e[o]=e[o]/r[o][o],s=-e[o],i=1;o>i;i+=1)e[i]=e[i]+s*r[i][o]}function o(r,t,n,e){var i,o,a,s,u,f;for(o=1;n>=o;o+=1){if(e[1]=o,f=0,a=o-1,1>a){if(f=r[o][o]-f,0>=f)break;r[o][o]=Math.sqrt(f)}else{for(s=1;a>=s;s+=1){for(u=r[s][o],i=1;s>i;i+=1)u-=r[i][o]*r[i][s];u/=r[s][s],r[s][o]=u,f+=u*u}if(f=r[o][o]-f,0>=f)break;r[o][o]=Math.sqrt(f)}e[1]=0}}function a(r,t,n,a,s,u,f,c,h,m,l,p,d,g,v,y){function w(){for(g[1]=g[1]+1,j=_,A=1;m>=A;A+=1){for(j+=1,L=-c[A],S=1;a>=S;S+=1)L+=f[S][A]*s[S];if(Math.abs(L)<Y&&(L=0),A>l)v[j]=L;else if(v[j]=-Math.abs(L),L>0){for(S=1;a>=S;S+=1)f[S][A]=-f[S][A];c[A]=-c[A]}}for(A=1;d>=A;A+=1)v[_+p[A]]=0;for(C=0,N=0,A=1;m>=A;A+=1)v[_+A]<N*v[E+A]&&(C=A,N=v[_+A]/v[E+A]);return 0===C?999:0}function x(){for(A=1;a>=A;A+=1){for(L=0,S=1;a>=S;S+=1)L+=r[S][A]*f[S][C];v[A]=L}for(q=D,A=1;a>=A;A+=1)v[q+A]=0;for(S=d+1;a>=S;S+=1)for(A=1;a>=A;A+=1)v[q+A]=v[q+A]+r[A][S]*v[S];for(Q=!0,A=d;A>=1;A-=1){for(L=v[A],j=R+A*(A+3)/2,q=j-A,S=A+1;d>=S;S+=1)L-=v[j]*v[O+S],j+=S;if(L/=v[q],v[O+A]=L,p[A]<l)break;if(0>L)break;Q=!1,V=A}if(!Q)for(I=v[z+V]/v[O+V],A=1;d>=A&&!(p[A]<l)&&!(v[O+A]<0);A+=1)N=v[z+A]/v[O+A],I>N&&(I=N,V=A);for(L=0,A=D+1;D+a>=A;A+=1)L+=v[A]*v[A];if(Math.abs(L)<=Y){if(Q)return y[1]=1,999;for(A=1;d>=A;A+=1)v[z+A]=v[z+A]-I*v[O+A];return v[z+d+1]=v[z+d+1]+I,700}for(L=0,A=1;a>=A;A+=1)L+=v[D+A]*f[A][C];for(U=-v[_+C]/L,W=!0,Q||U>I&&(U=I,W=!1),A=1;a>=A;A+=1)s[A]=s[A]+U*v[D+A],Math.abs(s[A])<Y&&(s[A]=0);for(u[1]=u[1]+U*L*(U/2+v[z+d+1]),A=1;d>=A;A+=1)v[z+A]=v[z+A]-U*v[O+A];if(v[z+d+1]=v[z+d+1]+U,!W){for(L=-c[C],S=1;a>=S;S+=1)L+=s[S]*f[S][C];if(C>l)v[_+C]=L;else if(v[_+C]=-Math.abs(L),L>0){for(S=1;a>=S;S+=1)f[S][C]=-f[S][C];c[C]=-c[C]}return 700}for(d+=1,p[d]=C,j=R+(d-1)*d/2+1,A=1;d-1>=A;A+=1)v[j]=v[A],j+=1;if(d===a)v[j]=v[a];else{for(A=a;A>=d+1&&0!==v[A]&&(F=Math.max(Math.abs(v[A-1]),Math.abs(v[A])),B=Math.min(Math.abs(v[A-1]),Math.abs(v[A])),N=v[A-1]>=0?Math.abs(F*Math.sqrt(1+B*B/(F*F))):-Math.abs(F*Math.sqrt(1+B*B/(F*F))),F=v[A-1]/N,B=v[A]/N,1!==F);A-=1)if(0===F)for(v[A-1]=B*N,S=1;a>=S;S+=1)N=r[S][A-1],r[S][A-1]=r[S][A],r[S][A]=N;else for(v[A-1]=N,X=B/(1+F),S=1;a>=S;S+=1)N=F*r[S][A-1]+B*r[S][A],r[S][A]=X*(r[S][A-1]+N)-r[S][A],r[S][A-1]=N;v[j]=v[d]}return 0}function M(){if(j=R+V*(V+1)/2+1,q=j+V,0===v[q])return 798;if(F=Math.max(Math.abs(v[q-1]),Math.abs(v[q])),B=Math.min(Math.abs(v[q-1]),Math.abs(v[q])),N=v[q-1]>=0?Math.abs(F*Math.sqrt(1+B*B/(F*F))):-Math.abs(F*Math.sqrt(1+B*B/(F*F))),F=v[q-1]/N,B=v[q]/N,1===F)return 798;if(0===F){for(A=V+1;d>=A;A+=1)N=v[q-1],v[q-1]=v[q],v[q]=N,q+=A;for(A=1;a>=A;A+=1)N=r[A][V],r[A][V]=r[A][V+1],r[A][V+1]=N}else{for(X=B/(1+F),A=V+1;d>=A;A+=1)N=F*v[q-1]+B*v[q],v[q]=X*(v[q-1]+N)-v[q],v[q-1]=N,q+=A;for(A=1;a>=A;A+=1)N=F*r[A][V]+B*r[A][V+1],r[A][V+1]=X*(r[A][V]+N)-r[A][V+1],r[A][V]=N}return 0}function b(){for(q=j-V,A=1;V>=A;A+=1)v[q]=v[j],j+=1,q+=1;return v[z+V]=v[z+V+1],p[V]=p[V+1],V+=1,d>V?797:0}function k(){return v[z+d]=v[z+d+1],v[z+d+1]=0,p[d]=0,d-=1,g[2]=g[2]+1,0}var A,S,j,q,T,V,D,O,R,_,z,C,P,E,N,L,I,U,F,B,X,Q,W,Y,H,Z,G;P=Math.min(a,m),j=2*a+P*(P+5)/2+2*m+1,Y=1e-60;do Y+=Y,H=1+.1*Y,Z=1+.2*Y;while(1>=H||1>=Z);for(A=1;a>=A;A+=1)v[A]=t[A];for(A=a+1;j>=A;A+=1)v[A]=0;for(A=1;m>=A;A+=1)p[A]=0;if(T=[],0===y[1]){if(o(r,n,a,T),0!==T[1])return void(y[1]=2);i(r,n,a,t),e(r,n,a)}else{for(S=1;a>=S;S+=1)for(s[S]=0,A=1;S>=A;A+=1)s[S]=s[S]+r[A][S]*t[A];for(S=1;a>=S;S+=1)for(t[S]=0,A=S;a>=A;A+=1)t[S]=t[S]+r[S][A]*s[A]}for(u[1]=0,S=1;a>=S;S+=1)for(s[S]=t[S],u[1]=u[1]+v[S]*s[S],v[S]=0,A=S+1;a>=A;A+=1)r[A][S]=0;for(u[1]=-u[1]/2,y[1]=0,D=a,O=D+a,z=O+P,R=z+P+1,_=R+P*(P+1)/2,E=_+m,A=1;m>=A;A+=1){for(L=0,S=1;a>=S;S+=1)L+=f[S][A]*f[S][A];v[E+A]=Math.sqrt(L)}for(d=0,g[1]=0,g[2]=0,G=0;;){if(G=w(),999===G)return;for(;;){if(G=x(),0===G)break;if(999===G)return;if(700===G)if(V===d)k();else{for(;;)if(M(),G=b(),797!==G)break;k()}}}}function s(r,e,i,o,s,u){r=t(r),e=t(e),i=t(i);var f,c,h,m,l,p,d=[],g=[],v=[],y=[],w=[];if(s=s||0,u=u?t(u):[void 0,0],o=o?t(o):[],c=r.length-1,h=i[1].length-1,!o)for(f=1;h>=f;f+=1)o[f]=0;for(f=1;h>=f;f+=1)g[f]=0;for(m=0,l=Math.min(c,h),f=1;c>=f;f+=1)v[f]=0;for(d[1]=0,f=1;2*c+l*(l+5)/2+2*h+1>=f;f+=1)y[f]=0;for(f=1;2>=f;f+=1)w[f]=0;return a(r,e,c,c,v,d,i,o,c,h,s,g,m,w,y,u),p="",1===u[1]&&(p="constraints are inconsistent, no solution!"),2===u[1]&&(p="matrix D in quadratic function is not positive definite!"),{solution:n(v),value:n(d),unconstrained_solution:n(e),iterations:n(w),iact:n(g),message:p}}r.solveQP=s}(numeric),numeric.svd=function(r){function t(r,t){return r=Math.abs(r),t=Math.abs(t),r>t?r*Math.sqrt(1+t*t/r/r):0==t?r:t*Math.sqrt(1+r*r/t/t)}var n,e=numeric.epsilon,i=1e-64/e,o=50,a=0,s=0,u=0,f=0,c=0,h=numeric.clone(r),m=h.length,l=h[0].length;if(l>m)throw"Need more rows than columns";var p=new Array(l),d=new Array(l);for(s=0;l>s;s++)p[s]=d[s]=0;var g=numeric.rep([l,l],0),v=0,y=0,w=0,x=0,M=0,b=0,k=0;for(s=0;l>s;s++){for(p[s]=y,k=0,c=s+1,u=s;m>u;u++)k+=h[u][s]*h[u][s];if(i>=k)y=0;else for(v=h[s][s],y=Math.sqrt(k),v>=0&&(y=-y),w=v*y-k,h[s][s]=v-y,u=c;l>u;u++){for(k=0,f=s;m>f;f++)k+=h[f][s]*h[f][u];for(v=k/w,f=s;m>f;f++)h[f][u]+=v*h[f][s]}for(d[s]=y,k=0,u=c;l>u;u++)k+=h[s][u]*h[s][u];if(i>=k)y=0;else{for(v=h[s][s+1],y=Math.sqrt(k),v>=0&&(y=-y),w=v*y-k,h[s][s+1]=v-y,u=c;l>u;u++)p[u]=h[s][u]/w;for(u=c;m>u;u++){for(k=0,f=c;l>f;f++)k+=h[u][f]*h[s][f];for(f=c;l>f;f++)h[u][f]+=k*p[f]}}M=Math.abs(d[s])+Math.abs(p[s]),M>x&&(x=M)}for(s=l-1;-1!=s;s+=-1){if(0!=y){for(w=y*h[s][s+1],u=c;l>u;u++)g[u][s]=h[s][u]/w;for(u=c;l>u;u++){for(k=0,f=c;l>f;f++)k+=h[s][f]*g[f][u];for(f=c;l>f;f++)g[f][u]+=k*g[f][s]}}for(u=c;l>u;u++)g[s][u]=0,g[u][s]=0;g[s][s]=1,y=p[s],c=s}for(s=l-1;-1!=s;s+=-1){for(c=s+1,y=d[s],u=c;l>u;u++)h[s][u]=0;if(0!=y){for(w=h[s][s]*y,u=c;l>u;u++){for(k=0,f=c;m>f;f++)k+=h[f][s]*h[f][u];for(v=k/w,f=s;m>f;f++)h[f][u]+=v*h[f][s]}for(u=s;m>u;u++)h[u][s]=h[u][s]/y}else for(u=s;m>u;u++)h[u][s]=0;h[s][s]+=1}for(e*=x,f=l-1;-1!=f;f+=-1)for(var A=0;o>A;A++){var S=!1;for(c=f;-1!=c;c+=-1){if(Math.abs(p[c])<=e){S=!0;break}if(Math.abs(d[c-1])<=e)break}if(!S){a=0,k=1;var j=c-1;for(s=c;f+1>s&&(v=k*p[s],p[s]=a*p[s],!(Math.abs(v)<=e));s++)for(y=d[s],w=t(v,y),d[s]=w,a=y/w,k=-v/w,u=0;m>u;u++)M=h[u][j],b=h[u][s],h[u][j]=M*a+b*k,h[u][s]=-M*k+b*a}if(b=d[f],c==f){if(0>b)for(d[f]=-b,u=0;l>u;u++)g[u][f]=-g[u][f];break}if(A>=o-1)throw"Error: no convergence.";for(x=d[c],M=d[f-1],y=p[f-1],w=p[f],v=((M-b)*(M+b)+(y-w)*(y+w))/(2*w*M),y=t(v,1),v=0>v?((x-b)*(x+b)+w*(M/(v-y)-w))/x:((x-b)*(x+b)+w*(M/(v+y)-w))/x,a=1,k=1,s=c+1;f+1>s;s++){for(y=p[s],M=d[s],w=k*y,y=a*y,b=t(v,w),p[s-1]=b,a=v/b,k=w/b,v=x*a+y*k,y=-x*k+y*a,w=M*k,M*=a,u=0;l>u;u++)x=g[u][s-1],b=g[u][s],g[u][s-1]=x*a+b*k,g[u][s]=-x*k+b*a;for(b=t(v,w),d[s-1]=b,a=v/b,k=w/b,v=a*y+k*M,x=-k*y+a*M,u=0;m>u;u++)M=h[u][s-1],b=h[u][s],h[u][s-1]=M*a+b*k,h[u][s]=-M*k+b*a}p[c]=0,p[f]=v,d[f]=x}for(s=0;s<d.length;s++)d[s]<e&&(d[s]=0);for(s=0;l>s;s++)for(u=s-1;u>=0;u--)if(d[u]<d[s]){for(a=d[u],d[u]=d[s],d[s]=a,f=0;f<h.length;f++)n=h[f][s],h[f][s]=h[f][u],h[f][u]=n;for(f=0;f<g.length;f++)n=g[f][s],g[f][s]=g[f][u],g[f][u]=n;s=u}return{U:h,S:d,V:g}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],73:[function(r,t){"use strict";function n(r,t){this.data=r,this.h=t}var e=r("numeric"),i={windSize:5,deriv:1,pol:2};n.prototype.calc=function(r){r=r||{},this.options={};for(var t in i)this.options[t]=r.hasOwnProperty(t)?r[t]:i[t];if(this.options.windSize%2===0||this.options.windSize<5)throw new RangeError("Invalid window size");if(this.options.deriv<0||this.options.pol<1)throw new RangeError("Number too small");if(this.options.pol!==Math.floor(this.options.pol)||this.options.deriv!==Math.floor(this.options.deriv)||this.options.windSize!==Math.floor(this.options.windSize))throw new TypeError("Only integers allowed");var n,o;if(5!==this.options.windSize||2!==this.options.pol||1!==this.options.deriv&&2!==this.options.deriv){for(var a=new Array(this.options.windSize),s=0;s<a.length;s++){a[s]=new Array(this.options.pol+1);for(var u=-(this.options.windSize-1)/2,f=0;f<a[s].length;f++)a[s][f]=u+1===0&&0===f?1:Math.pow(u+s,f)}n=e.dot(e.inv(e.dot(e.transpose(a),a)),e.transpose(a)),n=n[this.options.deriv].concat(),o=1}else 1===this.options.deriv?(n=[-2,-1,0,1,2],o=10):(n=[2,-1,-2,-1,2],o=7);for(var c=new Array(this.data.length),h=Math.ceil(this.options.windSize/2);h<c.length-Math.floor(this.options.windSize/2);h++){for(var m=0,l=0;l<n.length;l++)m+=n[l]*this.data[l+h-Math.floor(this.options.windSize/2)]/(o*Math.pow(this.h,this.options.deriv));c[h]=m}return c},t.exports=n},{numeric:72}],74:[function(require,module,exports){"use strict";function SOM(r,t,n,e){this.x=r,this.y=t,n=n||{},this.options={};for(var i in defaultOptions)this.options[i]=n.hasOwnProperty(i)?n[i]:defaultOptions[i];if("number"==typeof this.options.fields)this.numWeights=this.options.fields;else{if(!Array.isArray(this.options.fields))throw new Error("Invalid fields definition");this.numWeights=this.options.fields.length;var o=getConverters(this.options.fields);this.extractor=o.extractor,this.creator=o.creator}if("rect"===this.options.gridType)this.nodeType=NodeSquare,this.gridDim={x:r,y:t};else{this.nodeType=NodeHexagonal;var a=this.x-Math.floor(this.y/2);this.gridDim={x:a,y:this.y,z:-(0-a-this.y)}}if(this.torus=this.options.torus,this.distanceMethod=this.torus?"getDistanceTorus":"getDistance",this.distance=this.options.distance,this.maxDistance=getMaxDistance(this.distance,this.numWeights),e===!0)return void(this.done=!0);if(!(r>0&&t>0))throw new Error("x and y must be positive");this.times={findBMU:0,adjust:0},this.randomizer=this.options.randomizer,this.iterationCount=0,this.iterations=this.options.iterations,this.startLearningRate=this.learningRate=this.options.learningRate,this.mapRadius=Math.floor(Math.max(r,t)/2),this.algorithmMethod=this.options.method,this._initNodes(),this.done=!1}function getConverters(r){for(var t=r.length,n=new Array(t),e=new Array(t),i=0;t>i;i++)n[i]=getNormalizer(r[i].range),e[i]=getDenormalizer(r[i].range);return{extractor:function(e){for(var i=new Array(t),o=0;t>o;o++)i[o]=n[o](e[r[o].name]);return i},creator:function(n){for(var i={},o=0;t>o;o++)i[r[o].name]=e[o](n[o]);return i}}}function getNormalizer(r){return function(t){return(t-r[0])/(r[1]-r[0])}}function getDenormalizer(r){return function(t){return r[0]+t*(r[1]-r[0])
}}function squareEuclidean(r,t){for(var n=0,e=0,i=r.length;i>e;e++)n+=(r[e]-t[e])*(r[e]-t[e]);return n}function getRandomValue(r,t){return r[Math.floor(t()*r.length)]}function getMaxDistance(r,t){for(var n=new Array(t),e=new Array(t),i=0;t>i;i++)n[i]=0,e[i]=1;return r(n,e)}var NodeSquare=require("./node-square"),NodeHexagonal=require("./node-hexagonal"),defaultOptions={fields:3,randomizer:Math.random,distance:squareEuclidean,iterations:10,learningRate:.1,gridType:"rect",torus:!0,method:"random"};SOM.load=function loadModel(model,distance){if("SOM"===model.name){var x=model.data.length,y=model.data[0].length;distance?model.options.distance=distance:model.options.distance&&(model.options.distance=eval("("+model.options.distance+")"));var som=new SOM(x,y,model.options,!0);som.nodes=new Array(x);for(var i=0;x>i;i++){som.nodes[i]=new Array(y);for(var j=0;y>j;j++)som.nodes[i][j]=new som.nodeType(i,j,model.data[i][j],som)}return som}throw new Error("expecting a SOM model")},SOM.prototype["export"]=function(r){if(!this.done)throw new Error("model is not ready yet");var t={name:"SOM"};t.options={fields:this.options.fields,gridType:this.options.gridType,torus:this.options.torus},t.data=new Array(this.x);for(var n=0;n<this.x;n++){t.data[n]=new Array(this.y);for(var e=0;e<this.y;e++)t.data[n][e]=this.nodes[n][e].weights}return r&&(t.options.distance=this.distance.toString()),t},SOM.prototype._initNodes=function(){var r,t,n,e=Date.now();for(this.nodes=new Array(this.x),r=0;r<this.x;r++)for(this.nodes[r]=new Array(this.y),t=0;t<this.y;t++){var i=new Array(this.numWeights);for(n=0;n<this.numWeights;n++)i[n]=this.randomizer();this.nodes[r][t]=new this.nodeType(r,t,i,this)}this.times.initNodes=Date.now()-e},SOM.prototype.setTraining=function(r){if(this.trainingSet)throw new Error("training set has already been set");var t,n=Date.now(),e=r,i=r.length;if(this.extractor)for(e=new Array(i),t=0;i>t;t++)e[t]=this.extractor(r[t]);this.numIterations=this.iterations*i,this.timeConstant="random"===this.algorithmMethod?this.numIterations/Math.log(this.mapRadius):i/Math.log(this.mapRadius),this.trainingSet=e,this.times.setTraining=Date.now()-n},SOM.prototype.trainOne=function(){if(this.done)return!1;if(this.numIterations-->0){var r,t,n;return"random"===this.algorithmMethod?(r=this.mapRadius*Math.exp(-this.iterationCount/this.timeConstant),t=getRandomValue(this.trainingSet,this.randomizer),this._adjust(t,r),this.learningRate=this.startLearningRate*Math.exp(-this.iterationCount/this.numIterations)):(n=-Math.floor(this.iterationCount/this.trainingSet.length),r=this.mapRadius*Math.exp(n/this.timeConstant),t=this.trainingSet[this.iterationCount%this.trainingSet.length],this._adjust(t,r),(this.iterationCount+1)%this.trainingSet.length===0&&(this.learningRate=this.startLearningRate*Math.exp(n/Math.floor(this.numIterations/this.trainingSet.length)))),this.iterationCount++,!0}return this.done=!0,!1},SOM.prototype._adjust=function(r,t){var n,e,i,o,a=Date.now(),s=this._findBestMatchingUnit(r),u=Date.now();this.times.findBMU+=u-a;var f=Math.floor(t),c=s.x-f,h=s.x+f,m=s.y-f,l=s.y+f;for(n=c;h>=n;n++){var p=n;for(0>n?p+=this.x:n>=this.x&&(p-=this.x),e=m;l>=e;e++){var d=e;0>e?d+=this.y:e>=this.y&&(d-=this.y),i=s[this.distanceMethod](this.nodes[p][d]),t>i&&(o=Math.exp(-i/(2*t)),this.nodes[p][d].adjustWeights(r,this.learningRate,o))}}this.times.adjust+=Date.now()-u},SOM.prototype.train=function(r){if(!this.done)for(this.setTraining(r);this.trainOne(););},SOM.prototype.getConvertedNodes=function(){for(var r=new Array(this.x),t=0;t<this.x;t++){r[t]=new Array(this.y);for(var n=0;n<this.y;n++){var e=this.nodes[t][n];r[t][n]=this.creator?this.creator(e.weights):e.weights}}return r},SOM.prototype._findBestMatchingUnit=function(r){for(var t,n,e=1/0,i=0;i<this.x;i++)for(var o=0;o<this.y;o++)n=this.distance(this.nodes[i][o].weights,r),e>n&&(e=n,t=this.nodes[i][o]);return t},SOM.prototype.predict=function(r,t){if("boolean"==typeof r&&(t=r,r=null),r||(r=this.trainingSet),Array.isArray(r)&&(Array.isArray(r[0])||"object"==typeof r[0])){var n=this;return r.map(function(r){return n._predict(r,t)})}return this._predict(r,t)},SOM.prototype._predict=function(r,t){Array.isArray(r)||(r=this.extractor(r));var n=this._findBestMatchingUnit(r),e=[n.x,n.y];return t&&(e[2]=n.getPosition(r)),e},SOM.prototype.getQuantizationError=function(){for(var r=this.getFit(),t=r.length,n=0,e=0;t>e;e++)n+=r[e];return n/t},SOM.prototype.getFit=function(r){r||(r=this.trainingSet);for(var t,n=r.length,e=new Array(n),i=0;n>i;i++)t=this._findBestMatchingUnit(r[i]),e[i]=Math.sqrt(this.distance(r[i],t.weights));return e},module.exports=SOM},{"./node-hexagonal":75,"./node-square":76}],75:[function(r,t){function n(r,t,n,i){e.call(this,r,t,n,i),this.hX=r-Math.floor(t/2),this.z=0-this.hX-t}var e=r("./node-square");n.prototype=new e,n.prototype.constructor=n,n.prototype.getDistance=function(r){return Math.max(Math.abs(this.hX-r.hX),Math.abs(this.y-r.y),Math.abs(this.z-r.z))},n.prototype.getDistanceTorus=function(r){var t=Math.abs(this.hX-r.hX),n=Math.abs(this.y-r.y),e=Math.abs(this.z-r.z);return Math.max(Math.min(t,this.som.gridDim.x-t),Math.min(n,this.som.gridDim.y-n),Math.min(e,this.som.gridDim.z-e))},n.prototype.getPosition=function(){throw new Error("Unimplemented : cannot get position of the points for hexagonal grid")},t.exports=n},{"./node-square":76}],76:[function(r,t){function n(r,t,n,e){this.x=r,this.y=t,this.weights=n,this.som=e,this.neighbors={}}n.prototype.adjustWeights=function(r,t,n){for(var e=0,i=this.weights.length;i>e;e++)this.weights[e]+=t*n*(r[e]-this.weights[e])},n.prototype.getDistance=function(r){return Math.max(Math.abs(this.x-r.x),Math.abs(this.y-r.y))},n.prototype.getDistanceTorus=function(r){var t=Math.abs(this.x-r.x),n=Math.abs(this.y-r.y);return Math.max(Math.min(t,this.som.gridDim.x-t),Math.min(n,this.som.gridDim.y-n))},n.prototype.getNeighbors=function(r){if(!this.neighbors[r]){this.neighbors[r]=new Array(2);var t;if(this[r]>0?t=this[r]-1:this.som.torus&&(t=this.som.gridDim[r]-1),"undefined"!=typeof t){var n,e;"x"===r?(n=t,e=this.y):(n=this.x,e=t),this.neighbors[r][0]=this.som.nodes[n][e]}var i;this[r]<this.som.gridDim[r]-1?i=this[r]+1:this.som.torus&&(i=0),"undefined"!=typeof i&&("x"===r?(n=i,e=this.y):(n=this.x,e=i),this.neighbors[r][1]=this.som.nodes[n][e])}return this.neighbors[r]},n.prototype.getPos=function(r,t){var n,e,i=this.getNeighbors(r),o=this.som.distance;if(i[0])if(i[1]){var a=o(t,i[0].weights),s=o(t,i[1].weights);s>a?(n=i[0],e=-1):(n=i[1],e=1)}else n=i[0],e=-1;else n=i[1],e=1;var u=1-o(t,this.weights),f=1-o(t,n.weights),c=(u-f)/(2-u-f);return.5+.5*c*e},n.prototype.getPosition=function(r){return[this.getPos("x",r),this.getPos("y",r)]},t.exports=n},{}],77:[function(r,t){"use strict";function n(r){for(var t=-1/0,n=r.length,e=0;n>e;e++)r[e]>t&&(t=r[e]);return t}function e(r){for(var t=1/0,n=r.length,e=0;n>e;e++)r[e]<t&&(t=r[e]);return t}function i(r){for(var t=1/0,n=-1/0,e=r.length,i=0;e>i;i++)r[i]<t&&(t=r[i]),r[i]>n&&(n=r[i]);return{min:t,max:n}}function o(r){for(var t=0,n=r.length,e=0;n>e;e++)t+=r[e];return t/n}function a(r){for(var t=0,n=r.length,e=0;n>e;e++)t*=r[e];return Math.pow(t,1/n)}function s(r){for(var t=0,n=r.length,e=0;n>e;e++)t+=Math.log(r[e]);return t/n}function u(r,t){for(var n=0,e=0,i=r.length,o=0;i>o;o++)n+=t[o]*r[o],e+=t[o];return n/e}function f(r,t,n){"undefined"==typeof n&&(n=!1),r=n?r:r.slice(),r.sort();for(var e=r.length,i=Math.floor(e*t),o=0,a=i;e-i>a;a++)o+=r[a];return o/(e-2*i)}function c(r,t){"undefined"==typeof t&&(t=1);for(var n=0,e=0,i=r.length,o=0;i>o;o++)n+=Math.pow(r[o],t+1),e+=Math.pow(r[o],t);return n/e}function h(r,t){return Math.sqrt(d(r,t))}function m(r){return h(r)/Math.sqrt(r.length)}function l(r,t){"undefined"==typeof t&&(t=!1),t||(r=r.slice(),r.sort());var n=r.length,e=Math.floor(n/2);return n%2===0?.5*(r[e-1]+r[e]):r[e]}function p(r,t){"undefined"==typeof t&&(t=!1),t||(r=r.slice(),r.sort());var n=r.length/4,e=r[Math.ceil(n)-1],i=l(r,!0),o=r[Math.ceil(3*n)-1];return{q1:e,q2:i,q3:o}}function d(r,t){"undefined"==typeof t&&(t=!0);for(var n=o(r),e=0,i=r.length,a=0;i>a;a++){var s=r[a]-n;e+=s*s}return t?e/(i-1):e/i}function g(r,t){return Math.sqrt(v(r,t))}function v(r,t){"undefined"==typeof t&&(t=!0);for(var n=0,e=0,i=r.length,o=0;i>o;o++){var a=r[o],s=d(a);n+=(a.length-1)*s,e+=t?a.length-1:a.length}return n/e}function y(r){var t,n=r.length,e=new Array(n);for(t=0;n>t;t++)e[t]=0;var i=new Array(n),o=0;for(t=0;n>t;t++){var a=i.indexOf(r[t]);a>=0?e[a]++:(i[o]=r[t],e[o]=1,o++)}var s=0,u=0;for(t=0;o>t;t++)e[t]>s&&(s=e[t],u=t);return i[u]}function w(r,t,n){"undefined"==typeof n&&(n=!0);var e=o(r),i=o(t);if(r.length!==t.length)throw"Vectors do not have the same dimensions";for(var a=0,s=r.length,u=0;s>u;u++){var f=r[u]-e,c=t[u]-i;a+=f*c}return n?a/(s-1):a/s}function x(r,t){"undefined"==typeof t&&(t=!0);for(var n=o(r),e=0,i=0,a=r.length,s=0;a>s;s++){var u=r[s]-n;e+=u*u,i+=u*u*u}var f=e/a,c=i/a,h=c/Math.pow(f,1.5);if(t){var m=Math.sqrt(a*(a-1)),l=a-2;return m/l*h}return h}function M(r,t){"undefined"==typeof t&&(t=!0);for(var n=o(r),e=r.length,i=0,a=0,s=0;e>s;s++){var u=r[s]-n;i+=u*u,a+=u*u*u*u}var f=i/e,c=a/e;if(t){var h=i/(e-1),m=e*(e+1)/((e-1)*(e-2)*(e-3)),l=a/(h*h),p=(e-1)*(e-1)/((e-2)*(e-3));return m*l-3*p}return c/(f*f)-3}function b(r,t){"undefined"==typeof t&&(t=0);for(var n=0,e=r.length,i=0;e>i;i++)n+=r[i]*Math.log(r[i]+t);return-n}function k(r,t){for(var n=0,e=r.length,i=0;e>i;i++)n+=r[i]*t[i];return n}function A(r,t){return Math.sqrt(S(r,t))}function S(r,t){for(var n=k(r,t),e=0,i=r.length,o=0,a=0,s=0;i>s;s++){var u=r[s]-n,f=t[s];e+=f*u*u,a+=f,o+=f*f}return e*(a/(a*a-o))}function j(r,t){"undefined"==typeof t&&(t=!1);var n=r;t||(n=r.slice());for(var e=o(n),i=n.length,a=0;i>a;a++)n[a]-=e}function q(r,t,n){"undefined"==typeof t&&(t=h(r)),"undefined"==typeof n&&(n=!1);for(var e=r.length,i=n?r:new Array(e),o=0;e>o;o++)i[o]=r[o]/t;return i}function T(r){var t=r.length,n=new Array(t);n[0]=r[0];for(var e=1;t>e;e++)n[e]=n[e-1]+r[e];return n}t.exports={min:e,max:n,minMax:i,mean:o,geometricMean:a,logGeometricMean:s,grandMean:u,truncatedMean:f,contraHarmonicMean:c,standardDeviation:h,standardError:m,median:l,quartiles:p,variance:d,pooledStandardDeviation:g,pooledVariance:v,mode:y,covariance:w,skewness:x,kurtosis:M,entropy:b,weightedMean:k,weightedStandardDeviation:A,weightedVariance:S,center:j,standardize:q,cumulativeSum:T}},{}],78:[function(r,t){"use strict";function n(r,t){"undefined"==typeof t&&(t=0);for(var n=0,e=r.length,i=r[0].length,o=0;e>o;o++)for(var a=0;i>a;a++)n+=r[o][a]*Math.log(r[o][a]+t);return-n}function e(r,t){"undefined"==typeof t&&(t=0);var n,e,i,o,a=r.length,s=r[0].length;if(-1===t){for(n=[0],e=a*s,i=0;a>i;i++)for(o=0;s>o;o++)n[0]+=r[i][o];n[0]/=e}else if(0===t)for(n=new Array(s),e=a,o=0;s>o;o++){for(n[o]=0,i=0;a>i;i++)n[o]+=r[i][o];n[o]/=e}else{if(1!==t)throw new Error("Invalid dimension");for(n=new Array(a),e=s,o=0;a>o;o++){for(n[o]=0,i=0;s>i;i++)n[o]+=r[o][i];n[o]/=e}}return n}function i(r,t,n){for(var e=o(r,t,n),i=e.length,a=0;i>a;a++)e[a]=Math.sqrt(e[a]);return e}function o(r,t,n){"undefined"==typeof n&&(n=!0),t=t||e(r);var i=r.length;if(0===i)return[];for(var o=r[0].length,a=new Array(o),s=0;o>s;s++){for(var u=0,f=0,c=0,h=0;i>h;h++)c=r[h][s]-t[s],u+=c,f+=c*c;a[s]=n?(f-u*u/i)/(i-1):(f-u*u/i)/i}return a}function a(r){for(var t=r.length,n=r[0].length,e=new Array(n),i=0;n>i;i++){for(var o=new Array(t),a=0;t>a;a++)o[a]=r[a][i];o.sort();var s=o.length;e[i]=s%2===0?.5*(o[s/2]+o[s/2-1]):o[Math.floor(s/2)]}return e}function s(r){var t,n,e=r.length,i=r[0].length,o=new Array(i);for(t=0;i>t;t++){for(var a=new Array(e),s=0;e>s;s++)a[s]=0;var u=new Array(e),f=0;for(n=0;e>n;n++){var c=u.indexOf(r[n][t]);c>=0?a[c]++:(u[f]=r[n][t],a[f]=1,f++)}var h=0,m=0;for(n=0;f>n;n++)a[n]>h&&(h=a[n],m=n);o[t]=u[m]}return o}function u(r,t){"undefined"==typeof t&&(t=!0);for(var n=e(r),i=r.length,o=n.length,a=new Array(o),s=0;o>s;s++){for(var u=0,f=0,c=0;i>c;c++){var h=r[c][s]-n[s];u+=h*h,f+=h*h*h}var m=u/i,l=f/i,p=l/Math.pow(m,1.5);if(t){var d=Math.sqrt(i*(i-1)),g=i-2;a[s]=d/g*p}else a[s]=p}return a}function f(r,t){"undefined"==typeof t&&(t=!0);for(var n=e(r),i=r.length,o=r[0].length,a=new Array(o),s=0;o>s;s++){for(var u=0,f=0,c=0;i>c;c++){var h=r[c][s]-n[s];u+=h*h,f+=h*h*h*h}var m=u/i,l=f/i;if(t){var p=u/(i-1),d=i*(i+1)/((i-1)*(i-2)*(i-3)),g=f/(p*p),v=(i-1)*(i-1)/((i-2)*(i-3));a[s]=d*g-3*v}else a[s]=l/(m*m)-3}return a}function c(r){for(var t=r.length,n=i(r),e=n.length,o=new Array(e),a=Math.sqrt(t),s=0;e>s;s++)o[s]=n[s]/a;return o}function h(r,t){return m(r,void 0,t)}function m(r,t,n){"undefined"==typeof n&&(n=0),"undefined"==typeof t&&(0===n?t=r.length-1:1===n&&(t=r[0].length-1));var i=e(r,n),o=r.length;if(0===o)return[[]];var a,s,u,f,c,h=r[0].length;if(0===n){for(a=new Array(h),s=0;h>s;s++)a[s]=new Array(h);for(s=0;h>s;s++)for(u=s;h>u;u++){for(f=0,c=0;o>c;c++)f+=(r[c][u]-i[u])*(r[c][s]-i[s]);f/=t,a[s][u]=f,a[u][s]=f}}else{if(1!==n)throw new Error("Invalid dimension");for(a=new Array(o),s=0;o>s;s++)a[s]=new Array(o);for(s=0;o>s;s++)for(u=s;o>u;u++){for(f=0,c=0;h>c;c++)f+=(r[u][c]-i[u])*(r[s][c]-i[s]);f/=t,a[s][u]=f,a[u][s]=f}}return a}function l(r){var t,n,o=e(r),a=i(r,!0,o),s=p(r,o,a),u=r.length,f=r[0].length,c=new Array(f);for(t=0;f>t;t++)c[t]=new Array(f);for(t=0;f>t;t++)for(n=t;f>n;n++){for(var h=0,m=0,l=s.length;l>m;m++)h+=s[m][n]*s[m][t];h/=u-1,c[t][n]=h,c[n][t]=h}return c}function p(r,t,n){return t=t||e(r),"undefined"==typeof n&&(n=i(r,!0,t)),g(d(r,t,!1),n,!0)}function d(r,t,n){t=t||e(r);var i,o,a,s=r,u=r.length;if(!n)for(s=new Array(u),i=0;u>i;i++)s[i]=new Array(r[i].length);for(i=0;u>i;i++){var f=s[i];for(o=0,a=f.length;a>o;o++)f[o]=r[i][o]-t[o]}return s}function g(r,t,n){"undefined"==typeof t&&(t=i(r));var e,o,a,s=r,u=r.length;if(!n)for(s=new Array(u),e=0;u>e;e++)s[e]=new Array(r[e].length);for(e=0;u>e;e++){var f=s[e],c=r[e];for(o=0,a=f.length;a>o;o++)0===t[o]||isNaN(t[o])||(f[o]=c[o]/t[o])}return s}function v(r,t){var n=e(r),i=r.length;if(0===i)return[];for(var o=r[0].length,a=new Array(o),s=0;o>s;s++){for(var u=0,f=0,c=0,h=0;i>h;h++){var m=r[h][s]-n[s],l=t[h];u+=l*m*m,c+=l,f+=l*l}a[s]=u*(c/(c*c-f))}return a}function y(r,t,n){"undefined"==typeof n&&(n=0);var e=r.length;if(0===e)return[];var i,o,a,s,u,f,c=r[0].length;if(0===n){for(i=new Array(c),o=0;c>o;o++)i[o]=0;for(o=0;e>o;o++)for(f=r[o],u=t[o],s=0;c>s;s++)i[s]+=f[s]*u}else{if(1!==n)throw new Error("Invalid dimension");for(i=new Array(e),o=0;e>o;o++)i[o]=0;for(s=0;e>s;s++)for(f=r[s],u=t[s],o=0;c>o;o++)i[s]+=f[o]*u}var h=M(t);if(0!==h)for(o=0,a=i.length;a>o;o++)i[o]/=h;return i}function w(r,t,n,e){e=e||0,n=n||y(r,t,e);for(var i=0,o=0,a=0,s=t.length;s>a;a++)i+=t[a],o+=t[a]*t[a];var u=i/(i*i-o);return x(r,t,n,u,e)}function x(r,t,n,e,i){i=i||0,n=n||y(r,t,i),"undefined"==typeof e&&(e=1);var o=r.length;if(0===o)return[[]];var a,s,u,f,c,h=r[0].length;if(0===i){for(a=new Array(h),s=0;h>s;s++)a[s]=new Array(h);for(s=0;h>s;s++)for(u=s;h>u;u++){for(c=0,f=0;o>f;f++)c+=t[f]*(r[f][u]-n[u])*(r[f][s]-n[s]);a[s][u]=c*e,a[u][s]=c*e}}else{if(1!==i)throw new Error("Invalid dimension");for(a=new Array(o),s=0;o>s;s++)a[s]=new Array(o);for(s=0;o>s;s++)for(u=s;o>u;u++){for(c=0,f=0;h>f;f++)c+=t[f]*(r[u][f]-n[u])*(r[s][f]-n[s]);a[s][u]=c*e,a[u][s]=c*e}}return a}function M(r){for(var t=0,n=r.length,e=0;n>e;e++)t+=r[e];return t}t.exports={entropy:n,mean:e,standardDeviation:i,variance:o,median:a,mode:s,skewness:u,kurtosis:f,standardError:c,covariance:h,scatter:m,correlation:l,zScores:p,center:d,standardize:g,weightedVariance:v,weightedMean:y,weightedCovariance:w,weightedScatter:x}},{}],79:[function(r,t,n){t.exports=n=r("./svm"),n.kernel=r("./kernel").kernel},{"./kernel":80,"./svm":81}],80:[function(r,t){"use strict";function n(r,t,n,e){return i(n)(r,t,e)}function e(r,t){for(var n=r.length,e=0,i=0;n>i;i++)e+=r[i]*t[i];return e}function i(r){switch(r="undefined"==typeof r?"lineal":r){case"lineal":return o;case"polynomial":return a;case"radial":return s;default:throw new TypeError("Function kernel undefined: "+r)}}function o(r,t){return e(r,t)}function a(r,t,n){return n="undefined"==typeof n?2:n,Math.pow(e(r,t)+1,n)}function s(r,t,n){n="undefined"==typeof n?2:n;for(var i=r.length,o=new Array(i),a=0;i>a;a++)o[a]=r[a]-t[a];var s=e(o,o);return Math.exp(s/(-2*n*n))}t.exports={kernel:n,getKernel:i,lineal:o,polynomial:a,radial:s}},{}],81:[function(r,t){"use strict";function n(r,t,n,e,i,o,a){for(var s=t.length,u=i,f=0;s>f;f++)i+=e[f]*n[f]*o(t[f],r,a);return u}function e(r){r=r||{},this.options={};for(var t in o)this.options[t]=r.hasOwnProperty(t)?r[t]:o[t];this.kernel=i(this.options.k),this.b=0}var i=(r("./kernel").kernel,r("./kernel").getKernel),o={C:10,tol:.1,max_passes:100,par:2,k:"lineal"};e.prototype.train=function(r,t){for(var e=t.length,i=new Array(e),o=0;e>o;o++)i[o]=0;if(r.length!==e)throw new TypeError("Arrays should have the same length");for(var a=0,s=0,u=0,f=0,c=0,h=0,m=0,l=0,p=0,d=0,g=0;f<this.options.max_passes;){for(var v=0,y=0;e>y;y++)if(c=n(r[y],r,t,i,a,this.kernel,this.options.par)-t[y],t[y]*c<-this.options.tol&&i[y]<this.options.C||t[y]*c>this.options.tol&&i[y]>0){var w=0;do w=Math.ceil(Math.random()*(e-1));while(w===y);h=n(r[w],r,t,i,a,this.kernel,this.options.par)-t[w],m=i[y],l=i[w],t[y]===t[w]?(p=Math.max(0,m+l-this.options.C),d=Math.min(this.options.C,m+l)):(p=Math.max(0,m-l),d=Math.min(this.options.C,this.options.C-m+l)),p!==d&&(g=2*this.kernel(r[y],r[w],this.options.par)-this.kernel(r[y],r[y],this.options.par)-this.kernel(r[w],r[w],this.options.par),0>g&&(i[w]=i[w]-t[w]*(c-h)/g,i[w]>d?i[w]=d:i[w]<p&&(i[w]=p),Math.abs(l-i[w])>=1e-4&&(i[y]=i[y]+t[y]*t[w]*(l-i[w]),s=a-c-t[y]*(i[y]-m)*this.kernel(r[y],r[y],this.options.par)-t[w]*(i[w]-l)*this.kernel(r[y],r[w],this.options.par),u=a-h-t[y]*(i[y]-m)*this.kernel(r[y],r[w],this.options.par)-t[w]*(i[w]-l)*this.kernel(r[w],r[w],this.options.par),a=i[y]<this.options.C&&i[y]>0?s:i[w]<this.options.C&&i[w]>0?u:(s+u)/2,v+=1)))}0==v?f+=1:f=0}this.b=a;var x=r[0].length;this.W=new Array(x);for(var M=0;x>M;M++){this.W[M]=0;for(var b=0;e>b;b++)this.W[M]+=t[b]*i[b]*r[b][M]}this.alphas=i.splice()},e.load=function(r){if("SVM"===r.name){var t=new e(r.options);return t.W=r.W.slice(),t.b=r.b,t}throw new TypeError("expecting a SVM model")},e.prototype["export"]=function(){var r={name:"SVM"};return r.options=this.options,r.W=this.W,r.b=this.b,r},e.prototype.getAlphas=function(){return this.alphas.slice()},e.prototype.getThreshold=function(){return this.b},e.prototype.predict=function(r){var t;if(Array.isArray(r)&&(Array.isArray(r[0])||"object"==typeof r[0])){for(var n=new Array(r.length),e=0;e<n.length;e++){t=this.b;for(var i=0;i<this.W.length;i++)t+=this.W[i]*r[i];n[e]=0>t?-1:1}return n}t=this.b;for(var o=0;o<this.W.length;o++)t+=this.W[o]*r[o];return 0>t?-1:1},t.exports=e},{"./kernel":80}]},{},[1])(1)});
//# sourceMappingURL=ml.min.js.map