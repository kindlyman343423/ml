!function(r,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):"object"==typeof exports?exports.ML=t():r.ML=t()}(this,function(){return function(r){function t(o){if(n[o])return n[o].exports;var e=n[o]={exports:{},id:o,loaded:!1};return r[o].call(e.exports,e,e.exports,t),e.loaded=!0,e.exports}var n={};return t.m=r,t.c=n,t.p="",t(0)}([function(r,t,n){"use strict";t.ArrayUtils=t.AU=n(1),t.BitArray=n(17),t.Matrix=n(19);var o=t.Math={},e=n(28);o.Distance=e.distance,o.Similarity=e.similarity,o.SG=n(84);var i=t.Stat={};i.array=n(6),i.matrix=n(7),i.PCA=n(86);var s=t.RNG={};s.XSadd=n(97);var a=t.SL={};a.SVM=n(98),a.KNN=n(101),a.NaiveBayes=n(104),a.PLS=n(115);var u=t.Clust={};u.kmeans=n(128),u.hclust=n(130);var f=t.NN=t.nn={};f.SOM=n(140),f.FNN=n(143)},function(r,t,n){r.exports=t=n(2),t.getEquallySpacedData=n(3).getEquallySpacedData,t.SNV=n(4).SNV},function(r,t){"use strict";function n(r,t){if(r.length%t!==0)throw new RangeError("Dimensions number must be accordance with the size of the array.");for(var n=r.length/t,o=new Array(n),e=0,i=0;i<r.length;i+=t){for(var s=new Array(t),a=0;t>a;++a)s[a]=r[i+a];o[e]=s,e++}return o}function o(r,t){if(r.length%t!==0)throw new RangeError("Dimensions number must be accordance with the size of the array.");for(var n=new Array(t),o=r.length/t,e=0;e<n.length;e++)n[e]=new Array(o);for(e=0;e<r.length;e+=t)for(var i=0;t>i;++i){var s=Math.floor(e/t);n[i][s]=r[e+i]}return n}function e(r){for(var t=new Array(r.length*r[0].length),n=0,o=0;o<r[0].length;++o)for(var e=0;e<r.length;++e)t[n]=r[e][o],++n;return t}function i(r){for(var t=new Array(r[0].length),n=0;n<t.length;++n)t[n]=new Array(r.length);for(n=0;n<r.length;++n)for(var o=0;o<r[0].length;++o)t[o][n]=r[n][o];return t}function s(r){for(var t=new Array(r.length*r[0].length),n=0,o=0;o<r.length;++o)for(var e=0;e<r[0].length;++e)t[n]=r[o][e],++n;return t}function a(r,t){var n,o;r.length<=t.length?(o=r,n=t):(o=t,n=r);for(var e=n.length-o.length+1,i=new Array(e),s=0;e>s;++s){for(var a=0,u=0;u<o.length;++u)a+=o[u]*n[s+u];i[s]=a}return i}r.exports={coordArrayToPoints:n,coordArrayToCoordMatrix:o,coordMatrixToCoordArray:e,coordMatrixToPoints:i,pointsToCoordArray:s,pointsToCoordMatrix:i,applyDotProduct:a}},function(r,t){"use strict";function n(r,t,n){var i=r.length;if(i!==t.length)throw new RangeError("the x and y vector doesn't have the same size.");void 0===n&&(n={});var s=void 0===n.from?r[0]:n.from;if(isNaN(s)||!isFinite(s))throw new RangeError("'From' value must be a number");var a=void 0===n.to?r[r.length-1]:n.to;if(isNaN(a)||!isFinite(a))throw new RangeError("'To' value must be a number");var u=s>a;if(u){var f=s;s=a,a=f}var h=void 0===n.numberOfPoints?100:n.numberOfPoints;if(isNaN(h)||!isFinite(h))throw new RangeError("'Number of points' value must be a number");if(1>h)throw new RangeError("the number of point must be higher than 1");var c="slot"===n.variant?"slot":"smooth",l="slot"===c?e(r,t,s,a,h):o(r,t,s,a,h);return u?l.reverse():l}function o(r,t,n,o,e){function s(r,t,n,o){return(o-t)/(n-r)}var a=r.length,u=(o-n)/(e-1),f=u/2,h=n-f,c=new Array(e),l=r[1]-r[0],m=r[r.length-1]-r[r.length-2],p=h,w=h+u,v=-Number.MAX_VALUE,g=0,y=r[0]-l,d=0,b=0,x=0,M=0,k=0,R=0,A=0,j=0;r:for(;;){for(;y-w>=0;){var S=i(0,w-v,x,g);if(R=b+S,c[j]=(R-k)/u,j++,j===e)break r;p=w,w+=u,k=R}p>=v&&y>=p&&(S=i(0,p-v,x,g),k=b+S),b+=i(v,y,x,M),v=y,g=d,a>A?(y=r[A],d=t[A],A++):A===a&&(y+=m,d=0),x=s(v,g,y,d),M=-x*v+g}return c}function e(r,t,n,o,e){var i=r.length,s=(o-n)/(e-1),a=s/2,u=r[r.length-1]-r[r.length-2],f=n-a,h=new Array(e),c=f,l=f+s,m=-Number.MAX_VALUE,p=0,w=r[0],v=t[0],g=0,y=!0,d=0,b=0,x=1,M=0;r:for(;;){for(;m-l>0;){if(y&&(b++,y=!1),h[M]=0>=b?0:d/b,M++,M===e)break r;c=l,l+=s,d=0,b=0}m>c&&(d+=p,b++),(m===-Number.MAX_VALUE||g>1)&&b--,m=w,p=v,i>x?(w=r[x],v=t[x],x++):(w+=u,v=0,g++)}return h}function i(r,t,n,o){return.5*n*t*t+o*t-(.5*n*r*r+o*r)}t.getEquallySpacedData=n,t.integral=i},function(r,t,n){"use strict";function o(r){var t=e.array.mean(r),n=e.array.standardDeviation(r);return new i([r]).clone().sub(t).div(n).getRow(0)}t.SNV=o;var e=n(5),i=n(8)},function(r,t,n){t.array=n(6),t.matrix=n(7)},function(r,t){"use strict";function n(r){for(var t=-(1/0),n=r.length,o=0;n>o;o++)r[o]>t&&(t=r[o]);return t}function o(r){for(var t=1/0,n=r.length,o=0;n>o;o++)r[o]<t&&(t=r[o]);return t}function e(r){for(var t=1/0,n=-(1/0),o=r.length,e=0;o>e;e++)r[e]<t&&(t=r[e]),r[e]>n&&(n=r[e]);return{min:t,max:n}}function i(r){for(var t=0,n=r.length,o=0;n>o;o++)t+=r[o];return t/n}function s(r){for(var t=0,n=r.length,o=0;n>o;o++)t*=r[o];return Math.pow(t,1/n)}function a(r){for(var t=0,n=r.length,o=0;n>o;o++)t+=Math.log(r[o]);return t/n}function u(r,t){for(var n=0,o=0,e=r.length,i=0;e>i;i++)n+=t[i]*r[i],o+=t[i];return n/o}function f(r,t,n){"undefined"==typeof n&&(n=!1),r=n?r:r.slice(),r.sort();for(var o=r.length,e=Math.floor(o*t),i=0,s=e;o-e>s;s++)i+=r[s];return i/(o-2*e)}function h(r,t){"undefined"==typeof t&&(t=1);for(var n=0,o=0,e=r.length,i=0;e>i;i++)n+=Math.pow(r[i],t+1),o+=Math.pow(r[i],t);return n/o}function c(r,t){return Math.sqrt(w(r,t))}function l(r){return c(r)/Math.sqrt(r.length)}function m(r,t){"undefined"==typeof t&&(t=!1),t||(r=r.slice(),r.sort());var n=r.length,o=Math.floor(n/2);return n%2===0?.5*(r[o-1]+r[o]):r[o]}function p(r,t){"undefined"==typeof t&&(t=!1),t||(r=r.slice(),r.sort());var n=r.length/4,o=r[Math.ceil(n)-1],e=m(r,!0),i=r[Math.ceil(3*n)-1];return{q1:o,q2:e,q3:i}}function w(r,t){"undefined"==typeof t&&(t=!0);for(var n=i(r),o=0,e=r.length,s=0;e>s;s++){var a=r[s]-n;o+=a*a}return t?o/(e-1):o/e}function v(r,t){return Math.sqrt(g(r,t))}function g(r,t){"undefined"==typeof t&&(t=!0);for(var n=0,o=0,e=r.length,i=0;e>i;i++){var s=r[i],a=w(s);n+=(s.length-1)*a,o+=t?s.length-1:s.length}return n/o}function y(r){var t,n=r.length,o=new Array(n);for(t=0;n>t;t++)o[t]=0;var e=new Array(n),i=0;for(t=0;n>t;t++){var s=e.indexOf(r[t]);s>=0?o[s]++:(e[i]=r[t],o[i]=1,i++)}var a=0,u=0;for(t=0;i>t;t++)o[t]>a&&(a=o[t],u=t);return e[u]}function d(r,t,n){"undefined"==typeof n&&(n=!0);var o=i(r),e=i(t);if(r.length!==t.length)throw"Vectors do not have the same dimensions";for(var s=0,a=r.length,u=0;a>u;u++){var f=r[u]-o,h=t[u]-e;s+=f*h}return n?s/(a-1):s/a}function b(r,t){"undefined"==typeof t&&(t=!0);for(var n=i(r),o=0,e=0,s=r.length,a=0;s>a;a++){var u=r[a]-n;o+=u*u,e+=u*u*u}var f=o/s,h=e/s,c=h/Math.pow(f,1.5);if(t){var l=Math.sqrt(s*(s-1)),m=s-2;return l/m*c}return c}function x(r,t){"undefined"==typeof t&&(t=!0);for(var n=i(r),o=r.length,e=0,s=0,a=0;o>a;a++){var u=r[a]-n;e+=u*u,s+=u*u*u*u}var f=e/o,h=s/o;if(t){var c=e/(o-1),l=o*(o+1)/((o-1)*(o-2)*(o-3)),m=s/(c*c),p=(o-1)*(o-1)/((o-2)*(o-3));return l*m-3*p}return h/(f*f)-3}function M(r,t){"undefined"==typeof t&&(t=0);for(var n=0,o=r.length,e=0;o>e;e++)n+=r[e]*Math.log(r[e]+t);return-n}function k(r,t){for(var n=0,o=r.length,e=0;o>e;e++)n+=r[e]*t[e];return n}function R(r,t){return Math.sqrt(A(r,t))}function A(r,t){for(var n=k(r,t),o=0,e=r.length,i=0,s=0,a=0;e>a;a++){var u=r[a]-n,f=t[a];o+=f*(u*u),s+=f,i+=f*f}return o*(s/(s*s-i))}function j(r,t){"undefined"==typeof t&&(t=!1);var n=r;t||(n=r.slice());for(var o=i(n),e=n.length,s=0;e>s;s++)n[s]-=o}function S(r,t,n){"undefined"==typeof t&&(t=c(r)),"undefined"==typeof n&&(n=!1);for(var o=r.length,e=n?r:new Array(o),i=0;o>i;i++)e[i]=r[i]/t;return e}function V(r){var t=r.length,n=new Array(t);n[0]=r[0];for(var o=1;t>o;o++)n[o]=n[o-1]+r[o];return n}r.exports={min:o,max:n,minMax:e,mean:i,geometricMean:s,logGeometricMean:a,grandMean:u,truncatedMean:f,contraHarmonicMean:h,standardDeviation:c,standardError:l,median:m,quartiles:p,variance:w,pooledStandardDeviation:v,pooledVariance:g,mode:y,covariance:d,skewness:b,kurtosis:x,entropy:M,weightedMean:k,weightedStandardDeviation:R,weightedVariance:A,center:j,standardize:S,cumulativeSum:V}},function(r,t){"use strict";function n(r,t){"undefined"==typeof t&&(t=0);for(var n=0,o=r.length,e=r[0].length,i=0;o>i;i++)for(var s=0;e>s;s++)n+=r[i][s]*Math.log(r[i][s]+t);return-n}function o(r,t){"undefined"==typeof t&&(t=0);var n,o,e,i,s=r.length,a=r[0].length;if(-1===t){for(n=[0],o=s*a,e=0;s>e;e++)for(i=0;a>i;i++)n[0]+=r[e][i];n[0]/=o}else if(0===t)for(n=new Array(a),o=s,i=0;a>i;i++){for(n[i]=0,e=0;s>e;e++)n[i]+=r[e][i];n[i]/=o}else{if(1!==t)throw new Error("Invalid dimension");for(n=new Array(s),o=a,i=0;s>i;i++){for(n[i]=0,e=0;a>e;e++)n[i]+=r[i][e];n[i]/=o}}return n}function e(r,t,n){for(var o=i(r,t,n),e=o.length,s=0;e>s;s++)o[s]=Math.sqrt(o[s]);return o}function i(r,t,n){"undefined"==typeof n&&(n=!0),t=t||o(r);var e=r.length;if(0===e)return[];for(var i=r[0].length,s=new Array(i),a=0;i>a;a++){for(var u=0,f=0,h=0,c=0;e>c;c++)h=r[c][a]-t[a],u+=h,f+=h*h;n?s[a]=(f-u*u/e)/(e-1):s[a]=(f-u*u/e)/e}return s}function s(r){for(var t=r.length,n=r[0].length,o=new Array(n),e=0;n>e;e++){for(var i=new Array(t),s=0;t>s;s++)i[s]=r[s][e];i.sort();var a=i.length;a%2===0?o[e]=.5*(i[a/2]+i[a/2-1]):o[e]=i[Math.floor(a/2)]}return o}function a(r){var t,n,o=r.length,e=r[0].length,i=new Array(e);for(t=0;e>t;t++){for(var s=new Array(o),a=0;o>a;a++)s[a]=0;var u=new Array(o),f=0;for(n=0;o>n;n++){var h=u.indexOf(r[n][t]);h>=0?s[h]++:(u[f]=r[n][t],s[f]=1,f++)}var c=0,l=0;for(n=0;f>n;n++)s[n]>c&&(c=s[n],l=n);i[t]=u[l]}return i}function u(r,t){"undefined"==typeof t&&(t=!0);for(var n=o(r),e=r.length,i=n.length,s=new Array(i),a=0;i>a;a++){for(var u=0,f=0,h=0;e>h;h++){var c=r[h][a]-n[a];u+=c*c,f+=c*c*c}var l=u/e,m=f/e,p=m/Math.pow(l,1.5);if(t){var w=Math.sqrt(e*(e-1)),v=e-2;s[a]=w/v*p}else s[a]=p}return s}function f(r,t){"undefined"==typeof t&&(t=!0);for(var n=o(r),e=r.length,i=r[0].length,s=new Array(i),a=0;i>a;a++){for(var u=0,f=0,h=0;e>h;h++){var c=r[h][a]-n[a];u+=c*c,f+=c*c*c*c}var l=u/e,m=f/e;if(t){var p=u/(e-1),w=e*(e+1)/((e-1)*(e-2)*(e-3)),v=f/(p*p),g=(e-1)*(e-1)/((e-2)*(e-3));s[a]=w*v-3*g}else s[a]=m/(l*l)-3}return s}function h(r){for(var t=r.length,n=e(r),o=n.length,i=new Array(o),s=Math.sqrt(t),a=0;o>a;a++)i[a]=n[a]/s;return i}function c(r,t){return l(r,void 0,t)}function l(r,t,n){"undefined"==typeof n&&(n=0),"undefined"==typeof t&&(0===n?t=r.length-1:1===n&&(t=r[0].length-1));var e=o(r,n),i=r.length;if(0===i)return[[]];var s,a,u,f,h,c=r[0].length;if(0===n){for(s=new Array(c),a=0;c>a;a++)s[a]=new Array(c);for(a=0;c>a;a++)for(u=a;c>u;u++){for(f=0,h=0;i>h;h++)f+=(r[h][u]-e[u])*(r[h][a]-e[a]);f/=t,s[a][u]=f,s[u][a]=f}}else{if(1!==n)throw new Error("Invalid dimension");for(s=new Array(i),a=0;i>a;a++)s[a]=new Array(i);for(a=0;i>a;a++)for(u=a;i>u;u++){for(f=0,h=0;c>h;h++)f+=(r[u][h]-e[u])*(r[a][h]-e[a]);f/=t,s[a][u]=f,s[u][a]=f}}return s}function m(r){var t,n,i=o(r),s=e(r,!0,i),a=p(r,i,s),u=r.length,f=r[0].length,h=new Array(f);for(t=0;f>t;t++)h[t]=new Array(f);for(t=0;f>t;t++)for(n=t;f>n;n++){for(var c=0,l=0,m=a.length;m>l;l++)c+=a[l][n]*a[l][t];c/=u-1,h[t][n]=c,h[n][t]=c}return h}function p(r,t,n){return t=t||o(r),"undefined"==typeof n&&(n=e(r,!0,t)),v(w(r,t,!1),n,!0)}function w(r,t,n){t=t||o(r);var e,i,s,a=r,u=r.length;if(!n)for(a=new Array(u),e=0;u>e;e++)a[e]=new Array(r[e].length);for(e=0;u>e;e++){var f=a[e];for(i=0,s=f.length;s>i;i++)f[i]=r[e][i]-t[i]}return a}function v(r,t,n){"undefined"==typeof t&&(t=e(r));var o,i,s,a=r,u=r.length;if(!n)for(a=new Array(u),o=0;u>o;o++)a[o]=new Array(r[o].length);for(o=0;u>o;o++){var f=a[o],h=r[o];for(i=0,s=f.length;s>i;i++)0===t[i]||isNaN(t[i])||(f[i]=h[i]/t[i])}return a}function g(r,t){var n=o(r),e=r.length;if(0===e)return[];for(var i=r[0].length,s=new Array(i),a=0;i>a;a++){for(var u=0,f=0,h=0,c=0;e>c;c++){var l=r[c][a]-n[a],m=t[c];u+=m*(l*l),h+=m,f+=m*m}s[a]=u*(h/(h*h-f))}return s}function y(r,t,n){"undefined"==typeof n&&(n=0);var o=r.length;if(0===o)return[];var e,i,s,a,u,f,h=r[0].length;if(0===n){for(e=new Array(h),i=0;h>i;i++)e[i]=0;for(i=0;o>i;i++)for(f=r[i],u=t[i],a=0;h>a;a++)e[a]+=f[a]*u}else{if(1!==n)throw new Error("Invalid dimension");for(e=new Array(o),i=0;o>i;i++)e[i]=0;for(a=0;o>a;a++)for(f=r[a],u=t[a],i=0;h>i;i++)e[a]+=f[i]*u}var c=x(t);if(0!==c)for(i=0,s=e.length;s>i;i++)e[i]/=c;return e}function d(r,t,n,o){o=o||0,n=n||y(r,t,o);for(var e=0,i=0,s=0,a=t.length;a>s;s++)e+=t[s],i+=t[s]*t[s];var u=e/(e*e-i);return b(r,t,n,u,o)}function b(r,t,n,o,e){e=e||0,n=n||y(r,t,e),"undefined"==typeof o&&(o=1);var i=r.length;if(0===i)return[[]];var s,a,u,f,h,c=r[0].length;if(0===e){for(s=new Array(c),a=0;c>a;a++)s[a]=new Array(c);for(a=0;c>a;a++)for(u=a;c>u;u++){for(h=0,f=0;i>f;f++)h+=t[f]*(r[f][u]-n[u])*(r[f][a]-n[a]);s[a][u]=h*o,s[u][a]=h*o}}else{if(1!==e)throw new Error("Invalid dimension");for(s=new Array(i),a=0;i>a;a++)s[a]=new Array(i);for(a=0;i>a;a++)for(u=a;i>u;u++){for(h=0,f=0;c>f;f++)h+=t[f]*(r[u][f]-n[u])*(r[a][f]-n[a]);s[a][u]=h*o,s[u][a]=h*o}}return s}function x(r){for(var t=0,n=r.length,o=0;n>o;o++)t+=r[o];return t}r.exports={entropy:n,mean:o,standardDeviation:e,variance:i,median:s,mode:a,skewness:u,kurtosis:f,standardError:h,covariance:c,scatter:l,correlation:m,zScores:p,center:w,standardize:v,weightedVariance:g,weightedMean:y,weightedCovariance:d,weightedScatter:b}},function(r,t,n){"use strict";r.exports=n(9),r.exports.Decompositions=r.exports.DC=n(10)},function(r,t){"use strict";function n(r){for(var t=0,n=r.length,o=new Array(n);n>t;t++)o[t]=r[t];return o}function o(r,t){var e,i,s=0;if(Array.isArray(r)){if(i=t,e=i?n(r):r,r=e.length,t=e[0].length,"undefined"==typeof t)throw new TypeError("Data must be a 2D array");if(!(r>0&&t>0))throw new RangeError("Invalid dimensions: "+r+"x"+t);for(;r>s;s++){if(e[s].length!==t)throw new RangeError("Inconsistent array dimensions");i&&(e[s]=n(e[s]))}}else{if("number"!=typeof r)throw new TypeError("Invalid arguments");if(!(r>0&&t>0))throw new RangeError("Invalid dimensions: "+r+"x"+t);for(e=new Array(r);r>s;s++)e[s]=new Array(t)}return Object.defineProperty(e,"rows",{writable:!0,value:r}),Object.defineProperty(e,"columns",{writable:!0,value:t}),e.__proto__=o.prototype,e}var e=Array.prototype.splice,i=Array.prototype.concat;o.from1DArray=function(r,t,n){var e,i,s=0;if(e=r*t,e!==n.length)throw new RangeError("Data length does not match given dimensions");for(i=new Array(r);r>s;s++)i[s]=n.slice(s*t,(s+1)*t);return new o(i)},o.rowVector=function(r){return new o([r])},o.columnVector=function(r){for(var t=r.length,n=new Array(t),e=0;t>e;e++)n[e]=[r[e]];return new o(n)},o.empty=function(r,t){return new o(r,t)},o.zeros=function(r,t){return o.empty(r,t).fill(0)},o.ones=function(r,t){return o.empty(r,t).fill(1)},o.rand=function(r,t){for(var n=o.empty(r,t),e=0,i=n.rows;i>e;e++)for(var s=0,a=n.columns;a>s;s++)n[e][s]=Math.random();return n},o.eye=function(r){for(var t=o.zeros(r,r),n=t.rows,e=0;n>e;e++)t[e][e]=1;return t},o.diag=function(r){for(var t=r.length,n=o.zeros(t,t),e=0;t>e;e++)n[e][e]=r[e];return n},o.indices=function(r,t){for(var n=new Array(t-r),o=0;o<n.length;o++)n[o]=r++;return n},o.stack=function(r){var t,n,e;if(o.isMatrix(r)){var i=0,s=0;for(t=0;t<arguments.length;t++)i+=arguments[t].rows,arguments[t].columns>s&&(s=arguments[t].columns);var a=o.zeros(i,s),u=0;for(t=0;t<arguments.length;t++){var f=arguments[t];for(n=0;n<f.rows;n++){for(e=0;e<f.columns;e++)a[u][e]=f[n][e];u++}}return a}if(Array.isArray(r)){var h=o.empty(arguments.length,r.length);for(t=0;t<arguments.length;t++)h.setRow(t,arguments[t]);return h}},o.expand=function(r,t){for(var n=[],e=0;e<t.length;e++)for(var i=0;i<t[e];i++)n.push(r[e]);return new o(n)},o.checkMatrix=function(r){if(!r)throw new TypeError("Argument has to be a matrix");return"Matrix"!==r.klass&&(r=new o(r)),r},o.isMatrix=function(r){return r?"Matrix"===r.klass:!1},Object.defineProperty(o.prototype,"klass",{get:function(){return"Matrix"}}),Object.defineProperty(o.prototype,"size",{get:function(){return this.rows*this.columns}}),o.prototype.checkRowIndex=function(r){if(0>r||r>this.rows-1)throw new RangeError("Row index out of range.")},o.prototype.checkColumnIndex=function(r){if(0>r||r>this.columns-1)throw new RangeError("Column index out of range.")},o.prototype.checkDimensions=function(r){if(this.rows!==r.rows||this.columns!==r.columns)throw new RangeError("Matrices dimensions must be equal.")},o.prototype.apply=function(r){for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)r.call(this,o,e);return this},o.prototype.clone=function(){return new o(this.to2DArray())},o.prototype.to1DArray=function(){return i.apply([],this)},o.prototype.to2DArray=function(){for(var r=this.rows,t=new Array(r),o=0;r>o;o++)t[o]=n(this[o]);return t},o.prototype.isRowVector=function(){return 1===this.rows},o.prototype.isColumnVector=function(){return 1===this.columns},o.prototype.isVector=function(){return 1===this.rows||1===this.columns},o.prototype.isSquare=function(){return this.rows===this.columns},o.prototype.isSymmetric=function(){if(this.isSquare()){for(var r=this.rows,t=0;r>t;t++)for(var n=0;t>=n;n++)if(this[t][n]!==this[n][t])return!1;return!0}return!1},o.prototype.set=function(r,t,n){return this[r][t]=n,this},o.prototype.get=function(r,t){return this[r][t]},o.prototype.fill=function(r){for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]=r;return this},o.prototype.neg=function(){return this.mulS(-1)},o.prototype.add=function(r){return"number"==typeof r?this.addS(r):(r=o.checkMatrix(r),this.addM(r))},o.prototype.addS=function(r){for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]+=r;return this},o.prototype.addM=function(r){this.checkDimensions(r);for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]+=r[o][e];return this},o.prototype.sub=function(r){return"number"==typeof r?this.subS(r):(r=o.checkMatrix(r),this.subM(r))},o.prototype.subS=function(r){for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]-=r;return this},o.prototype.subM=function(r){this.checkDimensions(r);for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]-=r[o][e];return this},o.prototype.mul=function(r){return"number"==typeof r?this.mulS(r):(r=o.checkMatrix(r),this.mulM(r))},o.prototype.mulS=function(r){for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]*=r;return this},o.prototype.mulM=function(r){this.checkDimensions(r);for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]*=r[o][e];return this},o.prototype.div=function(r){return"number"==typeof r?this.divS(r):(r=o.checkMatrix(r),this.divM(r))},o.prototype.divS=function(r){for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]/=r;return this},o.prototype.divM=function(r){this.checkDimensions(r);for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]/=r[o][e];return this},o.prototype.getRow=function(r){return this.checkRowIndex(r),n(this[r])},o.prototype.getRowVector=function(r){return o.rowVector(this.getRow(r))},o.prototype.setRow=function(r,t){if(this.checkRowIndex(r),o.isMatrix(t)&&(t=t.to1DArray()),t.length!==this.columns)throw new RangeError("Invalid row size");return this[r]=n(t),this},o.prototype.removeRow=function(r){if(this.checkRowIndex(r),1===this.rows)throw new RangeError("A matrix cannot have less than one row");return e.call(this,r,1),this.rows-=1,this},o.prototype.addRow=function(r,t){if("undefined"==typeof t&&(t=r,r=this.rows),0>r||r>this.rows)throw new RangeError("Row index out of range.");if(o.isMatrix(t)&&(t=t.to1DArray()),t.length!==this.columns)throw new RangeError("Invalid row size");return e.call(this,r,0,n(t)),this.rows+=1,this},o.prototype.swapRows=function(r,t){this.checkRowIndex(r),this.checkRowIndex(t);var n=this[r];return this[r]=this[t],this[t]=n,this},o.prototype.getColumn=function(r){this.checkColumnIndex(r);for(var t=this.rows,n=new Array(t),o=0;t>o;o++)n[o]=this[o][r];return n},o.prototype.getColumnVector=function(r){return o.columnVector(this.getColumn(r))},o.prototype.setColumn=function(r,t){this.checkColumnIndex(r),o.isMatrix(t)&&(t=t.to1DArray());var n=this.rows;if(t.length!==n)throw new RangeError("Invalid column size");for(var e=0;n>e;e++)this[e][r]=t[e];return this},o.prototype.removeColumn=function(r){if(this.checkColumnIndex(r),1===this.columns)throw new RangeError("A matrix cannot have less than one column");for(var t=0,n=this.rows;n>t;t++)this[t].splice(r,1);return this.columns-=1,this},o.prototype.addColumn=function(r,t){if("undefined"==typeof t&&(t=r,r=this.columns),0>r||r>this.columns)throw new RangeError("Column index out of range.");o.isMatrix(t)&&(t=t.to1DArray());var n=this.rows;if(t.length!==n)throw new RangeError("Invalid column size");for(var e=0;n>e;e++)this[e].splice(r,0,t[e]);return this.columns+=1,this},o.prototype.swapColumns=function(r,t){this.checkRowIndex(r),this.checkRowIndex(t);for(var n,o,e=this.rows,i=0;e>i;i++)o=this[i],n=o[r],o[r]=o[t],o[t]=n;return this},o.prototype.checkRowVector=function(r){if(o.isMatrix(r)&&(r=r.to1DArray()),r.length!==this.columns)throw new RangeError("vector size must be the same as the number of columns");return r},o.prototype.checkColumnVector=function(r){if(o.isMatrix(r)&&(r=r.to1DArray()),r.length!==this.rows)throw new RangeError("vector size must be the same as the number of rows");return r},o.prototype.addRowVector=function(r){r=this.checkRowVector(r);for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]+=r[e];return this},o.prototype.subRowVector=function(r){r=this.checkRowVector(r);for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]-=r[e];return this},o.prototype.mulRowVector=function(r){r=this.checkRowVector(r);for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]*=r[e];return this},o.prototype.divRowVector=function(r){r=this.checkRowVector(r);for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]/=r[e];return this},o.prototype.addColumnVector=function(r){r=this.checkColumnVector(r);for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]+=r[o];return this},o.prototype.subColumnVector=function(r){r=this.checkColumnVector(r);for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]-=r[o];return this},o.prototype.mulColumnVector=function(r){r=this.checkColumnVector(r);for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]*=r[o];return this},o.prototype.divColumnVector=function(r){r=this.checkColumnVector(r);for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]/=r[o];return this},o.prototype.mulRow=function(r,t){this.checkRowIndex(r);for(var n=0,o=this.columns;o>n;n++)this[r][n]*=t;return this},o.prototype.mulColumn=function(r,t){this.checkColumnIndex(r);for(var n=0,o=this.rows;o>n;n++)this[n][r]*=t},o.prototype.max=function(){for(var r=-(1/0),t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]>r&&(r=this[o][e]);return r},o.prototype.maxIndex=function(){for(var r=-(1/0),t={},n=this.rows,o=this.columns,e=0;n>e;e++)for(var i=0;o>i;i++)this[e][i]>r&&(r=this[e][i],t.row=e,t.column=i);return t},o.prototype.min=function(){for(var r=1/0,t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]<r&&(r=this[o][e]);return r},o.prototype.minIndex=function(){for(var r=1/0,t={},n=this.rows,o=this.columns,e=0;n>e;e++)for(var i=0;o>i;i++)this[e][i]<r&&(r=this[e][i],t.row=e,t.column=i);return t},o.prototype.maxRow=function(r){this.checkRowIndex(r);for(var t=-(1/0),n=0,o=this.columns;o>n;n++)this[r][n]>t&&(t=this[r][n]);return t},o.prototype.maxRowIndex=function(r){this.checkRowIndex(r);for(var t=-(1/0),n={row:r},o=0,e=this.columns;e>o;o++)this[r][o]>t&&(t=this[r][o],n.column=o);return n},o.prototype.minRow=function(r){this.checkRowIndex(r);for(var t=1/0,n=0,o=this.columns;o>n;n++)this[r][n]<t&&(t=this[r][n]);return t},o.prototype.minRowIndex=function(r){this.checkRowIndex(r);for(var t=1/0,n={row:r,column:0},o=0,e=this.columns;e>o;o++)this[r][o]<t&&(t=this[r][o],n.column=o);return n},o.prototype.maxColumn=function(r){this.checkColumnIndex(r);for(var t=-(1/0),n=0,o=this.rows;o>n;n++)this[n][r]>t&&(t=this[n][r]);return t},o.prototype.maxColumnIndex=function(r){this.checkColumnIndex(r);for(var t=-(1/0),n={row:0,column:r},o=0,e=this.rows;e>o;o++)this[o][r]>t&&(t=this[o][r],n.row=o);return n},o.prototype.minColumn=function(r){this.checkColumnIndex(r);for(var t=1/0,n=0,o=this.rows;o>n;n++)this[n][r]<t&&(t=this[n][r]);return t},o.prototype.minColumnIndex=function(r){this.checkColumnIndex(r);for(var t=1/0,n={row:0,column:r},o=0,e=this.rows;e>o;o++)this[o][r]<t&&(t=this[o][r],n.row=o);return n},o.prototype.diag=function s(){if(!this.isSquare())throw new TypeError("Only square matrices have a diagonal.");for(var s=new Array(this.rows),r=0,t=this.rows;t>r;r++)s[r]=this[r][r];return s},o.prototype.sum=function(){for(var r=0,t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)r+=this[o][e];return r},o.prototype.mean=function(){return this.sum()/this.size},o.prototype.prod=function a(){for(var a=1,r=this.rows,t=this.columns,n=0;r>n;n++)for(var o=0;t>o;o++)a*=this[n][o];return a},o.prototype.cumulativeSum=function(){for(var r=0,t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)r+=this[o][e],this[o][e]=r;return this},o.prototype.dot=function u(r){if(this.size!==r.size)throw new RangeError("vectors do not have the same size");for(var t=this.to1DArray(),n=r.to1DArray(),u=0,o=t.length,e=0;o>e;e++)u+=t[e]*n[e];return u},o.prototype.mmul=function(r){if(!o.isMatrix(r))throw new TypeError('parameter "other" must be a matrix');this.columns!==r.rows&&console.warn("Number of columns of left matrix are not equal to number of rows of right matrix.");var t,n,e,i=this.rows,s=this.columns,a=r.columns,u=new o(i,a),f=new Array(s);for(n=0;a>n;n++){for(e=0;s>e;e++)f[e]=r[e][n];for(t=0;i>t;t++){var h=this[t],c=0;for(e=0;s>e;e++)c+=h[e]*f[e];u[t][n]=c}}return u},o.prototype.sortRows=function(r){for(var t=0,n=this.rows;n>t;t++)this[t].sort(r);return this},o.prototype.sortColumns=function(r){for(var t=0,n=this.columns;n>t;t++)this.setColumn(t,this.getColumn(t).sort(r));return this},o.prototype.transpose=function(){for(var r=new o(this.columns,this.rows),t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)r[i][e]=this[e][i];return r},o.prototype.subMatrix=function(r,t,n,e){if(r>t||n>e||0>r||r>=this.rows||0>t||t>=this.rows||0>n||n>=this.columns||0>e||e>=this.columns)throw new RangeError("Argument out of range");for(var i=new o(t-r+1,e-n+1),s=r;t>=s;s++)for(var a=n;e>=a;a++)i[s-r][a-n]=this[s][a];return i},o.prototype.subMatrixRow=function(r,t,n){if("undefined"==typeof t?(t=0,n=this.columns-1):"undefined"==typeof n&&(n=this.columns-1),t>n||0>t||t>=this.columns||0>n||n>=this.columns)throw new RangeError("Argument out of range.");for(var e=r.length,i=this.rows,s=new o(e,n-t+1),a=0;e>a;a++)for(var u=t;n>=u;u++){if(r[a]<0||r[a]>=i)throw new RangeError("Argument out of range.");s[a][u-t]=this[r[a]][u]}return s},o.prototype.subMatrixColumn=function(r,t,n){if("undefined"==typeof t?(t=0,n=this.rows-1):"undefined"==typeof n&&(n=this.rows-1),t>n||0>t||t>=this.rows||0>n||n>=this.rows)throw new RangeError("Argument out of range.");for(var e=r.length,i=this.columns,s=new o(n-t+1,e),a=0;e>a;a++)for(var u=t;n>=u;u++){if(r[a]<0||r[a]>=i)throw new RangeError("Argument out of range.");s[u-t][a]=this[u][r[a]]}return s},o.prototype.trace=function f(){if(!this.isSquare())throw new TypeError("The matrix is not square");for(var f=0,r=0,t=this.rows;t>r;r++)f+=this[r][r];return f},o.prototype.abs=function(){for(var r=this.rows,t=this.columns,n=0;r>n;n++)for(var o=0;t>o;o++)this[n][o]=Math.abs(this[n][o])},r.exports=o},function(r,t,n){"use strict";function o(r){return e(r,i.eye(r.rows))}function e(r,t){return r.isSquare()?new u(r).solve(t):new f(r).solve(t)}var i=n(9),s=n(11),a=n(13),u=n(14),f=n(15),h=n(16);i.prototype.inverse=function(){return o(this)},i.prototype.solve=function(r){return e(this,r)},r.exports={SingularValueDecomposition:s,SVD:s,EigenvalueDecomposition:a,EVD:a,LuDecomposition:u,LU:u,QrDecomposition:f,QR:f,CholeskyDecomposition:h,CHO:h,inverse:o,solve:e}},function(r,t,n){"use strict";function o(r,t){if(!(this instanceof o))return new o(r,t);r=e.checkMatrix(r),t=t||{};var n=r.clone(),s=r.rows,a=r.columns,u=Math.min(s,a),f=!0,h=!0;t.computeLeftSingularVectors===!1&&(f=!1),t.computeRightSingularVectors===!1&&(h=!1);var c=t.autoTranspose===!0,l=!1;if(a>s)if(c){n=n.transpose(),s=n.rows,a=n.columns,l=!0;var m=f;f=h,h=m}else console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");var p,w,v,g,y,d,b,x,M,k,R,A,j,S,V,E,C,D,I,O,q,z=new Array(Math.min(s+1,a)),T=e.zeros(s,u),U=e.zeros(a,a),L=new Array(a),_=new Array(s),N=Math.min(s-1,a),P=Math.max(0,Math.min(a-2,s));for(v=0,k=Math.max(N,P);k>v;v++){if(N>v){for(z[v]=0,p=v;s>p;p++)z[v]=i(z[v],n[p][v]);if(0!==z[v]){for(n[v][v]<0&&(z[v]=-z[v]),p=v;s>p;p++)n[p][v]/=z[v];n[v][v]+=1}z[v]=-z[v]}for(w=v+1;a>w;w++){if(N>v&&0!==z[v]){for(y=0,p=v;s>p;p++)y+=n[p][v]*n[p][w];for(y=-y/n[v][v],p=v;s>p;p++)n[p][w]+=y*n[p][v]}L[w]=n[v][w]}if(f&&N>v)for(p=v;s>p;p++)T[p][v]=n[p][v];if(P>v){for(L[v]=0,p=v+1;a>p;p++)L[v]=i(L[v],L[p]);if(0!==L[v]){for(L[v+1]<0&&(L[v]=-L[v]),p=v+1;a>p;p++)L[p]/=L[v];L[v+1]+=1}if(L[v]=-L[v],s>v+1&&0!==L[v]){for(p=v+1;s>p;p++)_[p]=0;for(w=v+1;a>w;w++)for(p=v+1;s>p;p++)_[p]+=L[w]*n[p][w];for(w=v+1;a>w;w++)for(y=-L[w]/L[v+1],p=v+1;s>p;p++)n[p][w]+=y*_[p]}if(h)for(p=v+1;a>p;p++)U[p][v]=L[p]}}if(g=Math.min(a,s+1),a>N&&(z[N]=n[N][N]),g>s&&(z[g-1]=0),g>P+1&&(L[P]=n[P][g-1]),L[g-1]=0,f){for(w=N;u>w;w++){for(p=0;s>p;p++)T[p][w]=0;T[w][w]=1}for(v=N-1;v>=0;v--)if(0!==z[v]){for(w=v+1;u>w;w++){for(y=0,p=v;s>p;p++)y+=T[p][v]*T[p][w];for(y=-y/T[v][v],p=v;s>p;p++)T[p][w]+=y*T[p][v]}for(p=v;s>p;p++)T[p][v]=-T[p][v];for(T[v][v]=1+T[v][v],p=0;v-1>p;p++)T[p][v]=0}else{for(p=0;s>p;p++)T[p][v]=0;T[v][v]=1}}if(h)for(v=a-1;v>=0;v--){if(P>v&&0!==L[v])for(w=v+1;a>w;w++){for(y=0,p=v+1;a>p;p++)y+=U[p][v]*U[p][w];for(y=-y/U[v+1][v],p=v+1;a>p;p++)U[p][w]+=y*U[p][v]}for(p=0;a>p;p++)U[p][v]=0;U[v][v]=1}for(var F=g-1,Q=0,B=Math.pow(2,-52);g>0;){for(v=g-2;v>=-1&&-1!==v;v--)if(Math.abs(L[v])<=B*(Math.abs(z[v])+Math.abs(z[v+1]))){L[v]=0;break}if(v===g-2)R=4;else{for(d=g-1;d>=v&&d!==v;d--)if(y=(d!==g?Math.abs(L[d]):0)+(d!==v+1?Math.abs(L[d-1]):0),Math.abs(z[d])<=B*y){z[d]=0;break}d===v?R=3:d===g-1?R=1:(R=2,v=d)}switch(v++,R){case 1:for(b=L[g-2],L[g-2]=0,w=g-2;w>=v;w--)if(y=i(z[w],b),x=z[w]/y,M=b/y,z[w]=y,w!==v&&(b=-M*L[w-1],L[w-1]=x*L[w-1]),h)for(p=0;a>p;p++)y=x*U[p][w]+M*U[p][g-1],U[p][g-1]=-M*U[p][w]+x*U[p][g-1],U[p][w]=y;break;case 2:for(b=L[v-1],L[v-1]=0,w=v;g>w;w++)if(y=i(z[w],b),x=z[w]/y,M=b/y,z[w]=y,b=-M*L[w],L[w]=x*L[w],f)for(p=0;s>p;p++)y=x*T[p][w]+M*T[p][v-1],T[p][v-1]=-M*T[p][w]+x*T[p][v-1],T[p][w]=y;break;case 3:for(A=Math.max(Math.max(Math.max(Math.max(Math.abs(z[g-1]),Math.abs(z[g-2])),Math.abs(L[g-2])),Math.abs(z[v])),Math.abs(L[v])),j=z[g-1]/A,S=z[g-2]/A,V=L[g-2]/A,E=z[v]/A,C=L[v]/A,D=((S+j)*(S-j)+V*V)/2,I=j*V*(j*V),O=0,(0!==D||0!==I)&&(O=Math.sqrt(D*D+I),0>D&&(O=-O),O=I/(D+O)),b=(E+j)*(E-j)+O,q=E*C,w=v;g-1>w;w++){if(y=i(b,q),x=b/y,M=q/y,w!==v&&(L[w-1]=y),b=x*z[w]+M*L[w],L[w]=x*L[w]-M*z[w],q=M*z[w+1],z[w+1]=x*z[w+1],h)for(p=0;a>p;p++)y=x*U[p][w]+M*U[p][w+1],U[p][w+1]=-M*U[p][w]+x*U[p][w+1],U[p][w]=y;if(y=i(b,q),x=b/y,M=q/y,z[w]=y,b=x*L[w]+M*z[w+1],z[w+1]=-M*L[w]+x*z[w+1],q=M*L[w+1],L[w+1]=x*L[w+1],f&&s-1>w)for(p=0;s>p;p++)y=x*T[p][w]+M*T[p][w+1],T[p][w+1]=-M*T[p][w]+x*T[p][w+1],T[p][w]=y}L[g-2]=b,Q+=1;break;case 4:if(z[v]<=0&&(z[v]=z[v]<0?-z[v]:0,h))for(p=0;F>=p;p++)U[p][v]=-U[p][v];for(;F>v&&!(z[v]>=z[v+1]);){if(y=z[v],z[v]=z[v+1],z[v+1]=y,h&&a-1>v)for(p=0;a>p;p++)y=U[p][v+1],U[p][v+1]=U[p][v],U[p][v]=y;if(f&&s-1>v)for(p=0;s>p;p++)y=T[p][v+1],T[p][v+1]=T[p][v],T[p][v]=y;v++}Q=0,g--}}if(l){var X=U;U=T,T=X}this.m=s,this.n=a,this.s=z,this.U=T,this.V=U}var e=n(9),i=n(12).hypotenuse;o.prototype={get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]},get norm2(){return this.s[0]},get rank(){for(var r=Math.pow(2,-52),t=Math.max(this.m,this.n)*this.s[0]*r,n=0,o=this.s,e=0,i=o.length;i>e;e++)o[e]>t&&n++;return n},get diagonal(){return this.s;
},get threshold(){return Math.pow(2,-52)/2*Math.max(this.m,this.n)*this.s[0]},get leftSingularVectors(){return this.U},get rightSingularVectors(){return this.V},get diagonalMatrix(){return e.diag(this.s)},solve:function(r){var t,n=r,o=this.threshold,i=this.s.length,s=e.zeros(i,i);for(t=0;i>t;t++)Math.abs(this.s[t])<=o?s[t][t]=0:s[t][t]=1/this.s[t];var a,u,f,h=this.V.mmul(s),c=this.V.rows,l=this.U.rows,m=e.zeros(c,l);for(t=0;c>t;t++)for(a=0;l>a;a++){for(f=0,u=0;i>u;u++)f+=h[t][u]*this.U[a][u];m[t][a]=f}return m.mmul(n)},solveForDiagonal:function(r){return this.solve(e.diag(r))},inverse:function(){var r,t,n=this.threshold,o=this.V.rows,i=this.V.columns,s=new e(o,this.s.length);for(r=0;o>r;r++)for(t=0;i>t;t++)Math.abs(this.s[t])>n?s[r][t]=this.V[r][t]/this.s[t]:s[r][t]=0;var a,u,f=this.U.rows,h=this.U.columns,c=new e(o,f);for(r=0;o>r;r++)for(t=0;f>t;t++){for(u=0,a=0;h>a;a++)u+=s[r][a]*this.U[t][a];c[r][t]=u}return c}},r.exports=o},function(r,t){"use strict";t.hypotenuse=function(r,t){var n;return Math.abs(r)>Math.abs(t)?(n=t/r,Math.abs(r)*Math.sqrt(1+n*n)):0!==t?(n=r/t,Math.abs(t)*Math.sqrt(1+n*n)):0}},function(r,t,n){"use strict";function o(r){if(!(this instanceof o))return new o(r);if(r=f.checkMatrix(r),!r.isSquare())throw new Error("Matrix is not a square matrix");var t,n,u=r.columns,h=f.zeros(u,u),c=new Array(u),l=new Array(u),m=r;if(r.isSymmetric()){for(t=0;u>t;t++)for(n=0;u>n;n++)h[t][n]=m[t][n];e(u,l,c,h),i(u,l,c,h)}else{var p=f.zeros(u,u),w=new Array(u);for(n=0;u>n;n++)for(t=0;u>t;t++)p[t][n]=m[t][n];s(u,p,w,h),a(u,l,c,h,p)}this.n=u,this.e=l,this.d=c,this.V=h}function e(r,t,n,o){var e,i,s,a,u,f,h,c;for(u=0;r>u;u++)n[u]=o[r-1][u];for(a=r-1;a>0;a--){for(c=0,s=0,f=0;a>f;f++)c+=Math.abs(n[f]);if(0===c)for(t[a]=n[a-1],u=0;a>u;u++)n[u]=o[a-1][u],o[a][u]=0,o[u][a]=0;else{for(f=0;a>f;f++)n[f]/=c,s+=n[f]*n[f];for(e=n[a-1],i=Math.sqrt(s),e>0&&(i=-i),t[a]=c*i,s-=e*i,n[a-1]=e-i,u=0;a>u;u++)t[u]=0;for(u=0;a>u;u++){for(e=n[u],o[u][a]=e,i=t[u]+o[u][u]*e,f=u+1;a-1>=f;f++)i+=o[f][u]*n[f],t[f]+=o[f][u]*e;t[u]=i}for(e=0,u=0;a>u;u++)t[u]/=s,e+=t[u]*n[u];for(h=e/(s+s),u=0;a>u;u++)t[u]-=h*n[u];for(u=0;a>u;u++){for(e=n[u],i=t[u],f=u;a-1>=f;f++)o[f][u]-=e*t[f]+i*n[f];n[u]=o[a-1][u],o[a][u]=0}}n[a]=s}for(a=0;r-1>a;a++){if(o[r-1][a]=o[a][a],o[a][a]=1,s=n[a+1],0!==s){for(f=0;a>=f;f++)n[f]=o[f][a+1]/s;for(u=0;a>=u;u++){for(i=0,f=0;a>=f;f++)i+=o[f][a+1]*o[f][u];for(f=0;a>=f;f++)o[f][u]-=i*n[f]}}for(f=0;a>=f;f++)o[f][a+1]=0}for(u=0;r>u;u++)n[u]=o[r-1][u],o[r-1][u]=0;o[r-1][r-1]=1,t[0]=0}function i(r,t,n,o){var e,i,s,a,u,f,c,l,m,p,w,v,g,y,d,b,x;for(s=1;r>s;s++)t[s-1]=t[s];t[r-1]=0;var M=0,k=0,R=Math.pow(2,-52);for(f=0;r>f;f++){for(k=Math.max(k,Math.abs(n[f])+Math.abs(t[f])),c=f;r>c&&!(Math.abs(t[c])<=R*k);)c++;if(c>f){x=0;do{for(x+=1,e=n[f],l=(n[f+1]-e)/(2*t[f]),m=h(l,1),0>l&&(m=-m),n[f]=t[f]/(l+m),n[f+1]=t[f]*(l+m),p=n[f+1],i=e-n[f],s=f+2;r>s;s++)n[s]-=i;for(M+=i,l=n[c],w=1,v=w,g=w,y=t[f+1],d=0,b=0,s=c-1;s>=f;s--)for(g=v,v=w,b=d,e=w*t[s],i=w*l,m=h(l,t[s]),t[s+1]=d*m,d=t[s]/m,w=l/m,l=w*n[s]-d*e,n[s+1]=i+d*(w*e+d*n[s]),u=0;r>u;u++)i=o[u][s+1],o[u][s+1]=d*o[u][s]+w*i,o[u][s]=w*o[u][s]-d*i;l=-d*b*g*y*t[f]/p,t[f]=d*l,n[f]=w*l}while(Math.abs(t[f])>R*k)}n[f]=n[f]+M,t[f]=0}for(s=0;r-1>s;s++){for(u=s,l=n[s],a=s+1;r>a;a++)n[a]<l&&(u=a,l=n[a]);if(u!==s)for(n[u]=n[s],n[s]=l,a=0;r>a;a++)l=o[a][s],o[a][s]=o[a][u],o[a][u]=l}}function s(r,t,n,o){var e,i,s,a,u,f,h,c=0,l=r-1;for(f=c+1;l-1>=f;f++){for(h=0,a=f;l>=a;a++)h+=Math.abs(t[a][f-1]);if(0!==h){for(s=0,a=l;a>=f;a--)n[a]=t[a][f-1]/h,s+=n[a]*n[a];for(i=Math.sqrt(s),n[f]>0&&(i=-i),s-=n[f]*i,n[f]=n[f]-i,u=f;r>u;u++){for(e=0,a=l;a>=f;a--)e+=n[a]*t[a][u];for(e/=s,a=f;l>=a;a++)t[a][u]-=e*n[a]}for(a=0;l>=a;a++){for(e=0,u=l;u>=f;u--)e+=n[u]*t[a][u];for(e/=s,u=f;l>=u;u++)t[a][u]-=e*n[u]}n[f]=h*n[f],t[f][f-1]=h*i}}for(a=0;r>a;a++)for(u=0;r>u;u++)o[a][u]=a===u?1:0;for(f=l-1;f>=c+1;f--)if(0!==t[f][f-1]){for(a=f+1;l>=a;a++)n[a]=t[a][f-1];for(u=f;l>=u;u++){for(i=0,a=f;l>=a;a++)i+=n[a]*o[a][u];for(i=i/n[f]/t[f][f-1],a=f;l>=a;a++)o[a][u]+=i*n[a]}}}function a(r,t,n,o,e){var i,s,a,f,h,c,l,m,p,w,v,g,y,d,b,x=r-1,M=0,k=r-1,R=Math.pow(2,-52),A=0,j=0,S=0,V=0,E=0,C=0,D=0,I=0;for(i=0;r>i;i++)for((M>i||i>k)&&(n[i]=e[i][i],t[i]=0),s=Math.max(i-1,0);r>s;s++)j+=Math.abs(e[i][s]);for(;x>=M;){for(f=x;f>M&&(C=Math.abs(e[f-1][f-1])+Math.abs(e[f][f]),0===C&&(C=j),!(Math.abs(e[f][f-1])<R*C));)f--;if(f===x)e[x][x]=e[x][x]+A,n[x]=e[x][x],t[x]=0,x--,I=0;else if(f===x-1){if(l=e[x][x-1]*e[x-1][x],S=(e[x-1][x-1]-e[x][x])/2,V=S*S+l,D=Math.sqrt(Math.abs(V)),e[x][x]=e[x][x]+A,e[x-1][x-1]=e[x-1][x-1]+A,m=e[x][x],V>=0){for(D=S>=0?S+D:S-D,n[x-1]=m+D,n[x]=n[x-1],0!==D&&(n[x]=m-l/D),t[x-1]=0,t[x]=0,m=e[x][x-1],C=Math.abs(m)+Math.abs(D),S=m/C,V=D/C,E=Math.sqrt(S*S+V*V),S/=E,V/=E,s=x-1;r>s;s++)D=e[x-1][s],e[x-1][s]=V*D+S*e[x][s],e[x][s]=V*e[x][s]-S*D;for(i=0;x>=i;i++)D=e[i][x-1],e[i][x-1]=V*D+S*e[i][x],e[i][x]=V*e[i][x]-S*D;for(i=M;k>=i;i++)D=o[i][x-1],o[i][x-1]=V*D+S*o[i][x],o[i][x]=V*o[i][x]-S*D}else n[x-1]=m+S,n[x]=m+S,t[x-1]=D,t[x]=-D;x-=2,I=0}else{if(m=e[x][x],p=0,l=0,x>f&&(p=e[x-1][x-1],l=e[x][x-1]*e[x-1][x]),10===I){for(A+=m,i=M;x>=i;i++)e[i][i]-=m;C=Math.abs(e[x][x-1])+Math.abs(e[x-1][x-2]),m=p=.75*C,l=-.4375*C*C}if(30===I&&(C=(p-m)/2,C=C*C+l,C>0)){for(C=Math.sqrt(C),m>p&&(C=-C),C=m-l/((p-m)/2+C),i=M;x>=i;i++)e[i][i]-=C;A+=C,m=p=l=.964}for(I+=1,h=x-2;h>=f&&(D=e[h][h],E=m-D,C=p-D,S=(E*C-l)/e[h+1][h]+e[h][h+1],V=e[h+1][h+1]-D-E-C,E=e[h+2][h+1],C=Math.abs(S)+Math.abs(V)+Math.abs(E),S/=C,V/=C,E/=C,h!==f)&&!(Math.abs(e[h][h-1])*(Math.abs(V)+Math.abs(E))<R*(Math.abs(S)*(Math.abs(e[h-1][h-1])+Math.abs(D)+Math.abs(e[h+1][h+1]))));)h--;for(i=h+2;x>=i;i++)e[i][i-2]=0,i>h+2&&(e[i][i-3]=0);for(a=h;x-1>=a&&(d=a!==x-1,a!==h&&(S=e[a][a-1],V=e[a+1][a-1],E=d?e[a+2][a-1]:0,m=Math.abs(S)+Math.abs(V)+Math.abs(E),0!==m&&(S/=m,V/=m,E/=m)),0!==m);a++)if(C=Math.sqrt(S*S+V*V+E*E),0>S&&(C=-C),0!==C){for(a!==h?e[a][a-1]=-C*m:f!==h&&(e[a][a-1]=-e[a][a-1]),S+=C,m=S/C,p=V/C,D=E/C,V/=S,E/=S,s=a;r>s;s++)S=e[a][s]+V*e[a+1][s],d&&(S+=E*e[a+2][s],e[a+2][s]=e[a+2][s]-S*D),e[a][s]=e[a][s]-S*m,e[a+1][s]=e[a+1][s]-S*p;for(i=0;i<=Math.min(x,a+3);i++)S=m*e[i][a]+p*e[i][a+1],d&&(S+=D*e[i][a+2],e[i][a+2]=e[i][a+2]-S*E),e[i][a]=e[i][a]-S,e[i][a+1]=e[i][a+1]-S*V;for(i=M;k>=i;i++)S=m*o[i][a]+p*o[i][a+1],d&&(S+=D*o[i][a+2],o[i][a+2]=o[i][a+2]-S*E),o[i][a]=o[i][a]-S,o[i][a+1]=o[i][a+1]-S*V}}}if(0!==j){for(x=r-1;x>=0;x--)if(S=n[x],V=t[x],0===V)for(f=x,e[x][x]=1,i=x-1;i>=0;i--){for(l=e[i][i]-S,E=0,s=f;x>=s;s++)E+=e[i][s]*e[s][x];if(t[i]<0)D=l,C=E;else if(f=i,0===t[i]?e[i][x]=0!==l?-E/l:-E/(R*j):(m=e[i][i+1],p=e[i+1][i],V=(n[i]-S)*(n[i]-S)+t[i]*t[i],c=(m*C-D*E)/V,e[i][x]=c,e[i+1][x]=Math.abs(m)>Math.abs(D)?(-E-l*c)/m:(-C-p*c)/D),c=Math.abs(e[i][x]),R*c*c>1)for(s=i;x>=s;s++)e[s][x]=e[s][x]/c}else if(0>V)for(f=x-1,Math.abs(e[x][x-1])>Math.abs(e[x-1][x])?(e[x-1][x-1]=V/e[x][x-1],e[x-1][x]=-(e[x][x]-S)/e[x][x-1]):(b=u(0,-e[x-1][x],e[x-1][x-1]-S,V),e[x-1][x-1]=b[0],e[x-1][x]=b[1]),e[x][x-1]=0,e[x][x]=1,i=x-2;i>=0;i--){for(w=0,v=0,s=f;x>=s;s++)w+=e[i][s]*e[s][x-1],v+=e[i][s]*e[s][x];if(l=e[i][i]-S,t[i]<0)D=l,E=w,C=v;else if(f=i,0===t[i]?(b=u(-w,-v,l,V),e[i][x-1]=b[0],e[i][x]=b[1]):(m=e[i][i+1],p=e[i+1][i],g=(n[i]-S)*(n[i]-S)+t[i]*t[i]-V*V,y=2*(n[i]-S)*V,0===g&&0===y&&(g=R*j*(Math.abs(l)+Math.abs(V)+Math.abs(m)+Math.abs(p)+Math.abs(D))),b=u(m*E-D*w+V*v,m*C-D*v-V*w,g,y),e[i][x-1]=b[0],e[i][x]=b[1],Math.abs(m)>Math.abs(D)+Math.abs(V)?(e[i+1][x-1]=(-w-l*e[i][x-1]+V*e[i][x])/m,e[i+1][x]=(-v-l*e[i][x]-V*e[i][x-1])/m):(b=u(-E-p*e[i][x-1],-C-p*e[i][x],D,V),e[i+1][x-1]=b[0],e[i+1][x]=b[1])),c=Math.max(Math.abs(e[i][x-1]),Math.abs(e[i][x])),R*c*c>1)for(s=i;x>=s;s++)e[s][x-1]=e[s][x-1]/c,e[s][x]=e[s][x]/c}for(i=0;r>i;i++)if(M>i||i>k)for(s=i;r>s;s++)o[i][s]=e[i][s];for(s=r-1;s>=M;s--)for(i=M;k>=i;i++){for(D=0,a=M;a<=Math.min(s,k);a++)D+=o[i][a]*e[a][s];o[i][s]=D}}}function u(r,t,n,o){var e,i;return Math.abs(n)>Math.abs(o)?(e=o/n,i=n+e*o,[(r+e*t)/i,(t-e*r)/i]):(e=n/o,i=o+e*n,[(e*r+t)/i,(e*t-r)/i])}var f=n(9),h=n(12).hypotenuse;o.prototype={get realEigenvalues(){return this.d},get imaginaryEigenvalues(){return this.e},get eigenvectorMatrix(){return this.V},get diagonalMatrix(){var r,t,n=this.n,o=this.e,e=this.d,i=new f(n,n);for(r=0;n>r;r++){for(t=0;n>t;t++)i[r][t]=0;i[r][r]=e[r],o[r]>0?i[r][r+1]=o[r]:o[r]<0&&(i[r][r-1]=o[r])}return i}},r.exports=o},function(r,t,n){"use strict";function o(r){if(!(this instanceof o))return new o(r);r=e.checkMatrix(r);var t,n,i,s,a,u,f,h,c,l,m=r.clone(),p=m.rows,w=m.columns,v=new Array(p),g=1;for(t=0;p>t;t++)v[t]=t;for(c=new Array(p),n=0;w>n;n++){for(t=0;p>t;t++)c[t]=m[t][n];for(t=0;p>t;t++){for(h=m[t],l=Math.min(t,n),a=0,i=0;l>i;i++)a+=h[i]*c[i];h[n]=c[t]-=a}for(s=n,t=n+1;p>t;t++)Math.abs(c[t])>Math.abs(c[s])&&(s=t);if(s!==n){for(i=0;w>i;i++)u=m[s][i],m[s][i]=m[n][i],m[n][i]=u;f=v[s],v[s]=v[n],v[n]=f,g=-g}if(p>n&&0!==m[n][n])for(t=n+1;p>t;t++)m[t][n]/=m[n][n]}this.LU=m,this.pivotVector=v,this.pivotSign=g}var e=n(9);o.prototype={isSingular:function(){for(var r=this.LU,t=r.columns,n=0;t>n;n++)if(0===r[n][n])return!0;return!1},get determinant(){var r=this.LU;if(!r.isSquare())throw new Error("Matrix must be square");for(var t=this.pivotSign,n=r.columns,o=0;n>o;o++)t*=r[o][o];return t},get lowerTriangularFactor(){for(var r=this.LU,t=r.rows,n=r.columns,o=new e(t,n),i=0;t>i;i++)for(var s=0;n>s;s++)i>s?o[i][s]=r[i][s]:i===s?o[i][s]=1:o[i][s]=0;return o},get upperTriangularFactor(){for(var r=this.LU,t=r.rows,n=r.columns,o=new e(t,n),i=0;t>i;i++)for(var s=0;n>s;s++)s>=i?o[i][s]=r[i][s]:o[i][s]=0;return o},get pivotPermutationVector(){return this.pivotVector.slice()},solve:function(r){r=e.checkMatrix(r);var t=this.LU,n=t.rows;if(n!==r.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");var o,i,s,a=r.columns,u=r.subMatrixRow(this.pivotVector,0,a-1),f=t.columns;for(s=0;f>s;s++)for(o=s+1;f>o;o++)for(i=0;a>i;i++)u[o][i]-=u[s][i]*t[o][s];for(s=f-1;s>=0;s--){for(i=0;a>i;i++)u[s][i]/=t[s][s];for(o=0;s>o;o++)for(i=0;a>i;i++)u[o][i]-=u[s][i]*t[o][s]}return u}},r.exports=o},function(r,t,n){"use strict";function o(r){if(!(this instanceof o))return new o(r);r=e.checkMatrix(r);var t,n,s,a,u=r.clone(),f=r.rows,h=r.columns,c=new Array(h);for(s=0;h>s;s++){var l=0;for(t=s;f>t;t++)l=i(l,u[t][s]);if(0!==l){for(u[s][s]<0&&(l=-l),t=s;f>t;t++)u[t][s]/=l;for(u[s][s]+=1,n=s+1;h>n;n++){for(a=0,t=s;f>t;t++)a+=u[t][s]*u[t][n];for(a=-a/u[s][s],t=s;f>t;t++)u[t][n]+=a*u[t][s]}}c[s]=-l}this.QR=u,this.Rdiag=c}var e=n(9),i=n(12).hypotenuse;o.prototype={solve:function(r){r=e.checkMatrix(r);var t=this.QR,n=t.rows;if(r.rows!==n)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");var o,i,s,a,u=r.columns,f=r.clone(),h=t.columns;for(s=0;h>s;s++)for(i=0;u>i;i++){for(a=0,o=s;n>o;o++)a+=t[o][s]*f[o][i];for(a=-a/t[s][s],o=s;n>o;o++)f[o][i]+=a*t[o][s]}for(s=h-1;s>=0;s--){for(i=0;u>i;i++)f[s][i]/=this.Rdiag[s];for(o=0;s>o;o++)for(i=0;u>i;i++)f[o][i]-=f[s][i]*t[o][s]}return f.subMatrix(0,h-1,0,u-1)},isFullRank:function(){for(var r=this.QR.columns,t=0;r>t;t++)if(0===this.Rdiag[t])return!1;return!0},get upperTriangularFactor(){var r,t,n=this.QR,o=n.columns,i=new e(o,o);for(r=0;o>r;r++)for(t=0;o>t;t++)t>r?i[r][t]=n[r][t]:r===t?i[r][t]=this.Rdiag[r]:i[r][t]=0;return i},get orthogonalFactor(){var r,t,n,o,i=this.QR,s=i.rows,a=i.columns,u=new e(s,a);for(n=a-1;n>=0;n--){for(r=0;s>r;r++)u[r][n]=0;for(u[n][n]=1,t=n;a>t;t++)if(0!==i[n][n]){for(o=0,r=n;s>r;r++)o+=i[r][n]*u[r][t];for(o=-o/i[n][n],r=n;s>r;r++)u[r][t]+=o*i[r][n]}}return u}},r.exports=o},function(r,t,n){"use strict";function o(r){if(!(this instanceof o))return new o(r);if(r=e.checkMatrix(r),!r.isSymmetric())throw new Error("Matrix is not symmetric");var t,n,i,s=r,a=s.rows,u=new e(a,a),f=!0;for(n=0;a>n;n++){var h=u[n],c=0;for(i=0;n>i;i++){var l=u[i],m=0;for(t=0;i>t;t++)m+=l[t]*h[t];h[i]=m=(s[n][i]-m)/u[i][i],c+=m*m}for(c=s[n][n]-c,f&=c>0,u[n][n]=Math.sqrt(Math.max(c,0)),i=n+1;a>i;i++)u[n][i]=0}if(!f)throw new Error("Matrix is not positive definite");this.L=u}var e=n(9);o.prototype={get leftTriangularFactor(){return this.L},solve:function(r){r=e.checkMatrix(r);var t=this.L,n=t.rows;if(r.rows!==n)throw new Error("Matrix dimensions do not match");var o,i,s,a=r.columns,u=r.clone();for(s=0;n>s;s++)for(i=0;a>i;i++){for(o=0;s>o;o++)u[s][i]-=u[o][i]*t[s][o];u[s][i]/=t[s][s]}for(s=n-1;s>=0;s--)for(i=0;a>i;i++){for(o=s+1;n>o;o++)u[s][i]-=u[o][i]*t[o][s];u[s][i]/=t[s][s]}return u}},r.exports=o},function(r,t,n){"use strict";function o(r){for(var t=0,n=0;n<r.length;n++)t+=w[255&r[n]]+w[r[n]>>8&255]+w[r[n]>>16&255]+w[r[n]>>24&255];return t}function e(r,t){for(var n=new Array(r.length),o=0;o<r.length;o++)n[o]=r[o]&t[o];return n}function i(r,t){for(var n=new Array(r.length),o=0;o<r.length;o++)n[o]=r[o]|t[o];return n}function s(r,t){for(var n=new Array(r.length),o=0;o<r.length;o++)n[o]=r[o]^t[o];return n}function a(r){for(var t=new Array(r.length),n=0;n<t.length;n++)t[n]=~r[n];return t}function u(r,t){var n=t>>5,o=1<<31-t%32;return Boolean(r[n]&o)}function f(r,t,n){var o=t>>5,e=1<<31-t%32;return n?r[o]=e|r[o]:r[o]=~e&r[o],r}function h(r){for(var t="",n=0;n<r.length;n++){var o=(r[n]>>>0).toString(2);t+="00000000000000000000000000000000".substr(o.length)+o}return t}function c(r){for(var t=r.length/32,n=new Array(t),o=0;t>o;o++)n[o]=0|parseInt(r.substr(32*o,32),2);return n}function l(r){for(var t="",n=0;n<r.length;n++){var o=(r[n]>>>0).toString(16);t+="00000000".substr(o.length)+o}return t}function m(r){for(var t=r.length/8,n=new Array(t),o=0;t>o;o++)n[o]=0|parseInt(r.substr(8*o,8),16);return n}function p(r){for(var t=h(r),n="",o=0;o<r.length;o++){n+="0000".substr((32*o).toString(16).length)+(32*o).toString(16)+":";for(var e=0;32>e;e+=4)n+=" "+t.substr(32*o+e,4);o<r.length-1&&(n+="\n")}return n}var w=n(18);r.exports={count:o,and:e,or:i,xor:s,not:a,getBit:u,setBit:f,toBinaryString:h,parseBinaryString:c,toHexString:l,parseHexString:m,toDebug:p}},function(r,t){for(var n=new Array(256),o=0;256>o;o++){for(var e=o,i=0;e;)e&=e-1,i++;n[o]=i}r.exports=n},function(r,t,n){"use strict";r.exports=n(20),r.exports.Decompositions=r.exports.DC=n(21)},function(r,t){"use strict";function n(r){for(var t=0,n=r.length,o=new Array(n);n>t;t++)o[t]=r[t];return o}function o(r,t){var e,i,s=0;if(Array.isArray(r)){if(i=t,e=i?n(r):r,r=e.length,t=e[0].length,"undefined"==typeof t)throw new TypeError("Data must be a 2D array");if(!(r>0&&t>0))throw new RangeError("Invalid dimensions: "+r+"x"+t);for(;r>s;s++){if(e[s].length!==t)throw new RangeError("Inconsistent array dimensions");i&&(e[s]=n(e[s]))}}else{if("number"!=typeof r)throw new TypeError("Invalid arguments");if(!(r>0&&t>0))throw new RangeError("Invalid dimensions: "+r+"x"+t);for(e=new Array(r);r>s;s++)e[s]=new Array(t)}return Object.defineProperty(e,"rows",{writable:!0,value:r}),Object.defineProperty(e,"columns",{writable:!0,value:t}),e.__proto__=o.prototype,e}var e=Array.prototype.splice,i=Array.prototype.concat;o.from1DArray=function(r,t,n){var e,i,s=0;if(e=r*t,e!==n.length)throw new RangeError("Data length does not match given dimensions");for(i=new Array(r);r>s;s++)i[s]=n.slice(s*t,(s+1)*t);return new o(i)},o.rowVector=function(r){return new o([r])},o.columnVector=function(r){for(var t=r.length,n=new Array(t),e=0;t>e;e++)n[e]=[r[e]];return new o(n)},o.empty=function(r,t){return new o(r,t)},o.zeros=function(r,t){return o.empty(r,t).fill(0)},o.ones=function(r,t){return o.empty(r,t).fill(1)},o.rand=function(r,t){for(var n=o.empty(r,t),e=0,i=n.rows;i>e;e++)for(var s=0,a=n.columns;a>s;s++)n[e][s]=Math.random();return n},o.eye=function(r){for(var t=o.zeros(r,r),n=t.rows,e=0;n>e;e++)t[e][e]=1;return t},o.diag=function(r){for(var t=r.length,n=o.zeros(t,t),e=0;t>e;e++)n[e][e]=r[e];return n},o.indices=function(r,t){for(var n=new Array(t-r),o=0;o<n.length;o++)n[o]=r++;return n},o.stack=function(r){var t,n,e;if(o.isMatrix(r)){var i=0,s=0;for(t=0;t<arguments.length;t++)i+=arguments[t].rows,arguments[t].columns>s&&(s=arguments[t].columns);var a=o.zeros(i,s),u=0;for(t=0;t<arguments.length;t++){var f=arguments[t];for(n=0;n<f.rows;n++){for(e=0;e<f.columns;e++)a[u][e]=f[n][e];u++}}return a}if(Array.isArray(r)){var h=o.empty(arguments.length,r.length);for(t=0;t<arguments.length;t++)h.setRow(t,arguments[t]);return h}},o.expand=function(r,t){for(var n=[],e=0;e<t.length;e++)for(var i=0;i<t[e];i++)n.push(r[e]);return new o(n)},o.checkMatrix=function(r){if(!r)throw new TypeError("Argument has to be a matrix");return"Matrix"!==r.klass&&(r=new o(r)),r},o.isMatrix=function(r){return r?"Matrix"===r.klass:!1},Object.defineProperty(o.prototype,"klass",{get:function(){return"Matrix"}}),Object.defineProperty(o.prototype,"size",{get:function(){return this.rows*this.columns}}),o.prototype.checkRowIndex=function(r){if(0>r||r>this.rows-1)throw new RangeError("Row index out of range.")},o.prototype.checkColumnIndex=function(r){if(0>r||r>this.columns-1)throw new RangeError("Column index out of range.")},o.prototype.checkDimensions=function(r){if(this.rows!==r.rows||this.columns!==r.columns)throw new RangeError("Matrices dimensions must be equal.")},o.prototype.apply=function(r){for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)r.call(this,o,e);return this},o.prototype.clone=function(){return new o(this.to2DArray())},o.prototype.to1DArray=function(){return i.apply([],this)},o.prototype.to2DArray=function(){for(var r=this.rows,t=new Array(r),o=0;r>o;o++)t[o]=n(this[o]);return t},o.prototype.isRowVector=function(){return 1===this.rows},o.prototype.isColumnVector=function(){return 1===this.columns},o.prototype.isVector=function(){return 1===this.rows||1===this.columns},o.prototype.isSquare=function(){return this.rows===this.columns},o.prototype.isSymmetric=function(){if(this.isSquare()){for(var r=this.rows,t=0;r>t;t++)for(var n=0;t>=n;n++)if(this[t][n]!==this[n][t])return!1;return!0}return!1},o.prototype.set=function(r,t,n){return this[r][t]=n,this},o.prototype.get=function(r,t){return this[r][t]},o.prototype.fill=function(r){for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]=r;return this},o.prototype.neg=function(){return this.mulS(-1)},o.prototype.add=function(r){return"number"==typeof r?this.addS(r):(r=o.checkMatrix(r),this.addM(r))},o.prototype.addS=function(r){for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]+=r;return this},o.prototype.addM=function(r){this.checkDimensions(r);for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]+=r[o][e];return this},o.prototype.sub=function(r){return"number"==typeof r?this.subS(r):(r=o.checkMatrix(r),this.subM(r))},o.prototype.subS=function(r){for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]-=r;return this},o.prototype.subM=function(r){this.checkDimensions(r);for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]-=r[o][e];return this},o.prototype.mul=function(r){return"number"==typeof r?this.mulS(r):(r=o.checkMatrix(r),this.mulM(r))},o.prototype.mulS=function(r){for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]*=r;return this},o.prototype.mulM=function(r){this.checkDimensions(r);for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]*=r[o][e];return this},o.prototype.div=function(r){return"number"==typeof r?this.divS(r):(r=o.checkMatrix(r),this.divM(r))},o.prototype.divS=function(r){for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]/=r;return this},o.prototype.divM=function(r){this.checkDimensions(r);for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]/=r[o][e];return this},o.prototype.getRow=function(r){return this.checkRowIndex(r),n(this[r])},o.prototype.getRowVector=function(r){return o.rowVector(this.getRow(r))},o.prototype.setRow=function(r,t){if(this.checkRowIndex(r),o.isMatrix(t)&&(t=t.to1DArray()),t.length!==this.columns)throw new RangeError("Invalid row size");return this[r]=n(t),this},o.prototype.removeRow=function(r){if(this.checkRowIndex(r),1===this.rows)throw new RangeError("A matrix cannot have less than one row");return e.call(this,r,1),this.rows-=1,this},o.prototype.addRow=function(r,t){if("undefined"==typeof t&&(t=r,r=this.rows),0>r||r>this.rows)throw new RangeError("Row index out of range.");if(o.isMatrix(t)&&(t=t.to1DArray()),t.length!==this.columns)throw new RangeError("Invalid row size");return e.call(this,r,0,n(t)),this.rows+=1,this},o.prototype.swapRows=function(r,t){this.checkRowIndex(r),this.checkRowIndex(t);var n=this[r];return this[r]=this[t],this[t]=n,this},o.prototype.getColumn=function(r){this.checkColumnIndex(r);for(var t=this.rows,n=new Array(t),o=0;t>o;o++)n[o]=this[o][r];return n},o.prototype.getColumnVector=function(r){return o.columnVector(this.getColumn(r))},o.prototype.setColumn=function(r,t){this.checkColumnIndex(r),o.isMatrix(t)&&(t=t.to1DArray());var n=this.rows;if(t.length!==n)throw new RangeError("Invalid column size");for(var e=0;n>e;e++)this[e][r]=t[e];return this},o.prototype.removeColumn=function(r){if(this.checkColumnIndex(r),1===this.columns)throw new RangeError("A matrix cannot have less than one column");for(var t=0,n=this.rows;n>t;t++)this[t].splice(r,1);return this.columns-=1,this},o.prototype.addColumn=function(r,t){if("undefined"==typeof t&&(t=r,r=this.columns),0>r||r>this.columns)throw new RangeError("Column index out of range.");o.isMatrix(t)&&(t=t.to1DArray());var n=this.rows;if(t.length!==n)throw new RangeError("Invalid column size");for(var e=0;n>e;e++)this[e].splice(r,0,t[e]);return this.columns+=1,this},o.prototype.swapColumns=function(r,t){this.checkRowIndex(r),this.checkRowIndex(t);for(var n,o,e=this.rows,i=0;e>i;i++)o=this[i],n=o[r],o[r]=o[t],o[t]=n;return this},o.prototype.checkRowVector=function(r){if(o.isMatrix(r)&&(r=r.to1DArray()),r.length!==this.columns)throw new RangeError("vector size must be the same as the number of columns");return r},o.prototype.checkColumnVector=function(r){if(o.isMatrix(r)&&(r=r.to1DArray()),r.length!==this.rows)throw new RangeError("vector size must be the same as the number of rows");return r},o.prototype.addRowVector=function(r){r=this.checkRowVector(r);for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]+=r[e];return this},o.prototype.subRowVector=function(r){r=this.checkRowVector(r);for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]-=r[e];return this},o.prototype.mulRowVector=function(r){r=this.checkRowVector(r);for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]*=r[e];return this},o.prototype.divRowVector=function(r){r=this.checkRowVector(r);for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]/=r[e];return this},o.prototype.addColumnVector=function(r){r=this.checkColumnVector(r);for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]+=r[o];return this},o.prototype.subColumnVector=function(r){r=this.checkColumnVector(r);for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]-=r[o];return this},o.prototype.mulColumnVector=function(r){r=this.checkColumnVector(r);for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]*=r[o];return this},o.prototype.divColumnVector=function(r){r=this.checkColumnVector(r);for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]/=r[o];return this},o.prototype.mulRow=function(r,t){this.checkRowIndex(r);for(var n=0,o=this.columns;o>n;n++)this[r][n]*=t;return this},o.prototype.mulColumn=function(r,t){this.checkColumnIndex(r);for(var n=0,o=this.rows;o>n;n++)this[n][r]*=t},o.prototype.max=function(){for(var r=-(1/0),t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]>r&&(r=this[o][e]);return r},o.prototype.maxIndex=function(){for(var r=-(1/0),t={},n=this.rows,o=this.columns,e=0;n>e;e++)for(var i=0;o>i;i++)this[e][i]>r&&(r=this[e][i],t.row=e,t.column=i);return t},o.prototype.min=function(){for(var r=1/0,t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]<r&&(r=this[o][e]);return r},o.prototype.minIndex=function(){for(var r=1/0,t={},n=this.rows,o=this.columns,e=0;n>e;e++)for(var i=0;o>i;i++)this[e][i]<r&&(r=this[e][i],t.row=e,t.column=i);return t},o.prototype.maxRow=function(r){this.checkRowIndex(r);for(var t=-(1/0),n=0,o=this.columns;o>n;n++)this[r][n]>t&&(t=this[r][n]);return t},o.prototype.maxRowIndex=function(r){this.checkRowIndex(r);for(var t=-(1/0),n={row:r},o=0,e=this.columns;e>o;o++)this[r][o]>t&&(t=this[r][o],n.column=o);return n},o.prototype.minRow=function(r){this.checkRowIndex(r);for(var t=1/0,n=0,o=this.columns;o>n;n++)this[r][n]<t&&(t=this[r][n]);return t},o.prototype.minRowIndex=function(r){this.checkRowIndex(r);for(var t=1/0,n={row:r,column:0},o=0,e=this.columns;e>o;o++)this[r][o]<t&&(t=this[r][o],n.column=o);return n},o.prototype.maxColumn=function(r){this.checkColumnIndex(r);for(var t=-(1/0),n=0,o=this.rows;o>n;n++)this[n][r]>t&&(t=this[n][r]);return t},o.prototype.maxColumnIndex=function(r){this.checkColumnIndex(r);for(var t=-(1/0),n={row:0,column:r},o=0,e=this.rows;e>o;o++)this[o][r]>t&&(t=this[o][r],n.row=o);return n},o.prototype.minColumn=function(r){this.checkColumnIndex(r);for(var t=1/0,n=0,o=this.rows;o>n;n++)this[n][r]<t&&(t=this[n][r]);return t},o.prototype.minColumnIndex=function(r){this.checkColumnIndex(r);for(var t=1/0,n={row:0,column:r},o=0,e=this.rows;e>o;o++)this[o][r]<t&&(t=this[o][r],n.row=o);return n},o.prototype.diag=function s(){if(!this.isSquare())throw new TypeError("Only square matrices have a diagonal.");for(var s=new Array(this.rows),r=0,t=this.rows;t>r;r++)s[r]=this[r][r];return s},o.prototype.sum=function(){for(var r=0,t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)r+=this[o][e];return r},o.prototype.mean=function(){return this.sum()/this.size},o.prototype.prod=function a(){for(var a=1,r=this.rows,t=this.columns,n=0;r>n;n++)for(var o=0;t>o;o++)a*=this[n][o];return a},o.prototype.cumulativeSum=function(){for(var r=0,t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)r+=this[o][e],this[o][e]=r;return this},o.prototype.dot=function u(r){if(this.size!==r.size)throw new RangeError("vectors do not have the same size");for(var t=this.to1DArray(),n=r.to1DArray(),u=0,o=t.length,e=0;o>e;e++)u+=t[e]*n[e];return u},o.prototype.mmul=function(r){if(!o.isMatrix(r))throw new TypeError('parameter "other" must be a matrix');this.columns!==r.rows&&console.warn("Number of columns of left matrix are not equal to number of rows of right matrix.");var t,n,e,i=this.rows,s=this.columns,a=r.columns,u=new o(i,a),f=new Array(s);for(n=0;a>n;n++){for(e=0;s>e;e++)f[e]=r[e][n];for(t=0;i>t;t++){var h=this[t],c=0;for(e=0;s>e;e++)c+=h[e]*f[e];u[t][n]=c}}return u},o.prototype.sortRows=function(r){for(var t=0,n=this.rows;n>t;t++)this[t].sort(r);return this},o.prototype.sortColumns=function(r){for(var t=0,n=this.columns;n>t;t++)this.setColumn(t,this.getColumn(t).sort(r));return this},o.prototype.transpose=function(){for(var r=new o(this.columns,this.rows),t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)r[i][e]=this[e][i];return r},o.prototype.subMatrix=function(r,t,n,e){if(r>t||n>e||0>r||r>=this.rows||0>t||t>=this.rows||0>n||n>=this.columns||0>e||e>=this.columns)throw new RangeError("Argument out of range");for(var i=new o(t-r+1,e-n+1),s=r;t>=s;s++)for(var a=n;e>=a;a++)i[s-r][a-n]=this[s][a];return i},o.prototype.subMatrixRow=function(r,t,n){if("undefined"==typeof t?(t=0,n=this.columns-1):"undefined"==typeof n&&(n=this.columns-1),t>n||0>t||t>=this.columns||0>n||n>=this.columns)throw new RangeError("Argument out of range.");for(var e=r.length,i=this.rows,s=new o(e,n-t+1),a=0;e>a;a++)for(var u=t;n>=u;u++){if(r[a]<0||r[a]>=i)throw new RangeError("Argument out of range.");s[a][u-t]=this[r[a]][u]}return s},o.prototype.subMatrixColumn=function(r,t,n){if("undefined"==typeof t?(t=0,n=this.rows-1):"undefined"==typeof n&&(n=this.rows-1),t>n||0>t||t>=this.rows||0>n||n>=this.rows)throw new RangeError("Argument out of range.");for(var e=r.length,i=this.columns,s=new o(n-t+1,e),a=0;e>a;a++)for(var u=t;n>=u;u++){if(r[a]<0||r[a]>=i)throw new RangeError("Argument out of range.");s[u-t][a]=this[u][r[a]]}return s},o.prototype.trace=function f(){if(!this.isSquare())throw new TypeError("The matrix is not square");for(var f=0,r=0,t=this.rows;t>r;r++)f+=this[r][r];return f},o.prototype.abs=function(){for(var r=this.rows,t=this.columns,n=0;r>n;n++)for(var o=0;t>o;o++)this[n][o]=Math.abs(this[n][o])},r.exports=o},function(r,t,n){"use strict";function o(r){return e(r,i.eye(r.rows))}function e(r,t){return r.isSquare()?new u(r).solve(t):new f(r).solve(t)}var i=n(20),s=n(22),a=n(24),u=n(25),f=n(26),h=n(27);i.prototype.inverse=function(){return o(this)},i.prototype.solve=function(r){return e(this,r)},r.exports={SingularValueDecomposition:s,SVD:s,EigenvalueDecomposition:a,EVD:a,LuDecomposition:u,LU:u,QrDecomposition:f,QR:f,CholeskyDecomposition:h,CHO:h,inverse:o,solve:e}},function(r,t,n){"use strict";function o(r,t){if(!(this instanceof o))return new o(r,t);r=e.checkMatrix(r),t=t||{};var n=r.clone(),s=r.rows,a=r.columns,u=Math.min(s,a),f=!0,h=!0;t.computeLeftSingularVectors===!1&&(f=!1),t.computeRightSingularVectors===!1&&(h=!1);var c=t.autoTranspose===!0,l=!1;if(a>s)if(c){n=n.transpose(),s=n.rows,a=n.columns,l=!0;var m=f;f=h,h=m}else console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");var p,w,v,g,y,d,b,x,M,k,R,A,j,S,V,E,C,D,I,O,q,z=new Array(Math.min(s+1,a)),T=e.zeros(s,u),U=e.zeros(a,a),L=new Array(a),_=new Array(s),N=Math.min(s-1,a),P=Math.max(0,Math.min(a-2,s));for(v=0,k=Math.max(N,P);k>v;v++){if(N>v){for(z[v]=0,p=v;s>p;p++)z[v]=i(z[v],n[p][v]);if(0!==z[v]){for(n[v][v]<0&&(z[v]=-z[v]),p=v;s>p;p++)n[p][v]/=z[v];n[v][v]+=1}z[v]=-z[v]}for(w=v+1;a>w;w++){if(N>v&&0!==z[v]){for(y=0,p=v;s>p;p++)y+=n[p][v]*n[p][w];for(y=-y/n[v][v],p=v;s>p;p++)n[p][w]+=y*n[p][v]}L[w]=n[v][w]}if(f&&N>v)for(p=v;s>p;p++)T[p][v]=n[p][v];if(P>v){for(L[v]=0,p=v+1;a>p;p++)L[v]=i(L[v],L[p]);if(0!==L[v]){for(L[v+1]<0&&(L[v]=-L[v]),p=v+1;a>p;p++)L[p]/=L[v];L[v+1]+=1}if(L[v]=-L[v],s>v+1&&0!==L[v]){for(p=v+1;s>p;p++)_[p]=0;for(w=v+1;a>w;w++)for(p=v+1;s>p;p++)_[p]+=L[w]*n[p][w];for(w=v+1;a>w;w++)for(y=-L[w]/L[v+1],p=v+1;s>p;p++)n[p][w]+=y*_[p]}if(h)for(p=v+1;a>p;p++)U[p][v]=L[p]}}if(g=Math.min(a,s+1),a>N&&(z[N]=n[N][N]),g>s&&(z[g-1]=0),g>P+1&&(L[P]=n[P][g-1]),L[g-1]=0,f){for(w=N;u>w;w++){for(p=0;s>p;p++)T[p][w]=0;T[w][w]=1}for(v=N-1;v>=0;v--)if(0!==z[v]){for(w=v+1;u>w;w++){for(y=0,p=v;s>p;p++)y+=T[p][v]*T[p][w];for(y=-y/T[v][v],p=v;s>p;p++)T[p][w]+=y*T[p][v]}for(p=v;s>p;p++)T[p][v]=-T[p][v];for(T[v][v]=1+T[v][v],p=0;v-1>p;p++)T[p][v]=0}else{for(p=0;s>p;p++)T[p][v]=0;T[v][v]=1}}if(h)for(v=a-1;v>=0;v--){if(P>v&&0!==L[v])for(w=v+1;a>w;w++){for(y=0,p=v+1;a>p;p++)y+=U[p][v]*U[p][w];for(y=-y/U[v+1][v],p=v+1;a>p;p++)U[p][w]+=y*U[p][v]}for(p=0;a>p;p++)U[p][v]=0;U[v][v]=1}for(var F=g-1,Q=0,B=Math.pow(2,-52);g>0;){for(v=g-2;v>=-1&&-1!==v;v--)if(Math.abs(L[v])<=B*(Math.abs(z[v])+Math.abs(z[v+1]))){L[v]=0;break}if(v===g-2)R=4;else{for(d=g-1;d>=v&&d!==v;d--)if(y=(d!==g?Math.abs(L[d]):0)+(d!==v+1?Math.abs(L[d-1]):0),Math.abs(z[d])<=B*y){z[d]=0;break}d===v?R=3:d===g-1?R=1:(R=2,v=d)}switch(v++,R){case 1:for(b=L[g-2],L[g-2]=0,w=g-2;w>=v;w--)if(y=i(z[w],b),x=z[w]/y,M=b/y,z[w]=y,w!==v&&(b=-M*L[w-1],L[w-1]=x*L[w-1]),h)for(p=0;a>p;p++)y=x*U[p][w]+M*U[p][g-1],U[p][g-1]=-M*U[p][w]+x*U[p][g-1],U[p][w]=y;break;case 2:for(b=L[v-1],L[v-1]=0,w=v;g>w;w++)if(y=i(z[w],b),x=z[w]/y,M=b/y,z[w]=y,b=-M*L[w],L[w]=x*L[w],f)for(p=0;s>p;p++)y=x*T[p][w]+M*T[p][v-1],T[p][v-1]=-M*T[p][w]+x*T[p][v-1],T[p][w]=y;break;case 3:for(A=Math.max(Math.max(Math.max(Math.max(Math.abs(z[g-1]),Math.abs(z[g-2])),Math.abs(L[g-2])),Math.abs(z[v])),Math.abs(L[v])),j=z[g-1]/A,S=z[g-2]/A,V=L[g-2]/A,E=z[v]/A,C=L[v]/A,D=((S+j)*(S-j)+V*V)/2,I=j*V*(j*V),O=0,(0!==D||0!==I)&&(O=Math.sqrt(D*D+I),0>D&&(O=-O),O=I/(D+O)),b=(E+j)*(E-j)+O,q=E*C,w=v;g-1>w;w++){if(y=i(b,q),x=b/y,M=q/y,w!==v&&(L[w-1]=y),
b=x*z[w]+M*L[w],L[w]=x*L[w]-M*z[w],q=M*z[w+1],z[w+1]=x*z[w+1],h)for(p=0;a>p;p++)y=x*U[p][w]+M*U[p][w+1],U[p][w+1]=-M*U[p][w]+x*U[p][w+1],U[p][w]=y;if(y=i(b,q),x=b/y,M=q/y,z[w]=y,b=x*L[w]+M*z[w+1],z[w+1]=-M*L[w]+x*z[w+1],q=M*L[w+1],L[w+1]=x*L[w+1],f&&s-1>w)for(p=0;s>p;p++)y=x*T[p][w]+M*T[p][w+1],T[p][w+1]=-M*T[p][w]+x*T[p][w+1],T[p][w]=y}L[g-2]=b,Q+=1;break;case 4:if(z[v]<=0&&(z[v]=z[v]<0?-z[v]:0,h))for(p=0;F>=p;p++)U[p][v]=-U[p][v];for(;F>v&&!(z[v]>=z[v+1]);){if(y=z[v],z[v]=z[v+1],z[v+1]=y,h&&a-1>v)for(p=0;a>p;p++)y=U[p][v+1],U[p][v+1]=U[p][v],U[p][v]=y;if(f&&s-1>v)for(p=0;s>p;p++)y=T[p][v+1],T[p][v+1]=T[p][v],T[p][v]=y;v++}Q=0,g--}}if(l){var X=U;U=T,T=X}this.m=s,this.n=a,this.s=z,this.U=T,this.V=U}var e=n(20),i=n(23).hypotenuse;o.prototype={get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]},get norm2(){return this.s[0]},get rank(){for(var r=Math.pow(2,-52),t=Math.max(this.m,this.n)*this.s[0]*r,n=0,o=this.s,e=0,i=o.length;i>e;e++)o[e]>t&&n++;return n},get diagonal(){return this.s},get threshold(){return Math.pow(2,-52)/2*Math.max(this.m,this.n)*this.s[0]},get leftSingularVectors(){return this.U},get rightSingularVectors(){return this.V},get diagonalMatrix(){return e.diag(this.s)},solve:function(r){var t,n=r,o=this.threshold,i=this.s.length,s=e.zeros(i,i);for(t=0;i>t;t++)Math.abs(this.s[t])<=o?s[t][t]=0:s[t][t]=1/this.s[t];var a,u,f,h=this.V.mmul(s),c=this.V.rows,l=this.U.rows,m=e.zeros(c,l);for(t=0;c>t;t++)for(a=0;l>a;a++){for(f=0,u=0;i>u;u++)f+=h[t][u]*this.U[a][u];m[t][a]=f}return m.mmul(n)},solveForDiagonal:function(r){return this.solve(e.diag(r))},inverse:function(){var r,t,n=this.threshold,o=this.V.rows,i=this.V.columns,s=new e(o,this.s.length);for(r=0;o>r;r++)for(t=0;i>t;t++)Math.abs(this.s[t])>n?s[r][t]=this.V[r][t]/this.s[t]:s[r][t]=0;var a,u,f=this.U.rows,h=this.U.columns,c=new e(o,f);for(r=0;o>r;r++)for(t=0;f>t;t++){for(u=0,a=0;h>a;a++)u+=s[r][a]*this.U[t][a];c[r][t]=u}return c}},r.exports=o},function(r,t){"use strict";t.hypotenuse=function(r,t){var n;return Math.abs(r)>Math.abs(t)?(n=t/r,Math.abs(r)*Math.sqrt(1+n*n)):0!==t?(n=r/t,Math.abs(t)*Math.sqrt(1+n*n)):0}},function(r,t,n){"use strict";function o(r){if(!(this instanceof o))return new o(r);if(r=f.checkMatrix(r),!r.isSquare())throw new Error("Matrix is not a square matrix");var t,n,u=r.columns,h=f.zeros(u,u),c=new Array(u),l=new Array(u),m=r;if(r.isSymmetric()){for(t=0;u>t;t++)for(n=0;u>n;n++)h[t][n]=m[t][n];e(u,l,c,h),i(u,l,c,h)}else{var p=f.zeros(u,u),w=new Array(u);for(n=0;u>n;n++)for(t=0;u>t;t++)p[t][n]=m[t][n];s(u,p,w,h),a(u,l,c,h,p)}this.n=u,this.e=l,this.d=c,this.V=h}function e(r,t,n,o){var e,i,s,a,u,f,h,c;for(u=0;r>u;u++)n[u]=o[r-1][u];for(a=r-1;a>0;a--){for(c=0,s=0,f=0;a>f;f++)c+=Math.abs(n[f]);if(0===c)for(t[a]=n[a-1],u=0;a>u;u++)n[u]=o[a-1][u],o[a][u]=0,o[u][a]=0;else{for(f=0;a>f;f++)n[f]/=c,s+=n[f]*n[f];for(e=n[a-1],i=Math.sqrt(s),e>0&&(i=-i),t[a]=c*i,s-=e*i,n[a-1]=e-i,u=0;a>u;u++)t[u]=0;for(u=0;a>u;u++){for(e=n[u],o[u][a]=e,i=t[u]+o[u][u]*e,f=u+1;a-1>=f;f++)i+=o[f][u]*n[f],t[f]+=o[f][u]*e;t[u]=i}for(e=0,u=0;a>u;u++)t[u]/=s,e+=t[u]*n[u];for(h=e/(s+s),u=0;a>u;u++)t[u]-=h*n[u];for(u=0;a>u;u++){for(e=n[u],i=t[u],f=u;a-1>=f;f++)o[f][u]-=e*t[f]+i*n[f];n[u]=o[a-1][u],o[a][u]=0}}n[a]=s}for(a=0;r-1>a;a++){if(o[r-1][a]=o[a][a],o[a][a]=1,s=n[a+1],0!==s){for(f=0;a>=f;f++)n[f]=o[f][a+1]/s;for(u=0;a>=u;u++){for(i=0,f=0;a>=f;f++)i+=o[f][a+1]*o[f][u];for(f=0;a>=f;f++)o[f][u]-=i*n[f]}}for(f=0;a>=f;f++)o[f][a+1]=0}for(u=0;r>u;u++)n[u]=o[r-1][u],o[r-1][u]=0;o[r-1][r-1]=1,t[0]=0}function i(r,t,n,o){var e,i,s,a,u,f,c,l,m,p,w,v,g,y,d,b,x;for(s=1;r>s;s++)t[s-1]=t[s];t[r-1]=0;var M=0,k=0,R=Math.pow(2,-52);for(f=0;r>f;f++){for(k=Math.max(k,Math.abs(n[f])+Math.abs(t[f])),c=f;r>c&&!(Math.abs(t[c])<=R*k);)c++;if(c>f){x=0;do{for(x+=1,e=n[f],l=(n[f+1]-e)/(2*t[f]),m=h(l,1),0>l&&(m=-m),n[f]=t[f]/(l+m),n[f+1]=t[f]*(l+m),p=n[f+1],i=e-n[f],s=f+2;r>s;s++)n[s]-=i;for(M+=i,l=n[c],w=1,v=w,g=w,y=t[f+1],d=0,b=0,s=c-1;s>=f;s--)for(g=v,v=w,b=d,e=w*t[s],i=w*l,m=h(l,t[s]),t[s+1]=d*m,d=t[s]/m,w=l/m,l=w*n[s]-d*e,n[s+1]=i+d*(w*e+d*n[s]),u=0;r>u;u++)i=o[u][s+1],o[u][s+1]=d*o[u][s]+w*i,o[u][s]=w*o[u][s]-d*i;l=-d*b*g*y*t[f]/p,t[f]=d*l,n[f]=w*l}while(Math.abs(t[f])>R*k)}n[f]=n[f]+M,t[f]=0}for(s=0;r-1>s;s++){for(u=s,l=n[s],a=s+1;r>a;a++)n[a]<l&&(u=a,l=n[a]);if(u!==s)for(n[u]=n[s],n[s]=l,a=0;r>a;a++)l=o[a][s],o[a][s]=o[a][u],o[a][u]=l}}function s(r,t,n,o){var e,i,s,a,u,f,h,c=0,l=r-1;for(f=c+1;l-1>=f;f++){for(h=0,a=f;l>=a;a++)h+=Math.abs(t[a][f-1]);if(0!==h){for(s=0,a=l;a>=f;a--)n[a]=t[a][f-1]/h,s+=n[a]*n[a];for(i=Math.sqrt(s),n[f]>0&&(i=-i),s-=n[f]*i,n[f]=n[f]-i,u=f;r>u;u++){for(e=0,a=l;a>=f;a--)e+=n[a]*t[a][u];for(e/=s,a=f;l>=a;a++)t[a][u]-=e*n[a]}for(a=0;l>=a;a++){for(e=0,u=l;u>=f;u--)e+=n[u]*t[a][u];for(e/=s,u=f;l>=u;u++)t[a][u]-=e*n[u]}n[f]=h*n[f],t[f][f-1]=h*i}}for(a=0;r>a;a++)for(u=0;r>u;u++)o[a][u]=a===u?1:0;for(f=l-1;f>=c+1;f--)if(0!==t[f][f-1]){for(a=f+1;l>=a;a++)n[a]=t[a][f-1];for(u=f;l>=u;u++){for(i=0,a=f;l>=a;a++)i+=n[a]*o[a][u];for(i=i/n[f]/t[f][f-1],a=f;l>=a;a++)o[a][u]+=i*n[a]}}}function a(r,t,n,o,e){var i,s,a,f,h,c,l,m,p,w,v,g,y,d,b,x=r-1,M=0,k=r-1,R=Math.pow(2,-52),A=0,j=0,S=0,V=0,E=0,C=0,D=0,I=0;for(i=0;r>i;i++)for((M>i||i>k)&&(n[i]=e[i][i],t[i]=0),s=Math.max(i-1,0);r>s;s++)j+=Math.abs(e[i][s]);for(;x>=M;){for(f=x;f>M&&(C=Math.abs(e[f-1][f-1])+Math.abs(e[f][f]),0===C&&(C=j),!(Math.abs(e[f][f-1])<R*C));)f--;if(f===x)e[x][x]=e[x][x]+A,n[x]=e[x][x],t[x]=0,x--,I=0;else if(f===x-1){if(l=e[x][x-1]*e[x-1][x],S=(e[x-1][x-1]-e[x][x])/2,V=S*S+l,D=Math.sqrt(Math.abs(V)),e[x][x]=e[x][x]+A,e[x-1][x-1]=e[x-1][x-1]+A,m=e[x][x],V>=0){for(D=S>=0?S+D:S-D,n[x-1]=m+D,n[x]=n[x-1],0!==D&&(n[x]=m-l/D),t[x-1]=0,t[x]=0,m=e[x][x-1],C=Math.abs(m)+Math.abs(D),S=m/C,V=D/C,E=Math.sqrt(S*S+V*V),S/=E,V/=E,s=x-1;r>s;s++)D=e[x-1][s],e[x-1][s]=V*D+S*e[x][s],e[x][s]=V*e[x][s]-S*D;for(i=0;x>=i;i++)D=e[i][x-1],e[i][x-1]=V*D+S*e[i][x],e[i][x]=V*e[i][x]-S*D;for(i=M;k>=i;i++)D=o[i][x-1],o[i][x-1]=V*D+S*o[i][x],o[i][x]=V*o[i][x]-S*D}else n[x-1]=m+S,n[x]=m+S,t[x-1]=D,t[x]=-D;x-=2,I=0}else{if(m=e[x][x],p=0,l=0,x>f&&(p=e[x-1][x-1],l=e[x][x-1]*e[x-1][x]),10===I){for(A+=m,i=M;x>=i;i++)e[i][i]-=m;C=Math.abs(e[x][x-1])+Math.abs(e[x-1][x-2]),m=p=.75*C,l=-.4375*C*C}if(30===I&&(C=(p-m)/2,C=C*C+l,C>0)){for(C=Math.sqrt(C),m>p&&(C=-C),C=m-l/((p-m)/2+C),i=M;x>=i;i++)e[i][i]-=C;A+=C,m=p=l=.964}for(I+=1,h=x-2;h>=f&&(D=e[h][h],E=m-D,C=p-D,S=(E*C-l)/e[h+1][h]+e[h][h+1],V=e[h+1][h+1]-D-E-C,E=e[h+2][h+1],C=Math.abs(S)+Math.abs(V)+Math.abs(E),S/=C,V/=C,E/=C,h!==f)&&!(Math.abs(e[h][h-1])*(Math.abs(V)+Math.abs(E))<R*(Math.abs(S)*(Math.abs(e[h-1][h-1])+Math.abs(D)+Math.abs(e[h+1][h+1]))));)h--;for(i=h+2;x>=i;i++)e[i][i-2]=0,i>h+2&&(e[i][i-3]=0);for(a=h;x-1>=a&&(d=a!==x-1,a!==h&&(S=e[a][a-1],V=e[a+1][a-1],E=d?e[a+2][a-1]:0,m=Math.abs(S)+Math.abs(V)+Math.abs(E),0!==m&&(S/=m,V/=m,E/=m)),0!==m);a++)if(C=Math.sqrt(S*S+V*V+E*E),0>S&&(C=-C),0!==C){for(a!==h?e[a][a-1]=-C*m:f!==h&&(e[a][a-1]=-e[a][a-1]),S+=C,m=S/C,p=V/C,D=E/C,V/=S,E/=S,s=a;r>s;s++)S=e[a][s]+V*e[a+1][s],d&&(S+=E*e[a+2][s],e[a+2][s]=e[a+2][s]-S*D),e[a][s]=e[a][s]-S*m,e[a+1][s]=e[a+1][s]-S*p;for(i=0;i<=Math.min(x,a+3);i++)S=m*e[i][a]+p*e[i][a+1],d&&(S+=D*e[i][a+2],e[i][a+2]=e[i][a+2]-S*E),e[i][a]=e[i][a]-S,e[i][a+1]=e[i][a+1]-S*V;for(i=M;k>=i;i++)S=m*o[i][a]+p*o[i][a+1],d&&(S+=D*o[i][a+2],o[i][a+2]=o[i][a+2]-S*E),o[i][a]=o[i][a]-S,o[i][a+1]=o[i][a+1]-S*V}}}if(0!==j){for(x=r-1;x>=0;x--)if(S=n[x],V=t[x],0===V)for(f=x,e[x][x]=1,i=x-1;i>=0;i--){for(l=e[i][i]-S,E=0,s=f;x>=s;s++)E+=e[i][s]*e[s][x];if(t[i]<0)D=l,C=E;else if(f=i,0===t[i]?e[i][x]=0!==l?-E/l:-E/(R*j):(m=e[i][i+1],p=e[i+1][i],V=(n[i]-S)*(n[i]-S)+t[i]*t[i],c=(m*C-D*E)/V,e[i][x]=c,e[i+1][x]=Math.abs(m)>Math.abs(D)?(-E-l*c)/m:(-C-p*c)/D),c=Math.abs(e[i][x]),R*c*c>1)for(s=i;x>=s;s++)e[s][x]=e[s][x]/c}else if(0>V)for(f=x-1,Math.abs(e[x][x-1])>Math.abs(e[x-1][x])?(e[x-1][x-1]=V/e[x][x-1],e[x-1][x]=-(e[x][x]-S)/e[x][x-1]):(b=u(0,-e[x-1][x],e[x-1][x-1]-S,V),e[x-1][x-1]=b[0],e[x-1][x]=b[1]),e[x][x-1]=0,e[x][x]=1,i=x-2;i>=0;i--){for(w=0,v=0,s=f;x>=s;s++)w+=e[i][s]*e[s][x-1],v+=e[i][s]*e[s][x];if(l=e[i][i]-S,t[i]<0)D=l,E=w,C=v;else if(f=i,0===t[i]?(b=u(-w,-v,l,V),e[i][x-1]=b[0],e[i][x]=b[1]):(m=e[i][i+1],p=e[i+1][i],g=(n[i]-S)*(n[i]-S)+t[i]*t[i]-V*V,y=2*(n[i]-S)*V,0===g&&0===y&&(g=R*j*(Math.abs(l)+Math.abs(V)+Math.abs(m)+Math.abs(p)+Math.abs(D))),b=u(m*E-D*w+V*v,m*C-D*v-V*w,g,y),e[i][x-1]=b[0],e[i][x]=b[1],Math.abs(m)>Math.abs(D)+Math.abs(V)?(e[i+1][x-1]=(-w-l*e[i][x-1]+V*e[i][x])/m,e[i+1][x]=(-v-l*e[i][x]-V*e[i][x-1])/m):(b=u(-E-p*e[i][x-1],-C-p*e[i][x],D,V),e[i+1][x-1]=b[0],e[i+1][x]=b[1])),c=Math.max(Math.abs(e[i][x-1]),Math.abs(e[i][x])),R*c*c>1)for(s=i;x>=s;s++)e[s][x-1]=e[s][x-1]/c,e[s][x]=e[s][x]/c}for(i=0;r>i;i++)if(M>i||i>k)for(s=i;r>s;s++)o[i][s]=e[i][s];for(s=r-1;s>=M;s--)for(i=M;k>=i;i++){for(D=0,a=M;a<=Math.min(s,k);a++)D+=o[i][a]*e[a][s];o[i][s]=D}}}function u(r,t,n,o){var e,i;return Math.abs(n)>Math.abs(o)?(e=o/n,i=n+e*o,[(r+e*t)/i,(t-e*r)/i]):(e=n/o,i=o+e*n,[(e*r+t)/i,(e*t-r)/i])}var f=n(20),h=n(23).hypotenuse;o.prototype={get realEigenvalues(){return this.d},get imaginaryEigenvalues(){return this.e},get eigenvectorMatrix(){return this.V},get diagonalMatrix(){var r,t,n=this.n,o=this.e,e=this.d,i=new f(n,n);for(r=0;n>r;r++){for(t=0;n>t;t++)i[r][t]=0;i[r][r]=e[r],o[r]>0?i[r][r+1]=o[r]:o[r]<0&&(i[r][r-1]=o[r])}return i}},r.exports=o},function(r,t,n){"use strict";function o(r){if(!(this instanceof o))return new o(r);r=e.checkMatrix(r);var t,n,i,s,a,u,f,h,c,l,m=r.clone(),p=m.rows,w=m.columns,v=new Array(p),g=1;for(t=0;p>t;t++)v[t]=t;for(c=new Array(p),n=0;w>n;n++){for(t=0;p>t;t++)c[t]=m[t][n];for(t=0;p>t;t++){for(h=m[t],l=Math.min(t,n),a=0,i=0;l>i;i++)a+=h[i]*c[i];h[n]=c[t]-=a}for(s=n,t=n+1;p>t;t++)Math.abs(c[t])>Math.abs(c[s])&&(s=t);if(s!==n){for(i=0;w>i;i++)u=m[s][i],m[s][i]=m[n][i],m[n][i]=u;f=v[s],v[s]=v[n],v[n]=f,g=-g}if(p>n&&0!==m[n][n])for(t=n+1;p>t;t++)m[t][n]/=m[n][n]}this.LU=m,this.pivotVector=v,this.pivotSign=g}var e=n(20);o.prototype={isSingular:function(){for(var r=this.LU,t=r.columns,n=0;t>n;n++)if(0===r[n][n])return!0;return!1},get determinant(){var r=this.LU;if(!r.isSquare())throw new Error("Matrix must be square");for(var t=this.pivotSign,n=r.columns,o=0;n>o;o++)t*=r[o][o];return t},get lowerTriangularFactor(){for(var r=this.LU,t=r.rows,n=r.columns,o=new e(t,n),i=0;t>i;i++)for(var s=0;n>s;s++)i>s?o[i][s]=r[i][s]:i===s?o[i][s]=1:o[i][s]=0;return o},get upperTriangularFactor(){for(var r=this.LU,t=r.rows,n=r.columns,o=new e(t,n),i=0;t>i;i++)for(var s=0;n>s;s++)s>=i?o[i][s]=r[i][s]:o[i][s]=0;return o},get pivotPermutationVector(){return this.pivotVector.slice()},solve:function(r){r=e.checkMatrix(r);var t=this.LU,n=t.rows;if(n!==r.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");var o,i,s,a=r.columns,u=r.subMatrixRow(this.pivotVector,0,a-1),f=t.columns;for(s=0;f>s;s++)for(o=s+1;f>o;o++)for(i=0;a>i;i++)u[o][i]-=u[s][i]*t[o][s];for(s=f-1;s>=0;s--){for(i=0;a>i;i++)u[s][i]/=t[s][s];for(o=0;s>o;o++)for(i=0;a>i;i++)u[o][i]-=u[s][i]*t[o][s]}return u}},r.exports=o},function(r,t,n){"use strict";function o(r){if(!(this instanceof o))return new o(r);r=e.checkMatrix(r);var t,n,s,a,u=r.clone(),f=r.rows,h=r.columns,c=new Array(h);for(s=0;h>s;s++){var l=0;for(t=s;f>t;t++)l=i(l,u[t][s]);if(0!==l){for(u[s][s]<0&&(l=-l),t=s;f>t;t++)u[t][s]/=l;for(u[s][s]+=1,n=s+1;h>n;n++){for(a=0,t=s;f>t;t++)a+=u[t][s]*u[t][n];for(a=-a/u[s][s],t=s;f>t;t++)u[t][n]+=a*u[t][s]}}c[s]=-l}this.QR=u,this.Rdiag=c}var e=n(20),i=n(23).hypotenuse;o.prototype={solve:function(r){r=e.checkMatrix(r);var t=this.QR,n=t.rows;if(r.rows!==n)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");var o,i,s,a,u=r.columns,f=r.clone(),h=t.columns;for(s=0;h>s;s++)for(i=0;u>i;i++){for(a=0,o=s;n>o;o++)a+=t[o][s]*f[o][i];for(a=-a/t[s][s],o=s;n>o;o++)f[o][i]+=a*t[o][s]}for(s=h-1;s>=0;s--){for(i=0;u>i;i++)f[s][i]/=this.Rdiag[s];for(o=0;s>o;o++)for(i=0;u>i;i++)f[o][i]-=f[s][i]*t[o][s]}return f.subMatrix(0,h-1,0,u-1)},isFullRank:function(){for(var r=this.QR.columns,t=0;r>t;t++)if(0===this.Rdiag[t])return!1;return!0},get upperTriangularFactor(){var r,t,n=this.QR,o=n.columns,i=new e(o,o);for(r=0;o>r;r++)for(t=0;o>t;t++)t>r?i[r][t]=n[r][t]:r===t?i[r][t]=this.Rdiag[r]:i[r][t]=0;return i},get orthogonalFactor(){var r,t,n,o,i=this.QR,s=i.rows,a=i.columns,u=new e(s,a);for(n=a-1;n>=0;n--){for(r=0;s>r;r++)u[r][n]=0;for(u[n][n]=1,t=n;a>t;t++)if(0!==i[n][n]){for(o=0,r=n;s>r;r++)o+=i[r][n]*u[r][t];for(o=-o/i[n][n],r=n;s>r;r++)u[r][t]+=o*i[r][n]}}return u}},r.exports=o},function(r,t,n){"use strict";function o(r){if(!(this instanceof o))return new o(r);if(r=e.checkMatrix(r),!r.isSymmetric())throw new Error("Matrix is not symmetric");var t,n,i,s=r,a=s.rows,u=new e(a,a),f=!0;for(n=0;a>n;n++){var h=u[n],c=0;for(i=0;n>i;i++){var l=u[i],m=0;for(t=0;i>t;t++)m+=l[t]*h[t];h[i]=m=(s[n][i]-m)/u[i][i],c+=m*m}for(c=s[n][n]-c,f&=c>0,u[n][n]=Math.sqrt(Math.max(c,0)),i=n+1;a>i;i++)u[n][i]=0}if(!f)throw new Error("Matrix is not positive definite");this.L=u}var e=n(20);o.prototype={get leftTriangularFactor(){return this.L},solve:function(r){r=e.checkMatrix(r);var t=this.L,n=t.rows;if(r.rows!==n)throw new Error("Matrix dimensions do not match");var o,i,s,a=r.columns,u=r.clone();for(s=0;n>s;s++)for(i=0;a>i;i++){for(o=0;s>o;o++)u[s][i]-=u[o][i]*t[s][o];u[s][i]/=t[s][s]}for(s=n-1;s>=0;s--)for(i=0;a>i;i++){for(o=s+1;n>o;o++)u[s][i]-=u[o][i]*t[o][s];u[s][i]/=t[s][s]}return u}},r.exports=o},function(r,t,n){"use strict";t.distance=n(29),t.similarity=n(74)},function(r,t,n){"use strict";t.additiveSymmetric=n(30),t.avg=n(31),t.bhattacharyya=n(32),t.canberra=n(33),t.chebyshev=n(34),t.clark=n(35),t.czekanowski=n(36),t.dice=n(37),t.divergence=n(38),t.euclidean=n(39),t.fidelity=n(40),t.gower=n(41),t.harmonicMean=n(42),t.hellinger=n(43),t.innerProduct=n(44),t.intersection=n(45),t.jaccard=n(46),t.jeffreys=n(47),t.jensenDifference=n(48),t.jensenShannon=n(49),t.kdivergence=n(50),t.kulczynski=n(51),t.kullbackLeibler=n(52),t.kumarHassebrook=n(53),t.kumarJohnson=n(54),t.lorentzian=n(55),t.manhattan=n(56),t.matusita=n(57),t.minkowski=n(58),t.motyka=n(59),t.neyman=n(60),t.pearson=n(61),t.probabilisticSymmetric=n(62),t.ruzicka=n(63),t.soergel=n(64),t.sorensen=n(65),t.squared=n(66),t.squaredChord=n(67),t.squaredEuclidean=n(39).squared,t.taneja=n(68),t.tanimoto=n(69),t.topsoe=n(71),t.tree=n(72),t.waveHedges=n(73)},function(r,t){r.exports=function(r,t){for(var n=0,o=r.length,e=0;o>n;n++)e+=(r[n]-t[n])*(r[n]-t[n])*(r[n]+t[n])/(r[n]*t[n]);return 2*e}},function(r,t){r.exports=function(r,t){for(var n=r.length,o=0,e=0,i=0,s=0;n>s;s++)i=Math.abs(r[s]-t[s]),e+=i,i>o&&(o=i);return(o+e)/2}},function(r,t){r.exports=function(r,t){for(var n=r.length,o=0,e=0;n>e;e++)o+=Math.sqrt(r[e]*t[e]);return-Math.log(o)}},function(r,t){r.exports=function(r,t){for(var n=r.length,o=0,e=0;n>e;e++)o+=Math.abs(r[e]-t[e])/(r[e]+t[e]);return o}},function(r,t){r.exports=function(r,t){for(var n=r.length,o=0,e=0,i=0;n>i;i++)e=Math.abs(r[i]-t[i]),e>o&&(o=e);return o}},function(r,t){r.exports=function(r,t){for(var n=0,o=r.length,e=0;o>n;n++)e+=Math.sqrt((r[n]-t[n])*(r[n]-t[n])/((r[n]+t[n])*(r[n]+t[n])));return 2*e}},function(r,t){r.exports=function(r,t){for(var n=r.length,o=0,e=0,i=0;n>i;i++)o+=Math.min(r[i],t[i]),e+=r[i]+t[i];return 1-2*o/e}},function(r,t){r.exports=function(r,t){for(var n=r.length,o=0,e=0,i=0,s=0;n>s;s++)o+=r[s]*r[s],e+=t[s]*t[s],i+=(r[s]-t[s])*(r[s]-t[s]);return i/(o+e)}},function(r,t){r.exports=function(r,t){for(var n=0,o=r.length,e=0;o>n;n++)e+=(r[n]-t[n])*(r[n]-t[n])/((r[n]+t[n])*(r[n]+t[n]));return 2*e}},function(r,t){"use strict";function n(r,t){for(var n=0,o=0;o<r.length;o++)n+=(r[o]-t[o])*(r[o]-t[o]);return n}function o(r,t){return Math.sqrt(n(r,t))}r.exports=o,o.squared=n},function(r,t){r.exports=function(r,t){for(var n=r.length,o=0,e=0;n>e;e++)o+=Math.sqrt(r[e]*t[e]);return o}},function(r,t){r.exports=function(r,t){for(var n=r.length,o=0,e=0;n>e;e++)o+=Math.abs(r[e]-t[e]);return o/n}},function(r,t){r.exports=function(r,t){for(var n=r.length,o=0,e=0;n>e;e++)o+=r[e]*t[e]/(r[e]+t[e]);return 2*o}},function(r,t){r.exports=function(r,t){for(var n=r.length,o=0,e=0;n>e;e++)o+=Math.sqrt(r[e]*t[e]);return 2*Math.sqrt(1-o)}},function(r,t){r.exports=function(r,t){for(var n=r.length,o=0,e=0;n>e;e++)o+=r[e]*t[e];return o}},function(r,t){r.exports=function(r,t){for(var n=r.length,o=0,e=0;n>e;e++)o+=Math.min(r[e],t[e]);return 1-o}},function(r,t){r.exports=function(r,t){for(var n=r.length,o=0,e=0,i=0,s=0,a=0;n>a;a++)o+=r[a]*t[a],e+=r[a]*r[a],i+=t[a]*t[a],s+=(r[a]-t[a])*(r[a]-t[a]);return s/(e+i-o)}},function(r,t){r.exports=function(r,t){for(var n=r.length,o=0,e=0;n>e;e++)o+=(r[e]-t[e])*Math.log(r[e]/t[e]);return o}},function(r,t){r.exports=function(r,t){for(var n=r.length,o=0,e=0;n>e;e++)o+=(r[e]*Math.log(r[e])+t[e]*Math.log(t[e]))/2-(r[e]+t[e])/2*Math.log((r[e]+t[e])/2);return o}},function(r,t){r.exports=function(r,t){for(var n=r.length,o=0,e=0,i=0;n>i;i++)o+=r[i]*Math.log(2*r[i]/(r[i]+t[i])),e+=t[i]*Math.log(2*t[i]/(r[i]+t[i]));return(o+e)/2}},function(r,t){r.exports=function(r,t){for(var n=r.length,o=0,e=0;n>e;e++)o+=r[e]*Math.log(2*r[e]/(r[e]+t[e]));return o}},function(r,t){r.exports=function(r,t){for(var n=r.length,o=0,e=0,i=0;n>i;i++)o+=Math.abs(r[i]-t[i]),e+=Math.min(r[i],t[i]);return o/e}},function(r,t){r.exports=function(r,t){for(var n=r.length,o=0,e=0;n>e;e++)o+=r[e]*Math.log(r[e]/t[e]);return o}},function(r,t){r.exports=function(r,t){for(var n=r.length,o=0,e=0,i=0,s=0;n>s;s++)o+=r[s]*t[s],e+=r[s]*r[s],i+=t[s]*t[s];return o/(e+i-o)}},function(r,t){r.exports=function(r,t){for(var n=r.length,o=0,e=0;n>e;e++)o+=Math.pow(r[e]*r[e]-t[e]*t[e],2)/(2*Math.pow(r[e]*t[e],1.5));return o}},function(r,t){r.exports=function(r,t){for(var n=r.length,o=0,e=0;n>e;e++)o+=Math.log(Math.abs(r[e]-t[e])+1);return o}},function(r,t){r.exports=function(r,t){for(var n=0,o=r.length,e=0;o>n;n++)e+=Math.abs(r[n]-t[n]);return e}},function(r,t){r.exports=function(r,t){for(var n=r.length,o=0,e=0;n>e;e++)o+=Math.sqrt(r[e]*t[e]);return Math.sqrt(2-2*o)}},function(r,t){r.exports=function(r,t,n){for(var o=0,e=r.length,i=0;e>o;o++)i+=Math.pow(Math.abs(r[o]-t[o]),n);return Math.pow(i,1/n)}},function(r,t){r.exports=function(r,t){for(var n=r.length,o=0,e=0,i=0;n>i;i++)o+=Math.min(r[i],t[i]),e+=r[i]+t[i];return 1-o/e}},function(r,t){r.exports=function(r,t){for(var n=0,o=r.length,e=0;o>n;n++)e+=(r[n]-t[n])*(r[n]-t[n])/r[n];return e}},function(r,t){r.exports=function(r,t){for(var n=0,o=r.length,e=0;o>n;n++)e+=(r[n]-t[n])*(r[n]-t[n])/t[n];return e}},function(r,t){r.exports=function(r,t){for(var n=0,o=r.length,e=0;o>n;n++)e+=(r[n]-t[n])*(r[n]-t[n])/(r[n]+t[n]);return 2*e}},function(r,t){r.exports=function(r,t){for(var n=r.length,o=0,e=0,i=0;n>i;i++)o+=Math.min(r[i],t[i]),e+=Math.max(r[i],t[i]);return o/e}},function(r,t){r.exports=function(r,t){for(var n=r.length,o=0,e=0,i=0;n>i;i++)o+=Math.abs(r[i]-t[i]),e+=Math.max(r[i],t[i]);return o/e}},function(r,t){r.exports=function(r,t){for(var n=r.length,o=0,e=0,i=0;n>i;i++)o+=Math.abs(r[i]-t[i]),e+=r[i]+t[i];return o/e}},function(r,t){r.exports=function(r,t){for(var n=0,o=r.length,e=0;o>n;n++)e+=(r[n]-t[n])*(r[n]-t[n])/(r[n]+t[n]);return e}},function(r,t){r.exports=function(r,t){for(var n=r.length,o=0,e=0;n>e;e++)o+=(Math.sqrt(r[e])-Math.sqrt(t[e]))*(Math.sqrt(r[e])-Math.sqrt(t[e]));return o}},function(r,t){r.exports=function(r,t){for(var n=r.length,o=0,e=0;n>e;e++)o+=(r[e]+t[e])/2*Math.log((r[e]+t[e])/(2*Math.sqrt(r[e]*t[e])));return o}},function(r,t,n){var o=n(70);r.exports=function(r,t,n){if(n)return 1-o(r,t,n);for(var e=r.length,i=0,s=0,a=0,u=0;e>u;u++)i+=r[u],s+=t[u],a+=Math.min(r[u],t[u]);return(i+s-2*a)/(i+s-a)}},function(r,t){r.exports=function(r,t,n){if(n){for(var o=0,e=0,i=0;i<r.length;i++)o+=r[i]&&t[i],e+=r[i]||t[i];return 0===e?1:o/e}for(var s=r.length,a=0,u=0,f=0,h=0;s>h;h++)a+=r[h],u+=t[h],f+=Math.min(r[h],t[h]);return 1-(a+u-2*f)/(a+u-f)}},function(r,t){r.exports=function(r,t){for(var n=r.length,o=0,e=0;n>e;e++)o+=r[e]*Math.log(2*r[e]/(r[e]+t[e]))+t[e]*Math.log(2*t[e]/(r[e]+t[e]));return o}},function(r,t){"use strict";function n(r,t,o,e,i,s){if(i=i||.16,s=s||.01,i>e-o)return void 0;for(var a=0,u=0;r[u]<e;u++)r[u]>o&&(a+=t[u]);if(s>a)return void 0;for(var f=0,h=0;r[h]<e;h++)r[u]>o&&(f+=r[h]*t[h]);return f/=a,1e-5>f-o||1e-5>e-f?void 0:i/4>f-o?n(r,t,f,e,i,s):i/4>e-f?n(r,t,o,f,i,s):{sum:a,center:f,left:n(r,t,o,f,i,s),right:n(r,t,f,e,i,s)}}function o(r,t,n,e,i){if(void 0===r||void 0===t)return 0;var s=n*Math.min(r.sum,t.sum)/Math.max(r.sum,t.sum)+(1-n)*Math.exp(-i*Math.abs(r.center-t.center));return e*s+(1-e)*(o(r.left,t.left,n,e,i)+o(r.right,t.right,n,e,i))}function e(r,t,e,s,a){a=a||{};for(var u in i)a.hasOwnProperty(u)||(a[u]=i[u]);var f,h;return f=r.sum?r:n(r.x,r.y,e,s,a.minWindow,a.threshold),h=t.sum?t:n(t.x,t.y,e,s,a.minWindow,a.threshold),o(f,h,a.alpha,a.beta,a.gamma)}var i={minWindow:.16,threshold:.01,alpha:.1,beta:.33,gamma:.001};r.exports={calc:e,createTree:n}},function(r,t){r.exports=function(r,t){for(var n=r.length,o=0,e=0;n>e;e++)o+=1-Math.min(r[e],t[e])/Math.max(r[e],t[e]);return o}},function(r,t,n){"use strict";t.cosine=n(75),t.czekanowski=n(76),t.dice=n(77),t.intersection=n(78),t.jaccard=n(79),t.kulczynski=n(80),t.motyka=n(81),t.pearson=n(82),t.squaredChord=n(83),t.tanimoto=n(70)},function(r,t){r.exports=function(r,t){for(var n=r.length,o=0,e=0,i=0,s=0;n>s;s++)o+=r[s]*t[s],e+=r[s]*r[s],i+=t[s]*t[s];return o/(Math.sqrt(e)*Math.sqrt(i))}},function(r,t,n){var o=n(36);r.exports=function(r,t){return 1-o(r,t)}},function(r,t,n){var o=n(37);r.exports=function(r,t){return 1-o(r,t)}},function(r,t,n){var o=n(45);r.exports=function(r,t){return 1-o(r,t)}},function(r,t,n){var o=n(46);r.exports=function(r,t){return 1-o(r,t)}},function(r,t,n){var o=n(51);r.exports=function(r,t){return 1/o(r,t)}},function(r,t,n){var o=n(59);r.exports=function(r,t){return 1-o(r,t)}},function(r,t,n){"use strict";var o=n(5).array,e=n(75);r.exports=function(r,t){for(var n=o.mean(r),i=o.mean(t),s=new Array(r.length),a=new Array(t.length),u=0;u<s.length;u++)s[u]=r[u]-n,a[u]=t[u]-i;return e(s,a)}},function(r,t,n){var o=n(67);r.exports=function(r,t){return 1-o(r,t)}},function(r,t,n){"use strict";function o(r,t){this.data=r,this.h=t}var e=n(85),i={windSize:5,deriv:1,pol:2};o.prototype.calc=function(r){r=r||{},this.options={};for(var t in i)r.hasOwnProperty(t)?this.options[t]=r[t]:this.options[t]=i[t];if(this.options.windSize%2===0||this.options.windSize<5)throw new RangeError("Invalid window size");if(this.options.deriv<0||this.options.pol<1)throw new RangeError("Number too small");if(this.options.pol!==Math.floor(this.options.pol)||this.options.deriv!==Math.floor(this.options.deriv)||this.options.windSize!==Math.floor(this.options.windSize))throw new TypeError("Only integers allowed");var n,o;if(5!==this.options.windSize||2!==this.options.pol||1!==this.options.deriv&&2!==this.options.deriv){for(var s=new Array(this.options.windSize),a=0;a<s.length;a++){s[a]=new Array(this.options.pol+1);for(var u=-(this.options.windSize-1)/2,f=0;f<s[a].length;f++)u+1===0&&0===f?s[a][f]=1:s[a][f]=Math.pow(u+a,f)}n=e.dot(e.inv(e.dot(e.transpose(s),s)),e.transpose(s)),n=n[this.options.deriv].concat(),o=1}else 1===this.options.deriv?(n=[-2,-1,0,1,2],o=10):(n=[2,-1,-2,-1,2],o=7);for(var h=new Array(this.data.length),c=Math.ceil(this.options.windSize/2);c<h.length-Math.floor(this.options.windSize/2);c++){for(var l=0,m=0;m<n.length;m++)l+=n[m]*this.data[m+c-Math.floor(this.options.windSize/2)]/(o*Math.pow(this.h,this.options.deriv));h[c]=l}for(var p=0;p<Math.ceil(this.options.windSize/2);p++)h[p]=h[Math.ceil(this.options.windSize/2)];for(var w=h.length-Math.floor(this.options.windSize/2);w<h.length;w++)h[w]=h[h.length-Math.floor(this.options.windSize/2)-1];return h},r.exports=o},function(module,exports,__webpack_require__){(function(global){"use strict";var numeric=exports;"undefined"!=typeof global&&(global.numeric=numeric),numeric.version="1.2.6",numeric.bench=function(r,t){var n,o,e,i;for("undefined"==typeof t&&(t=15),e=.5,n=new Date;;){for(e*=2,i=e;i>3;i-=4)r(),r(),r(),r();for(;i>0;)r(),i--;if(o=new Date,o-n>t)break}for(i=e;i>3;i-=4)r(),r(),r(),r();for(;i>0;)r(),i--;return o=new Date,1e3*(3*e-1)/(o-n)},numeric._myIndexOf=function(r){var t,n=this.length;for(t=0;n>t;++t)if(this[t]===r)return t;return-1},numeric.myIndexOf=Array.prototype.indexOf?Array.prototype.indexOf:numeric._myIndexOf,numeric.Function=Function,numeric.precision=4,numeric.largeArray=50,numeric.prettyPrint=function(r){function t(r){if(0===r)return"0";if(isNaN(r))return"NaN";if(0>r)return"-"+t(-r);if(isFinite(r)){var n=Math.floor(Math.log(r)/Math.log(10)),o=r/Math.pow(10,n),e=o.toPrecision(numeric.precision);return 10===parseFloat(e)&&(n++,o=1,e=o.toPrecision(numeric.precision)),parseFloat(e).toString()+"e"+n.toString()}return"Infinity"}function n(r){var e;if("undefined"==typeof r)return o.push(Array(numeric.precision+8).join(" ")),!1;if("string"==typeof r)return o.push('"'+r+'"'),!1;if("boolean"==typeof r)return o.push(r.toString()),!1;if("number"==typeof r){var i=t(r),s=r.toPrecision(numeric.precision),a=parseFloat(r.toString()).toString(),u=[i,s,a,parseFloat(s).toString(),parseFloat(a).toString()];for(e=1;e<u.length;e++)u[e].length<i.length&&(i=u[e]);return o.push(Array(numeric.precision+8-i.length).join(" ")+i),!1}if(null===r)return o.push("null"),!1;if("function"==typeof r){o.push(r.toString());var f=!1;for(e in r)r.hasOwnProperty(e)&&(f?o.push(",\n"):o.push("\n{"),f=!0,o.push(e),o.push(": \n"),n(r[e]));return f&&o.push("}\n"),!0}if(r instanceof Array){if(r.length>numeric.largeArray)return o.push("...Large Array..."),!0;var f=!1;for(o.push("["),e=0;e<r.length;e++)e>0&&(o.push(","),f&&o.push("\n ")),f=n(r[e]);return o.push("]"),!0}o.push("{");var f=!1;for(e in r)r.hasOwnProperty(e)&&(f&&o.push(",\n"),f=!0,o.push(e),o.push(": \n"),n(r[e]));return o.push("}"),!0}var o=[];return n(r),o.join("")},numeric.parseDate=function(r){function t(r){if("string"==typeof r)return Date.parse(r.replace(/-/g,"/"));if(!(r instanceof Array))throw new Error("parseDate: parameter must be arrays of strings");var n,o=[];for(n=0;n<r.length;n++)o[n]=t(r[n]);return o}return t(r)},numeric.parseFloat=function(r){function t(r){if("string"==typeof r)return parseFloat(r);if(!(r instanceof Array))throw new Error("parseFloat: parameter must be arrays of strings");var n,o=[];for(n=0;n<r.length;n++)o[n]=t(r[n]);return o}return t(r)},numeric.parseCSV=function(r){var t,n,o=r.split("\n"),e=[],i=/(([^'",]*)|('[^']*')|("[^"]*")),/g,s=/^\s*(([+-]?[0-9]+(\.[0-9]*)?(e[+-]?[0-9]+)?)|([+-]?[0-9]*(\.[0-9]+)?(e[+-]?[0-9]+)?))\s*$/,a=function(r){return r.substr(0,r.length-1)},u=0;for(n=0;n<o.length;n++){var f,h=(o[n]+",").match(i);if(h.length>0){for(e[u]=[],t=0;t<h.length;t++)f=a(h[t]),s.test(f)?e[u][t]=parseFloat(f):e[u][t]=f;u++}}return e},numeric.toCSV=function(r){var t,n,o,e,i,s,a=numeric.dim(r);for(o=a[0],e=a[1],s=[],t=0;o>t;t++){for(i=[],n=0;o>n;n++)i[n]=r[t][n].toString();s[t]=i.join(", ")}return s.join("\n")+"\n"},numeric.getURL=function(r){var t=new XMLHttpRequest;return t.open("GET",r,!1),t.send(),t},numeric.imageURL=function(r){function t(r){var t,n,o,e,i,s,a,u,f=r.length,h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c="";for(t=0;f>t;t+=3)n=r[t],o=r[t+1],e=r[t+2],i=n>>2,s=((3&n)<<4)+(o>>4),a=((15&o)<<2)+(e>>6),u=63&e,t+1>=f?a=u=64:t+2>=f&&(u=64),c+=h.charAt(i)+h.charAt(s)+h.charAt(a)+h.charAt(u);return c}function n(r,t,n){"undefined"==typeof t&&(t=0),"undefined"==typeof n&&(n=r.length);var o,e=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],i=-1,s=0;r.length;for(o=t;n>o;o++)s=255&(i^r[o]),i=i>>>8^e[s];return-1^i}var o,e,i,s,a,u,f,h,c,l,m=r[0].length,p=r[0][0].length,w=[137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,p>>24&255,p>>16&255,p>>8&255,255&p,m>>24&255,m>>16&255,m>>8&255,255&m,8,2,0,0,0,-1,-2,-3,-4,-5,-6,-7,-8,73,68,65,84,8,29];for(l=n(w,12,29),w[29]=l>>24&255,w[30]=l>>16&255,w[31]=l>>8&255,w[32]=255&l,o=1,e=0,f=0;m>f;f++){for(m-1>f?w.push(0):w.push(1),a=3*p+1+(0===f)&255,u=3*p+1+(0===f)>>8&255,w.push(a),w.push(u),w.push(255&~a),w.push(255&~u),0===f&&w.push(0),h=0;p>h;h++)for(i=0;3>i;i++)a=r[i][f][h],a=a>255?255:0>a?0:Math.round(a),o=(o+a)%65521,e=(e+o)%65521,w.push(a);w.push(0)}return c=(e<<16)+o,w.push(c>>24&255),w.push(c>>16&255),w.push(c>>8&255),w.push(255&c),s=w.length-41,w[33]=s>>24&255,w[34]=s>>16&255,w[35]=s>>8&255,w[36]=255&s,l=n(w,37),w.push(l>>24&255),w.push(l>>16&255),w.push(l>>8&255),w.push(255&l),w.push(0),w.push(0),w.push(0),w.push(0),w.push(73),w.push(69),w.push(78),w.push(68),w.push(174),w.push(66),w.push(96),w.push(130),"data:image/png;base64,"+t(w)},numeric._dim=function(r){for(var t=[];"object"==typeof r;)t.push(r.length),r=r[0];return t},numeric.dim=function(r){var t,n;return"object"==typeof r?(t=r[0],"object"==typeof t?(n=t[0],"object"==typeof n?numeric._dim(r):[r.length,t.length]):[r.length]):[]},numeric.mapreduce=function(r,t){return Function("x","accum","_s","_k",'if(typeof accum === "undefined") accum = '+t+';\nif(typeof x === "number") { var xi = x; '+r+'; return accum; }\nif(typeof _s === "undefined") _s = numeric.dim(x);\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i,xi;\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) {\n        accum = arguments.callee(x[i],accum,_s,_k+1);\n    }    return accum;\n}\nfor(i=_n-1;i>=1;i-=2) { \n    xi = x[i];\n    '+r+";\n    xi = x[i-1];\n    "+r+";\n}\nif(i === 0) {\n    xi = x[i];\n    "+r+"\n}\nreturn accum;");
},numeric.mapreduce2=function(r,t){return Function("x","var n = x.length;\nvar i,xi;\n"+t+";\nfor(i=n-1;i!==-1;--i) { \n    xi = x[i];\n    "+r+";\n}\nreturn accum;")},numeric.same=function r(t,n){var o,e;if(!(t instanceof Array&&n instanceof Array))return!1;if(e=t.length,e!==n.length)return!1;for(o=0;e>o;o++)if(t[o]!==n[o]){if("object"!=typeof t[o])return!1;if(!r(t[o],n[o]))return!1}return!0},numeric.rep=function(r,t,n){"undefined"==typeof n&&(n=0);var o,e=r[n],i=Array(e);if(n===r.length-1){for(o=e-2;o>=0;o-=2)i[o+1]=t,i[o]=t;return-1===o&&(i[0]=t),i}for(o=e-1;o>=0;o--)i[o]=numeric.rep(r,t,n+1);return i},numeric.dotMMsmall=function(r,t){var n,o,e,i,s,a,u,f,h,c,l;for(i=r.length,s=t.length,a=t[0].length,u=Array(i),n=i-1;n>=0;n--){for(f=Array(a),h=r[n],e=a-1;e>=0;e--){for(c=h[s-1]*t[s-1][e],o=s-2;o>=1;o-=2)l=o-1,c+=h[o]*t[o][e]+h[l]*t[l][e];0===o&&(c+=h[0]*t[0][e]),f[e]=c}u[n]=f}return u},numeric._getCol=function(r,t,n){var o,e=r.length;for(o=e-1;o>0;--o)n[o]=r[o][t],--o,n[o]=r[o][t];0===o&&(n[0]=r[0][t])},numeric.dotMMbig=function(r,t){var n,o,e,i,s=numeric._getCol,a=t.length,u=Array(a),f=r.length,h=t[0].length,c=new Array(f),l=numeric.dotVV;for(--a,--f,o=f;-1!==o;--o)c[o]=Array(h);for(--h,o=h;-1!==o;--o)for(s(t,o,u),e=f;-1!==e;--e)i=0,n=r[e],c[e][o]=l(n,u);return c},numeric.dotMV=function(r,t){var n,o=r.length,e=(t.length,Array(o)),i=numeric.dotVV;for(n=o-1;n>=0;n--)e[n]=i(r[n],t);return e},numeric.dotVM=function(r,t){var n,o,e,i,s,a,u;for(e=r.length,i=t[0].length,s=Array(i),o=i-1;o>=0;o--){for(a=r[e-1]*t[e-1][o],n=e-2;n>=1;n-=2)u=n-1,a+=r[n]*t[n][o]+r[u]*t[u][o];0===n&&(a+=r[0]*t[0][o]),s[o]=a}return s},numeric.dotVV=function(r,t){var n,o,e=r.length,i=r[e-1]*t[e-1];for(n=e-2;n>=1;n-=2)o=n-1,i+=r[n]*t[n]+r[o]*t[o];return 0===n&&(i+=r[0]*t[0]),i},numeric.dot=function(r,t){var n=numeric.dim;switch(1e3*n(r).length+n(t).length){case 2002:return t.length<10?numeric.dotMMsmall(r,t):numeric.dotMMbig(r,t);case 2001:return numeric.dotMV(r,t);case 1002:return numeric.dotVM(r,t);case 1001:return numeric.dotVV(r,t);case 1e3:return numeric.mulVS(r,t);case 1:return numeric.mulSV(r,t);case 0:return r*t;default:throw new Error("numeric.dot only works on vectors and matrices")}},numeric.diag=function(r){var t,n,o,e,i=r.length,s=Array(i);for(t=i-1;t>=0;t--){for(e=Array(i),n=t+2,o=i-1;o>=n;o-=2)e[o]=0,e[o-1]=0;for(o>t&&(e[o]=0),e[t]=r[t],o=t-1;o>=1;o-=2)e[o]=0,e[o-1]=0;0===o&&(e[0]=0),s[t]=e}return s},numeric.getDiag=function(r){var t,n=Math.min(r.length,r[0].length),o=Array(n);for(t=n-1;t>=1;--t)o[t]=r[t][t],--t,o[t]=r[t][t];return 0===t&&(o[0]=r[0][0]),o},numeric.identity=function(r){return numeric.diag(numeric.rep([r],1))},numeric.pointwise=function(r,t,n){"undefined"==typeof n&&(n="");var o,e,i=[],s=/\[i\]$/,a="",u=!1;for(o=0;o<r.length;o++)s.test(r[o])?(e=r[o].substring(0,r[o].length-3),a=e):e=r[o],"ret"===e&&(u=!0),i.push(e);return i[r.length]="_s",i[r.length+1]="_k",i[r.length+2]='if(typeof _s === "undefined") _s = numeric.dim('+a+');\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i'+(u?"":", ret = Array(_n)")+";\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) ret[i] = arguments.callee("+r.join(",")+",_s,_k+1);\n    return ret;\n}\n"+n+"\nfor(i=_n-1;i!==-1;--i) {\n    "+t+"\n}\nreturn ret;",Function.apply(null,i)},numeric.pointwise2=function(r,t,n){"undefined"==typeof n&&(n="");var o,e,i=[],s=/\[i\]$/,a="",u=!1;for(o=0;o<r.length;o++)s.test(r[o])?(e=r[o].substring(0,r[o].length-3),a=e):e=r[o],"ret"===e&&(u=!0),i.push(e);return i[r.length]="var _n = "+a+".length;\nvar i"+(u?"":", ret = Array(_n)")+";\n"+n+"\nfor(i=_n-1;i!==-1;--i) {\n"+t+"\n}\nreturn ret;",Function.apply(null,i)},numeric._biforeach=function t(r,n,o,e,i){if(e===o.length-1)return void i(r,n);var s,a=o[e];for(s=a-1;s>=0;s--)t("object"==typeof r?r[s]:r,"object"==typeof n?n[s]:n,o,e+1,i)},numeric._biforeach2=function n(r,t,o,e,i){if(e===o.length-1)return i(r,t);var s,a=o[e],u=Array(a);for(s=a-1;s>=0;--s)u[s]=n("object"==typeof r?r[s]:r,"object"==typeof t?t[s]:t,o,e+1,i);return u},numeric._foreach=function o(r,t,n,e){if(n===t.length-1)return void e(r);var i,s=t[n];for(i=s-1;i>=0;i--)o(r[i],t,n+1,e)},numeric._foreach2=function e(r,t,n,o){if(n===t.length-1)return o(r);var i,s=t[n],a=Array(s);for(i=s-1;i>=0;i--)a[i]=e(r[i],t,n+1,o);return a},numeric.ops2={add:"+",sub:"-",mul:"*",div:"/",mod:"%",and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">=",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"},numeric.opseq={addeq:"+=",subeq:"-=",muleq:"*=",diveq:"/=",modeq:"%=",lshifteq:"<<=",rshifteq:">>=",rrshifteq:">>>=",bandeq:"&=",boreq:"|=",bxoreq:"^="},numeric.mathfuns=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan","isNaN","isFinite"],numeric.mathfuns2=["atan2","pow","max","min"],numeric.ops1={neg:"-",not:"!",bnot:"~",clone:""},numeric.mapreducers={any:["if(xi) return true;","var accum = false;"],all:["if(!xi) return false;","var accum = true;"],sum:["accum += xi;","var accum = 0;"],prod:["accum *= xi;","var accum = 1;"],norm2Squared:["accum += xi*xi;","var accum = 0;"],norminf:["accum = max(accum,abs(xi));","var accum = 0, max = Math.max, abs = Math.abs;"],norm1:["accum += abs(xi)","var accum = 0, abs = Math.abs;"],sup:["accum = max(accum,xi);","var accum = -Infinity, max = Math.max;"],inf:["accum = min(accum,xi);","var accum = Infinity, min = Math.min;"]},function(){var r,t;for(r=0;r<numeric.mathfuns2.length;++r)t=numeric.mathfuns2[r],numeric.ops2[t]=t;for(r in numeric.ops2)if(numeric.ops2.hasOwnProperty(r)){t=numeric.ops2[r];var n,o,e="";-1!==numeric.myIndexOf.call(numeric.mathfuns2,r)?(e="var "+t+" = Math."+t+";\n",n=function(r,n,o){return r+" = "+t+"("+n+","+o+")"},o=function(r,n){return r+" = "+t+"("+r+","+n+")"}):(n=function(r,n,o){return r+" = "+n+" "+t+" "+o},o=numeric.opseq.hasOwnProperty(r+"eq")?function(r,n){return r+" "+t+"= "+n}:function(r,n){return r+" = "+r+" "+t+" "+n}),numeric[r+"VV"]=numeric.pointwise2(["x[i]","y[i]"],n("ret[i]","x[i]","y[i]"),e),numeric[r+"SV"]=numeric.pointwise2(["x","y[i]"],n("ret[i]","x","y[i]"),e),numeric[r+"VS"]=numeric.pointwise2(["x[i]","y"],n("ret[i]","x[i]","y"),e),numeric[r]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar VV = numeric."+r+"VV, VS = numeric."+r+"VS, SV = numeric."+r+'SV;\nvar dim = numeric.dim;\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof x === "object") {\n      if(typeof y === "object") x = numeric._biforeach2(x,y,dim(x),0,VV);\n      else x = numeric._biforeach2(x,y,dim(x),0,VS);\n  } else if(typeof y === "object") x = numeric._biforeach2(x,y,dim(y),0,SV);\n  else '+o("x","y")+"\n}\nreturn x;\n"),numeric[t]=numeric[r],numeric[r+"eqV"]=numeric.pointwise2(["ret[i]","x[i]"],o("ret[i]","x[i]"),e),numeric[r+"eqS"]=numeric.pointwise2(["ret[i]","x"],o("ret[i]","x"),e),numeric[r+"eq"]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar V = numeric."+r+"eqV, S = numeric."+r+'eqS\nvar s = numeric.dim(x);\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof y === "object") numeric._biforeach(x,y,s,0,V);\n  else numeric._biforeach(x,y,s,0,S);\n}\nreturn x;\n')}for(r=0;r<numeric.mathfuns2.length;++r)t=numeric.mathfuns2[r],delete numeric.ops2[t];for(r=0;r<numeric.mathfuns.length;++r)t=numeric.mathfuns[r],numeric.ops1[t]=t;for(r in numeric.ops1)numeric.ops1.hasOwnProperty(r)&&(e="",t=numeric.ops1[r],-1!==numeric.myIndexOf.call(numeric.mathfuns,r)&&Math.hasOwnProperty(t)&&(e="var "+t+" = Math."+t+";\n"),numeric[r+"eqV"]=numeric.pointwise2(["ret[i]"],"ret[i] = "+t+"(ret[i]);",e),numeric[r+"eq"]=Function("x",'if(typeof x !== "object") return '+t+"x\nvar i;\nvar V = numeric."+r+"eqV;\nvar s = numeric.dim(x);\nnumeric._foreach(x,s,0,V);\nreturn x;\n"),numeric[r+"V"]=numeric.pointwise2(["x[i]"],"ret[i] = "+t+"(x[i]);",e),numeric[r]=Function("x",'if(typeof x !== "object") return '+t+"(x)\nvar i;\nvar V = numeric."+r+"V;\nvar s = numeric.dim(x);\nreturn numeric._foreach2(x,s,0,V);\n"));for(r=0;r<numeric.mathfuns.length;++r)t=numeric.mathfuns[r],delete numeric.ops1[t];for(r in numeric.mapreducers)numeric.mapreducers.hasOwnProperty(r)&&(t=numeric.mapreducers[r],numeric[r+"V"]=numeric.mapreduce2(t[0],t[1]),numeric[r]=Function("x","s","k",t[1]+'if(typeof x !== "object") {    xi = x;\n'+t[0]+';\n    return accum;\n}if(typeof s === "undefined") s = numeric.dim(x);\nif(typeof k === "undefined") k = 0;\nif(k === s.length-1) return numeric.'+r+"V(x);\nvar xi;\nvar n = x.length, i;\nfor(i=n-1;i!==-1;--i) {\n   xi = arguments.callee(x[i]);\n"+t[0]+";\n}\nreturn accum;\n"))}(),numeric.truncVV=numeric.pointwise(["x[i]","y[i]"],"ret[i] = round(x[i]/y[i])*y[i];","var round = Math.round;"),numeric.truncVS=numeric.pointwise(["x[i]","y"],"ret[i] = round(x[i]/y)*y;","var round = Math.round;"),numeric.truncSV=numeric.pointwise(["x","y[i]"],"ret[i] = round(x/y[i])*y[i];","var round = Math.round;"),numeric.trunc=function(r,t){return"object"==typeof r?"object"==typeof t?numeric.truncVV(r,t):numeric.truncVS(r,t):"object"==typeof t?numeric.truncSV(r,t):Math.round(r/t)*t},numeric.inv=function(r){var t,n,o,e,i,s,a,r,u=numeric.dim(r),f=Math.abs,h=u[0],c=u[1],l=numeric.clone(r),m=numeric.identity(h);for(s=0;c>s;++s){var p=-1,w=-1;for(i=s;i!==h;++i)a=f(l[i][s]),a>w&&(p=i,w=a);for(n=l[p],l[p]=l[s],l[s]=n,e=m[p],m[p]=m[s],m[s]=e,r=n[s],a=s;a!==c;++a)n[a]/=r;for(a=c-1;-1!==a;--a)e[a]/=r;for(i=h-1;-1!==i;--i)if(i!==s){for(t=l[i],o=m[i],r=t[s],a=s+1;a!==c;++a)t[a]-=n[a]*r;for(a=c-1;a>0;--a)o[a]-=e[a]*r,--a,o[a]-=e[a]*r;0===a&&(o[0]-=e[0]*r)}}return m},numeric.det=function(r){var t=numeric.dim(r);if(2!==t.length||t[0]!==t[1])throw new Error("numeric: det() only works on square matrices");var n,o,e,i,s,a,u,f,h=t[0],c=1,l=numeric.clone(r);for(o=0;h-1>o;o++){for(e=o,n=o+1;h>n;n++)Math.abs(l[n][o])>Math.abs(l[e][o])&&(e=n);for(e!==o&&(u=l[e],l[e]=l[o],l[o]=u,c*=-1),i=l[o],n=o+1;h>n;n++){for(s=l[n],a=s[o]/i[o],e=o+1;h-1>e;e+=2)f=e+1,s[e]-=i[e]*a,s[f]-=i[f]*a;e!==h&&(s[e]-=i[e]*a)}if(0===i[o])return 0;c*=i[o]}return c*l[o][o]},numeric.transpose=function(r){var t,n,o,e,i,s=r.length,a=r[0].length,u=Array(a);for(n=0;a>n;n++)u[n]=Array(s);for(t=s-1;t>=1;t-=2){for(e=r[t],o=r[t-1],n=a-1;n>=1;--n)i=u[n],i[t]=e[n],i[t-1]=o[n],--n,i=u[n],i[t]=e[n],i[t-1]=o[n];0===n&&(i=u[0],i[t]=e[0],i[t-1]=o[0])}if(0===t){for(o=r[0],n=a-1;n>=1;--n)u[n][0]=o[n],--n,u[n][0]=o[n];0===n&&(u[0][0]=o[0])}return u},numeric.negtranspose=function(r){var t,n,o,e,i,s=r.length,a=r[0].length,u=Array(a);for(n=0;a>n;n++)u[n]=Array(s);for(t=s-1;t>=1;t-=2){for(e=r[t],o=r[t-1],n=a-1;n>=1;--n)i=u[n],i[t]=-e[n],i[t-1]=-o[n],--n,i=u[n],i[t]=-e[n],i[t-1]=-o[n];0===n&&(i=u[0],i[t]=-e[0],i[t-1]=-o[0])}if(0===t){for(o=r[0],n=a-1;n>=1;--n)u[n][0]=-o[n],--n,u[n][0]=-o[n];0===n&&(u[0][0]=-o[0])}return u},numeric._random=function i(r,t){var n,o,e=r[t],s=Array(e);if(t===r.length-1){for(o=Math.random,n=e-1;n>=1;n-=2)s[n]=o(),s[n-1]=o();return 0===n&&(s[0]=o()),s}for(n=e-1;n>=0;n--)s[n]=i(r,t+1);return s},numeric.random=function(r){return numeric._random(r,0)},numeric.norm2=function(r){return Math.sqrt(numeric.norm2Squared(r))},numeric.linspace=function(r,t,n){if("undefined"==typeof n&&(n=Math.max(Math.round(t-r)+1,1)),2>n)return 1===n?[r]:[];var o,e=Array(n);for(n--,o=n;o>=0;o--)e[o]=(o*t+(n-o)*r)/n;return e},numeric.getBlock=function(r,t,n){function o(r,i){var s,a=t[i],u=n[i]-a,f=Array(u);if(i===e.length-1){for(s=u;s>=0;s--)f[s]=r[s+a];return f}for(s=u;s>=0;s--)f[s]=o(r[s+a],i+1);return f}var e=numeric.dim(r);return o(r,0)},numeric.setBlock=function(r,t,n,o){function e(r,o,s){var a,u=t[s],f=n[s]-u;if(s===i.length-1)for(a=f;a>=0;a--)r[a+u]=o[a];for(a=f;a>=0;a--)e(r[a+u],o[a],s+1)}var i=numeric.dim(r);return e(r,o,0),r},numeric.getRange=function(r,t,n){var o,e,i,s,a=t.length,u=n.length,f=Array(a);for(o=a-1;-1!==o;--o)for(f[o]=Array(u),i=f[o],s=r[t[o]],e=u-1;-1!==e;--e)i[e]=s[n[e]];return f},numeric.blockMatrix=function(r){var t=numeric.dim(r);if(t.length<4)return numeric.blockMatrix([r]);var n,o,e,i,s,a=t[0],u=t[1];for(n=0,o=0,e=0;a>e;++e)n+=r[e][0].length;for(i=0;u>i;++i)o+=r[0][i][0].length;var f=Array(n);for(e=0;n>e;++e)f[e]=Array(o);var h,c,l,m,p,w=0;for(e=0;a>e;++e){for(h=o,i=u-1;-1!==i;--i)for(s=r[e][i],h-=s[0].length,l=s.length-1;-1!==l;--l)for(p=s[l],c=f[w+l],m=p.length-1;-1!==m;--m)c[h+m]=p[m];w+=r[e][0].length}return f},numeric.tensor=function(r,t){if("number"==typeof r||"number"==typeof t)return numeric.mul(r,t);var n=numeric.dim(r),o=numeric.dim(t);if(1!==n.length||1!==o.length)throw new Error("numeric: tensor product is only defined for vectors");var e,i,s,a,u=n[0],f=o[0],h=Array(u);for(i=u-1;i>=0;i--){for(e=Array(f),a=r[i],s=f-1;s>=3;--s)e[s]=a*t[s],--s,e[s]=a*t[s],--s,e[s]=a*t[s],--s,e[s]=a*t[s];for(;s>=0;)e[s]=a*t[s],--s;h[i]=e}return h},numeric.T=function(r,t){this.x=r,this.y=t},numeric.t=function(r,t){return new numeric.T(r,t)},numeric.Tbinop=function(r,t,n,o,e){numeric.indexOf;if("string"!=typeof e){var i;e="";for(i in numeric)numeric.hasOwnProperty(i)&&(r.indexOf(i)>=0||t.indexOf(i)>=0||n.indexOf(i)>=0||o.indexOf(i)>=0)&&i.length>1&&(e+="var "+i+" = numeric."+i+";\n")}return Function(["y"],"var x = this;\nif(!(y instanceof numeric.T)) { y = new numeric.T(y); }\n"+e+"\nif(x.y) {  if(y.y) {    return new numeric.T("+o+");\n  }\n  return new numeric.T("+n+");\n}\nif(y.y) {\n  return new numeric.T("+t+");\n}\nreturn new numeric.T("+r+");\n")},numeric.T.prototype.add=numeric.Tbinop("add(x.x,y.x)","add(x.x,y.x),y.y","add(x.x,y.x),x.y","add(x.x,y.x),add(x.y,y.y)"),numeric.T.prototype.sub=numeric.Tbinop("sub(x.x,y.x)","sub(x.x,y.x),neg(y.y)","sub(x.x,y.x),x.y","sub(x.x,y.x),sub(x.y,y.y)"),numeric.T.prototype.mul=numeric.Tbinop("mul(x.x,y.x)","mul(x.x,y.x),mul(x.x,y.y)","mul(x.x,y.x),mul(x.y,y.x)","sub(mul(x.x,y.x),mul(x.y,y.y)),add(mul(x.x,y.y),mul(x.y,y.x))"),numeric.T.prototype.reciprocal=function(){var r=numeric.mul,t=numeric.div;if(this.y){var n=numeric.add(r(this.x,this.x),r(this.y,this.y));return new numeric.T(t(this.x,n),t(numeric.neg(this.y),n))}return new T(t(1,this.x))},numeric.T.prototype.div=function s(r){if(r instanceof numeric.T||(r=new numeric.T(r)),r.y)return this.mul(r.reciprocal());var s=numeric.div;return this.y?new numeric.T(s(this.x,r.x),s(this.y,r.x)):new numeric.T(s(this.x,r.x))},numeric.T.prototype.dot=numeric.Tbinop("dot(x.x,y.x)","dot(x.x,y.x),dot(x.x,y.y)","dot(x.x,y.x),dot(x.y,y.x)","sub(dot(x.x,y.x),dot(x.y,y.y)),add(dot(x.x,y.y),dot(x.y,y.x))"),numeric.T.prototype.transpose=function(){var r=numeric.transpose,t=this.x,n=this.y;return n?new numeric.T(r(t),r(n)):new numeric.T(r(t))},numeric.T.prototype.transjugate=function(){var r=numeric.transpose,t=this.x,n=this.y;return n?new numeric.T(r(t),numeric.negtranspose(n)):new numeric.T(r(t))},numeric.Tunop=function(r,t,n){return"string"!=typeof n&&(n=""),Function("var x = this;\n"+n+"\nif(x.y) {  "+t+";\n}\n"+r+";\n")},numeric.T.prototype.exp=numeric.Tunop("return new numeric.T(ex)","return new numeric.T(mul(cos(x.y),ex),mul(sin(x.y),ex))","var ex = numeric.exp(x.x), cos = numeric.cos, sin = numeric.sin, mul = numeric.mul;"),numeric.T.prototype.conj=numeric.Tunop("return new numeric.T(x.x);","return new numeric.T(x.x,numeric.neg(x.y));"),numeric.T.prototype.neg=numeric.Tunop("return new numeric.T(neg(x.x));","return new numeric.T(neg(x.x),neg(x.y));","var neg = numeric.neg;"),numeric.T.prototype.sin=numeric.Tunop("return new numeric.T(numeric.sin(x.x))","return x.exp().sub(x.neg().exp()).div(new numeric.T(0,2));"),numeric.T.prototype.cos=numeric.Tunop("return new numeric.T(numeric.cos(x.x))","return x.exp().add(x.neg().exp()).div(2);"),numeric.T.prototype.abs=numeric.Tunop("return new numeric.T(numeric.abs(x.x));","return new numeric.T(numeric.sqrt(numeric.add(mul(x.x,x.x),mul(x.y,x.y))));","var mul = numeric.mul;"),numeric.T.prototype.log=numeric.Tunop("return new numeric.T(numeric.log(x.x));","var theta = new numeric.T(numeric.atan2(x.y,x.x)), r = x.abs();\nreturn new numeric.T(numeric.log(r.x),theta.x);"),numeric.T.prototype.norm2=numeric.Tunop("return numeric.norm2(x.x);","var f = numeric.norm2Squared;\nreturn Math.sqrt(f(x.x)+f(x.y));"),numeric.T.prototype.inv=function(){var r=this;if("undefined"==typeof r.y)return new numeric.T(numeric.inv(r.x));var t,n,o,e,i,s,a,u,f,h,c,t,n,o,l,m,p,w,v,g,y,d=r.x.length,b=numeric.identity(d),x=numeric.rep([d,d],0),M=numeric.clone(r.x),k=numeric.clone(r.y);for(t=0;d>t;t++){for(p=M[t][t],w=k[t][t],l=p*p+w*w,o=t,n=t+1;d>n;n++)p=M[n][t],w=k[n][t],m=p*p+w*w,m>l&&(o=n,l=m);for(o!==t&&(y=M[t],M[t]=M[o],M[o]=y,y=k[t],k[t]=k[o],k[o]=y,y=b[t],b[t]=b[o],b[o]=y,y=x[t],x[t]=x[o],x[o]=y),e=M[t],i=k[t],u=b[t],f=x[t],p=e[t],w=i[t],n=t+1;d>n;n++)v=e[n],g=i[n],e[n]=(v*p+g*w)/l,i[n]=(g*p-v*w)/l;for(n=0;d>n;n++)v=u[n],g=f[n],u[n]=(v*p+g*w)/l,f[n]=(g*p-v*w)/l;for(n=t+1;d>n;n++){for(s=M[n],a=k[n],h=b[n],c=x[n],p=s[t],w=a[t],o=t+1;d>o;o++)v=e[o],g=i[o],s[o]-=v*p-g*w,a[o]-=g*p+v*w;for(o=0;d>o;o++)v=u[o],g=f[o],h[o]-=v*p-g*w,c[o]-=g*p+v*w}}for(t=d-1;t>0;t--)for(u=b[t],f=x[t],n=t-1;n>=0;n--)for(h=b[n],c=x[n],p=M[n][t],w=k[n][t],o=d-1;o>=0;o--)v=u[o],g=f[o],h[o]-=p*v-w*g,c[o]-=p*g+w*v;return new numeric.T(b,x)},numeric.T.prototype.get=function(r){var t,n=this.x,o=this.y,e=0,i=r.length;if(o){for(;i>e;)t=r[e],n=n[t],o=o[t],e++;return new numeric.T(n,o)}for(;i>e;)t=r[e],n=n[t],e++;return new numeric.T(n)},numeric.T.prototype.set=function(r,t){var n,o=this.x,e=this.y,i=0,s=r.length,a=t.x,u=t.y;if(0===s)return u?this.y=u:e&&(this.y=void 0),this.x=o,this;if(u){for(e||(e=numeric.rep(numeric.dim(o),0),this.y=e);s-1>i;)n=r[i],o=o[n],e=e[n],i++;return n=r[i],o[n]=a,e[n]=u,this}if(e){for(;s-1>i;)n=r[i],o=o[n],e=e[n],i++;return n=r[i],o[n]=a,a instanceof Array?e[n]=numeric.rep(numeric.dim(a),0):e[n]=0,this}for(;s-1>i;)n=r[i],o=o[n],i++;return n=r[i],o[n]=a,this},numeric.T.prototype.getRows=function(r,t){var n,o,e=t-r+1,i=Array(e),s=this.x,a=this.y;for(n=r;t>=n;n++)i[n-r]=s[n];if(a){for(o=Array(e),n=r;t>=n;n++)o[n-r]=a[n];return new numeric.T(i,o)}return new numeric.T(i)},numeric.T.prototype.setRows=function(r,t,n){var o,e=this.x,i=this.y,s=n.x,a=n.y;for(o=r;t>=o;o++)e[o]=s[o-r];if(a)for(i||(i=numeric.rep(numeric.dim(e),0),this.y=i),o=r;t>=o;o++)i[o]=a[o-r];else if(i)for(o=r;t>=o;o++)i[o]=numeric.rep([s[o-r].length],0);return this},numeric.T.prototype.getRow=function(r){var t=this.x,n=this.y;return n?new numeric.T(t[r],n[r]):new numeric.T(t[r])},numeric.T.prototype.setRow=function(r,t){var n=this.x,o=this.y,e=t.x,i=t.y;return n[r]=e,i?(o||(o=numeric.rep(numeric.dim(n),0),this.y=o),o[r]=i):o&&(o=numeric.rep([e.length],0)),this},numeric.T.prototype.getBlock=function(r,t){var n=this.x,o=this.y,e=numeric.getBlock;return o?new numeric.T(e(n,r,t),e(o,r,t)):new numeric.T(e(n,r,t))},numeric.T.prototype.setBlock=function(r,t,n){n instanceof numeric.T||(n=new numeric.T(n));var o=this.x,e=this.y,i=numeric.setBlock,s=n.x,a=n.y;return a?(e||(this.y=numeric.rep(numeric.dim(this),0),e=this.y),i(o,r,t,s),i(e,r,t,a),this):(i(o,r,t,s),void(e&&i(e,r,t,numeric.rep(numeric.dim(s),0))))},numeric.T.rep=function(r,t){var n=numeric.T;t instanceof n||(t=new n(t));var o=t.x,e=t.y,i=numeric.rep;return e?new n(i(r,o),i(r,e)):new n(i(r,o))},numeric.T.diag=function a(r){r instanceof numeric.T||(r=new numeric.T(r));var t=r.x,n=r.y,a=numeric.diag;return n?new numeric.T(a(t),a(n)):new numeric.T(a(t))},numeric.T.eig=function(){if(this.y)throw new Error("eig: not implemented for complex matrices.");return numeric.eig(this.x)},numeric.T.identity=function(r){return new numeric.T(numeric.identity(r))},numeric.T.prototype.getDiag=function(){var r=numeric,t=this.x,n=this.y;return n?new r.T(r.getDiag(t),r.getDiag(n)):new r.T(r.getDiag(t))},numeric.house=function(r){var t=numeric.clone(r),n=r[0]>=0?1:-1,o=n*numeric.norm2(r);t[0]+=o;var e=numeric.norm2(t);if(0===e)throw new Error("eig: internal error");return numeric.div(t,e)},numeric.toUpperHessenberg=function(r){var t=numeric.dim(r);if(2!==t.length||t[0]!==t[1])throw new Error("numeric: toUpperHessenberg() only works on square matrices");var n,o,e,i,s,a,u,f,h,c,l=t[0],m=numeric.clone(r),p=numeric.identity(l);for(o=0;l-2>o;o++){for(i=Array(l-o-1),n=o+1;l>n;n++)i[n-o-1]=m[n][o];if(numeric.norm2(i)>0){for(s=numeric.house(i),a=numeric.getBlock(m,[o+1,o],[l-1,l-1]),u=numeric.tensor(s,numeric.dot(s,a)),n=o+1;l>n;n++)for(f=m[n],h=u[n-o-1],e=o;l>e;e++)f[e]-=2*h[e-o];for(a=numeric.getBlock(m,[0,o+1],[l-1,l-1]),u=numeric.tensor(numeric.dot(a,s),s),n=0;l>n;n++)for(f=m[n],h=u[n],e=o+1;l>e;e++)f[e]-=2*h[e-o-1];for(a=Array(l-o-1),n=o+1;l>n;n++)a[n-o-1]=p[n];for(u=numeric.tensor(s,numeric.dot(s,a)),n=o+1;l>n;n++)for(c=p[n],h=u[n-o-1],e=0;l>e;e++)c[e]-=2*h[e]}}return{H:m,Q:p}},numeric.epsilon=2.220446049250313e-16,numeric.QRFrancis=function(r,t){"undefined"==typeof t&&(t=1e4),r=numeric.clone(r);var n,o,e,i,s,a,u,f,h,c,l,m,p,w,v,g,y,d,b=(numeric.clone(r),numeric.dim(r)),x=b[0],M=numeric.identity(x);if(3>x)return{Q:M,B:[[0,x-1]]};var k=numeric.epsilon;for(d=0;t>d;d++){for(g=0;x-1>g;g++)if(Math.abs(r[g+1][g])<k*(Math.abs(r[g][g])+Math.abs(r[g+1][g+1]))){var R=numeric.QRFrancis(numeric.getBlock(r,[0,0],[g,g]),t),A=numeric.QRFrancis(numeric.getBlock(r,[g+1,g+1],[x-1,x-1]),t);for(m=Array(g+1),v=0;g>=v;v++)m[v]=M[v];for(p=numeric.dot(R.Q,m),v=0;g>=v;v++)M[v]=p[v];for(m=Array(x-g-1),v=g+1;x>v;v++)m[v-g-1]=M[v];for(p=numeric.dot(A.Q,m),v=g+1;x>v;v++)M[v]=p[v-g-1];return{Q:M,B:R.B.concat(numeric.add(A.B,g+1))}}if(e=r[x-2][x-2],i=r[x-2][x-1],s=r[x-1][x-2],a=r[x-1][x-1],f=e+a,u=e*a-i*s,h=numeric.getBlock(r,[0,0],[2,2]),f*f>=4*u){var j,S;j=.5*(f+Math.sqrt(f*f-4*u)),S=.5*(f-Math.sqrt(f*f-4*u)),h=numeric.add(numeric.sub(numeric.dot(h,h),numeric.mul(h,j+S)),numeric.diag(numeric.rep([3],j*S)))}else h=numeric.add(numeric.sub(numeric.dot(h,h),numeric.mul(h,f)),numeric.diag(numeric.rep([3],u)));for(n=[h[0][0],h[1][0],h[2][0]],o=numeric.house(n),m=[r[0],r[1],r[2]],p=numeric.tensor(o,numeric.dot(o,m)),v=0;3>v;v++)for(l=r[v],w=p[v],y=0;x>y;y++)l[y]-=2*w[y];for(m=numeric.getBlock(r,[0,0],[x-1,2]),p=numeric.tensor(numeric.dot(m,o),o),v=0;x>v;v++)for(l=r[v],w=p[v],y=0;3>y;y++)l[y]-=2*w[y];for(m=[M[0],M[1],M[2]],p=numeric.tensor(o,numeric.dot(o,m)),v=0;3>v;v++)for(c=M[v],w=p[v],y=0;x>y;y++)c[y]-=2*w[y];var V;for(g=0;x-2>g;g++){for(y=g;g+1>=y;y++)if(Math.abs(r[y+1][y])<k*(Math.abs(r[y][y])+Math.abs(r[y+1][y+1]))){var R=numeric.QRFrancis(numeric.getBlock(r,[0,0],[y,y]),t),A=numeric.QRFrancis(numeric.getBlock(r,[y+1,y+1],[x-1,x-1]),t);for(m=Array(y+1),v=0;y>=v;v++)m[v]=M[v];for(p=numeric.dot(R.Q,m),v=0;y>=v;v++)M[v]=p[v];for(m=Array(x-y-1),v=y+1;x>v;v++)m[v-y-1]=M[v];for(p=numeric.dot(A.Q,m),v=y+1;x>v;v++)M[v]=p[v-y-1];return{Q:M,B:R.B.concat(numeric.add(A.B,y+1))}}for(V=Math.min(x-1,g+3),n=Array(V-g),v=g+1;V>=v;v++)n[v-g-1]=r[v][g];for(o=numeric.house(n),m=numeric.getBlock(r,[g+1,g],[V,x-1]),p=numeric.tensor(o,numeric.dot(o,m)),v=g+1;V>=v;v++)for(l=r[v],w=p[v-g-1],y=g;x>y;y++)l[y]-=2*w[y-g];for(m=numeric.getBlock(r,[0,g+1],[x-1,V]),p=numeric.tensor(numeric.dot(m,o),o),v=0;x>v;v++)for(l=r[v],w=p[v],y=g+1;V>=y;y++)l[y]-=2*w[y-g-1];for(m=Array(V-g),v=g+1;V>=v;v++)m[v-g-1]=M[v];for(p=numeric.tensor(o,numeric.dot(o,m)),v=g+1;V>=v;v++)for(c=M[v],w=p[v-g-1],y=0;x>y;y++)c[y]-=2*w[y]}}throw new Error("numeric: eigenvalue iteration does not converge -- increase maxiter?")},numeric.eig=function(r,t){var n,o,e,i,s,a,u,f,h,c,l,m,p,w,v,g,y,d=numeric.toUpperHessenberg(r),b=numeric.QRFrancis(d.H,t),x=numeric.T,M=r.length,k=b.B,R=numeric.dot(b.Q,numeric.dot(d.H,numeric.transpose(b.Q))),A=new x(numeric.dot(b.Q,d.Q)),j=k.length,S=Math.sqrt;for(o=0;j>o;o++)if(n=k[o][0],n===k[o][1]);else{if(i=n+1,s=R[n][n],a=R[n][i],u=R[i][n],f=R[i][i],0===a&&0===u)continue;h=-s-f,c=s*f-a*u,l=h*h-4*c,l>=0?(m=0>h?-.5*(h-S(l)):-.5*(h+S(l)),g=(s-m)*(s-m)+a*a,y=u*u+(f-m)*(f-m),g>y?(g=S(g),w=(s-m)/g,v=a/g):(y=S(y),w=u/y,v=(f-m)/y),e=new x([[v,-w],[w,v]]),A.setRows(n,i,e.dot(A.getRows(n,i)))):(m=-.5*h,p=.5*S(-l),g=(s-m)*(s-m)+a*a,y=u*u+(f-m)*(f-m),g>y?(g=S(g+p*p),w=(s-m)/g,v=a/g,m=0,p/=g):(y=S(y+p*p),w=u/y,v=(f-m)/y,m=p/y,p=0),e=new x([[v,-w],[w,v]],[[m,p],[p,-m]]),A.setRows(n,i,e.dot(A.getRows(n,i))))}var V=A.dot(r).dot(A.transjugate()),M=r.length,E=numeric.T.identity(M);for(i=0;M>i;i++)if(i>0)for(o=i-1;o>=0;o--){var C=V.get([o,o]),D=V.get([i,i]);numeric.neq(C.x,D.x)||numeric.neq(C.y,D.y)?(m=V.getRow(o).getBlock([o],[i-1]),p=E.getRow(i).getBlock([o],[i-1]),E.set([i,o],V.get([o,i]).neg().sub(m.dot(p)).div(C.sub(D)))):E.setRow(i,E.getRow(o))}for(i=0;M>i;i++)m=E.getRow(i),E.setRow(i,m.div(m.norm2()));return E=E.transpose(),E=A.transjugate().dot(E),{lambda:V.getDiag(),E:E}},numeric.ccsSparse=function(r){var t,n,o,e,i=r.length,s=[];for(o=i-1;-1!==o;--o){n=r[o];for(e in n){for(e=parseInt(e);e>=s.length;)s[s.length]=0;0!==n[e]&&s[e]++}}var t=s.length,a=Array(t+1);for(a[0]=0,o=0;t>o;++o)a[o+1]=a[o]+s[o];var u=Array(a[t]),f=Array(a[t]);for(o=i-1;-1!==o;--o){n=r[o];for(e in n)0!==n[e]&&(s[e]--,u[a[e]+s[e]]=o,f[a[e]+s[e]]=n[e])}return[a,u,f]},numeric.ccsFull=function(r){var t,n,o,e,i=r[0],s=r[1],a=r[2],u=numeric.ccsDim(r),f=u[0],h=u[1],c=numeric.rep([f,h],0);for(t=0;h>t;t++)for(o=i[t],e=i[t+1],n=o;e>n;++n)c[s[n]][t]=a[n];return c},numeric.ccsTSolve=function(r,t,n,o,e){function i(r){var t;if(0===n[r]){for(n[r]=1,t=s[r];t<s[r+1];++t)i(a[t]);e[c]=r,++c}}var s=r[0],a=r[1],u=r[2],f=s.length-1,h=Math.max,c=0;"undefined"==typeof o&&(n=numeric.rep([f],0)),"undefined"==typeof o&&(o=numeric.linspace(0,n.length-1)),"undefined"==typeof e&&(e=[]);var l,m,p,w,v,g,y;for(l=o.length-1;-1!==l;--l)i(o[l]);for(e.length=c,l=e.length-1;-1!==l;--l)n[e[l]]=0;for(l=o.length-1;-1!==l;--l)m=o[l],n[m]=t[m];for(l=e.length-1;-1!==l;--l){for(m=e[l],p=s[m],w=h(s[m+1],p),v=p;v!==w;++v)if(a[v]===m){n[m]/=u[v];break}for(y=n[m],v=p;v!==w;++v)g=a[v],g!==m&&(n[g]-=y*u[v])}return n},numeric.ccsDFS=function(r){this.k=Array(r),this.k1=Array(r),this.j=Array(r)},numeric.ccsDFS.prototype.dfs=function(r,t,n,o,e,i){var s,a,u,f=0,h=e.length,c=this.k,l=this.k1,m=this.j;if(0===o[r])for(o[r]=1,m[0]=r,c[0]=a=t[r],l[0]=u=t[r+1];;)if(a>=u){if(e[h]=m[f],0===f)return;++h,--f,a=c[f],u=l[f]}else s=i[n[a]],0===o[s]?(o[s]=1,c[f]=a,++f,m[f]=s,a=t[s],l[f]=u=t[s+1]):++a},numeric.ccsLPSolve=function(r,t,n,o,e,i,s){var a,u,f,h,c,l,m,p,w,v=r[0],g=r[1],y=r[2],d=(v.length-1,t[0]),b=t[1],x=t[2];for(u=d[e],f=d[e+1],o.length=0,a=u;f>a;++a)s.dfs(i[b[a]],v,g,n,o,i);for(a=o.length-1;-1!==a;--a)n[o[a]]=0;for(a=u;a!==f;++a)h=i[b[a]],n[h]=x[a];for(a=o.length-1;-1!==a;--a){for(h=o[a],c=v[h],l=v[h+1],m=c;l>m;++m)if(i[g[m]]===h){n[h]/=y[m];break}for(w=n[h],m=c;l>m;++m)p=i[g[m]],p!==h&&(n[p]-=w*y[m])}return n},numeric.ccsLUP1=function(r,t){var n,o,e,i,s,a,u,f=r[0].length-1,h=[numeric.rep([f+1],0),[],[]],c=[numeric.rep([f+1],0),[],[]],l=h[0],m=h[1],p=h[2],w=c[0],v=c[1],g=c[2],y=numeric.rep([f],0),d=numeric.rep([f],0),b=numeric.ccsLPSolve,x=(Math.max,Math.abs),M=numeric.linspace(0,f-1),k=numeric.linspace(0,f-1),R=new numeric.ccsDFS(f);for("undefined"==typeof t&&(t=1),n=0;f>n;++n){for(b(h,r,y,d,n,k,R),i=-1,s=-1,o=d.length-1;-1!==o;--o)e=d[o],n>=e||(a=x(y[e]),a>i&&(s=e,i=a));for(x(y[n])<t*i&&(o=M[n],i=M[s],M[n]=i,k[i]=n,M[s]=o,k[o]=s,i=y[n],y[n]=y[s],y[s]=i),i=l[n],s=w[n],u=y[n],m[i]=M[n],p[i]=1,++i,o=d.length-1;-1!==o;--o)e=d[o],a=y[e],d[o]=0,y[e]=0,n>=e?(v[s]=e,g[s]=a,++s):(m[i]=M[e],p[i]=a/u,++i);l[n+1]=i,w[n+1]=s}for(o=m.length-1;-1!==o;--o)m[o]=k[m[o]];return{L:h,U:c,P:M,Pinv:k}},numeric.ccsDFS0=function(r){this.k=Array(r),this.k1=Array(r),this.j=Array(r)},numeric.ccsDFS0.prototype.dfs=function(r,t,n,o,e,i,s){var a,u,f,h=0,c=e.length,l=this.k,m=this.k1,p=this.j;if(0===o[r])for(o[r]=1,p[0]=r,l[0]=u=t[i[r]],m[0]=f=t[i[r]+1];;){if(isNaN(u))throw new Error("Ow!");if(u>=f){if(e[c]=i[p[h]],0===h)return;++c,--h,u=l[h],f=m[h]}else a=n[u],0===o[a]?(o[a]=1,l[h]=u,++h,p[h]=a,a=i[a],u=t[a],m[h]=f=t[a+1]):++u}},numeric.ccsLPSolve0=function(r,t,n,o,e,i,s,a){var u,f,h,c,l,m,p,w,v,g=r[0],y=r[1],d=r[2],b=(g.length-1,t[0]),x=t[1],M=t[2];for(f=b[e],h=b[e+1],o.length=0,u=f;h>u;++u)a.dfs(x[u],g,y,n,o,i,s);for(u=o.length-1;-1!==u;--u)c=o[u],n[s[c]]=0;for(u=f;u!==h;++u)c=x[u],n[c]=M[u];for(u=o.length-1;-1!==u;--u){for(c=o[u],w=s[c],l=g[c],m=g[c+1],p=l;m>p;++p)if(y[p]===w){n[w]/=d[p];break}for(v=n[w],p=l;m>p;++p)n[y[p]]-=v*d[p];n[w]=v}},numeric.ccsLUP0=function(r,t){var n,o,e,i,s,a,u,f=r[0].length-1,h=[numeric.rep([f+1],0),[],[]],c=[numeric.rep([f+1],0),[],[]],l=h[0],m=h[1],p=h[2],w=c[0],v=c[1],g=c[2],y=numeric.rep([f],0),d=numeric.rep([f],0),b=numeric.ccsLPSolve0,x=(Math.max,Math.abs),M=numeric.linspace(0,f-1),k=numeric.linspace(0,f-1),R=new numeric.ccsDFS0(f);for("undefined"==typeof t&&(t=1),n=0;f>n;++n){for(b(h,r,y,d,n,k,M,R),i=-1,s=-1,o=d.length-1;-1!==o;--o)e=d[o],n>=e||(a=x(y[M[e]]),a>i&&(s=e,i=a));for(x(y[M[n]])<t*i&&(o=M[n],i=M[s],M[n]=i,k[i]=n,M[s]=o,k[o]=s),i=l[n],s=w[n],u=y[M[n]],m[i]=M[n],p[i]=1,++i,o=d.length-1;-1!==o;--o)e=d[o],a=y[M[e]],d[o]=0,y[M[e]]=0,n>=e?(v[s]=e,g[s]=a,++s):(m[i]=M[e],p[i]=a/u,++i);l[n+1]=i,w[n+1]=s}for(o=m.length-1;-1!==o;--o)m[o]=k[m[o]];return{L:h,U:c,P:M,Pinv:k}},numeric.ccsLUP=numeric.ccsLUP0,numeric.ccsDim=function(r){return[numeric.sup(r[1])+1,r[0].length-1]},numeric.ccsGetBlock=function(r,t,n){var o=numeric.ccsDim(r),e=o[0],i=o[1];"undefined"==typeof t?t=numeric.linspace(0,e-1):"number"==typeof t&&(t=[t]),"undefined"==typeof n?n=numeric.linspace(0,i-1):"number"==typeof n&&(n=[n]);var s,a,u,f,h,c=t.length,l=n.length,m=numeric.rep([i],0),p=[],w=[],v=[m,p,w],g=r[0],y=r[1],d=r[2],b=numeric.rep([e],0),x=0,M=numeric.rep([e],0);for(a=0;l>a;++a){f=n[a];var k=g[f],R=g[f+1];for(s=k;R>s;++s)u=y[s],M[u]=1,b[u]=d[s];for(s=0;c>s;++s)h=t[s],M[h]&&(p[x]=s,w[x]=b[t[s]],++x);for(s=k;R>s;++s)u=y[s],M[u]=0;m[a+1]=x}return v},numeric.ccsDot=function(r,t){var n,o,e,i,s,a,u,f,h,c,l,m=r[0],p=r[1],w=r[2],v=t[0],g=t[1],y=t[2],d=numeric.ccsDim(r),b=numeric.ccsDim(t),x=d[0],M=(d[1],b[1]),k=numeric.rep([x],0),R=numeric.rep([x],0),A=Array(x),j=numeric.rep([M],0),S=[],V=[],E=[j,S,V];for(e=0;e!==M;++e){for(i=v[e],s=v[e+1],h=0,o=i;s>o;++o)for(c=g[o],l=y[o],a=m[c],u=m[c+1],n=a;u>n;++n)f=p[n],0===R[f]&&(A[h]=f,R[f]=1,h+=1),k[f]=k[f]+w[n]*l;for(i=j[e],s=i+h,j[e+1]=s,o=h-1;-1!==o;--o)l=i+o,n=A[o],S[l]=n,V[l]=k[n],R[n]=0,k[n]=0;j[e+1]=j[e]+h}return E},numeric.ccsLUPSolve=function(r,t){var n=r.L,o=r.U,e=(r.P,t[0]),i=!1;"object"!=typeof e&&(t=[[0,t.length],numeric.linspace(0,t.length-1),t],e=t[0],i=!0);var s,a,u,f,h,c,l=t[1],m=t[2],p=n[0].length-1,w=e.length-1,v=numeric.rep([p],0),g=Array(p),y=numeric.rep([p],0),d=Array(p),b=numeric.rep([w+1],0),x=[],M=[],k=numeric.ccsTSolve,R=0;for(s=0;w>s;++s){for(h=0,u=e[s],f=e[s+1],a=u;f>a;++a)c=r.Pinv[l[a]],d[h]=c,y[c]=m[a],++h;for(d.length=h,k(n,y,v,d,g),a=d.length-1;-1!==a;--a)y[d[a]]=0;if(k(o,v,y,g,d),i)return y;for(a=g.length-1;-1!==a;--a)v[g[a]]=0;for(a=d.length-1;-1!==a;--a)c=d[a],x[R]=c,M[R]=y[c],y[c]=0,++R;b[s+1]=R}return[b,x,M]},numeric.ccsbinop=function(r,t){return"undefined"==typeof t&&(t=""),Function("X","Y","var Xi = X[0], Xj = X[1], Xv = X[2];\nvar Yi = Y[0], Yj = Y[1], Yv = Y[2];\nvar n = Xi.length-1,m = Math.max(numeric.sup(Xj),numeric.sup(Yj))+1;\nvar Zi = numeric.rep([n+1],0), Zj = [], Zv = [];\nvar x = numeric.rep([m],0),y = numeric.rep([m],0);\nvar xk,yk,zk;\nvar i,j,j0,j1,k,p=0;\n"+t+"for(i=0;i<n;++i) {\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Xj[j];\n    x[k] = 1;\n    Zj[p] = k;\n    ++p;\n  }\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Yj[j];\n    y[k] = Yv[j];\n    if(x[k] === 0) {\n      Zj[p] = k;\n      ++p;\n    }\n  }\n  Zi[i+1] = p;\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = Xv[j];\n  j0 = Zi[i]; j1 = Zi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Zj[j];\n    xk = x[k];\n    yk = y[k];\n"+r+"\n    Zv[j] = zk;\n  }\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = 0;\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) y[Yj[j]] = 0;\n}\nreturn [Zi,Zj,Zv];")},function(){var k,A,B,C;for(k in numeric.ops2)A=isFinite(eval("1"+numeric.ops2[k]+"0"))?"[Y[0],Y[1],numeric."+k+"(X,Y[2])]":"NaN",B=isFinite(eval("0"+numeric.ops2[k]+"1"))?"[X[0],X[1],numeric."+k+"(X[2],Y)]":"NaN",C=isFinite(eval("1"+numeric.ops2[k]+"0"))&&isFinite(eval("0"+numeric.ops2[k]+"1"))?"numeric.ccs"+k+"MM(X,Y)":"NaN",
numeric["ccs"+k+"MM"]=numeric.ccsbinop("zk = xk "+numeric.ops2[k]+"yk;"),numeric["ccs"+k]=Function("X","Y",'if(typeof X === "number") return '+A+';\nif(typeof Y === "number") return '+B+";\nreturn "+C+";\n")}(),numeric.ccsScatter=function(r){var t,n=r[0],o=r[1],e=r[2],i=numeric.sup(o)+1,s=n.length,a=numeric.rep([i],0),u=Array(s),f=Array(s),h=numeric.rep([i],0);for(t=0;s>t;++t)h[o[t]]++;for(t=0;i>t;++t)a[t+1]=a[t]+h[t];var c,l,m=a.slice(0);for(t=0;s>t;++t)l=o[t],c=m[l],u[c]=n[t],f[c]=e[t],m[l]=m[l]+1;return[a,u,f]},numeric.ccsGather=function(r){var t,n,o,e,i,s=r[0],a=r[1],u=r[2],f=s.length-1,h=a.length,c=Array(h),l=Array(h),m=Array(h);for(i=0,t=0;f>t;++t)for(o=s[t],e=s[t+1],n=o;n!==e;++n)l[i]=t,c[i]=a[n],m[i]=u[n],++i;return[c,l,m]},numeric.sdim=function u(r,t,n){if("undefined"==typeof t&&(t=[]),"object"!=typeof r)return t;"undefined"==typeof n&&(n=0),n in t||(t[n]=0),r.length>t[n]&&(t[n]=r.length);var o;for(o in r)r.hasOwnProperty(o)&&u(r[o],t,n+1);return t},numeric.sclone=function f(r,t,n){"undefined"==typeof t&&(t=0),"undefined"==typeof n&&(n=numeric.sdim(r).length);var o,e=Array(r.length);if(t===n-1){for(o in r)r.hasOwnProperty(o)&&(e[o]=r[o]);return e}for(o in r)r.hasOwnProperty(o)&&(e[o]=f(r[o],t+1,n));return e},numeric.sdiag=function(r){var t,n,o=r.length,e=Array(o);for(t=o-1;t>=1;t-=2)n=t-1,e[t]=[],e[t][t]=r[t],e[n]=[],e[n][n]=r[n];return 0===t&&(e[0]=[],e[0][0]=r[t]),e},numeric.sidentity=function(r){return numeric.sdiag(numeric.rep([r],1))},numeric.stranspose=function(r){var t,n,o,e=[];r.length;for(t in r)if(r.hasOwnProperty(t)){o=r[t];for(n in o)o.hasOwnProperty(n)&&("object"!=typeof e[n]&&(e[n]=[]),e[n][t]=o[n])}return e},numeric.sLUP=function(r,t){throw new Error("The function numeric.sLUP had a bug in it and has been removed. Please use the new numeric.ccsLUP function instead.")},numeric.sdotMM=function(r,t){var n,o,e,i,s,a,u,f=r.length,h=(t.length,numeric.stranspose(t)),c=h.length,l=Array(f);for(e=f-1;e>=0;e--){for(u=[],n=r[e],s=c-1;s>=0;s--){a=0,o=h[s];for(i in n)n.hasOwnProperty(i)&&i in o&&(a+=n[i]*o[i]);a&&(u[s]=a)}l[e]=u}return l},numeric.sdotMV=function(r,t){var n,o,e,i,s=r.length,a=Array(s);for(o=s-1;o>=0;o--){n=r[o],i=0;for(e in n)n.hasOwnProperty(e)&&t[e]&&(i+=n[e]*t[e]);i&&(a[o]=i)}return a},numeric.sdotVM=function(r,t){var n,o,e,i,s=[];for(n in r)if(r.hasOwnProperty(n)){e=t[n],i=r[n];for(o in e)e.hasOwnProperty(o)&&(s[o]||(s[o]=0),s[o]+=i*e[o])}return s},numeric.sdotVV=function(r,t){var n,o=0;for(n in r)r[n]&&t[n]&&(o+=r[n]*t[n]);return o},numeric.sdot=function(r,t){var n=numeric.sdim(r).length,o=numeric.sdim(t).length,e=1e3*n+o;switch(e){case 0:return r*t;case 1001:return numeric.sdotVV(r,t);case 2001:return numeric.sdotMV(r,t);case 1002:return numeric.sdotVM(r,t);case 2002:return numeric.sdotMM(r,t);default:throw new Error("numeric.sdot not implemented for tensors of order "+n+" and "+o)}},numeric.sscatter=function(r){var t,n,o,e,i=r[0].length,s=r.length,a=[];for(n=i-1;n>=0;--n)if(r[s-1][n]){for(e=a,o=0;s-2>o;o++)t=r[o][n],e[t]||(e[t]=[]),e=e[t];e[r[o][n]]=r[o+1][n]}return a},numeric.sgather=function h(r,t,n){"undefined"==typeof t&&(t=[]),"undefined"==typeof n&&(n=[]);var o,e,i;o=n.length;for(e in r)if(r.hasOwnProperty(e))if(n[o]=parseInt(e),i=r[e],"number"==typeof i){if(i){if(0===t.length)for(e=o+1;e>=0;--e)t[e]=[];for(e=o;e>=0;--e)t[e].push(n[e]);t[o+1].push(i)}}else h(i,t,n);return n.length>o&&n.pop(),t},numeric.cLU=function(r){var t,n,o,e,i,s,a=r[0],u=r[1],f=r[2],h=a.length,c=0;for(t=0;h>t;t++)a[t]>c&&(c=a[t]);c++;var l,m,p,w=Array(c),v=Array(c),g=numeric.rep([c],1/0),y=numeric.rep([c],-(1/0));for(o=0;h>o;o++)t=a[o],n=u[o],n<g[t]&&(g[t]=n),n>y[t]&&(y[t]=n);for(t=0;c-1>t;t++)y[t]>y[t+1]&&(y[t+1]=y[t]);for(t=c-1;t>=1;t--)g[t]<g[t-1]&&(g[t-1]=g[t]);var d=0,b=0;for(t=0;c>t;t++)v[t]=numeric.rep([y[t]-g[t]+1],0),w[t]=numeric.rep([t-g[t]],0),d+=t-g[t]+1,b+=y[t]-t+1;for(o=0;h>o;o++)t=a[o],v[t][u[o]-g[t]]=f[o];for(t=0;c-1>t;t++)for(e=t-g[t],l=v[t],n=t+1;g[n]<=t&&c>n;n++)if(i=t-g[n],s=y[t]-t,m=v[n],p=m[i]/l[e]){for(o=1;s>=o;o++)m[o+i]-=p*l[o+e];w[n][t-g[n]]=p}var h,x,M,l=[],m=[],k=[],R=[],A=[],j=[];for(h=0,x=0,t=0;c>t;t++){for(e=g[t],i=y[t],M=v[t],n=t;i>=n;n++)M[n-e]&&(l[h]=t,m[h]=n,k[h]=M[n-e],h++);for(M=w[t],n=e;t>n;n++)M[n-e]&&(R[x]=t,A[x]=n,j[x]=M[n-e],x++);R[x]=t,A[x]=t,j[x]=1,x++}return{U:[l,m,k],L:[R,A,j]}},numeric.cLUsolve=function(r,t){var n,o,e=r.L,i=r.U,s=numeric.clone(t),a=e[0],u=e[1],f=e[2],h=i[0],c=i[1],l=i[2],m=h.length,p=(a.length,s.length);for(o=0,n=0;p>n;n++){for(;u[o]<n;)s[n]-=f[o]*s[u[o]],o++;o++}for(o=m-1,n=p-1;n>=0;n--){for(;c[o]>n;)s[n]-=l[o]*s[c[o]],o--;s[n]/=l[o],o--}return s},numeric.cgrid=function(r,t){"number"==typeof r&&(r=[r,r]);var n,o,e,i=numeric.rep(r,-1);if("function"!=typeof t)switch(t){case"L":t=function(t,n){return t>=r[0]/2||n<r[1]/2};break;default:t=function(r,t){return!0}}for(e=0,n=1;n<r[0]-1;n++)for(o=1;o<r[1]-1;o++)t(n,o)&&(i[n][o]=e,e++);return i},numeric.cdelsq=function(r){var t,n,o,e,i,s=[[-1,0],[0,-1],[0,1],[1,0]],a=numeric.dim(r),u=a[0],f=a[1],h=[],c=[],l=[];for(t=1;u-1>t;t++)for(n=1;f-1>n;n++)if(!(r[t][n]<0)){for(o=0;4>o;o++)e=t+s[o][0],i=n+s[o][1],r[e][i]<0||(h.push(r[t][n]),c.push(r[e][i]),l.push(-1));h.push(r[t][n]),c.push(r[t][n]),l.push(4)}return[h,c,l]},numeric.cdotMV=function(r,t){var n,o,e,i=r[0],s=r[1],a=r[2],u=i.length;for(e=0,o=0;u>o;o++)i[o]>e&&(e=i[o]);for(e++,n=numeric.rep([e],0),o=0;u>o;o++)n[i[o]]+=a[o]*t[s[o]];return n},numeric.Spline=function(r,t,n,o,e){this.x=r,this.yl=t,this.yr=n,this.kl=o,this.kr=e},numeric.Spline.prototype._at=function(r,t){var r,n,o,e,i=this.x,s=this.yl,a=this.yr,u=this.kl,f=this.kr,h=numeric.add,c=numeric.sub,l=numeric.mul;n=c(l(u[t],i[t+1]-i[t]),c(a[t+1],s[t])),o=h(l(f[t+1],i[t]-i[t+1]),c(a[t+1],s[t])),e=(r-i[t])/(i[t+1]-i[t]);var m=e*(1-e);return h(h(h(l(1-e,s[t]),l(e,a[t+1])),l(n,m*(1-e))),l(o,m*e))},numeric.Spline.prototype.at=function(r){if("number"==typeof r){var t,n,o,e=this.x,i=e.length,s=Math.floor;for(t=0,n=i-1;n-t>1;)o=s((t+n)/2),e[o]<=r?t=o:n=o;return this._at(r,t)}var a,i=r.length,u=Array(i);for(a=i-1;-1!==a;--a)u[a]=this.at(r[a]);return u},numeric.Spline.prototype.diff=function(){var r,t,n,o=this.x,e=this.yl,i=this.yr,s=this.kl,a=this.kr,u=e.length,f=s,h=a,c=Array(u),l=Array(u),m=numeric.add,p=numeric.mul,w=numeric.div,v=numeric.sub;for(r=u-1;-1!==r;--r)t=o[r+1]-o[r],n=v(i[r+1],e[r]),c[r]=w(m(p(n,6),p(s[r],-4*t),p(a[r+1],-2*t)),t*t),l[r+1]=w(m(p(n,-6),p(s[r],2*t),p(a[r+1],4*t)),t*t);return new numeric.Spline(o,f,h,c,l)},numeric.Spline.prototype.roots=function(){function r(r){return r*r}var t=[],n=this.x,o=this.yl,e=this.yr,i=this.kl,s=this.kr;"number"==typeof o[0]&&(o=[o],e=[e],i=[i],s=[s]);var a,u,f,h,c,l,m,p,w,v,g,y,d,b,x,M,k,R,A,j,S,V,E,C,D=o.length,I=n.length-1,t=Array(D),O=Math.sqrt;for(a=0;a!==D;++a){for(h=o[a],c=e[a],l=i[a],m=s[a],p=[],u=0;u!==I;u++){for(u>0&&c[u]*h[u]<0&&p.push(n[u]),M=n[u+1]-n[u],k=n[u],g=h[u],y=c[u+1],w=l[u]/M,v=m[u+1]/M,x=r(w-v+3*(g-y))+12*v*g,d=v+3*g+2*w-3*y,b=3*(v+w+2*(g-y)),0>=x?(A=d/b,R=A>n[u]&&A<n[u+1]?[n[u],A,n[u+1]]:[n[u],n[u+1]]):(A=(d-O(x))/b,j=(d+O(x))/b,R=[n[u]],A>n[u]&&A<n[u+1]&&R.push(A),j>n[u]&&j<n[u+1]&&R.push(j),R.push(n[u+1])),V=R[0],A=this._at(V,u),f=0;f<R.length-1;f++)if(E=R[f+1],j=this._at(E,u),0!==A)if(0===j||A*j>0)V=E,A=j;else{for(var q=0;;){if(C=(A*E-j*V)/(A-j),V>=C||C>=E)break;if(S=this._at(C,u),S*j>0)E=C,j=S,-1===q&&(A*=.5),q=-1;else{if(!(S*A>0))break;V=C,A=S,1===q&&(j*=.5),q=1}}p.push(C),V=R[f+1],A=this._at(V,u)}else p.push(V),V=E,A=j;0===j&&p.push(E)}t[a]=p}return"number"==typeof this.yl[0]?t[0]:t},numeric.spline=function(r,t,n,o){var e,i=r.length,s=[],a=[],u=[],f=numeric.sub,h=numeric.mul,c=numeric.add;for(e=i-2;e>=0;e--)a[e]=r[e+1]-r[e],u[e]=f(t[e+1],t[e]);("string"==typeof n||"string"==typeof o)&&(n=o="periodic");var l=[[],[],[]];switch(typeof n){case"undefined":s[0]=h(3/(a[0]*a[0]),u[0]),l[0].push(0,0),l[1].push(0,1),l[2].push(2/a[0],1/a[0]);break;case"string":s[0]=c(h(3/(a[i-2]*a[i-2]),u[i-2]),h(3/(a[0]*a[0]),u[0])),l[0].push(0,0,0),l[1].push(i-2,0,1),l[2].push(1/a[i-2],2/a[i-2]+2/a[0],1/a[0]);break;default:s[0]=n,l[0].push(0),l[1].push(0),l[2].push(1)}for(e=1;i-1>e;e++)s[e]=c(h(3/(a[e-1]*a[e-1]),u[e-1]),h(3/(a[e]*a[e]),u[e])),l[0].push(e,e,e),l[1].push(e-1,e,e+1),l[2].push(1/a[e-1],2/a[e-1]+2/a[e],1/a[e]);switch(typeof o){case"undefined":s[i-1]=h(3/(a[i-2]*a[i-2]),u[i-2]),l[0].push(i-1,i-1),l[1].push(i-2,i-1),l[2].push(1/a[i-2],2/a[i-2]);break;case"string":l[1][l[1].length-1]=0;break;default:s[i-1]=o,l[0].push(i-1),l[1].push(i-1),l[2].push(1)}s="number"!=typeof s[0]?numeric.transpose(s):[s];var m=Array(s.length);if("string"==typeof n)for(e=m.length-1;-1!==e;--e)m[e]=numeric.ccsLUPSolve(numeric.ccsLUP(numeric.ccsScatter(l)),s[e]),m[e][i-1]=m[e][0];else for(e=m.length-1;-1!==e;--e)m[e]=numeric.cLUsolve(numeric.cLU(l),s[e]);return m="number"==typeof t[0]?m[0]:numeric.transpose(m),new numeric.Spline(r,t,t,m,m)},numeric.fftpow2=function c(r,t){var n=r.length;if(1!==n){var o,e,i=Math.cos,s=Math.sin,a=Array(n/2),u=Array(n/2),f=Array(n/2),h=Array(n/2);for(e=n/2,o=n-1;-1!==o;--o)--e,f[e]=r[o],h[e]=t[o],--o,a[e]=r[o],u[e]=t[o];c(a,u),c(f,h),e=n/2;var l,m,p,w=-6.283185307179586/n;for(o=n-1;-1!==o;--o)--e,-1===e&&(e=n/2-1),l=w*o,m=i(l),p=s(l),r[o]=a[e]+m*f[e]-p*h[e],t[o]=u[e]+m*h[e]+p*f[e]}},numeric._ifftpow2=function l(r,t){var n=r.length;if(1!==n){var o,e,i=Math.cos,s=Math.sin,a=Array(n/2),u=Array(n/2),f=Array(n/2),h=Array(n/2);for(e=n/2,o=n-1;-1!==o;--o)--e,f[e]=r[o],h[e]=t[o],--o,a[e]=r[o],u[e]=t[o];l(a,u),l(f,h),e=n/2;var c,m,p,w=6.283185307179586/n;for(o=n-1;-1!==o;--o)--e,-1===e&&(e=n/2-1),c=w*o,m=i(c),p=s(c),r[o]=a[e]+m*f[e]-p*h[e],t[o]=u[e]+m*h[e]+p*f[e]}},numeric.ifftpow2=function(r,t){numeric._ifftpow2(r,t),numeric.diveq(r,r.length),numeric.diveq(t,t.length)},numeric.convpow2=function(r,t,n,o){numeric.fftpow2(r,t),numeric.fftpow2(n,o);var e,i,s,a,u,f=r.length;for(e=f-1;-1!==e;--e)i=r[e],a=t[e],s=n[e],u=o[e],r[e]=i*s-a*u,t[e]=i*u+a*s;numeric.ifftpow2(r,t)},numeric.T.prototype.fft=function(){var r,t,n=this.x,o=this.y,e=n.length,i=Math.log,s=i(2),a=Math.ceil(i(2*e-1)/s),u=Math.pow(2,a),f=numeric.rep([u],0),h=numeric.rep([u],0),c=Math.cos,l=Math.sin,m=-3.141592653589793/e,p=numeric.rep([u],0),w=numeric.rep([u],0);Math.floor(e/2);for(r=0;e>r;r++)p[r]=n[r];if("undefined"!=typeof o)for(r=0;e>r;r++)w[r]=o[r];for(f[0]=1,r=1;u/2>=r;r++)t=m*r*r,f[r]=c(t),h[r]=l(t),f[u-r]=c(t),h[u-r]=l(t);var v=new numeric.T(p,w),g=new numeric.T(f,h);return v=v.mul(g),numeric.convpow2(v.x,v.y,numeric.clone(g.x),numeric.neg(g.y)),v=v.mul(g),v.x.length=e,v.y.length=e,v},numeric.T.prototype.ifft=function(){var r,t,n=this.x,o=this.y,e=n.length,i=Math.log,s=i(2),a=Math.ceil(i(2*e-1)/s),u=Math.pow(2,a),f=numeric.rep([u],0),h=numeric.rep([u],0),c=Math.cos,l=Math.sin,m=3.141592653589793/e,p=numeric.rep([u],0),w=numeric.rep([u],0);Math.floor(e/2);for(r=0;e>r;r++)p[r]=n[r];if("undefined"!=typeof o)for(r=0;e>r;r++)w[r]=o[r];for(f[0]=1,r=1;u/2>=r;r++)t=m*r*r,f[r]=c(t),h[r]=l(t),f[u-r]=c(t),h[u-r]=l(t);var v=new numeric.T(p,w),g=new numeric.T(f,h);return v=v.mul(g),numeric.convpow2(v.x,v.y,numeric.clone(g.x),numeric.neg(g.y)),v=v.mul(g),v.x.length=e,v.y.length=e,v.div(e)},numeric.gradient=function(r,t){var n=t.length,o=r(t);if(isNaN(o))throw new Error("gradient: f(x) is a NaN!");var e,i,s,a,u,f,h,c,l,m,p=Math.max,w=numeric.clone(t),v=Array(n),p=(numeric.div,numeric.sub,Math.max),g=.001,y=Math.abs,d=Math.min,b=0;for(e=0;n>e;e++)for(var x=p(1e-6*o,1e-8);;){if(++b,b>20)throw new Error("Numerical gradient fails");if(w[e]=t[e]+x,i=r(w),w[e]=t[e]-x,s=r(w),w[e]=t[e],isNaN(i)||isNaN(s))x/=16;else{if(v[e]=(i-s)/(2*x),u=t[e]-x,f=t[e],h=t[e]+x,c=(i-o)/x,l=(o-s)/x,m=p(y(v[e]),y(o),y(i),y(s),y(u),y(f),y(h),1e-8),a=d(p(y(c-v[e]),y(l-v[e]),y(c-l))/m,x/m),!(a>g))break;x/=16}}return v},numeric.uncmin=function(r,t,n,o,e,i,s){var a=numeric.gradient;"undefined"==typeof s&&(s={}),"undefined"==typeof n&&(n=1e-8),"undefined"==typeof o&&(o=function(t){return a(r,t)}),"undefined"==typeof e&&(e=1e3),t=numeric.clone(t);var u,f,h=t.length,c=r(t);if(isNaN(c))throw new Error("uncmin: f(x0) is a NaN!");var l=Math.max,m=numeric.norm2;n=l(n,numeric.epsilon);var p,w,v,g,y,d,b,x,M,k,R=s.Hinv||numeric.identity(h),A=numeric.dot,j=(numeric.inv,numeric.sub),S=numeric.add,V=numeric.tensor,E=numeric.div,C=numeric.mul,D=numeric.all,I=numeric.isFinite,O=numeric.neg,q=0,z="";for(w=o(t);e>q;){if("function"==typeof i&&i(q,t,c,w,R)){z="Callback returned true";break}if(!D(I(w))){z="Gradient has Infinity or NaN";break}if(p=O(A(R,w)),!D(I(p))){z="Search direction has Infinity or NaN";break}if(k=m(p),n>k){z="Newton step smaller than tol";break}for(M=1,f=A(w,p),y=t;e>q&&!(n>M*k)&&(g=C(p,M),y=S(t,g),u=r(y),u-c>=.1*M*f||isNaN(u));)M*=.5,++q;if(n>M*k){z="Line search step size smaller than tol";break}if(q===e){z="maxit reached during line search";break}v=o(y),d=j(v,w),x=A(d,g),b=A(R,d),R=j(S(R,C((x+A(d,b))/(x*x),V(g,g))),E(S(V(b,g),V(g,b)),x)),t=y,c=u,w=v,++q}return{solution:t,f:c,gradient:w,invHessian:R,iterations:q,message:z}},numeric.Dopri=function(r,t,n,o,e,i,s){this.x=r,this.y=t,this.f=n,this.ymid=o,this.iterations=e,this.events=s,this.message=i},numeric.Dopri.prototype._at=function(r,t){function n(r){return r*r}var o,e,i,s,a,u,r,f,h,c,l,m=this,p=m.x,w=m.y,v=m.f,g=m.ymid,y=(p.length,Math.floor,.5),d=numeric.add,b=numeric.mul,x=numeric.sub;return o=p[t],e=p[t+1],s=w[t],a=w[t+1],f=e-o,i=o+y*f,u=g[t],h=x(v[t],b(s,1/(o-i)+2/(o-e))),c=x(v[t+1],b(a,1/(e-i)+2/(e-o))),l=[n(r-e)*(r-i)/n(o-e)/(o-i),n(r-o)*n(r-e)/n(o-i)/n(e-i),n(r-o)*(r-i)/n(e-o)/(e-i),(r-o)*n(r-e)*(r-i)/n(o-e)/(o-i),(r-e)*n(r-o)*(r-i)/n(o-e)/(e-i)],d(d(d(d(b(s,l[0]),b(u,l[1])),b(a,l[2])),b(h,l[3])),b(c,l[4]))},numeric.Dopri.prototype.at=function(r){var t,n,o,e=Math.floor;if("number"!=typeof r){var i=r.length,s=Array(i);for(t=i-1;-1!==t;--t)s[t]=this.at(r[t]);return s}var a=this.x;for(t=0,n=a.length-1;n-t>1;)o=e(.5*(t+n)),a[o]<=r?t=o:n=o;return this._at(r,t)},numeric.dopri=function(r,t,n,o,e,i,s){"undefined"==typeof e&&(e=1e-6),"undefined"==typeof i&&(i=1e3);var a,u,f,h,c,l,m,p,w,v,g,y,d,b=[r],x=[n],M=[o(r,n)],k=[],R=.2,A=[.075,.225],j=[44/45,-56/15,32/9],S=[19372/6561,-25360/2187,64448/6561,-212/729],V=[9017/3168,-355/33,46732/5247,49/176,-5103/18656],E=[35/384,0,500/1113,125/192,-2187/6784,11/84],C=[.10013431883002395,0,.3918321794184259,-0.02982460176594817,.05893268337240795,-0.04497888809104361,.023904308236133973],D=[.2,.3,.8,8/9,1,1],I=[-71/57600,0,71/16695,-71/1920,17253/339200,-22/525,.025],O=0,q=(t-r)/10,z=0,T=numeric.add,U=numeric.mul,L=(Math.max,Math.min),_=Math.abs,N=numeric.norminf,P=Math.pow,F=numeric.any,Q=numeric.lt,B=numeric.and,X=(numeric.sub,new numeric.Dopri(b,x,M,k,-1,""));for("function"==typeof s&&(g=s(r,n));t>r&&i>z;)if(++z,r+q>t&&(q=t-r),a=o(r+D[0]*q,T(n,U(R*q,M[O]))),u=o(r+D[1]*q,T(T(n,U(A[0]*q,M[O])),U(A[1]*q,a))),f=o(r+D[2]*q,T(T(T(n,U(j[0]*q,M[O])),U(j[1]*q,a)),U(j[2]*q,u))),h=o(r+D[3]*q,T(T(T(T(n,U(S[0]*q,M[O])),U(S[1]*q,a)),U(S[2]*q,u)),U(S[3]*q,f))),c=o(r+D[4]*q,T(T(T(T(T(n,U(V[0]*q,M[O])),U(V[1]*q,a)),U(V[2]*q,u)),U(V[3]*q,f)),U(V[4]*q,h))),w=T(T(T(T(T(n,U(M[O],q*E[0])),U(u,q*E[2])),U(f,q*E[3])),U(h,q*E[4])),U(c,q*E[5])),l=o(r+q,w),m=T(T(T(T(T(U(M[O],q*I[0]),U(u,q*I[2])),U(f,q*I[3])),U(h,q*I[4])),U(c,q*I[5])),U(l,q*I[6])),v="number"==typeof m?_(m):N(m),v>e){if(q=.2*q*P(e/v,.25),r+q===r){X.msg="Step size became too small";break}}else{if(k[O]=T(T(T(T(T(T(n,U(M[O],q*C[0])),U(u,q*C[2])),U(f,q*C[3])),U(h,q*C[4])),U(c,q*C[5])),U(l,q*C[6])),++O,b[O]=r+q,x[O]=w,M[O]=l,"function"==typeof s){var W,H,Y=r,Z=r+.5*q;if(y=s(Z,k[O-1]),d=B(Q(g,0),Q(0,y)),F(d)||(Y=Z,Z=r+q,g=y,y=s(Z,w),d=B(Q(g,0),Q(0,y))),F(d)){for(var G,J,$=0,K=1,rr=1;;){if("number"==typeof g)H=(rr*y*Y-K*g*Z)/(rr*y-K*g);else for(H=Z,p=g.length-1;-1!==p;--p)g[p]<0&&y[p]>0&&(H=L(H,(rr*y[p]*Y-K*g[p]*Z)/(rr*y[p]-K*g[p])));if(Y>=H||H>=Z)break;W=X._at(H,O-1),J=s(H,W),G=B(Q(g,0),Q(0,J)),F(G)?(Z=H,y=J,d=G,rr=1,-1===$?K*=.5:K=1,$=-1):(Y=H,g=J,K=1,1===$?rr*=.5:rr=1,$=1)}return w=X._at(.5*(r+H),O-1),X.f[O]=o(H,W),X.x[O]=H,X.y[O]=W,X.ymid[O-1]=w,X.events=d,X.iterations=z,X}}r+=q,n=w,g=y,q=L(.8*q*P(e/v,.25),4*q)}return X.iterations=z,X},numeric.LU=function(r,t){t=t||!1;var n,o,e,i,s,a,u,f,h,c=Math.abs,l=r.length,m=l-1,p=new Array(l);for(t||(r=numeric.clone(r)),e=0;l>e;++e){for(u=e,a=r[e],h=c(a[e]),o=e+1;l>o;++o)i=c(r[o][e]),i>h&&(h=i,u=o);for(p[e]=u,u!=e&&(r[e]=r[u],r[u]=a,a=r[e]),s=a[e],n=e+1;l>n;++n)r[n][e]/=s;for(n=e+1;l>n;++n){for(f=r[n],o=e+1;m>o;++o)f[o]-=f[e]*a[o],++o,f[o]-=f[e]*a[o];o===m&&(f[o]-=f[e]*a[o])}}return{LU:r,P:p}},numeric.LUsolve=function(r,t){var n,o,e,i,s,a=r.LU,u=a.length,f=numeric.clone(t),h=r.P;for(n=u-1;-1!==n;--n)f[n]=t[n];for(n=0;u>n;++n)for(e=h[n],h[n]!==n&&(s=f[n],f[n]=f[e],f[e]=s),i=a[n],o=0;n>o;++o)f[n]-=f[o]*i[o];for(n=u-1;n>=0;--n){for(i=a[n],o=n+1;u>o;++o)f[n]-=f[o]*i[o];f[n]/=i[n]}return f},numeric.solve=function(r,t,n){return numeric.LUsolve(numeric.LU(r,n),t)},numeric.echelonize=function(r){var t,n,o,e,i,s,a,u,f=numeric.dim(r),h=f[0],c=f[1],l=numeric.identity(h),m=Array(h),p=Math.abs,w=numeric.diveq;for(r=numeric.clone(r),t=0;h>t;++t){for(o=0,i=r[t],s=l[t],n=1;c>n;++n)p(i[o])<p(i[n])&&(o=n);for(m[t]=o,w(s,i[o]),w(i,i[o]),n=0;h>n;++n)if(n!==t){for(a=r[n],u=a[o],e=c-1;-1!==e;--e)a[e]-=i[e]*u;for(a=l[n],e=h-1;-1!==e;--e)a[e]-=s[e]*u}}return{I:l,A:r,P:m}},numeric.__solveLP=function(r,t,n,o,e,i,s){var a,u,f,h,c=numeric.sum,l=(numeric.log,numeric.mul),m=numeric.sub,p=numeric.dot,w=numeric.div,v=numeric.add,g=r.length,y=n.length,d=!1,b=0,x=1,M=(numeric.transpose(t),numeric.svd,numeric.transpose),k=(numeric.leq,Math.sqrt),R=Math.abs,A=(numeric.muleq,numeric.norminf,numeric.any,Math.min),j=numeric.all,S=numeric.gt,V=Array(g),E=Array(y),C=(numeric.rep([y],1),numeric.solve),D=m(n,p(t,i)),I=p(r,r);for(f=b;e>f;++f){var O,q;for(O=y-1;-1!==O;--O)E[O]=w(t[O],D[O]);var z=M(E);for(O=g-1;-1!==O;--O)V[O]=c(z[O]);x=.25*R(I/p(r,V));var T=100*k(I/p(V,V));for((!isFinite(x)||x>T)&&(x=T),h=v(r,l(x,V)),u=p(z,E),O=g-1;-1!==O;--O)u[O][O]+=1;q=C(u,w(h,x),!0);var U=w(D,p(t,q)),L=1;for(O=y-1;-1!==O;--O)U[O]<0&&(L=A(L,-.999*U[O]));if(a=m(i,l(q,L)),D=m(n,p(t,a)),!j(S(D,0)))return{solution:i,message:"",iterations:f};if(i=a,o>x)return{solution:a,message:"",iterations:f};if(s){var _=p(r,h),N=p(t,h);for(d=!0,O=y-1;-1!==O;--O)if(_*N[O]<0){d=!1;break}}else d=i[g-1]>=0?!1:!0;if(d)return{solution:a,message:"Unbounded",iterations:f}}return{solution:i,message:"maximum iteration count exceeded",iterations:f}},numeric._solveLP=function(r,t,n,o,e){var i,s=r.length,a=n.length,u=(numeric.sum,numeric.log,numeric.mul,numeric.sub),f=numeric.dot,h=(numeric.div,numeric.add,numeric.rep([s],0).concat([1])),c=numeric.rep([a,1],-1),l=numeric.blockMatrix([[t,c]]),m=n,i=numeric.rep([s],0).concat(Math.max(0,numeric.sup(numeric.neg(n)))+1),p=numeric.__solveLP(h,l,m,o,e,i,!1),w=numeric.clone(p.solution);w.length=s;var v=numeric.inf(u(n,f(t,w)));if(0>v)return{solution:NaN,message:"Infeasible",iterations:p.iterations};var g=numeric.__solveLP(r,t,n,o,e-p.iterations,w,!0);return g.iterations+=p.iterations,g},numeric.solveLP=function(r,t,n,o,e,i,s){if("undefined"==typeof s&&(s=1e3),"undefined"==typeof i&&(i=numeric.epsilon),"undefined"==typeof o)return numeric._solveLP(r,t,n,i,s);var a,u=o.length,f=o[0].length,h=t.length,c=numeric.echelonize(o),l=numeric.rep([f],0),m=c.P,p=[];for(a=m.length-1;-1!==a;--a)l[m[a]]=1;for(a=f-1;-1!==a;--a)0===l[a]&&p.push(a);var w=numeric.getRange,v=numeric.linspace(0,u-1),g=numeric.linspace(0,h-1),y=w(o,v,p),d=w(t,g,m),b=w(t,g,p),x=numeric.dot,M=numeric.sub,k=x(d,c.I),R=M(b,x(k,y)),A=M(n,x(k,e)),j=Array(m.length),S=Array(p.length);for(a=m.length-1;-1!==a;--a)j[a]=r[m[a]];for(a=p.length-1;-1!==a;--a)S[a]=r[p[a]];var V=M(S,x(j,x(c.I,y))),E=numeric._solveLP(V,R,A,i,s),C=E.solution;if(C!==C)return E;var D=x(c.I,M(e,x(y,C))),I=Array(r.length);for(a=m.length-1;-1!==a;--a)I[m[a]]=D[a];for(a=p.length-1;-1!==a;--a)I[p[a]]=C[a];return{solution:I,message:E.message,iterations:E.iterations}},numeric.MPStoLP=function(r){function t(t){throw new Error("MPStoLP: "+t+"\nLine "+n+": "+r[n]+"\nCurrent state: "+a[s]+"\n")}r instanceof String&&r.split("\n");var n,o,e,i,s=0,a=["Initial state","NAME","ROWS","COLUMNS","RHS","BOUNDS","ENDATA"],u=r.length,f=0,h={},c=[],l=0,m={},p=0,w=[],v=[],g=[];for(n=0;u>n;++n){e=r[n];var y=e.match(/\S*/g),d=[];for(o=0;o<y.length;++o)""!==y[o]&&d.push(y[o]);if(0!==d.length){for(o=0;o<a.length&&e.substr(0,a[o].length)!==a[o];++o);if(o<a.length){if(s=o,1===o&&(i=d[1]),6===o)return{name:i,c:w,A:numeric.transpose(v),b:g,rows:h,vars:m}}else switch(s){case 0:case 1:t("Unexpected line");case 2:switch(d[0]){case"N":0===f?f=d[1]:t("Two or more N rows");break;case"L":h[d[1]]=l,c[l]=1,g[l]=0,++l;break;case"G":h[d[1]]=l,c[l]=-1,g[l]=0,++l;break;case"E":h[d[1]]=l,c[l]=0,g[l]=0,++l;break;default:t("Parse error "+numeric.prettyPrint(d))}break;case 3:m.hasOwnProperty(d[0])||(m[d[0]]=p,w[p]=0,v[p]=numeric.rep([l],0),++p);var b=m[d[0]];for(o=1;o<d.length;o+=2)if(d[o]!==f){var x=h[d[o]];v[b][x]=(c[x]<0?-1:1)*parseFloat(d[o+1])}else w[b]=parseFloat(d[o+1]);break;case 4:for(o=1;o<d.length;o+=2)g[h[d[o]]]=(c[h[d[o]]]<0?-1:1)*parseFloat(d[o+1]);break;case 5:break;case 6:t("Internal error")}}}t("Reached end of file without ENDATA")},numeric.seedrandom={pow:Math.pow,random:Math.random},function(r,t,n,o,e,i,s){function a(r){var t,o,e=this,i=r.length,s=0,a=e.i=e.j=e.m=0;for(e.S=[],e.c=[],i||(r=[i++]);n>s;)e.S[s]=s++;for(s=0;n>s;s++)t=e.S[s],a=h(a+t+r[s%i]),o=e.S[a],e.S[s]=o,e.S[a]=t;e.g=function(r){var t=e.S,o=h(e.i+1),i=t[o],s=h(e.j+i),a=t[s];t[o]=a,t[s]=i;for(var u=t[h(i+a)];--r;)o=h(o+1),i=t[o],s=h(s+i),a=t[s],t[o]=a,t[s]=i,u=u*n+t[h(i+a)];return e.i=o,e.j=s,u},e.g(n)}function u(r,t,n,o,e){if(n=[],e=typeof r,t&&"object"==e)for(o in r)if(o.indexOf("S")<5)try{n.push(u(r[o],t-1))}catch(i){}return n.length?n:r+("string"!=e?"\x00":"")}function f(r,t,n,o){for(r+="",n=0,o=0;o<r.length;o++)t[h(o)]=h((n^=19*t[h(o)])+r.charCodeAt(o));r="";for(o in t)r+=String.fromCharCode(t[o]);return r}function h(r){return r&n-1}t.seedrandom=function(h,c){var l,m=[];return h=f(u(c?[h,r]:arguments.length?h:[(new Date).getTime(),r,window],3),m),l=new a(m),f(l.S,r),t.random=function(){for(var r=l.g(o),t=s,a=0;e>r;)r=(r+a)*n,t*=n,a=l.g(1);for(;r>=i;)r/=2,t/=2,a>>>=1;return(r+a)/t},h},s=t.pow(n,o),e=t.pow(2,e),i=2*e,f(t.random(),r)}([],numeric.seedrandom,256,6,52),function(r){function t(r){if("object"!=typeof r)return r;var n,o=[],e=r.length;for(n=0;e>n;n++)o[n+1]=t(r[n]);return o}function n(r){if("object"!=typeof r)return r;var t,o=[],e=r.length;for(t=1;e>t;t++)o[t-1]=n(r[t]);return o}function o(r,t,n){var o,e,i,s,a;for(i=1;n>=i;i+=1){for(r[i][i]=1/r[i][i],a=-r[i][i],o=1;i>o;o+=1)r[o][i]=a*r[o][i];if(s=i+1,s>n)break;for(e=s;n>=e;e+=1)for(a=r[i][e],r[i][e]=0,o=1;i>=o;o+=1)r[o][e]=r[o][e]+a*r[o][i]}}function e(r,t,n,o){var e,i,s,a;for(i=1;n>=i;i+=1){for(a=0,e=1;i>e;e+=1)a+=r[e][i]*o[e];o[i]=(o[i]-a)/r[i][i]}for(s=1;n>=s;s+=1)for(i=n+1-s,o[i]=o[i]/r[i][i],a=-o[i],e=1;i>e;e+=1)o[e]=o[e]+a*r[e][i]}function i(r,t,n,o){var e,i,s,a,u,f;for(i=1;n>=i;i+=1){if(o[1]=i,f=0,s=i-1,1>s){if(f=r[i][i]-f,0>=f)break;r[i][i]=Math.sqrt(f)}else{for(a=1;s>=a;a+=1){for(u=r[a][i],e=1;a>e;e+=1)u-=r[e][i]*r[e][a];u/=r[a][a],r[a][i]=u,f+=u*u}if(f=r[i][i]-f,0>=f)break;r[i][i]=Math.sqrt(f)}o[1]=0}}function s(r,t,n,s,a,u,f,h,c,l,m,p,w,v,g,y){function d(){for(v[1]=v[1]+1,j=O,R=1;l>=R;R+=1){for(j+=1,_=-h[R],A=1;s>=A;A+=1)_+=f[A][R]*a[A];if(Math.abs(_)<H&&(_=0),R>m)g[j]=_;else if(g[j]=-Math.abs(_),_>0){for(A=1;s>=A;A+=1)f[A][R]=-f[A][R];h[R]=-h[R]}}for(R=1;w>=R;R+=1)g[O+p[R]]=0;for(z=0,L=0,R=1;l>=R;R+=1)g[O+R]<L*g[U+R]&&(z=R,L=g[O+R]/g[U+R]);return 0===z?999:0}function b(){for(R=1;s>=R;R+=1){for(_=0,A=1;s>=A;A+=1)_+=r[A][R]*f[A][z];g[R]=_}for(S=C,R=1;s>=R;R+=1)g[S+R]=0;for(A=w+1;s>=A;A+=1)for(R=1;s>=R;R+=1)g[S+R]=g[S+R]+r[R][A]*g[A];for(X=!0,R=w;R>=1;R-=1){for(_=g[R],j=I+R*(R+3)/2,S=j-R,A=R+1;w>=A;A+=1)_-=g[j]*g[D+A],j+=A;if(_/=g[S],g[D+R]=_,p[R]<m)break;if(0>_)break;X=!1,E=R}if(!X)for(N=g[q+E]/g[D+E],R=1;w>=R&&!(p[R]<m)&&!(g[D+R]<0);R+=1)L=g[q+R]/g[D+R],N>L&&(N=L,E=R);for(_=0,R=C+1;C+s>=R;R+=1)_+=g[R]*g[R];if(Math.abs(_)<=H){if(X)return y[1]=1,999;for(R=1;w>=R;R+=1)g[q+R]=g[q+R]-N*g[D+R];return g[q+w+1]=g[q+w+1]+N,700}for(_=0,R=1;s>=R;R+=1)_+=g[C+R]*f[R][z];for(P=-g[O+z]/_,W=!0,X||P>N&&(P=N,W=!1),R=1;s>=R;R+=1)a[R]=a[R]+P*g[C+R],Math.abs(a[R])<H&&(a[R]=0);for(u[1]=u[1]+P*_*(P/2+g[q+w+1]),R=1;w>=R;R+=1)g[q+R]=g[q+R]-P*g[D+R];if(g[q+w+1]=g[q+w+1]+P,!W){for(_=-h[z],A=1;s>=A;A+=1)_+=a[A]*f[A][z];if(z>m)g[O+z]=_;else if(g[O+z]=-Math.abs(_),_>0){for(A=1;s>=A;A+=1)f[A][z]=-f[A][z];h[z]=-h[z]}return 700}for(w+=1,p[w]=z,j=I+(w-1)*w/2+1,R=1;w-1>=R;R+=1)g[j]=g[R],j+=1;if(w===s)g[j]=g[s];else{for(R=s;R>=w+1&&0!==g[R]&&(F=Math.max(Math.abs(g[R-1]),Math.abs(g[R])),Q=Math.min(Math.abs(g[R-1]),Math.abs(g[R])),L=g[R-1]>=0?Math.abs(F*Math.sqrt(1+Q*Q/(F*F))):-Math.abs(F*Math.sqrt(1+Q*Q/(F*F))),F=g[R-1]/L,Q=g[R]/L,1!==F);R-=1)if(0===F)for(g[R-1]=Q*L,A=1;s>=A;A+=1)L=r[A][R-1],r[A][R-1]=r[A][R],r[A][R]=L;else for(g[R-1]=L,B=Q/(1+F),A=1;s>=A;A+=1)L=F*r[A][R-1]+Q*r[A][R],r[A][R]=B*(r[A][R-1]+L)-r[A][R],r[A][R-1]=L;g[j]=g[w]}return 0}function x(){if(j=I+E*(E+1)/2+1,S=j+E,0===g[S])return 798;if(F=Math.max(Math.abs(g[S-1]),Math.abs(g[S])),Q=Math.min(Math.abs(g[S-1]),Math.abs(g[S])),L=g[S-1]>=0?Math.abs(F*Math.sqrt(1+Q*Q/(F*F))):-Math.abs(F*Math.sqrt(1+Q*Q/(F*F))),F=g[S-1]/L,Q=g[S]/L,1===F)return 798;if(0===F){for(R=E+1;w>=R;R+=1)L=g[S-1],g[S-1]=g[S],g[S]=L,S+=R;for(R=1;s>=R;R+=1)L=r[R][E],r[R][E]=r[R][E+1],r[R][E+1]=L}else{for(B=Q/(1+F),R=E+1;w>=R;R+=1)L=F*g[S-1]+Q*g[S],g[S]=B*(g[S-1]+L)-g[S],g[S-1]=L,S+=R;for(R=1;s>=R;R+=1)L=F*r[R][E]+Q*r[R][E+1],r[R][E+1]=B*(r[R][E]+L)-r[R][E+1],r[R][E]=L}return 0}function M(){for(S=j-E,R=1;E>=R;R+=1)g[S]=g[j],j+=1,S+=1;return g[q+E]=g[q+E+1],p[E]=p[E+1],E+=1,w>E?797:0}function k(){return g[q+w]=g[q+w+1],g[q+w+1]=0,p[w]=0,w-=1,v[2]=v[2]+1,0}var R,A,j,S,V,E,C,D,I,O,q,z,T,U,L,_,N,P,F,Q,B,X,W,H,Y,Z,G;T=Math.min(s,l),j=2*s+T*(T+5)/2+2*l+1,H=1e-60;do H+=H,Y=1+.1*H,Z=1+.2*H;while(1>=Y||1>=Z);for(R=1;s>=R;R+=1)g[R]=t[R];for(R=s+1;j>=R;R+=1)g[R]=0;for(R=1;l>=R;R+=1)p[R]=0;if(V=[],0===y[1]){if(i(r,n,s,V),0!==V[1])return void(y[1]=2);e(r,n,s,t),o(r,n,s)}else{for(A=1;s>=A;A+=1)for(a[A]=0,R=1;A>=R;R+=1)a[A]=a[A]+r[R][A]*t[R];for(A=1;s>=A;A+=1)for(t[A]=0,R=A;s>=R;R+=1)t[A]=t[A]+r[A][R]*a[R]}for(u[1]=0,A=1;s>=A;A+=1)for(a[A]=t[A],u[1]=u[1]+g[A]*a[A],g[A]=0,R=A+1;s>=R;R+=1)r[R][A]=0;for(u[1]=-u[1]/2,y[1]=0,C=s,D=C+s,q=D+T,I=q+T+1,O=I+T*(T+1)/2,U=O+l,R=1;l>=R;R+=1){for(_=0,A=1;s>=A;A+=1)_+=f[A][R]*f[A][R];g[U+R]=Math.sqrt(_)}for(w=0,v[1]=0,v[2]=0,G=0;;){if(G=d(),999===G)return;for(;;){if(G=b(),0===G)break;if(999===G)return;if(700===G)if(E===w)k();else{for(;;)if(x(),G=M(),797!==G)break;k()}}}}function a(r,o,e,i,a,u){r=t(r),o=t(o),e=t(e);var f,h,c,l,m,p,w=[],v=[],g=[],y=[],d=[];if(a=a||0,u=u?t(u):[void 0,0],i=i?t(i):[],h=r.length-1,c=e[1].length-1,!i)for(f=1;c>=f;f+=1)i[f]=0;for(f=1;c>=f;f+=1)v[f]=0;for(l=0,m=Math.min(h,c),f=1;h>=f;f+=1)g[f]=0;for(w[1]=0,f=1;2*h+m*(m+5)/2+2*c+1>=f;f+=1)y[f]=0;for(f=1;2>=f;f+=1)d[f]=0;return s(r,o,h,h,g,w,e,i,h,c,a,v,l,d,y,u),p="",1===u[1]&&(p="constraints are inconsistent, no solution!"),2===u[1]&&(p="matrix D in quadratic function is not positive definite!"),{solution:n(g),value:n(w),unconstrained_solution:n(o),iterations:n(d),iact:n(v),message:p}}r.solveQP=a}(numeric),numeric.svd=function(r){function t(r,t){return r=Math.abs(r),t=Math.abs(t),r>t?r*Math.sqrt(1+t*t/r/r):0==t?r:t*Math.sqrt(1+r*r/t/t)}var n,o=numeric.epsilon,e=1e-64/o,i=50,s=0,a=0,u=0,f=0,h=0,c=numeric.clone(r),l=c.length,m=c[0].length;if(m>l)throw"Need more rows than columns";var p=new Array(m),w=new Array(m);for(a=0;m>a;a++)p[a]=w[a]=0;var v=numeric.rep([m,m],0),g=0,y=0,d=0,b=0,x=0,M=0,k=0;for(a=0;m>a;a++){for(p[a]=y,k=0,h=a+1,u=a;l>u;u++)k+=c[u][a]*c[u][a];if(e>=k)y=0;else for(g=c[a][a],y=Math.sqrt(k),g>=0&&(y=-y),d=g*y-k,c[a][a]=g-y,u=h;m>u;u++){for(k=0,f=a;l>f;f++)k+=c[f][a]*c[f][u];for(g=k/d,f=a;l>f;f++)c[f][u]+=g*c[f][a]}for(w[a]=y,k=0,u=h;m>u;u++)k+=c[a][u]*c[a][u];if(e>=k)y=0;else{for(g=c[a][a+1],y=Math.sqrt(k),g>=0&&(y=-y),d=g*y-k,c[a][a+1]=g-y,u=h;m>u;u++)p[u]=c[a][u]/d;for(u=h;l>u;u++){for(k=0,f=h;m>f;f++)k+=c[u][f]*c[a][f];for(f=h;m>f;f++)c[u][f]+=k*p[f]}}x=Math.abs(w[a])+Math.abs(p[a]),x>b&&(b=x)}for(a=m-1;-1!=a;a+=-1){if(0!=y){for(d=y*c[a][a+1],u=h;m>u;u++)v[u][a]=c[a][u]/d;for(u=h;m>u;u++){for(k=0,f=h;m>f;f++)k+=c[a][f]*v[f][u];for(f=h;m>f;f++)v[f][u]+=k*v[f][a]}}for(u=h;m>u;u++)v[a][u]=0,v[u][a]=0;v[a][a]=1,y=p[a],h=a}for(a=m-1;-1!=a;a+=-1){for(h=a+1,y=w[a],u=h;m>u;u++)c[a][u]=0;if(0!=y){for(d=c[a][a]*y,u=h;m>u;u++){for(k=0,f=h;l>f;f++)k+=c[f][a]*c[f][u];for(g=k/d,f=a;l>f;f++)c[f][u]+=g*c[f][a]}for(u=a;l>u;u++)c[u][a]=c[u][a]/y}else for(u=a;l>u;u++)c[u][a]=0;c[a][a]+=1}for(o*=b,f=m-1;-1!=f;f+=-1)for(var R=0;i>R;R++){var A=!1;for(h=f;-1!=h;h+=-1){if(Math.abs(p[h])<=o){A=!0;break}if(Math.abs(w[h-1])<=o)break}if(!A){s=0,k=1;var j=h-1;for(a=h;f+1>a&&(g=k*p[a],p[a]=s*p[a],!(Math.abs(g)<=o));a++)for(y=w[a],d=t(g,y),w[a]=d,s=y/d,k=-g/d,u=0;l>u;u++)x=c[u][j],M=c[u][a],c[u][j]=x*s+M*k,c[u][a]=-x*k+M*s}if(M=w[f],h==f){if(0>M)for(w[f]=-M,u=0;m>u;u++)v[u][f]=-v[u][f];break}if(R>=i-1)throw"Error: no convergence.";for(b=w[h],x=w[f-1],y=p[f-1],d=p[f],g=((x-M)*(x+M)+(y-d)*(y+d))/(2*d*x),y=t(g,1),g=0>g?((b-M)*(b+M)+d*(x/(g-y)-d))/b:((b-M)*(b+M)+d*(x/(g+y)-d))/b,s=1,k=1,a=h+1;f+1>a;a++){for(y=p[a],x=w[a],d=k*y,y=s*y,M=t(g,d),p[a-1]=M,s=g/M,k=d/M,g=b*s+y*k,y=-b*k+y*s,d=x*k,x*=s,u=0;m>u;u++)b=v[u][a-1],M=v[u][a],v[u][a-1]=b*s+M*k,v[u][a]=-b*k+M*s;for(M=t(g,d),w[a-1]=M,s=g/M,k=d/M,g=s*y+k*x,b=-k*y+s*x,u=0;l>u;u++)x=c[u][a-1],M=c[u][a],c[u][a-1]=x*s+M*k,c[u][a]=-x*k+M*s}p[h]=0,p[f]=g,w[f]=b}for(a=0;a<w.length;a++)w[a]<o&&(w[a]=0);for(a=0;m>a;a++)for(u=a-1;u>=0;u--)if(w[u]<w[a]){for(s=w[u],w[u]=w[a],w[a]=s,f=0;f<c.length;f++)n=c[f][a],c[f][a]=c[f][u],c[f][u]=n;for(f=0;f<v.length;f++)n=v[f][a],v[f][a]=v[f][u],v[f][u]=n;a=u}return{U:c,S:w,V:v}}}).call(exports,function(){return this}())},function(r,t,n){r.exports=n(87)},function(r,t,n){"use strict";function o(r,t,n){if(t)this.U=n.U,this.S=n.S,this.means=n.means,this.std=n.std;else{r=i.isMatrix(r)?r.clone():new i(r,!0);var o=e(r),s=o.result,u=s.transpose().mmul(s).divS(r.rows),f=new a(u,{computeLeftSingularVectors:!0,computeRightSingularVectors:!0,autoTranspose:!1});this.U=f.leftSingularVectors,this.S=f.diagonal,this.means=o.means,this.std=o.std}}function e(r){var t=s.matrix.mean(r),n=i.rowVector(s.matrix.standardDeviation(r,t,!0));t=i.rowVector(t);var o=r.subRowVector(t);return{result:o.divRowVector(n),means:t,std:n}}var i=n(88),s=n(5),a=i.DC.SVD;r.exports=o,o.load=function(r){if("PCA"!==r.modelName)throw new RangeError("The current model is invalid!");return new o(null,!0,r)},o.prototype["export"]=function(){return{modelName:"PCA",U:this.U,S:this.S,means:this.means,std:this.std}},o.prototype.project=function(r,t){var n=t-1;if(t>this.U.columns)throw new RangeError("the number of dimensions must not be larger than "+this.U.columns);var o=e(i(r).clone()).result;return o.mmul(this.U.subMatrix(0,this.U.rows-1,0,n))},o.prototype.getExplainedVariance=function(){var r=this.S.reduce(function(r,t){return r+t});return this.S.map(function(t){return t/r})},o.prototype.getEigenvectors=function(){return this.U},o.prototype.getEigenvalues=function(){return this.S}},function(r,t,n){"use strict";r.exports=n(89),r.exports.Decompositions=r.exports.DC=n(90)},function(r,t){"use strict";function n(r){for(var t=0,n=r.length,o=new Array(n);n>t;t++)o[t]=r[t];return o}function o(r,t){var e,i,s=0;if(Array.isArray(r)){if(i=t,e=i?n(r):r,r=e.length,t=e[0].length,"undefined"==typeof t)throw new TypeError("Data must be a 2D array");if(!(r>0&&t>0))throw new RangeError("Invalid dimensions: "+r+"x"+t);for(;r>s;s++){if(e[s].length!==t)throw new RangeError("Inconsistent array dimensions");i&&(e[s]=n(e[s]))}}else{if("number"!=typeof r)throw new TypeError("Invalid arguments");if(!(r>0&&t>0))throw new RangeError("Invalid dimensions: "+r+"x"+t);for(e=new Array(r);r>s;s++)e[s]=new Array(t)}return Object.defineProperty(e,"rows",{writable:!0,value:r}),Object.defineProperty(e,"columns",{
writable:!0,value:t}),e.__proto__=o.prototype,e}var e=Array.prototype.splice,i=Array.prototype.concat;o.from1DArray=function(r,t,n){var e,i,s=0;if(e=r*t,e!==n.length)throw new RangeError("Data length does not match given dimensions");for(i=new Array(r);r>s;s++)i[s]=n.slice(s*t,(s+1)*t);return new o(i)},o.rowVector=function(r){return new o([r])},o.columnVector=function(r){for(var t=r.length,n=new Array(t),e=0;t>e;e++)n[e]=[r[e]];return new o(n)},o.empty=function(r,t){return new o(r,t)},o.zeros=function(r,t){return o.empty(r,t).fill(0)},o.ones=function(r,t){return o.empty(r,t).fill(1)},o.rand=function(r,t){for(var n=o.empty(r,t),e=0,i=n.rows;i>e;e++)for(var s=0,a=n.columns;a>s;s++)n[e][s]=Math.random();return n},o.eye=function(r){for(var t=o.zeros(r,r),n=t.rows,e=0;n>e;e++)t[e][e]=1;return t},o.diag=function(r){for(var t=r.length,n=o.zeros(t,t),e=0;t>e;e++)n[e][e]=r[e];return n},o.indices=function(r,t){for(var n=new Array(t-r),o=0;o<n.length;o++)n[o]=r++;return n},o.stack=function(r){var t,n,e;if(o.isMatrix(r)){var i=0,s=0;for(t=0;t<arguments.length;t++)i+=arguments[t].rows,arguments[t].columns>s&&(s=arguments[t].columns);var a=o.zeros(i,s),u=0;for(t=0;t<arguments.length;t++){var f=arguments[t];for(n=0;n<f.rows;n++){for(e=0;e<f.columns;e++)a[u][e]=f[n][e];u++}}return a}if(Array.isArray(r)){var h=o.empty(arguments.length,r.length);for(t=0;t<arguments.length;t++)h.setRow(t,arguments[t]);return h}},o.expand=function(r,t){for(var n=[],e=0;e<t.length;e++)for(var i=0;i<t[e];i++)n.push(r[e]);return new o(n)},o.checkMatrix=function(r){if(!r)throw new TypeError("Argument has to be a matrix");return"Matrix"!==r.klass&&(r=new o(r)),r},o.isMatrix=function(r){return r?"Matrix"===r.klass:!1},Object.defineProperty(o.prototype,"klass",{get:function(){return"Matrix"}}),Object.defineProperty(o.prototype,"size",{get:function(){return this.rows*this.columns}}),o.prototype.checkRowIndex=function(r){if(0>r||r>this.rows-1)throw new RangeError("Row index out of range.")},o.prototype.checkColumnIndex=function(r){if(0>r||r>this.columns-1)throw new RangeError("Column index out of range.")},o.prototype.checkDimensions=function(r){if(this.rows!==r.rows||this.columns!==r.columns)throw new RangeError("Matrices dimensions must be equal.")},o.prototype.apply=function(r){for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)r.call(this,o,e);return this},o.prototype.clone=function(){return new o(this.to2DArray())},o.prototype.to1DArray=function(){return i.apply([],this)},o.prototype.to2DArray=function(){for(var r=this.rows,t=new Array(r),o=0;r>o;o++)t[o]=n(this[o]);return t},o.prototype.isRowVector=function(){return 1===this.rows},o.prototype.isColumnVector=function(){return 1===this.columns},o.prototype.isVector=function(){return 1===this.rows||1===this.columns},o.prototype.isSquare=function(){return this.rows===this.columns},o.prototype.isSymmetric=function(){if(this.isSquare()){for(var r=this.rows,t=0;r>t;t++)for(var n=0;t>=n;n++)if(this[t][n]!==this[n][t])return!1;return!0}return!1},o.prototype.set=function(r,t,n){return this[r][t]=n,this},o.prototype.get=function(r,t){return this[r][t]},o.prototype.fill=function(r){for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]=r;return this},o.prototype.neg=function(){return this.mulS(-1)},o.prototype.add=function(r){return"number"==typeof r?this.addS(r):(r=o.checkMatrix(r),this.addM(r))},o.prototype.addS=function(r){for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]+=r;return this},o.prototype.addM=function(r){this.checkDimensions(r);for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]+=r[o][e];return this},o.prototype.sub=function(r){return"number"==typeof r?this.subS(r):(r=o.checkMatrix(r),this.subM(r))},o.prototype.subS=function(r){for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]-=r;return this},o.prototype.subM=function(r){this.checkDimensions(r);for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]-=r[o][e];return this},o.prototype.mul=function(r){return"number"==typeof r?this.mulS(r):(r=o.checkMatrix(r),this.mulM(r))},o.prototype.mulS=function(r){for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]*=r;return this},o.prototype.mulM=function(r){this.checkDimensions(r);for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]*=r[o][e];return this},o.prototype.div=function(r){return"number"==typeof r?this.divS(r):(r=o.checkMatrix(r),this.divM(r))},o.prototype.divS=function(r){for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]/=r;return this},o.prototype.divM=function(r){this.checkDimensions(r);for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]/=r[o][e];return this},o.prototype.getRow=function(r){return this.checkRowIndex(r),n(this[r])},o.prototype.getRowVector=function(r){return o.rowVector(this.getRow(r))},o.prototype.setRow=function(r,t){if(this.checkRowIndex(r),o.isMatrix(t)&&(t=t.to1DArray()),t.length!==this.columns)throw new RangeError("Invalid row size");return this[r]=n(t),this},o.prototype.removeRow=function(r){if(this.checkRowIndex(r),1===this.rows)throw new RangeError("A matrix cannot have less than one row");return e.call(this,r,1),this.rows-=1,this},o.prototype.addRow=function(r,t){if("undefined"==typeof t&&(t=r,r=this.rows),0>r||r>this.rows)throw new RangeError("Row index out of range.");if(o.isMatrix(t)&&(t=t.to1DArray()),t.length!==this.columns)throw new RangeError("Invalid row size");return e.call(this,r,0,n(t)),this.rows+=1,this},o.prototype.swapRows=function(r,t){this.checkRowIndex(r),this.checkRowIndex(t);var n=this[r];return this[r]=this[t],this[t]=n,this},o.prototype.getColumn=function(r){this.checkColumnIndex(r);for(var t=this.rows,n=new Array(t),o=0;t>o;o++)n[o]=this[o][r];return n},o.prototype.getColumnVector=function(r){return o.columnVector(this.getColumn(r))},o.prototype.setColumn=function(r,t){this.checkColumnIndex(r),o.isMatrix(t)&&(t=t.to1DArray());var n=this.rows;if(t.length!==n)throw new RangeError("Invalid column size");for(var e=0;n>e;e++)this[e][r]=t[e];return this},o.prototype.removeColumn=function(r){if(this.checkColumnIndex(r),1===this.columns)throw new RangeError("A matrix cannot have less than one column");for(var t=0,n=this.rows;n>t;t++)this[t].splice(r,1);return this.columns-=1,this},o.prototype.addColumn=function(r,t){if("undefined"==typeof t&&(t=r,r=this.columns),0>r||r>this.columns)throw new RangeError("Column index out of range.");o.isMatrix(t)&&(t=t.to1DArray());var n=this.rows;if(t.length!==n)throw new RangeError("Invalid column size");for(var e=0;n>e;e++)this[e].splice(r,0,t[e]);return this.columns+=1,this},o.prototype.swapColumns=function(r,t){this.checkRowIndex(r),this.checkRowIndex(t);for(var n,o,e=this.rows,i=0;e>i;i++)o=this[i],n=o[r],o[r]=o[t],o[t]=n;return this},o.prototype.checkRowVector=function(r){if(o.isMatrix(r)&&(r=r.to1DArray()),r.length!==this.columns)throw new RangeError("vector size must be the same as the number of columns");return r},o.prototype.checkColumnVector=function(r){if(o.isMatrix(r)&&(r=r.to1DArray()),r.length!==this.rows)throw new RangeError("vector size must be the same as the number of rows");return r},o.prototype.addRowVector=function(r){r=this.checkRowVector(r);for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]+=r[e];return this},o.prototype.subRowVector=function(r){r=this.checkRowVector(r);for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]-=r[e];return this},o.prototype.mulRowVector=function(r){r=this.checkRowVector(r);for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]*=r[e];return this},o.prototype.divRowVector=function(r){r=this.checkRowVector(r);for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]/=r[e];return this},o.prototype.addColumnVector=function(r){r=this.checkColumnVector(r);for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]+=r[o];return this},o.prototype.subColumnVector=function(r){r=this.checkColumnVector(r);for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]-=r[o];return this},o.prototype.mulColumnVector=function(r){r=this.checkColumnVector(r);for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]*=r[o];return this},o.prototype.divColumnVector=function(r){r=this.checkColumnVector(r);for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]/=r[o];return this},o.prototype.mulRow=function(r,t){this.checkRowIndex(r);for(var n=0,o=this.columns;o>n;n++)this[r][n]*=t;return this},o.prototype.mulColumn=function(r,t){this.checkColumnIndex(r);for(var n=0,o=this.rows;o>n;n++)this[n][r]*=t},o.prototype.max=function(){for(var r=-(1/0),t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]>r&&(r=this[o][e]);return r},o.prototype.maxIndex=function(){for(var r=-(1/0),t={},n=this.rows,o=this.columns,e=0;n>e;e++)for(var i=0;o>i;i++)this[e][i]>r&&(r=this[e][i],t.row=e,t.column=i);return t},o.prototype.min=function(){for(var r=1/0,t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]<r&&(r=this[o][e]);return r},o.prototype.minIndex=function(){for(var r=1/0,t={},n=this.rows,o=this.columns,e=0;n>e;e++)for(var i=0;o>i;i++)this[e][i]<r&&(r=this[e][i],t.row=e,t.column=i);return t},o.prototype.maxRow=function(r){this.checkRowIndex(r);for(var t=-(1/0),n=0,o=this.columns;o>n;n++)this[r][n]>t&&(t=this[r][n]);return t},o.prototype.maxRowIndex=function(r){this.checkRowIndex(r);for(var t=-(1/0),n={row:r},o=0,e=this.columns;e>o;o++)this[r][o]>t&&(t=this[r][o],n.column=o);return n},o.prototype.minRow=function(r){this.checkRowIndex(r);for(var t=1/0,n=0,o=this.columns;o>n;n++)this[r][n]<t&&(t=this[r][n]);return t},o.prototype.minRowIndex=function(r){this.checkRowIndex(r);for(var t=1/0,n={row:r,column:0},o=0,e=this.columns;e>o;o++)this[r][o]<t&&(t=this[r][o],n.column=o);return n},o.prototype.maxColumn=function(r){this.checkColumnIndex(r);for(var t=-(1/0),n=0,o=this.rows;o>n;n++)this[n][r]>t&&(t=this[n][r]);return t},o.prototype.maxColumnIndex=function(r){this.checkColumnIndex(r);for(var t=-(1/0),n={row:0,column:r},o=0,e=this.rows;e>o;o++)this[o][r]>t&&(t=this[o][r],n.row=o);return n},o.prototype.minColumn=function(r){this.checkColumnIndex(r);for(var t=1/0,n=0,o=this.rows;o>n;n++)this[n][r]<t&&(t=this[n][r]);return t},o.prototype.minColumnIndex=function(r){this.checkColumnIndex(r);for(var t=1/0,n={row:0,column:r},o=0,e=this.rows;e>o;o++)this[o][r]<t&&(t=this[o][r],n.row=o);return n},o.prototype.diag=function s(){if(!this.isSquare())throw new TypeError("Only square matrices have a diagonal.");for(var s=new Array(this.rows),r=0,t=this.rows;t>r;r++)s[r]=this[r][r];return s},o.prototype.sum=function(){for(var r=0,t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)r+=this[o][e];return r},o.prototype.mean=function(){return this.sum()/this.size},o.prototype.prod=function a(){for(var a=1,r=this.rows,t=this.columns,n=0;r>n;n++)for(var o=0;t>o;o++)a*=this[n][o];return a},o.prototype.cumulativeSum=function(){for(var r=0,t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)r+=this[o][e],this[o][e]=r;return this},o.prototype.dot=function u(r){if(this.size!==r.size)throw new RangeError("vectors do not have the same size");for(var t=this.to1DArray(),n=r.to1DArray(),u=0,o=t.length,e=0;o>e;e++)u+=t[e]*n[e];return u},o.prototype.mmul=function(r){if(!o.isMatrix(r))throw new TypeError('parameter "other" must be a matrix');this.columns!==r.rows&&console.warn("Number of columns of left matrix are not equal to number of rows of right matrix.");var t,n,e,i=this.rows,s=this.columns,a=r.columns,u=new o(i,a),f=new Array(s);for(n=0;a>n;n++){for(e=0;s>e;e++)f[e]=r[e][n];for(t=0;i>t;t++){var h=this[t],c=0;for(e=0;s>e;e++)c+=h[e]*f[e];u[t][n]=c}}return u},o.prototype.sortRows=function(r){for(var t=0,n=this.rows;n>t;t++)this[t].sort(r);return this},o.prototype.sortColumns=function(r){for(var t=0,n=this.columns;n>t;t++)this.setColumn(t,this.getColumn(t).sort(r));return this},o.prototype.transpose=function(){for(var r=new o(this.columns,this.rows),t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)r[i][e]=this[e][i];return r},o.prototype.subMatrix=function(r,t,n,e){if(r>t||n>e||0>r||r>=this.rows||0>t||t>=this.rows||0>n||n>=this.columns||0>e||e>=this.columns)throw new RangeError("Argument out of range");for(var i=new o(t-r+1,e-n+1),s=r;t>=s;s++)for(var a=n;e>=a;a++)i[s-r][a-n]=this[s][a];return i},o.prototype.subMatrixRow=function(r,t,n){if("undefined"==typeof t?(t=0,n=this.columns-1):"undefined"==typeof n&&(n=this.columns-1),t>n||0>t||t>=this.columns||0>n||n>=this.columns)throw new RangeError("Argument out of range.");for(var e=r.length,i=this.rows,s=new o(e,n-t+1),a=0;e>a;a++)for(var u=t;n>=u;u++){if(r[a]<0||r[a]>=i)throw new RangeError("Argument out of range.");s[a][u-t]=this[r[a]][u]}return s},o.prototype.subMatrixColumn=function(r,t,n){if("undefined"==typeof t?(t=0,n=this.rows-1):"undefined"==typeof n&&(n=this.rows-1),t>n||0>t||t>=this.rows||0>n||n>=this.rows)throw new RangeError("Argument out of range.");for(var e=r.length,i=this.columns,s=new o(n-t+1,e),a=0;e>a;a++)for(var u=t;n>=u;u++){if(r[a]<0||r[a]>=i)throw new RangeError("Argument out of range.");s[u-t][a]=this[u][r[a]]}return s},o.prototype.trace=function f(){if(!this.isSquare())throw new TypeError("The matrix is not square");for(var f=0,r=0,t=this.rows;t>r;r++)f+=this[r][r];return f},o.prototype.abs=function(){for(var r=this.rows,t=this.columns,n=0;r>n;n++)for(var o=0;t>o;o++)this[n][o]=Math.abs(this[n][o])},r.exports=o},function(r,t,n){"use strict";function o(r){return e(r,i.eye(r.rows))}function e(r,t){return r.isSquare()?new u(r).solve(t):new f(r).solve(t)}var i=n(89),s=n(91),a=n(93),u=n(94),f=n(95),h=n(96);i.prototype.inverse=function(){return o(this)},i.prototype.solve=function(r){return e(this,r)},r.exports={SingularValueDecomposition:s,SVD:s,EigenvalueDecomposition:a,EVD:a,LuDecomposition:u,LU:u,QrDecomposition:f,QR:f,CholeskyDecomposition:h,CHO:h,inverse:o,solve:e}},function(r,t,n){"use strict";function o(r,t){if(!(this instanceof o))return new o(r,t);r=e.checkMatrix(r),t=t||{};var n=r.clone(),s=r.rows,a=r.columns,u=Math.min(s,a),f=!0,h=!0;t.computeLeftSingularVectors===!1&&(f=!1),t.computeRightSingularVectors===!1&&(h=!1);var c=t.autoTranspose===!0,l=!1;if(a>s)if(c){n=n.transpose(),s=n.rows,a=n.columns,l=!0;var m=f;f=h,h=m}else console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");var p,w,v,g,y,d,b,x,M,k,R,A,j,S,V,E,C,D,I,O,q,z=new Array(Math.min(s+1,a)),T=e.zeros(s,u),U=e.zeros(a,a),L=new Array(a),_=new Array(s),N=Math.min(s-1,a),P=Math.max(0,Math.min(a-2,s));for(v=0,k=Math.max(N,P);k>v;v++){if(N>v){for(z[v]=0,p=v;s>p;p++)z[v]=i(z[v],n[p][v]);if(0!==z[v]){for(n[v][v]<0&&(z[v]=-z[v]),p=v;s>p;p++)n[p][v]/=z[v];n[v][v]+=1}z[v]=-z[v]}for(w=v+1;a>w;w++){if(N>v&&0!==z[v]){for(y=0,p=v;s>p;p++)y+=n[p][v]*n[p][w];for(y=-y/n[v][v],p=v;s>p;p++)n[p][w]+=y*n[p][v]}L[w]=n[v][w]}if(f&&N>v)for(p=v;s>p;p++)T[p][v]=n[p][v];if(P>v){for(L[v]=0,p=v+1;a>p;p++)L[v]=i(L[v],L[p]);if(0!==L[v]){for(L[v+1]<0&&(L[v]=-L[v]),p=v+1;a>p;p++)L[p]/=L[v];L[v+1]+=1}if(L[v]=-L[v],s>v+1&&0!==L[v]){for(p=v+1;s>p;p++)_[p]=0;for(w=v+1;a>w;w++)for(p=v+1;s>p;p++)_[p]+=L[w]*n[p][w];for(w=v+1;a>w;w++)for(y=-L[w]/L[v+1],p=v+1;s>p;p++)n[p][w]+=y*_[p]}if(h)for(p=v+1;a>p;p++)U[p][v]=L[p]}}if(g=Math.min(a,s+1),a>N&&(z[N]=n[N][N]),g>s&&(z[g-1]=0),g>P+1&&(L[P]=n[P][g-1]),L[g-1]=0,f){for(w=N;u>w;w++){for(p=0;s>p;p++)T[p][w]=0;T[w][w]=1}for(v=N-1;v>=0;v--)if(0!==z[v]){for(w=v+1;u>w;w++){for(y=0,p=v;s>p;p++)y+=T[p][v]*T[p][w];for(y=-y/T[v][v],p=v;s>p;p++)T[p][w]+=y*T[p][v]}for(p=v;s>p;p++)T[p][v]=-T[p][v];for(T[v][v]=1+T[v][v],p=0;v-1>p;p++)T[p][v]=0}else{for(p=0;s>p;p++)T[p][v]=0;T[v][v]=1}}if(h)for(v=a-1;v>=0;v--){if(P>v&&0!==L[v])for(w=v+1;a>w;w++){for(y=0,p=v+1;a>p;p++)y+=U[p][v]*U[p][w];for(y=-y/U[v+1][v],p=v+1;a>p;p++)U[p][w]+=y*U[p][v]}for(p=0;a>p;p++)U[p][v]=0;U[v][v]=1}for(var F=g-1,Q=0,B=Math.pow(2,-52);g>0;){for(v=g-2;v>=-1&&-1!==v;v--)if(Math.abs(L[v])<=B*(Math.abs(z[v])+Math.abs(z[v+1]))){L[v]=0;break}if(v===g-2)R=4;else{for(d=g-1;d>=v&&d!==v;d--)if(y=(d!==g?Math.abs(L[d]):0)+(d!==v+1?Math.abs(L[d-1]):0),Math.abs(z[d])<=B*y){z[d]=0;break}d===v?R=3:d===g-1?R=1:(R=2,v=d)}switch(v++,R){case 1:for(b=L[g-2],L[g-2]=0,w=g-2;w>=v;w--)if(y=i(z[w],b),x=z[w]/y,M=b/y,z[w]=y,w!==v&&(b=-M*L[w-1],L[w-1]=x*L[w-1]),h)for(p=0;a>p;p++)y=x*U[p][w]+M*U[p][g-1],U[p][g-1]=-M*U[p][w]+x*U[p][g-1],U[p][w]=y;break;case 2:for(b=L[v-1],L[v-1]=0,w=v;g>w;w++)if(y=i(z[w],b),x=z[w]/y,M=b/y,z[w]=y,b=-M*L[w],L[w]=x*L[w],f)for(p=0;s>p;p++)y=x*T[p][w]+M*T[p][v-1],T[p][v-1]=-M*T[p][w]+x*T[p][v-1],T[p][w]=y;break;case 3:for(A=Math.max(Math.max(Math.max(Math.max(Math.abs(z[g-1]),Math.abs(z[g-2])),Math.abs(L[g-2])),Math.abs(z[v])),Math.abs(L[v])),j=z[g-1]/A,S=z[g-2]/A,V=L[g-2]/A,E=z[v]/A,C=L[v]/A,D=((S+j)*(S-j)+V*V)/2,I=j*V*(j*V),O=0,(0!==D||0!==I)&&(O=Math.sqrt(D*D+I),0>D&&(O=-O),O=I/(D+O)),b=(E+j)*(E-j)+O,q=E*C,w=v;g-1>w;w++){if(y=i(b,q),x=b/y,M=q/y,w!==v&&(L[w-1]=y),b=x*z[w]+M*L[w],L[w]=x*L[w]-M*z[w],q=M*z[w+1],z[w+1]=x*z[w+1],h)for(p=0;a>p;p++)y=x*U[p][w]+M*U[p][w+1],U[p][w+1]=-M*U[p][w]+x*U[p][w+1],U[p][w]=y;if(y=i(b,q),x=b/y,M=q/y,z[w]=y,b=x*L[w]+M*z[w+1],z[w+1]=-M*L[w]+x*z[w+1],q=M*L[w+1],L[w+1]=x*L[w+1],f&&s-1>w)for(p=0;s>p;p++)y=x*T[p][w]+M*T[p][w+1],T[p][w+1]=-M*T[p][w]+x*T[p][w+1],T[p][w]=y}L[g-2]=b,Q+=1;break;case 4:if(z[v]<=0&&(z[v]=z[v]<0?-z[v]:0,h))for(p=0;F>=p;p++)U[p][v]=-U[p][v];for(;F>v&&!(z[v]>=z[v+1]);){if(y=z[v],z[v]=z[v+1],z[v+1]=y,h&&a-1>v)for(p=0;a>p;p++)y=U[p][v+1],U[p][v+1]=U[p][v],U[p][v]=y;if(f&&s-1>v)for(p=0;s>p;p++)y=T[p][v+1],T[p][v+1]=T[p][v],T[p][v]=y;v++}Q=0,g--}}if(l){var X=U;U=T,T=X}this.m=s,this.n=a,this.s=z,this.U=T,this.V=U}var e=n(89),i=n(92).hypotenuse;o.prototype={get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]},get norm2(){return this.s[0]},get rank(){for(var r=Math.pow(2,-52),t=Math.max(this.m,this.n)*this.s[0]*r,n=0,o=this.s,e=0,i=o.length;i>e;e++)o[e]>t&&n++;return n},get diagonal(){return this.s},get threshold(){return Math.pow(2,-52)/2*Math.max(this.m,this.n)*this.s[0]},get leftSingularVectors(){return this.U},get rightSingularVectors(){return this.V},get diagonalMatrix(){return e.diag(this.s)},solve:function(r){var t,n=r,o=this.threshold,i=this.s.length,s=e.zeros(i,i);for(t=0;i>t;t++)Math.abs(this.s[t])<=o?s[t][t]=0:s[t][t]=1/this.s[t];var a,u,f,h=this.V.mmul(s),c=this.V.rows,l=this.U.rows,m=e.zeros(c,l);for(t=0;c>t;t++)for(a=0;l>a;a++){for(f=0,u=0;i>u;u++)f+=h[t][u]*this.U[a][u];m[t][a]=f}return m.mmul(n)},solveForDiagonal:function(r){return this.solve(e.diag(r))},inverse:function(){var r,t,n=this.threshold,o=this.V.rows,i=this.V.columns,s=new e(o,this.s.length);for(r=0;o>r;r++)for(t=0;i>t;t++)Math.abs(this.s[t])>n?s[r][t]=this.V[r][t]/this.s[t]:s[r][t]=0;var a,u,f=this.U.rows,h=this.U.columns,c=new e(o,f);for(r=0;o>r;r++)for(t=0;f>t;t++){for(u=0,a=0;h>a;a++)u+=s[r][a]*this.U[t][a];c[r][t]=u}return c}},r.exports=o},function(r,t){"use strict";t.hypotenuse=function(r,t){var n;return Math.abs(r)>Math.abs(t)?(n=t/r,Math.abs(r)*Math.sqrt(1+n*n)):0!==t?(n=r/t,Math.abs(t)*Math.sqrt(1+n*n)):0}},function(r,t,n){"use strict";function o(r){if(!(this instanceof o))return new o(r);if(r=f.checkMatrix(r),!r.isSquare())throw new Error("Matrix is not a square matrix");var t,n,u=r.columns,h=f.zeros(u,u),c=new Array(u),l=new Array(u),m=r;if(r.isSymmetric()){for(t=0;u>t;t++)for(n=0;u>n;n++)h[t][n]=m[t][n];e(u,l,c,h),i(u,l,c,h)}else{var p=f.zeros(u,u),w=new Array(u);for(n=0;u>n;n++)for(t=0;u>t;t++)p[t][n]=m[t][n];s(u,p,w,h),a(u,l,c,h,p)}this.n=u,this.e=l,this.d=c,this.V=h}function e(r,t,n,o){var e,i,s,a,u,f,h,c;for(u=0;r>u;u++)n[u]=o[r-1][u];for(a=r-1;a>0;a--){for(c=0,s=0,f=0;a>f;f++)c+=Math.abs(n[f]);if(0===c)for(t[a]=n[a-1],u=0;a>u;u++)n[u]=o[a-1][u],o[a][u]=0,o[u][a]=0;else{for(f=0;a>f;f++)n[f]/=c,s+=n[f]*n[f];for(e=n[a-1],i=Math.sqrt(s),e>0&&(i=-i),t[a]=c*i,s-=e*i,n[a-1]=e-i,u=0;a>u;u++)t[u]=0;for(u=0;a>u;u++){for(e=n[u],o[u][a]=e,i=t[u]+o[u][u]*e,f=u+1;a-1>=f;f++)i+=o[f][u]*n[f],t[f]+=o[f][u]*e;t[u]=i}for(e=0,u=0;a>u;u++)t[u]/=s,e+=t[u]*n[u];for(h=e/(s+s),u=0;a>u;u++)t[u]-=h*n[u];for(u=0;a>u;u++){for(e=n[u],i=t[u],f=u;a-1>=f;f++)o[f][u]-=e*t[f]+i*n[f];n[u]=o[a-1][u],o[a][u]=0}}n[a]=s}for(a=0;r-1>a;a++){if(o[r-1][a]=o[a][a],o[a][a]=1,s=n[a+1],0!==s){for(f=0;a>=f;f++)n[f]=o[f][a+1]/s;for(u=0;a>=u;u++){for(i=0,f=0;a>=f;f++)i+=o[f][a+1]*o[f][u];for(f=0;a>=f;f++)o[f][u]-=i*n[f]}}for(f=0;a>=f;f++)o[f][a+1]=0}for(u=0;r>u;u++)n[u]=o[r-1][u],o[r-1][u]=0;o[r-1][r-1]=1,t[0]=0}function i(r,t,n,o){var e,i,s,a,u,f,c,l,m,p,w,v,g,y,d,b,x;for(s=1;r>s;s++)t[s-1]=t[s];t[r-1]=0;var M=0,k=0,R=Math.pow(2,-52);for(f=0;r>f;f++){for(k=Math.max(k,Math.abs(n[f])+Math.abs(t[f])),c=f;r>c&&!(Math.abs(t[c])<=R*k);)c++;if(c>f){x=0;do{for(x+=1,e=n[f],l=(n[f+1]-e)/(2*t[f]),m=h(l,1),0>l&&(m=-m),n[f]=t[f]/(l+m),n[f+1]=t[f]*(l+m),p=n[f+1],i=e-n[f],s=f+2;r>s;s++)n[s]-=i;for(M+=i,l=n[c],w=1,v=w,g=w,y=t[f+1],d=0,b=0,s=c-1;s>=f;s--)for(g=v,v=w,b=d,e=w*t[s],i=w*l,m=h(l,t[s]),t[s+1]=d*m,d=t[s]/m,w=l/m,l=w*n[s]-d*e,n[s+1]=i+d*(w*e+d*n[s]),u=0;r>u;u++)i=o[u][s+1],o[u][s+1]=d*o[u][s]+w*i,o[u][s]=w*o[u][s]-d*i;l=-d*b*g*y*t[f]/p,t[f]=d*l,n[f]=w*l}while(Math.abs(t[f])>R*k)}n[f]=n[f]+M,t[f]=0}for(s=0;r-1>s;s++){for(u=s,l=n[s],a=s+1;r>a;a++)n[a]<l&&(u=a,l=n[a]);if(u!==s)for(n[u]=n[s],n[s]=l,a=0;r>a;a++)l=o[a][s],o[a][s]=o[a][u],o[a][u]=l}}function s(r,t,n,o){var e,i,s,a,u,f,h,c=0,l=r-1;for(f=c+1;l-1>=f;f++){for(h=0,a=f;l>=a;a++)h+=Math.abs(t[a][f-1]);if(0!==h){for(s=0,a=l;a>=f;a--)n[a]=t[a][f-1]/h,s+=n[a]*n[a];for(i=Math.sqrt(s),n[f]>0&&(i=-i),s-=n[f]*i,n[f]=n[f]-i,u=f;r>u;u++){for(e=0,a=l;a>=f;a--)e+=n[a]*t[a][u];for(e/=s,a=f;l>=a;a++)t[a][u]-=e*n[a]}for(a=0;l>=a;a++){for(e=0,u=l;u>=f;u--)e+=n[u]*t[a][u];for(e/=s,u=f;l>=u;u++)t[a][u]-=e*n[u]}n[f]=h*n[f],t[f][f-1]=h*i}}for(a=0;r>a;a++)for(u=0;r>u;u++)o[a][u]=a===u?1:0;for(f=l-1;f>=c+1;f--)if(0!==t[f][f-1]){for(a=f+1;l>=a;a++)n[a]=t[a][f-1];for(u=f;l>=u;u++){for(i=0,a=f;l>=a;a++)i+=n[a]*o[a][u];for(i=i/n[f]/t[f][f-1],a=f;l>=a;a++)o[a][u]+=i*n[a]}}}function a(r,t,n,o,e){var i,s,a,f,h,c,l,m,p,w,v,g,y,d,b,x=r-1,M=0,k=r-1,R=Math.pow(2,-52),A=0,j=0,S=0,V=0,E=0,C=0,D=0,I=0;for(i=0;r>i;i++)for((M>i||i>k)&&(n[i]=e[i][i],t[i]=0),s=Math.max(i-1,0);r>s;s++)j+=Math.abs(e[i][s]);for(;x>=M;){for(f=x;f>M&&(C=Math.abs(e[f-1][f-1])+Math.abs(e[f][f]),0===C&&(C=j),!(Math.abs(e[f][f-1])<R*C));)f--;if(f===x)e[x][x]=e[x][x]+A,n[x]=e[x][x],t[x]=0,x--,I=0;else if(f===x-1){if(l=e[x][x-1]*e[x-1][x],S=(e[x-1][x-1]-e[x][x])/2,V=S*S+l,D=Math.sqrt(Math.abs(V)),e[x][x]=e[x][x]+A,e[x-1][x-1]=e[x-1][x-1]+A,m=e[x][x],V>=0){for(D=S>=0?S+D:S-D,n[x-1]=m+D,n[x]=n[x-1],0!==D&&(n[x]=m-l/D),t[x-1]=0,t[x]=0,m=e[x][x-1],C=Math.abs(m)+Math.abs(D),S=m/C,V=D/C,E=Math.sqrt(S*S+V*V),S/=E,V/=E,s=x-1;r>s;s++)D=e[x-1][s],e[x-1][s]=V*D+S*e[x][s],e[x][s]=V*e[x][s]-S*D;for(i=0;x>=i;i++)D=e[i][x-1],e[i][x-1]=V*D+S*e[i][x],e[i][x]=V*e[i][x]-S*D;for(i=M;k>=i;i++)D=o[i][x-1],o[i][x-1]=V*D+S*o[i][x],o[i][x]=V*o[i][x]-S*D}else n[x-1]=m+S,n[x]=m+S,t[x-1]=D,t[x]=-D;x-=2,I=0}else{if(m=e[x][x],p=0,l=0,x>f&&(p=e[x-1][x-1],l=e[x][x-1]*e[x-1][x]),10===I){for(A+=m,i=M;x>=i;i++)e[i][i]-=m;C=Math.abs(e[x][x-1])+Math.abs(e[x-1][x-2]),m=p=.75*C,l=-.4375*C*C}if(30===I&&(C=(p-m)/2,C=C*C+l,C>0)){for(C=Math.sqrt(C),m>p&&(C=-C),C=m-l/((p-m)/2+C),i=M;x>=i;i++)e[i][i]-=C;A+=C,m=p=l=.964}for(I+=1,h=x-2;h>=f&&(D=e[h][h],E=m-D,C=p-D,S=(E*C-l)/e[h+1][h]+e[h][h+1],V=e[h+1][h+1]-D-E-C,E=e[h+2][h+1],C=Math.abs(S)+Math.abs(V)+Math.abs(E),S/=C,V/=C,E/=C,h!==f)&&!(Math.abs(e[h][h-1])*(Math.abs(V)+Math.abs(E))<R*(Math.abs(S)*(Math.abs(e[h-1][h-1])+Math.abs(D)+Math.abs(e[h+1][h+1]))));)h--;for(i=h+2;x>=i;i++)e[i][i-2]=0,i>h+2&&(e[i][i-3]=0);for(a=h;x-1>=a&&(d=a!==x-1,a!==h&&(S=e[a][a-1],V=e[a+1][a-1],E=d?e[a+2][a-1]:0,m=Math.abs(S)+Math.abs(V)+Math.abs(E),0!==m&&(S/=m,V/=m,E/=m)),0!==m);a++)if(C=Math.sqrt(S*S+V*V+E*E),0>S&&(C=-C),0!==C){for(a!==h?e[a][a-1]=-C*m:f!==h&&(e[a][a-1]=-e[a][a-1]),S+=C,m=S/C,p=V/C,D=E/C,V/=S,E/=S,s=a;r>s;s++)S=e[a][s]+V*e[a+1][s],d&&(S+=E*e[a+2][s],e[a+2][s]=e[a+2][s]-S*D),e[a][s]=e[a][s]-S*m,e[a+1][s]=e[a+1][s]-S*p;for(i=0;i<=Math.min(x,a+3);i++)S=m*e[i][a]+p*e[i][a+1],d&&(S+=D*e[i][a+2],e[i][a+2]=e[i][a+2]-S*E),e[i][a]=e[i][a]-S,e[i][a+1]=e[i][a+1]-S*V;for(i=M;k>=i;i++)S=m*o[i][a]+p*o[i][a+1],d&&(S+=D*o[i][a+2],o[i][a+2]=o[i][a+2]-S*E),o[i][a]=o[i][a]-S,o[i][a+1]=o[i][a+1]-S*V}}}if(0!==j){for(x=r-1;x>=0;x--)if(S=n[x],V=t[x],0===V)for(f=x,e[x][x]=1,i=x-1;i>=0;i--){for(l=e[i][i]-S,E=0,s=f;x>=s;s++)E+=e[i][s]*e[s][x];if(t[i]<0)D=l,C=E;else if(f=i,0===t[i]?e[i][x]=0!==l?-E/l:-E/(R*j):(m=e[i][i+1],p=e[i+1][i],V=(n[i]-S)*(n[i]-S)+t[i]*t[i],c=(m*C-D*E)/V,e[i][x]=c,e[i+1][x]=Math.abs(m)>Math.abs(D)?(-E-l*c)/m:(-C-p*c)/D),c=Math.abs(e[i][x]),R*c*c>1)for(s=i;x>=s;s++)e[s][x]=e[s][x]/c}else if(0>V)for(f=x-1,Math.abs(e[x][x-1])>Math.abs(e[x-1][x])?(e[x-1][x-1]=V/e[x][x-1],e[x-1][x]=-(e[x][x]-S)/e[x][x-1]):(b=u(0,-e[x-1][x],e[x-1][x-1]-S,V),e[x-1][x-1]=b[0],e[x-1][x]=b[1]),e[x][x-1]=0,e[x][x]=1,i=x-2;i>=0;i--){for(w=0,v=0,s=f;x>=s;s++)w+=e[i][s]*e[s][x-1],v+=e[i][s]*e[s][x];if(l=e[i][i]-S,t[i]<0)D=l,E=w,C=v;else if(f=i,0===t[i]?(b=u(-w,-v,l,V),e[i][x-1]=b[0],e[i][x]=b[1]):(m=e[i][i+1],p=e[i+1][i],g=(n[i]-S)*(n[i]-S)+t[i]*t[i]-V*V,y=2*(n[i]-S)*V,0===g&&0===y&&(g=R*j*(Math.abs(l)+Math.abs(V)+Math.abs(m)+Math.abs(p)+Math.abs(D))),b=u(m*E-D*w+V*v,m*C-D*v-V*w,g,y),e[i][x-1]=b[0],e[i][x]=b[1],Math.abs(m)>Math.abs(D)+Math.abs(V)?(e[i+1][x-1]=(-w-l*e[i][x-1]+V*e[i][x])/m,e[i+1][x]=(-v-l*e[i][x]-V*e[i][x-1])/m):(b=u(-E-p*e[i][x-1],-C-p*e[i][x],D,V),e[i+1][x-1]=b[0],e[i+1][x]=b[1])),c=Math.max(Math.abs(e[i][x-1]),Math.abs(e[i][x])),R*c*c>1)for(s=i;x>=s;s++)e[s][x-1]=e[s][x-1]/c,e[s][x]=e[s][x]/c}for(i=0;r>i;i++)if(M>i||i>k)for(s=i;r>s;s++)o[i][s]=e[i][s];for(s=r-1;s>=M;s--)for(i=M;k>=i;i++){for(D=0,a=M;a<=Math.min(s,k);a++)D+=o[i][a]*e[a][s];o[i][s]=D}}}function u(r,t,n,o){var e,i;return Math.abs(n)>Math.abs(o)?(e=o/n,i=n+e*o,[(r+e*t)/i,(t-e*r)/i]):(e=n/o,i=o+e*n,[(e*r+t)/i,(e*t-r)/i])}var f=n(89),h=n(92).hypotenuse;o.prototype={get realEigenvalues(){return this.d},get imaginaryEigenvalues(){return this.e},get eigenvectorMatrix(){return this.V},get diagonalMatrix(){var r,t,n=this.n,o=this.e,e=this.d,i=new f(n,n);for(r=0;n>r;r++){for(t=0;n>t;t++)i[r][t]=0;i[r][r]=e[r],o[r]>0?i[r][r+1]=o[r]:o[r]<0&&(i[r][r-1]=o[r])}return i}},r.exports=o},function(r,t,n){"use strict";function o(r){if(!(this instanceof o))return new o(r);r=e.checkMatrix(r);var t,n,i,s,a,u,f,h,c,l,m=r.clone(),p=m.rows,w=m.columns,v=new Array(p),g=1;for(t=0;p>t;t++)v[t]=t;for(c=new Array(p),n=0;w>n;n++){for(t=0;p>t;t++)c[t]=m[t][n];for(t=0;p>t;t++){for(h=m[t],l=Math.min(t,n),a=0,i=0;l>i;i++)a+=h[i]*c[i];h[n]=c[t]-=a}for(s=n,t=n+1;p>t;t++)Math.abs(c[t])>Math.abs(c[s])&&(s=t);if(s!==n){for(i=0;w>i;i++)u=m[s][i],m[s][i]=m[n][i],m[n][i]=u;f=v[s],v[s]=v[n],v[n]=f,g=-g}if(p>n&&0!==m[n][n])for(t=n+1;p>t;t++)m[t][n]/=m[n][n]}this.LU=m,this.pivotVector=v,this.pivotSign=g}var e=n(89);o.prototype={isSingular:function(){for(var r=this.LU,t=r.columns,n=0;t>n;n++)if(0===r[n][n])return!0;return!1},get determinant(){var r=this.LU;if(!r.isSquare())throw new Error("Matrix must be square");for(var t=this.pivotSign,n=r.columns,o=0;n>o;o++)t*=r[o][o];return t},get lowerTriangularFactor(){for(var r=this.LU,t=r.rows,n=r.columns,o=new e(t,n),i=0;t>i;i++)for(var s=0;n>s;s++)i>s?o[i][s]=r[i][s]:i===s?o[i][s]=1:o[i][s]=0;return o},get upperTriangularFactor(){for(var r=this.LU,t=r.rows,n=r.columns,o=new e(t,n),i=0;t>i;i++)for(var s=0;n>s;s++)s>=i?o[i][s]=r[i][s]:o[i][s]=0;return o},get pivotPermutationVector(){return this.pivotVector.slice()},solve:function(r){r=e.checkMatrix(r);var t=this.LU,n=t.rows;if(n!==r.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");var o,i,s,a=r.columns,u=r.subMatrixRow(this.pivotVector,0,a-1),f=t.columns;for(s=0;f>s;s++)for(o=s+1;f>o;o++)for(i=0;a>i;i++)u[o][i]-=u[s][i]*t[o][s];for(s=f-1;s>=0;s--){for(i=0;a>i;i++)u[s][i]/=t[s][s];for(o=0;s>o;o++)for(i=0;a>i;i++)u[o][i]-=u[s][i]*t[o][s]}return u}},r.exports=o},function(r,t,n){"use strict";function o(r){if(!(this instanceof o))return new o(r);r=e.checkMatrix(r);var t,n,s,a,u=r.clone(),f=r.rows,h=r.columns,c=new Array(h);for(s=0;h>s;s++){var l=0;for(t=s;f>t;t++)l=i(l,u[t][s]);if(0!==l){for(u[s][s]<0&&(l=-l),t=s;f>t;t++)u[t][s]/=l;for(u[s][s]+=1,n=s+1;h>n;n++){for(a=0,t=s;f>t;t++)a+=u[t][s]*u[t][n];for(a=-a/u[s][s],t=s;f>t;t++)u[t][n]+=a*u[t][s]}}c[s]=-l}this.QR=u,this.Rdiag=c}var e=n(89),i=n(92).hypotenuse;o.prototype={solve:function(r){r=e.checkMatrix(r);var t=this.QR,n=t.rows;if(r.rows!==n)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");var o,i,s,a,u=r.columns,f=r.clone(),h=t.columns;for(s=0;h>s;s++)for(i=0;u>i;i++){for(a=0,o=s;n>o;o++)a+=t[o][s]*f[o][i];for(a=-a/t[s][s],o=s;n>o;o++)f[o][i]+=a*t[o][s]}for(s=h-1;s>=0;s--){for(i=0;u>i;i++)f[s][i]/=this.Rdiag[s];for(o=0;s>o;o++)for(i=0;u>i;i++)f[o][i]-=f[s][i]*t[o][s]}return f.subMatrix(0,h-1,0,u-1)},isFullRank:function(){for(var r=this.QR.columns,t=0;r>t;t++)if(0===this.Rdiag[t])return!1;return!0},get upperTriangularFactor(){var r,t,n=this.QR,o=n.columns,i=new e(o,o);for(r=0;o>r;r++)for(t=0;o>t;t++)t>r?i[r][t]=n[r][t]:r===t?i[r][t]=this.Rdiag[r]:i[r][t]=0;return i},get orthogonalFactor(){var r,t,n,o,i=this.QR,s=i.rows,a=i.columns,u=new e(s,a);for(n=a-1;n>=0;n--){for(r=0;s>r;r++)u[r][n]=0;for(u[n][n]=1,t=n;a>t;t++)if(0!==i[n][n]){for(o=0,r=n;s>r;r++)o+=i[r][n]*u[r][t];for(o=-o/i[n][n],r=n;s>r;r++)u[r][t]+=o*i[r][n]}}return u}},r.exports=o},function(r,t,n){"use strict";function o(r){if(!(this instanceof o))return new o(r);if(r=e.checkMatrix(r),!r.isSymmetric())throw new Error("Matrix is not symmetric");var t,n,i,s=r,a=s.rows,u=new e(a,a),f=!0;for(n=0;a>n;n++){var h=u[n],c=0;for(i=0;n>i;i++){var l=u[i],m=0;for(t=0;i>t;t++)m+=l[t]*h[t];h[i]=m=(s[n][i]-m)/u[i][i],c+=m*m}for(c=s[n][n]-c,f&=c>0,u[n][n]=Math.sqrt(Math.max(c,0)),i=n+1;a>i;i++)u[n][i]=0}if(!f)throw new Error("Matrix is not positive definite");this.L=u}var e=n(89);o.prototype={get leftTriangularFactor(){return this.L},solve:function(r){r=e.checkMatrix(r);var t=this.L,n=t.rows;if(r.rows!==n)throw new Error("Matrix dimensions do not match");var o,i,s,a=r.columns,u=r.clone();for(s=0;n>s;s++)for(i=0;a>i;i++){for(o=0;s>o;o++)u[s][i]-=u[o][i]*t[s][o];u[s][i]/=t[s][s]}for(s=n-1;s>=0;s--)for(i=0;a>i;i++){for(o=s+1;n>o;o++)u[s][i]-=u[o][i]*t[o][s];u[s][i]/=t[s][s]}return u}},r.exports=o},function(r,t){"use strict";function n(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function o(r,t){r>>>=0,t>>>=0;var n=65535&r,o=r-n;return(o*t>>>0)+n*t>>>0}function e(r){0===r.state[0]&&0===r.state[1]&&0===r.state[2]&&0===r.state[3]&&(r.state[0]=88,r.state[1]=83,r.state[2]=65,r.state[3]=68)}function i(r){var t=r.state[0];t^=t<<h,t^=t>>>c,t^=r.state[3]<<l,r.state[0]=r.state[1],r.state[1]=r.state[2],r.state[2]=r.state[3],r.state[3]=t}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function r(r,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(r,o.key,o)}}return function(t,n,o){return n&&r(t.prototype,n),o&&r(t,o),t}}(),a=8,u=1/16777216,f=function(){function r(){var t=arguments.length<=0||void 0===arguments[0]?Date.now():arguments[0];n(this,r),this.state=new Uint32Array(4),this.init(t)}return s(r,[{key:"init",value:function(r){this.state[0]=r,this.state[1]=0,this.state[2]=0,this.state[3]=0;for(var t=1;a>t;t++)this.state[3&t]^=t+o(1812433253,this.state[t-1&3]^this.state[t-1&3]>>>30>>>0)>>>0;e(this);for(var t=0;a>t;t++)i(this)}},{key:"getUint32",value:function(){return i(this),this.state[3]+this.state[2]>>>0}},{key:"getFloat",value:function(){return(this.getUint32()>>>8)*u}},{key:"random",
get:function(){return this._random||(this._random=this.getFloat.bind(this)),this._random}}]),r}();t["default"]=f;var h=15,c=18,l=11;r.exports=t["default"]},function(r,t,n){r.exports=t=n(99),t.kernel=n(100).kernel},function(r,t,n){"use strict";function o(r,t,n,o,e,i,s){for(var a=t.length,u=e,f=0;a>f;f++)e+=o[f]*n[f]*i(t[f],r,s);return u}function e(r){r=r||{},this.options={};for(var t in s)r.hasOwnProperty(t)?this.options[t]=r[t]:this.options[t]=s[t];this.kernel=i(this.options.k),this.b=0}var i=(n(100).kernel,n(100).getKernel),s={C:10,tol:.1,max_passes:100,par:2,k:"lineal"};e.prototype.train=function(r,t){for(var n=t.length,e=new Array(n),i=0;n>i;i++)e[i]=0;if(r.length!==n)throw new TypeError("Arrays should have the same length");for(var s=0,a=0,u=0,f=0,h=0,c=0,l=0,m=0,p=0,w=0,v=0;f<this.options.max_passes;){for(var g=0,y=0;n>y;y++)if(h=o(r[y],r,t,e,s,this.kernel,this.options.par)-t[y],t[y]*h<-this.options.tol&&e[y]<this.options.C||t[y]*h>this.options.tol&&e[y]>0){var d=0;do d=Math.ceil(Math.random()*(n-1));while(d===y);c=o(r[d],r,t,e,s,this.kernel,this.options.par)-t[d],l=e[y],m=e[d],t[y]===t[d]?(p=Math.max(0,l+m-this.options.C),w=Math.min(this.options.C,l+m)):(p=Math.max(0,l-m),w=Math.min(this.options.C,this.options.C-l+m)),p!==w&&(v=2*this.kernel(r[y],r[d],this.options.par)-this.kernel(r[y],r[y],this.options.par)-this.kernel(r[d],r[d],this.options.par),0>v&&(e[d]=e[d]-t[d]*(h-c)/v,e[d]>w?e[d]=w:e[d]<p&&(e[d]=p),Math.abs(m-e[d])>=1e-4&&(e[y]=e[y]+t[y]*t[d]*(m-e[d]),a=s-h-t[y]*(e[y]-l)*this.kernel(r[y],r[y],this.options.par)-t[d]*(e[d]-m)*this.kernel(r[y],r[d],this.options.par),u=s-c-t[y]*(e[y]-l)*this.kernel(r[y],r[d],this.options.par)-t[d]*(e[d]-m)*this.kernel(r[d],r[d],this.options.par),s=e[y]<this.options.C&&e[y]>0?a:e[d]<this.options.C&&e[d]>0?u:(a+u)/2,g+=1)))}0==g?f+=1:f=0}this.b=s;var b=r[0].length;this.W=new Array(b);for(var x=0;b>x;x++){this.W[x]=0;for(var M=0;n>M;M++)this.W[x]+=t[M]*e[M]*r[M][x]}this.alphas=e.splice()},e.load=function(r){if("SVM"===r.name){var t=new e(r.options);return t.W=r.W.slice(),t.b=r.b,t}throw new TypeError("expecting a SVM model")},e.prototype["export"]=function(){var r={name:"SVM"};return r.options=this.options,r.W=this.W,r.b=this.b,r},e.prototype.getAlphas=function(){return this.alphas.slice()},e.prototype.getThreshold=function(){return this.b},e.prototype.predict=function(r){var t;if(Array.isArray(r)&&(Array.isArray(r[0])||"object"==typeof r[0])){for(var n=new Array(r.length),o=0;o<n.length;o++){t=this.b;for(var e=0;e<this.W.length;e++)t+=this.W[e]*r[e];0>t?n[o]=-1:n[o]=1}return n}t=this.b;for(var i=0;i<this.W.length;i++)t+=this.W[i]*r[i];return 0>t?-1:1},r.exports=e},function(r,t){"use strict";function n(r,t,n,o){return e(n)(r,t,o)}function o(r,t){for(var n=r.length,o=0,e=0;n>e;e++)o+=r[e]*t[e];return o}function e(r){switch(r="undefined"==typeof r?"lineal":r){case"lineal":return i;case"polynomial":return s;case"radial":return a;default:throw new TypeError("Function kernel undefined: "+r)}}function i(r,t){return o(r,t)}function s(r,t,n){return n="undefined"==typeof n?2:n,Math.pow(o(r,t)+1,n)}function a(r,t,n){n="undefined"==typeof n?2:n;for(var e=r.length,i=new Array(e),s=0;e>s;s++)i[s]=r[s]-t[s];var a=o(i,i);return Math.exp(a/(-2*n*n))}r.exports={kernel:n,getKernel:e,lineal:i,polynomial:s,radial:a}},function(r,t,n){"use strict";r.exports=n(102)},function(r,t,n){"use strict";function o(r,t){r&&(this.kdtree=t.kdtree,this.k=t.k,this.classes=t.classes)}r.exports=o;var e=n(103).kdTree,i=n(28);o.prototype.train=function(r,t,n){void 0===n&&(n={}),void 0===n.distance&&(n.distance=i.distance.euclidean),void 0===n.k&&(n.k=r[0].length+1);for(var o=0,s=new Array(1e3),a=0,u=0;u<t.length;++u)-1===s.indexOf(t[u])&&(o++,s[a]=t[u],a++);var f=new Array(r.length);for(u=0;u<f.length;++u)f[u]=r[u].slice();for(this.features=r[0].length,u=0;u<t.length;++u)f[u].push(t[u]);var h=new Array(r[0].length);for(u=0;u<h.length;++u)h[u]=u;this.kdtree=new e(f,n.distance,h),this.k=n.k,this.classes=o},o.prototype.predict=function(r){for(var t=new Array(r.length),n=0;n<r.length;++n)t[n]=this.getSinglePrediction(r[n]);return t},o.prototype.getSinglePrediction=function(r){for(var t=this.kdtree.nearest(r,this.k),n=new Array(this.classes),o=-1,e=-1,i=t[0][0].length-1,s=0;s<n.length;++s)n[s]=0;for(s=0;s<t.length;++s){var a=t[s][0][i],u=++n[a];u>e&&(o=a,e=u)}return o},o.load=function(r){if("KNN"!==r.modelName)throw new RangeError("The given model is invalid!");return new o(!0,r)},o.prototype["export"]=function(){return{modelName:"KNN",kdtree:this.kdtree,k:this.k,classes:this.classes}}},function(r,t){"use strict";/**
	* k-d Tree JavaScript - V 1.01
	*
	* https://github.com/ubilabs/kd-tree-javascript
	*
	* @author Mircea Pricop <pricop@ubilabs.net>, 2012
	* @author Martin Kleppe <kleppe@ubilabs.net>, 2012
	* @author Ubilabs http://ubilabs.net, 2012
	* @license MIT License <http://www.opensource.org/licenses/mit-license.php>
	*/
function n(r,t,n){this.obj=r,this.left=null,this.right=null,this.parent=n,this.dimension=t}function o(r,t,o){function i(r,t,e){var s,a,u=t%o.length;return 0===r.length?null:1===r.length?new n(r[0],u,e):(r.sort(function(r,t){return r[o[u]]-t[o[u]]}),s=Math.floor(r.length/2),a=new n(r[s],u,e),a.left=i(r.slice(0,s),t+1,a),a.right=i(r.slice(s+1),t+1,a),a)}function s(r){function t(r){r.left&&(r.left.parent=r,t(r.left)),r.right&&(r.right.parent=r,t(r.right))}a.root=r,t(a.root)}var a=this;Array.isArray(r)?this.root=i(r,0,null):s(r,t,o),this.toJSON=function(r){r||(r=this.root);var t=new n(r.obj,r.dimension,null);return r.left&&(t.left=a.toJSON(r.left)),r.right&&(t.right=a.toJSON(r.right)),t},this.insert=function(r){function t(n,e){if(null===n)return e;var i=o[n.dimension];return r[i]<n.obj[i]?t(n.left,n):t(n.right,n)}var e,i,s=t(this.root,null);return null===s?void(this.root=new n(r,0,null)):(e=new n(r,(s.dimension+1)%o.length,s),i=o[s.dimension],void(r[i]<s.obj[i]?s.left=e:s.right=e))},this.remove=function(r){function t(n){if(null===n)return null;if(n.obj===r)return n;var e=o[n.dimension];return r[e]<n.obj[e]?t(n.left,n):t(n.right,n)}function n(r){function t(r,n){var e,i,s,a,u;return null===r?null:(e=o[n],r.dimension===n?null!==r.left?t(r.left,n):r:(i=r.obj[e],s=t(r.left,n),a=t(r.right,n),u=r,null!==s&&s.obj[e]<i&&(u=s),null!==a&&a.obj[e]<u.obj[e]&&(u=a),u))}var e,i,s;return null===r.left&&null===r.right?null===r.parent?void(a.root=null):(s=o[r.parent.dimension],void(r.obj[s]<r.parent.obj[s]?r.parent.left=null:r.parent.right=null)):void(null!==r.right?(e=t(r.right,r.dimension),i=e.obj,n(e),r.obj=i):(e=t(r.left,r.dimension),i=e.obj,n(e),r.right=r.left,r.left=null,r.obj=i))}var e;e=t(a.root),null!==e&&n(e)},this.nearest=function(r,n,i){function s(e){function i(r,t){h.push([r,t]),h.size()>n&&h.pop()}var a,u,f,c,l=o[e.dimension],m=t(r,e.obj),p={};for(c=0;c<o.length;c+=1)c===e.dimension?p[o[c]]=r[o[c]]:p[o[c]]=e.obj[o[c]];return u=t(p,e.obj),null===e.right&&null===e.left?void((h.size()<n||m<h.peek()[1])&&i(e,m)):(a=null===e.right?e.left:null===e.left?e.right:r[l]<e.obj[l]?e.left:e.right,s(a),(h.size()<n||m<h.peek()[1])&&i(e,m),void((h.size()<n||Math.abs(u)<h.peek()[1])&&(f=a===e.left?e.right:e.left,null!==f&&s(f))))}var u,f,h;if(h=new e(function(r){return-r[1]}),i)for(u=0;n>u;u+=1)h.push([null,i]);for(a.root&&s(a.root),f=[],u=0;u<Math.min(n,h.content.length);u+=1)h.content[u][0]&&f.push([h.content[u][0].obj,h.content[u][1]]);return f},this.balanceFactor=function(){function r(t){return null===t?0:Math.max(r(t.left),r(t.right))+1}function t(r){return null===r?0:t(r.left)+t(r.right)+1}return r(a.root)/(Math.log(t(a.root))/Math.log(2))}}function e(r){this.content=[],this.scoreFunction=r}e.prototype={push:function(r){this.content.push(r),this.bubbleUp(this.content.length-1)},pop:function(){var r=this.content[0],t=this.content.pop();return this.content.length>0&&(this.content[0]=t,this.sinkDown(0)),r},peek:function(){return this.content[0]},remove:function(r){for(var t=this.content.length,n=0;t>n;n++)if(this.content[n]==r){var o=this.content.pop();return void(n!=t-1&&(this.content[n]=o,this.scoreFunction(o)<this.scoreFunction(r)?this.bubbleUp(n):this.sinkDown(n)))}throw new Error("Node not found.")},size:function(){return this.content.length},bubbleUp:function(r){for(var t=this.content[r];r>0;){var n=Math.floor((r+1)/2)-1,o=this.content[n];if(!(this.scoreFunction(t)<this.scoreFunction(o)))break;this.content[n]=t,this.content[r]=o,r=n}},sinkDown:function(r){for(var t=this.content.length,n=this.content[r],o=this.scoreFunction(n);;){var e=2*(r+1),i=e-1,s=null;if(t>i){var a=this.content[i],u=this.scoreFunction(a);o>u&&(s=i)}if(t>e){var f=this.content[e],h=this.scoreFunction(f);(null==s?o:u)>h&&(s=e)}if(null==s)break;this.content[r]=this.content[s],this.content[s]=n,r=s}}},this.kdTree=o,t.kdTree=o,t.BinaryHeap=e},function(r,t,n){r.exports=t=n(105).NaiveBayes,t.separateClasses=n(105).separateClasses},function(r,t,n){"use strict";function o(r,t){r&&(this.means=t.means,this.calculateProbabilities=t.calculateProbabilities)}function e(r,t,n){for(var o=0,e=-1,s=0;s<n.length;++s){for(var a=n[s][0],u=1;u<n[0][1].length+1;++u)a+=i(r[u-1],t[s][u-1],n[s][u][0],n[s][u][1]);a=Math.exp(a),a>o&&(o=a,e=s)}return e}function i(r,t,n,o){var r=r-t;return Math.log(n*Math.exp(r*r/o))}function s(r,t){for(var n=r.columns,o=0,e=new Array(100),i=0;i<t.length;i++)void 0===e[t[i]]&&(e[t[i]]=0,o++),e[t[i]]++;var s=new Array(o),u=new Array(o);for(i=0;o>i;++i)s[i]=new a(e[i],n),u[i]=0;for(i=0;i<r.rows;++i)s[t[i]].setRow(u[t[i]],r.getRow(i)),u[t[i]]++;return s}var a=n(106),u=n(5);r.exports.NaiveBayes=o,r.exports.separateClasses=s,o.prototype.train=function(r,t){var n=Math.sqrt(2*Math.PI);if(a.isMatrix(r))o=r.clone();else var o=a(r);if(o.rows!==t.length)throw new RangeError("the size of the training set and the training labels must be the same.");var e=s(r,t),i=new Array(e.length);this.means=new Array(e.length);for(var f=0;f<e.length;++f){var h=u.matrix.mean(e[f]),c=u.matrix.standardDeviation(e[f],h),l=Math.log(e[f].rows/o.rows);i[f]=new Array(h.length+1),i[f][0]=l;for(var m=1;m<h.length+1;++m){var p=c[m-1];i[f][m]=[1/(n*p),-2*p*p]}this.means[f]=h}this.calculateProbabilities=i},o.prototype.predict=function(r){if(r[0].length===this.calculateProbabilities[0].length)throw new RangeError("the dataset must have the same features as the training set");for(var t=new Array(r.length),n=0;n<t.length;++n)t[n]=e(r[n],this.means,this.calculateProbabilities);return t},o.prototype["export"]=function(){return{modelName:"NaiveBayes",means:this.means,calculateProbabilities:this.calculateProbabilities}},o.load=function(r){if("NaiveBayes"!==r.modelName)throw new RangeError("The given model is invalid!");return new o(!0,r)}},function(r,t,n){"use strict";r.exports=n(107),r.exports.Decompositions=r.exports.DC=n(108)},function(r,t){"use strict";function n(r){for(var t=0,n=r.length,o=new Array(n);n>t;t++)o[t]=r[t];return o}function o(r,t){var e,i,s=0;if(Array.isArray(r)){if(i=t,e=i?n(r):r,r=e.length,t=e[0].length,"undefined"==typeof t)throw new TypeError("Data must be a 2D array");if(!(r>0&&t>0))throw new RangeError("Invalid dimensions: "+r+"x"+t);for(;r>s;s++){if(e[s].length!==t)throw new RangeError("Inconsistent array dimensions");i&&(e[s]=n(e[s]))}}else{if("number"!=typeof r)throw new TypeError("Invalid arguments");if(!(r>0&&t>0))throw new RangeError("Invalid dimensions: "+r+"x"+t);for(e=new Array(r);r>s;s++)e[s]=new Array(t)}return Object.defineProperty(e,"rows",{writable:!0,value:r}),Object.defineProperty(e,"columns",{writable:!0,value:t}),e.__proto__=o.prototype,e}var e=Array.prototype.splice,i=Array.prototype.concat;o.from1DArray=function(r,t,n){var e,i,s=0;if(e=r*t,e!==n.length)throw new RangeError("Data length does not match given dimensions");for(i=new Array(r);r>s;s++)i[s]=n.slice(s*t,(s+1)*t);return new o(i)},o.rowVector=function(r){return new o([r])},o.columnVector=function(r){for(var t=r.length,n=new Array(t),e=0;t>e;e++)n[e]=[r[e]];return new o(n)},o.empty=function(r,t){return new o(r,t)},o.zeros=function(r,t){return o.empty(r,t).fill(0)},o.ones=function(r,t){return o.empty(r,t).fill(1)},o.rand=function(r,t){for(var n=o.empty(r,t),e=0,i=n.rows;i>e;e++)for(var s=0,a=n.columns;a>s;s++)n[e][s]=Math.random();return n},o.eye=function(r){for(var t=o.zeros(r,r),n=t.rows,e=0;n>e;e++)t[e][e]=1;return t},o.diag=function(r){for(var t=r.length,n=o.zeros(t,t),e=0;t>e;e++)n[e][e]=r[e];return n},o.indices=function(r,t){for(var n=new Array(t-r),o=0;o<n.length;o++)n[o]=r++;return n},o.stack=function(r){var t,n,e;if(o.isMatrix(r)){var i=0,s=0;for(t=0;t<arguments.length;t++)i+=arguments[t].rows,arguments[t].columns>s&&(s=arguments[t].columns);var a=o.zeros(i,s),u=0;for(t=0;t<arguments.length;t++){var f=arguments[t];for(n=0;n<f.rows;n++){for(e=0;e<f.columns;e++)a[u][e]=f[n][e];u++}}return a}if(Array.isArray(r)){var h=o.empty(arguments.length,r.length);for(t=0;t<arguments.length;t++)h.setRow(t,arguments[t]);return h}},o.expand=function(r,t){for(var n=[],e=0;e<t.length;e++)for(var i=0;i<t[e];i++)n.push(r[e]);return new o(n)},o.checkMatrix=function(r){if(!r)throw new TypeError("Argument has to be a matrix");return"Matrix"!==r.klass&&(r=new o(r)),r},o.isMatrix=function(r){return r?"Matrix"===r.klass:!1},Object.defineProperty(o.prototype,"klass",{get:function(){return"Matrix"}}),Object.defineProperty(o.prototype,"size",{get:function(){return this.rows*this.columns}}),o.prototype.checkRowIndex=function(r){if(0>r||r>this.rows-1)throw new RangeError("Row index out of range.")},o.prototype.checkColumnIndex=function(r){if(0>r||r>this.columns-1)throw new RangeError("Column index out of range.")},o.prototype.checkDimensions=function(r){if(this.rows!==r.rows||this.columns!==r.columns)throw new RangeError("Matrices dimensions must be equal.")},o.prototype.apply=function(r){for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)r.call(this,o,e);return this},o.prototype.clone=function(){return new o(this.to2DArray())},o.prototype.to1DArray=function(){return i.apply([],this)},o.prototype.to2DArray=function(){for(var r=this.rows,t=new Array(r),o=0;r>o;o++)t[o]=n(this[o]);return t},o.prototype.isRowVector=function(){return 1===this.rows},o.prototype.isColumnVector=function(){return 1===this.columns},o.prototype.isVector=function(){return 1===this.rows||1===this.columns},o.prototype.isSquare=function(){return this.rows===this.columns},o.prototype.isSymmetric=function(){if(this.isSquare()){for(var r=this.rows,t=0;r>t;t++)for(var n=0;t>=n;n++)if(this[t][n]!==this[n][t])return!1;return!0}return!1},o.prototype.set=function(r,t,n){return this[r][t]=n,this},o.prototype.get=function(r,t){return this[r][t]},o.prototype.fill=function(r){for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]=r;return this},o.prototype.neg=function(){return this.mulS(-1)},o.prototype.add=function(r){return"number"==typeof r?this.addS(r):(r=o.checkMatrix(r),this.addM(r))},o.prototype.addS=function(r){for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]+=r;return this},o.prototype.addM=function(r){this.checkDimensions(r);for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]+=r[o][e];return this},o.prototype.sub=function(r){return"number"==typeof r?this.subS(r):(r=o.checkMatrix(r),this.subM(r))},o.prototype.subS=function(r){for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]-=r;return this},o.prototype.subM=function(r){this.checkDimensions(r);for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]-=r[o][e];return this},o.prototype.mul=function(r){return"number"==typeof r?this.mulS(r):(r=o.checkMatrix(r),this.mulM(r))},o.prototype.mulS=function(r){for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]*=r;return this},o.prototype.mulM=function(r){this.checkDimensions(r);for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]*=r[o][e];return this},o.prototype.div=function(r){return"number"==typeof r?this.divS(r):(r=o.checkMatrix(r),this.divM(r))},o.prototype.divS=function(r){for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]/=r;return this},o.prototype.divM=function(r){this.checkDimensions(r);for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]/=r[o][e];return this},o.prototype.getRow=function(r){return this.checkRowIndex(r),n(this[r])},o.prototype.getRowVector=function(r){return o.rowVector(this.getRow(r))},o.prototype.setRow=function(r,t){if(this.checkRowIndex(r),o.isMatrix(t)&&(t=t.to1DArray()),t.length!==this.columns)throw new RangeError("Invalid row size");return this[r]=n(t),this},o.prototype.removeRow=function(r){if(this.checkRowIndex(r),1===this.rows)throw new RangeError("A matrix cannot have less than one row");return e.call(this,r,1),this.rows-=1,this},o.prototype.addRow=function(r,t){if("undefined"==typeof t&&(t=r,r=this.rows),0>r||r>this.rows)throw new RangeError("Row index out of range.");if(o.isMatrix(t)&&(t=t.to1DArray()),t.length!==this.columns)throw new RangeError("Invalid row size");return e.call(this,r,0,n(t)),this.rows+=1,this},o.prototype.swapRows=function(r,t){this.checkRowIndex(r),this.checkRowIndex(t);var n=this[r];return this[r]=this[t],this[t]=n,this},o.prototype.getColumn=function(r){this.checkColumnIndex(r);for(var t=this.rows,n=new Array(t),o=0;t>o;o++)n[o]=this[o][r];return n},o.prototype.getColumnVector=function(r){return o.columnVector(this.getColumn(r))},o.prototype.setColumn=function(r,t){this.checkColumnIndex(r),o.isMatrix(t)&&(t=t.to1DArray());var n=this.rows;if(t.length!==n)throw new RangeError("Invalid column size");for(var e=0;n>e;e++)this[e][r]=t[e];return this},o.prototype.removeColumn=function(r){if(this.checkColumnIndex(r),1===this.columns)throw new RangeError("A matrix cannot have less than one column");for(var t=0,n=this.rows;n>t;t++)this[t].splice(r,1);return this.columns-=1,this},o.prototype.addColumn=function(r,t){if("undefined"==typeof t&&(t=r,r=this.columns),0>r||r>this.columns)throw new RangeError("Column index out of range.");o.isMatrix(t)&&(t=t.to1DArray());var n=this.rows;if(t.length!==n)throw new RangeError("Invalid column size");for(var e=0;n>e;e++)this[e].splice(r,0,t[e]);return this.columns+=1,this},o.prototype.swapColumns=function(r,t){this.checkRowIndex(r),this.checkRowIndex(t);for(var n,o,e=this.rows,i=0;e>i;i++)o=this[i],n=o[r],o[r]=o[t],o[t]=n;return this},o.prototype.checkRowVector=function(r){if(o.isMatrix(r)&&(r=r.to1DArray()),r.length!==this.columns)throw new RangeError("vector size must be the same as the number of columns");return r},o.prototype.checkColumnVector=function(r){if(o.isMatrix(r)&&(r=r.to1DArray()),r.length!==this.rows)throw new RangeError("vector size must be the same as the number of rows");return r},o.prototype.addRowVector=function(r){r=this.checkRowVector(r);for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]+=r[e];return this},o.prototype.subRowVector=function(r){r=this.checkRowVector(r);for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]-=r[e];return this},o.prototype.mulRowVector=function(r){r=this.checkRowVector(r);for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]*=r[e];return this},o.prototype.divRowVector=function(r){r=this.checkRowVector(r);for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]/=r[e];return this},o.prototype.addColumnVector=function(r){r=this.checkColumnVector(r);for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]+=r[o];return this},o.prototype.subColumnVector=function(r){r=this.checkColumnVector(r);for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]-=r[o];return this},o.prototype.mulColumnVector=function(r){r=this.checkColumnVector(r);for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]*=r[o];return this},o.prototype.divColumnVector=function(r){r=this.checkColumnVector(r);for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]/=r[o];return this},o.prototype.mulRow=function(r,t){this.checkRowIndex(r);for(var n=0,o=this.columns;o>n;n++)this[r][n]*=t;return this},o.prototype.mulColumn=function(r,t){this.checkColumnIndex(r);for(var n=0,o=this.rows;o>n;n++)this[n][r]*=t},o.prototype.max=function(){for(var r=-(1/0),t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]>r&&(r=this[o][e]);return r},o.prototype.maxIndex=function(){for(var r=-(1/0),t={},n=this.rows,o=this.columns,e=0;n>e;e++)for(var i=0;o>i;i++)this[e][i]>r&&(r=this[e][i],t.row=e,t.column=i);return t},o.prototype.min=function(){for(var r=1/0,t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]<r&&(r=this[o][e]);return r},o.prototype.minIndex=function(){for(var r=1/0,t={},n=this.rows,o=this.columns,e=0;n>e;e++)for(var i=0;o>i;i++)this[e][i]<r&&(r=this[e][i],t.row=e,t.column=i);return t},o.prototype.maxRow=function(r){this.checkRowIndex(r);for(var t=-(1/0),n=0,o=this.columns;o>n;n++)this[r][n]>t&&(t=this[r][n]);return t},o.prototype.maxRowIndex=function(r){this.checkRowIndex(r);for(var t=-(1/0),n={row:r},o=0,e=this.columns;e>o;o++)this[r][o]>t&&(t=this[r][o],n.column=o);return n},o.prototype.minRow=function(r){this.checkRowIndex(r);for(var t=1/0,n=0,o=this.columns;o>n;n++)this[r][n]<t&&(t=this[r][n]);return t},o.prototype.minRowIndex=function(r){this.checkRowIndex(r);for(var t=1/0,n={row:r,column:0},o=0,e=this.columns;e>o;o++)this[r][o]<t&&(t=this[r][o],n.column=o);return n},o.prototype.maxColumn=function(r){this.checkColumnIndex(r);for(var t=-(1/0),n=0,o=this.rows;o>n;n++)this[n][r]>t&&(t=this[n][r]);return t},o.prototype.maxColumnIndex=function(r){this.checkColumnIndex(r);for(var t=-(1/0),n={row:0,column:r},o=0,e=this.rows;e>o;o++)this[o][r]>t&&(t=this[o][r],n.row=o);return n},o.prototype.minColumn=function(r){this.checkColumnIndex(r);for(var t=1/0,n=0,o=this.rows;o>n;n++)this[n][r]<t&&(t=this[n][r]);return t},o.prototype.minColumnIndex=function(r){this.checkColumnIndex(r);for(var t=1/0,n={row:0,column:r},o=0,e=this.rows;e>o;o++)this[o][r]<t&&(t=this[o][r],n.row=o);return n},o.prototype.diag=function s(){if(!this.isSquare())throw new TypeError("Only square matrices have a diagonal.");for(var s=new Array(this.rows),r=0,t=this.rows;t>r;r++)s[r]=this[r][r];return s},o.prototype.sum=function(){for(var r=0,t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)r+=this[o][e];return r},o.prototype.mean=function(){return this.sum()/this.size},o.prototype.prod=function a(){for(var a=1,r=this.rows,t=this.columns,n=0;r>n;n++)for(var o=0;t>o;o++)a*=this[n][o];return a},o.prototype.cumulativeSum=function(){for(var r=0,t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)r+=this[o][e],this[o][e]=r;return this},o.prototype.dot=function u(r){if(this.size!==r.size)throw new RangeError("vectors do not have the same size");for(var t=this.to1DArray(),n=r.to1DArray(),u=0,o=t.length,e=0;o>e;e++)u+=t[e]*n[e];return u},o.prototype.mmul=function(r){if(!o.isMatrix(r))throw new TypeError('parameter "other" must be a matrix');this.columns!==r.rows&&console.warn("Number of columns of left matrix are not equal to number of rows of right matrix.");var t,n,e,i=this.rows,s=this.columns,a=r.columns,u=new o(i,a),f=new Array(s);for(n=0;a>n;n++){for(e=0;s>e;e++)f[e]=r[e][n];for(t=0;i>t;t++){var h=this[t],c=0;for(e=0;s>e;e++)c+=h[e]*f[e];u[t][n]=c}}return u},o.prototype.sortRows=function(r){for(var t=0,n=this.rows;n>t;t++)this[t].sort(r);return this},o.prototype.sortColumns=function(r){for(var t=0,n=this.columns;n>t;t++)this.setColumn(t,this.getColumn(t).sort(r));return this},o.prototype.transpose=function(){for(var r=new o(this.columns,this.rows),t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)r[i][e]=this[e][i];return r},o.prototype.subMatrix=function(r,t,n,e){if(r>t||n>e||0>r||r>=this.rows||0>t||t>=this.rows||0>n||n>=this.columns||0>e||e>=this.columns)throw new RangeError("Argument out of range");for(var i=new o(t-r+1,e-n+1),s=r;t>=s;s++)for(var a=n;e>=a;a++)i[s-r][a-n]=this[s][a];return i},o.prototype.subMatrixRow=function(r,t,n){if("undefined"==typeof t?(t=0,n=this.columns-1):"undefined"==typeof n&&(n=this.columns-1),t>n||0>t||t>=this.columns||0>n||n>=this.columns)throw new RangeError("Argument out of range.");for(var e=r.length,i=this.rows,s=new o(e,n-t+1),a=0;e>a;a++)for(var u=t;n>=u;u++){if(r[a]<0||r[a]>=i)throw new RangeError("Argument out of range.");s[a][u-t]=this[r[a]][u]}return s},o.prototype.subMatrixColumn=function(r,t,n){if("undefined"==typeof t?(t=0,n=this.rows-1):"undefined"==typeof n&&(n=this.rows-1),t>n||0>t||t>=this.rows||0>n||n>=this.rows)throw new RangeError("Argument out of range.");for(var e=r.length,i=this.columns,s=new o(n-t+1,e),a=0;e>a;a++)for(var u=t;n>=u;u++){if(r[a]<0||r[a]>=i)throw new RangeError("Argument out of range.");s[u-t][a]=this[u][r[a]]}return s},o.prototype.trace=function f(){if(!this.isSquare())throw new TypeError("The matrix is not square");for(var f=0,r=0,t=this.rows;t>r;r++)f+=this[r][r];return f},o.prototype.abs=function(){for(var r=this.rows,t=this.columns,n=0;r>n;n++)for(var o=0;t>o;o++)this[n][o]=Math.abs(this[n][o])},r.exports=o},function(r,t,n){"use strict";function o(r){return e(r,i.eye(r.rows))}function e(r,t){return r.isSquare()?new u(r).solve(t):new f(r).solve(t)}var i=n(107),s=n(109),a=n(111),u=n(112),f=n(113),h=n(114);i.prototype.inverse=function(){return o(this)},i.prototype.solve=function(r){return e(this,r)},r.exports={SingularValueDecomposition:s,SVD:s,EigenvalueDecomposition:a,EVD:a,LuDecomposition:u,LU:u,QrDecomposition:f,QR:f,CholeskyDecomposition:h,CHO:h,inverse:o,solve:e}},function(r,t,n){"use strict";function o(r,t){if(!(this instanceof o))return new o(r,t);r=e.checkMatrix(r),t=t||{};var n=r.clone(),s=r.rows,a=r.columns,u=Math.min(s,a),f=!0,h=!0;t.computeLeftSingularVectors===!1&&(f=!1),t.computeRightSingularVectors===!1&&(h=!1);var c=t.autoTranspose===!0,l=!1;if(a>s)if(c){n=n.transpose(),s=n.rows,a=n.columns,l=!0;var m=f;f=h,h=m}else console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");var p,w,v,g,y,d,b,x,M,k,R,A,j,S,V,E,C,D,I,O,q,z=new Array(Math.min(s+1,a)),T=e.zeros(s,u),U=e.zeros(a,a),L=new Array(a),_=new Array(s),N=Math.min(s-1,a),P=Math.max(0,Math.min(a-2,s));for(v=0,k=Math.max(N,P);k>v;v++){if(N>v){for(z[v]=0,p=v;s>p;p++)z[v]=i(z[v],n[p][v]);if(0!==z[v]){for(n[v][v]<0&&(z[v]=-z[v]),p=v;s>p;p++)n[p][v]/=z[v];n[v][v]+=1}z[v]=-z[v]}for(w=v+1;a>w;w++){if(N>v&&0!==z[v]){for(y=0,p=v;s>p;p++)y+=n[p][v]*n[p][w];for(y=-y/n[v][v],p=v;s>p;p++)n[p][w]+=y*n[p][v]}L[w]=n[v][w]}if(f&&N>v)for(p=v;s>p;p++)T[p][v]=n[p][v];if(P>v){for(L[v]=0,p=v+1;a>p;p++)L[v]=i(L[v],L[p]);if(0!==L[v]){for(L[v+1]<0&&(L[v]=-L[v]),p=v+1;a>p;p++)L[p]/=L[v];L[v+1]+=1}if(L[v]=-L[v],s>v+1&&0!==L[v]){for(p=v+1;s>p;p++)_[p]=0;for(w=v+1;a>w;w++)for(p=v+1;s>p;p++)_[p]+=L[w]*n[p][w];for(w=v+1;a>w;w++)for(y=-L[w]/L[v+1],p=v+1;s>p;p++)n[p][w]+=y*_[p]}if(h)for(p=v+1;a>p;p++)U[p][v]=L[p]}}if(g=Math.min(a,s+1),a>N&&(z[N]=n[N][N]),g>s&&(z[g-1]=0),g>P+1&&(L[P]=n[P][g-1]),L[g-1]=0,f){for(w=N;u>w;w++){for(p=0;s>p;p++)T[p][w]=0;T[w][w]=1}for(v=N-1;v>=0;v--)if(0!==z[v]){for(w=v+1;u>w;w++){for(y=0,p=v;s>p;p++)y+=T[p][v]*T[p][w];for(y=-y/T[v][v],p=v;s>p;p++)T[p][w]+=y*T[p][v]}for(p=v;s>p;p++)T[p][v]=-T[p][v];for(T[v][v]=1+T[v][v],p=0;v-1>p;p++)T[p][v]=0}else{for(p=0;s>p;p++)T[p][v]=0;T[v][v]=1}}if(h)for(v=a-1;v>=0;v--){if(P>v&&0!==L[v])for(w=v+1;a>w;w++){for(y=0,p=v+1;a>p;p++)y+=U[p][v]*U[p][w];for(y=-y/U[v+1][v],p=v+1;a>p;p++)U[p][w]+=y*U[p][v]}for(p=0;a>p;p++)U[p][v]=0;U[v][v]=1}for(var F=g-1,Q=0,B=Math.pow(2,-52);g>0;){for(v=g-2;v>=-1&&-1!==v;v--)if(Math.abs(L[v])<=B*(Math.abs(z[v])+Math.abs(z[v+1]))){L[v]=0;break}if(v===g-2)R=4;else{for(d=g-1;d>=v&&d!==v;d--)if(y=(d!==g?Math.abs(L[d]):0)+(d!==v+1?Math.abs(L[d-1]):0),Math.abs(z[d])<=B*y){z[d]=0;break}d===v?R=3:d===g-1?R=1:(R=2,v=d)}switch(v++,R){case 1:for(b=L[g-2],L[g-2]=0,w=g-2;w>=v;w--)if(y=i(z[w],b),x=z[w]/y,M=b/y,z[w]=y,w!==v&&(b=-M*L[w-1],L[w-1]=x*L[w-1]),h)for(p=0;a>p;p++)y=x*U[p][w]+M*U[p][g-1],U[p][g-1]=-M*U[p][w]+x*U[p][g-1],U[p][w]=y;break;case 2:for(b=L[v-1],L[v-1]=0,w=v;g>w;w++)if(y=i(z[w],b),x=z[w]/y,M=b/y,z[w]=y,b=-M*L[w],L[w]=x*L[w],f)for(p=0;s>p;p++)y=x*T[p][w]+M*T[p][v-1],T[p][v-1]=-M*T[p][w]+x*T[p][v-1],T[p][w]=y;break;case 3:for(A=Math.max(Math.max(Math.max(Math.max(Math.abs(z[g-1]),Math.abs(z[g-2])),Math.abs(L[g-2])),Math.abs(z[v])),Math.abs(L[v])),j=z[g-1]/A,S=z[g-2]/A,V=L[g-2]/A,E=z[v]/A,C=L[v]/A,D=((S+j)*(S-j)+V*V)/2,I=j*V*(j*V),O=0,(0!==D||0!==I)&&(O=Math.sqrt(D*D+I),0>D&&(O=-O),O=I/(D+O)),b=(E+j)*(E-j)+O,q=E*C,w=v;g-1>w;w++){if(y=i(b,q),x=b/y,M=q/y,w!==v&&(L[w-1]=y),b=x*z[w]+M*L[w],L[w]=x*L[w]-M*z[w],q=M*z[w+1],z[w+1]=x*z[w+1],h)for(p=0;a>p;p++)y=x*U[p][w]+M*U[p][w+1],U[p][w+1]=-M*U[p][w]+x*U[p][w+1],U[p][w]=y;if(y=i(b,q),x=b/y,M=q/y,z[w]=y,b=x*L[w]+M*z[w+1],z[w+1]=-M*L[w]+x*z[w+1],q=M*L[w+1],L[w+1]=x*L[w+1],f&&s-1>w)for(p=0;s>p;p++)y=x*T[p][w]+M*T[p][w+1],T[p][w+1]=-M*T[p][w]+x*T[p][w+1],T[p][w]=y}L[g-2]=b,Q+=1;break;case 4:if(z[v]<=0&&(z[v]=z[v]<0?-z[v]:0,h))for(p=0;F>=p;p++)U[p][v]=-U[p][v];for(;F>v&&!(z[v]>=z[v+1]);){if(y=z[v],z[v]=z[v+1],z[v+1]=y,h&&a-1>v)for(p=0;a>p;p++)y=U[p][v+1],U[p][v+1]=U[p][v],U[p][v]=y;if(f&&s-1>v)for(p=0;s>p;p++)y=T[p][v+1],T[p][v+1]=T[p][v],T[p][v]=y;v++}Q=0,g--}}if(l){var X=U;U=T,T=X}this.m=s,this.n=a,this.s=z,this.U=T,this.V=U}var e=n(107),i=n(110).hypotenuse;o.prototype={get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]},get norm2(){return this.s[0]},get rank(){for(var r=Math.pow(2,-52),t=Math.max(this.m,this.n)*this.s[0]*r,n=0,o=this.s,e=0,i=o.length;i>e;e++)o[e]>t&&n++;return n},get diagonal(){return this.s},get threshold(){return Math.pow(2,-52)/2*Math.max(this.m,this.n)*this.s[0]},get leftSingularVectors(){return this.U},get rightSingularVectors(){return this.V},get diagonalMatrix(){return e.diag(this.s)},solve:function(r){var t,n=r,o=this.threshold,i=this.s.length,s=e.zeros(i,i);for(t=0;i>t;t++)Math.abs(this.s[t])<=o?s[t][t]=0:s[t][t]=1/this.s[t];var a,u,f,h=this.V.mmul(s),c=this.V.rows,l=this.U.rows,m=e.zeros(c,l);for(t=0;c>t;t++)for(a=0;l>a;a++){for(f=0,u=0;i>u;u++)f+=h[t][u]*this.U[a][u];m[t][a]=f}return m.mmul(n)},solveForDiagonal:function(r){return this.solve(e.diag(r))},inverse:function(){var r,t,n=this.threshold,o=this.V.rows,i=this.V.columns,s=new e(o,this.s.length);for(r=0;o>r;r++)for(t=0;i>t;t++)Math.abs(this.s[t])>n?s[r][t]=this.V[r][t]/this.s[t]:s[r][t]=0;var a,u,f=this.U.rows,h=this.U.columns,c=new e(o,f);for(r=0;o>r;r++)for(t=0;f>t;t++){for(u=0,a=0;h>a;a++)u+=s[r][a]*this.U[t][a];c[r][t]=u}return c}},r.exports=o},function(r,t){"use strict";t.hypotenuse=function(r,t){var n;return Math.abs(r)>Math.abs(t)?(n=t/r,Math.abs(r)*Math.sqrt(1+n*n)):0!==t?(n=r/t,Math.abs(t)*Math.sqrt(1+n*n)):0}},function(r,t,n){"use strict";function o(r){if(!(this instanceof o))return new o(r);if(r=f.checkMatrix(r),!r.isSquare())throw new Error("Matrix is not a square matrix");var t,n,u=r.columns,h=f.zeros(u,u),c=new Array(u),l=new Array(u),m=r;if(r.isSymmetric()){for(t=0;u>t;t++)for(n=0;u>n;n++)h[t][n]=m[t][n];e(u,l,c,h),i(u,l,c,h)}else{var p=f.zeros(u,u),w=new Array(u);for(n=0;u>n;n++)for(t=0;u>t;t++)p[t][n]=m[t][n];s(u,p,w,h),a(u,l,c,h,p)}this.n=u,this.e=l,this.d=c,this.V=h}function e(r,t,n,o){var e,i,s,a,u,f,h,c;for(u=0;r>u;u++)n[u]=o[r-1][u];for(a=r-1;a>0;a--){for(c=0,s=0,f=0;a>f;f++)c+=Math.abs(n[f]);if(0===c)for(t[a]=n[a-1],u=0;a>u;u++)n[u]=o[a-1][u],o[a][u]=0,o[u][a]=0;else{for(f=0;a>f;f++)n[f]/=c,s+=n[f]*n[f];for(e=n[a-1],i=Math.sqrt(s),e>0&&(i=-i),t[a]=c*i,s-=e*i,n[a-1]=e-i,u=0;a>u;u++)t[u]=0;for(u=0;a>u;u++){for(e=n[u],o[u][a]=e,i=t[u]+o[u][u]*e,f=u+1;a-1>=f;f++)i+=o[f][u]*n[f],t[f]+=o[f][u]*e;t[u]=i}for(e=0,u=0;a>u;u++)t[u]/=s,e+=t[u]*n[u];for(h=e/(s+s),u=0;a>u;u++)t[u]-=h*n[u];for(u=0;a>u;u++){for(e=n[u],i=t[u],f=u;a-1>=f;f++)o[f][u]-=e*t[f]+i*n[f];n[u]=o[a-1][u],o[a][u]=0}}n[a]=s}for(a=0;r-1>a;a++){if(o[r-1][a]=o[a][a],o[a][a]=1,s=n[a+1],0!==s){for(f=0;a>=f;f++)n[f]=o[f][a+1]/s;for(u=0;a>=u;u++){for(i=0,f=0;a>=f;f++)i+=o[f][a+1]*o[f][u];for(f=0;a>=f;f++)o[f][u]-=i*n[f]}}for(f=0;a>=f;f++)o[f][a+1]=0}for(u=0;r>u;u++)n[u]=o[r-1][u],o[r-1][u]=0;o[r-1][r-1]=1,t[0]=0}function i(r,t,n,o){var e,i,s,a,u,f,c,l,m,p,w,v,g,y,d,b,x;for(s=1;r>s;s++)t[s-1]=t[s];t[r-1]=0;var M=0,k=0,R=Math.pow(2,-52);for(f=0;r>f;f++){for(k=Math.max(k,Math.abs(n[f])+Math.abs(t[f])),c=f;r>c&&!(Math.abs(t[c])<=R*k);)c++;if(c>f){x=0;do{for(x+=1,e=n[f],l=(n[f+1]-e)/(2*t[f]),m=h(l,1),0>l&&(m=-m),n[f]=t[f]/(l+m),n[f+1]=t[f]*(l+m),p=n[f+1],i=e-n[f],s=f+2;r>s;s++)n[s]-=i;for(M+=i,l=n[c],w=1,v=w,g=w,y=t[f+1],d=0,b=0,s=c-1;s>=f;s--)for(g=v,v=w,b=d,e=w*t[s],i=w*l,m=h(l,t[s]),t[s+1]=d*m,d=t[s]/m,w=l/m,l=w*n[s]-d*e,n[s+1]=i+d*(w*e+d*n[s]),u=0;r>u;u++)i=o[u][s+1],o[u][s+1]=d*o[u][s]+w*i,o[u][s]=w*o[u][s]-d*i;l=-d*b*g*y*t[f]/p,t[f]=d*l,n[f]=w*l}while(Math.abs(t[f])>R*k)}n[f]=n[f]+M,t[f]=0}for(s=0;r-1>s;s++){for(u=s,l=n[s],a=s+1;r>a;a++)n[a]<l&&(u=a,l=n[a]);if(u!==s)for(n[u]=n[s],n[s]=l,a=0;r>a;a++)l=o[a][s],o[a][s]=o[a][u],o[a][u]=l}}function s(r,t,n,o){var e,i,s,a,u,f,h,c=0,l=r-1;for(f=c+1;l-1>=f;f++){for(h=0,a=f;l>=a;a++)h+=Math.abs(t[a][f-1]);if(0!==h){for(s=0,a=l;a>=f;a--)n[a]=t[a][f-1]/h,s+=n[a]*n[a];for(i=Math.sqrt(s),n[f]>0&&(i=-i),s-=n[f]*i,n[f]=n[f]-i,u=f;r>u;u++){for(e=0,a=l;a>=f;a--)e+=n[a]*t[a][u];for(e/=s,a=f;l>=a;a++)t[a][u]-=e*n[a]}for(a=0;l>=a;a++){for(e=0,u=l;u>=f;u--)e+=n[u]*t[a][u];for(e/=s,u=f;l>=u;u++)t[a][u]-=e*n[u]}n[f]=h*n[f],t[f][f-1]=h*i}}for(a=0;r>a;a++)for(u=0;r>u;u++)o[a][u]=a===u?1:0;for(f=l-1;f>=c+1;f--)if(0!==t[f][f-1]){for(a=f+1;l>=a;a++)n[a]=t[a][f-1];for(u=f;l>=u;u++){for(i=0,a=f;l>=a;a++)i+=n[a]*o[a][u];for(i=i/n[f]/t[f][f-1],a=f;l>=a;a++)o[a][u]+=i*n[a]}}}function a(r,t,n,o,e){var i,s,a,f,h,c,l,m,p,w,v,g,y,d,b,x=r-1,M=0,k=r-1,R=Math.pow(2,-52),A=0,j=0,S=0,V=0,E=0,C=0,D=0,I=0;for(i=0;r>i;i++)for((M>i||i>k)&&(n[i]=e[i][i],t[i]=0),s=Math.max(i-1,0);r>s;s++)j+=Math.abs(e[i][s]);for(;x>=M;){for(f=x;f>M&&(C=Math.abs(e[f-1][f-1])+Math.abs(e[f][f]),0===C&&(C=j),!(Math.abs(e[f][f-1])<R*C));)f--;if(f===x)e[x][x]=e[x][x]+A,n[x]=e[x][x],t[x]=0,x--,I=0;else if(f===x-1){if(l=e[x][x-1]*e[x-1][x],S=(e[x-1][x-1]-e[x][x])/2,V=S*S+l,D=Math.sqrt(Math.abs(V)),e[x][x]=e[x][x]+A,e[x-1][x-1]=e[x-1][x-1]+A,m=e[x][x],V>=0){for(D=S>=0?S+D:S-D,n[x-1]=m+D,n[x]=n[x-1],0!==D&&(n[x]=m-l/D),t[x-1]=0,t[x]=0,m=e[x][x-1],C=Math.abs(m)+Math.abs(D),S=m/C,V=D/C,E=Math.sqrt(S*S+V*V),S/=E,V/=E,s=x-1;r>s;s++)D=e[x-1][s],e[x-1][s]=V*D+S*e[x][s],e[x][s]=V*e[x][s]-S*D;for(i=0;x>=i;i++)D=e[i][x-1],e[i][x-1]=V*D+S*e[i][x],e[i][x]=V*e[i][x]-S*D;for(i=M;k>=i;i++)D=o[i][x-1],o[i][x-1]=V*D+S*o[i][x],o[i][x]=V*o[i][x]-S*D}else n[x-1]=m+S,n[x]=m+S,t[x-1]=D,t[x]=-D;x-=2,I=0}else{if(m=e[x][x],p=0,l=0,x>f&&(p=e[x-1][x-1],l=e[x][x-1]*e[x-1][x]),10===I){for(A+=m,i=M;x>=i;i++)e[i][i]-=m;C=Math.abs(e[x][x-1])+Math.abs(e[x-1][x-2]),m=p=.75*C,l=-.4375*C*C}if(30===I&&(C=(p-m)/2,C=C*C+l,C>0)){for(C=Math.sqrt(C),m>p&&(C=-C),C=m-l/((p-m)/2+C),i=M;x>=i;i++)e[i][i]-=C;A+=C,m=p=l=.964}for(I+=1,h=x-2;h>=f&&(D=e[h][h],E=m-D,C=p-D,S=(E*C-l)/e[h+1][h]+e[h][h+1],V=e[h+1][h+1]-D-E-C,E=e[h+2][h+1],C=Math.abs(S)+Math.abs(V)+Math.abs(E),S/=C,V/=C,E/=C,h!==f)&&!(Math.abs(e[h][h-1])*(Math.abs(V)+Math.abs(E))<R*(Math.abs(S)*(Math.abs(e[h-1][h-1])+Math.abs(D)+Math.abs(e[h+1][h+1]))));)h--;for(i=h+2;x>=i;i++)e[i][i-2]=0,i>h+2&&(e[i][i-3]=0);for(a=h;x-1>=a&&(d=a!==x-1,a!==h&&(S=e[a][a-1],V=e[a+1][a-1],E=d?e[a+2][a-1]:0,m=Math.abs(S)+Math.abs(V)+Math.abs(E),0!==m&&(S/=m,V/=m,E/=m)),0!==m);a++)if(C=Math.sqrt(S*S+V*V+E*E),0>S&&(C=-C),0!==C){for(a!==h?e[a][a-1]=-C*m:f!==h&&(e[a][a-1]=-e[a][a-1]),S+=C,m=S/C,p=V/C,D=E/C,V/=S,E/=S,s=a;r>s;s++)S=e[a][s]+V*e[a+1][s],d&&(S+=E*e[a+2][s],e[a+2][s]=e[a+2][s]-S*D),e[a][s]=e[a][s]-S*m,e[a+1][s]=e[a+1][s]-S*p;for(i=0;i<=Math.min(x,a+3);i++)S=m*e[i][a]+p*e[i][a+1],d&&(S+=D*e[i][a+2],e[i][a+2]=e[i][a+2]-S*E),e[i][a]=e[i][a]-S,e[i][a+1]=e[i][a+1]-S*V;for(i=M;k>=i;i++)S=m*o[i][a]+p*o[i][a+1],d&&(S+=D*o[i][a+2],o[i][a+2]=o[i][a+2]-S*E),o[i][a]=o[i][a]-S,o[i][a+1]=o[i][a+1]-S*V}}}if(0!==j){for(x=r-1;x>=0;x--)if(S=n[x],V=t[x],0===V)for(f=x,e[x][x]=1,i=x-1;i>=0;i--){for(l=e[i][i]-S,E=0,s=f;x>=s;s++)E+=e[i][s]*e[s][x];if(t[i]<0)D=l,C=E;else if(f=i,0===t[i]?e[i][x]=0!==l?-E/l:-E/(R*j):(m=e[i][i+1],p=e[i+1][i],V=(n[i]-S)*(n[i]-S)+t[i]*t[i],c=(m*C-D*E)/V,e[i][x]=c,e[i+1][x]=Math.abs(m)>Math.abs(D)?(-E-l*c)/m:(-C-p*c)/D),c=Math.abs(e[i][x]),R*c*c>1)for(s=i;x>=s;s++)e[s][x]=e[s][x]/c}else if(0>V)for(f=x-1,Math.abs(e[x][x-1])>Math.abs(e[x-1][x])?(e[x-1][x-1]=V/e[x][x-1],e[x-1][x]=-(e[x][x]-S)/e[x][x-1]):(b=u(0,-e[x-1][x],e[x-1][x-1]-S,V),e[x-1][x-1]=b[0],e[x-1][x]=b[1]),e[x][x-1]=0,e[x][x]=1,i=x-2;i>=0;i--){for(w=0,v=0,s=f;x>=s;s++)w+=e[i][s]*e[s][x-1],v+=e[i][s]*e[s][x];if(l=e[i][i]-S,t[i]<0)D=l,E=w,C=v;else if(f=i,0===t[i]?(b=u(-w,-v,l,V),e[i][x-1]=b[0],e[i][x]=b[1]):(m=e[i][i+1],p=e[i+1][i],g=(n[i]-S)*(n[i]-S)+t[i]*t[i]-V*V,y=2*(n[i]-S)*V,0===g&&0===y&&(g=R*j*(Math.abs(l)+Math.abs(V)+Math.abs(m)+Math.abs(p)+Math.abs(D))),
b=u(m*E-D*w+V*v,m*C-D*v-V*w,g,y),e[i][x-1]=b[0],e[i][x]=b[1],Math.abs(m)>Math.abs(D)+Math.abs(V)?(e[i+1][x-1]=(-w-l*e[i][x-1]+V*e[i][x])/m,e[i+1][x]=(-v-l*e[i][x]-V*e[i][x-1])/m):(b=u(-E-p*e[i][x-1],-C-p*e[i][x],D,V),e[i+1][x-1]=b[0],e[i+1][x]=b[1])),c=Math.max(Math.abs(e[i][x-1]),Math.abs(e[i][x])),R*c*c>1)for(s=i;x>=s;s++)e[s][x-1]=e[s][x-1]/c,e[s][x]=e[s][x]/c}for(i=0;r>i;i++)if(M>i||i>k)for(s=i;r>s;s++)o[i][s]=e[i][s];for(s=r-1;s>=M;s--)for(i=M;k>=i;i++){for(D=0,a=M;a<=Math.min(s,k);a++)D+=o[i][a]*e[a][s];o[i][s]=D}}}function u(r,t,n,o){var e,i;return Math.abs(n)>Math.abs(o)?(e=o/n,i=n+e*o,[(r+e*t)/i,(t-e*r)/i]):(e=n/o,i=o+e*n,[(e*r+t)/i,(e*t-r)/i])}var f=n(107),h=n(110).hypotenuse;o.prototype={get realEigenvalues(){return this.d},get imaginaryEigenvalues(){return this.e},get eigenvectorMatrix(){return this.V},get diagonalMatrix(){var r,t,n=this.n,o=this.e,e=this.d,i=new f(n,n);for(r=0;n>r;r++){for(t=0;n>t;t++)i[r][t]=0;i[r][r]=e[r],o[r]>0?i[r][r+1]=o[r]:o[r]<0&&(i[r][r-1]=o[r])}return i}},r.exports=o},function(r,t,n){"use strict";function o(r){if(!(this instanceof o))return new o(r);r=e.checkMatrix(r);var t,n,i,s,a,u,f,h,c,l,m=r.clone(),p=m.rows,w=m.columns,v=new Array(p),g=1;for(t=0;p>t;t++)v[t]=t;for(c=new Array(p),n=0;w>n;n++){for(t=0;p>t;t++)c[t]=m[t][n];for(t=0;p>t;t++){for(h=m[t],l=Math.min(t,n),a=0,i=0;l>i;i++)a+=h[i]*c[i];h[n]=c[t]-=a}for(s=n,t=n+1;p>t;t++)Math.abs(c[t])>Math.abs(c[s])&&(s=t);if(s!==n){for(i=0;w>i;i++)u=m[s][i],m[s][i]=m[n][i],m[n][i]=u;f=v[s],v[s]=v[n],v[n]=f,g=-g}if(p>n&&0!==m[n][n])for(t=n+1;p>t;t++)m[t][n]/=m[n][n]}this.LU=m,this.pivotVector=v,this.pivotSign=g}var e=n(107);o.prototype={isSingular:function(){for(var r=this.LU,t=r.columns,n=0;t>n;n++)if(0===r[n][n])return!0;return!1},get determinant(){var r=this.LU;if(!r.isSquare())throw new Error("Matrix must be square");for(var t=this.pivotSign,n=r.columns,o=0;n>o;o++)t*=r[o][o];return t},get lowerTriangularFactor(){for(var r=this.LU,t=r.rows,n=r.columns,o=new e(t,n),i=0;t>i;i++)for(var s=0;n>s;s++)i>s?o[i][s]=r[i][s]:i===s?o[i][s]=1:o[i][s]=0;return o},get upperTriangularFactor(){for(var r=this.LU,t=r.rows,n=r.columns,o=new e(t,n),i=0;t>i;i++)for(var s=0;n>s;s++)s>=i?o[i][s]=r[i][s]:o[i][s]=0;return o},get pivotPermutationVector(){return this.pivotVector.slice()},solve:function(r){r=e.checkMatrix(r);var t=this.LU,n=t.rows;if(n!==r.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");var o,i,s,a=r.columns,u=r.subMatrixRow(this.pivotVector,0,a-1),f=t.columns;for(s=0;f>s;s++)for(o=s+1;f>o;o++)for(i=0;a>i;i++)u[o][i]-=u[s][i]*t[o][s];for(s=f-1;s>=0;s--){for(i=0;a>i;i++)u[s][i]/=t[s][s];for(o=0;s>o;o++)for(i=0;a>i;i++)u[o][i]-=u[s][i]*t[o][s]}return u}},r.exports=o},function(r,t,n){"use strict";function o(r){if(!(this instanceof o))return new o(r);r=e.checkMatrix(r);var t,n,s,a,u=r.clone(),f=r.rows,h=r.columns,c=new Array(h);for(s=0;h>s;s++){var l=0;for(t=s;f>t;t++)l=i(l,u[t][s]);if(0!==l){for(u[s][s]<0&&(l=-l),t=s;f>t;t++)u[t][s]/=l;for(u[s][s]+=1,n=s+1;h>n;n++){for(a=0,t=s;f>t;t++)a+=u[t][s]*u[t][n];for(a=-a/u[s][s],t=s;f>t;t++)u[t][n]+=a*u[t][s]}}c[s]=-l}this.QR=u,this.Rdiag=c}var e=n(107),i=n(110).hypotenuse;o.prototype={solve:function(r){r=e.checkMatrix(r);var t=this.QR,n=t.rows;if(r.rows!==n)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");var o,i,s,a,u=r.columns,f=r.clone(),h=t.columns;for(s=0;h>s;s++)for(i=0;u>i;i++){for(a=0,o=s;n>o;o++)a+=t[o][s]*f[o][i];for(a=-a/t[s][s],o=s;n>o;o++)f[o][i]+=a*t[o][s]}for(s=h-1;s>=0;s--){for(i=0;u>i;i++)f[s][i]/=this.Rdiag[s];for(o=0;s>o;o++)for(i=0;u>i;i++)f[o][i]-=f[s][i]*t[o][s]}return f.subMatrix(0,h-1,0,u-1)},isFullRank:function(){for(var r=this.QR.columns,t=0;r>t;t++)if(0===this.Rdiag[t])return!1;return!0},get upperTriangularFactor(){var r,t,n=this.QR,o=n.columns,i=new e(o,o);for(r=0;o>r;r++)for(t=0;o>t;t++)t>r?i[r][t]=n[r][t]:r===t?i[r][t]=this.Rdiag[r]:i[r][t]=0;return i},get orthogonalFactor(){var r,t,n,o,i=this.QR,s=i.rows,a=i.columns,u=new e(s,a);for(n=a-1;n>=0;n--){for(r=0;s>r;r++)u[r][n]=0;for(u[n][n]=1,t=n;a>t;t++)if(0!==i[n][n]){for(o=0,r=n;s>r;r++)o+=i[r][n]*u[r][t];for(o=-o/i[n][n],r=n;s>r;r++)u[r][t]+=o*i[r][n]}}return u}},r.exports=o},function(r,t,n){"use strict";function o(r){if(!(this instanceof o))return new o(r);if(r=e.checkMatrix(r),!r.isSymmetric())throw new Error("Matrix is not symmetric");var t,n,i,s=r,a=s.rows,u=new e(a,a),f=!0;for(n=0;a>n;n++){var h=u[n],c=0;for(i=0;n>i;i++){var l=u[i],m=0;for(t=0;i>t;t++)m+=l[t]*h[t];h[i]=m=(s[n][i]-m)/u[i][i],c+=m*m}for(c=s[n][n]-c,f&=c>0,u[n][n]=Math.sqrt(Math.max(c,0)),i=n+1;a>i;i++)u[n][i]=0}if(!f)throw new Error("Matrix is not positive definite");this.L=u}var e=n(107);o.prototype={get leftTriangularFactor(){return this.L},solve:function(r){r=e.checkMatrix(r);var t=this.L,n=t.rows;if(r.rows!==n)throw new Error("Matrix dimensions do not match");var o,i,s,a=r.columns,u=r.clone();for(s=0;n>s;s++)for(i=0;a>i;i++){for(o=0;s>o;o++)u[s][i]-=u[o][i]*t[s][o];u[s][i]/=t[s][s]}for(s=n-1;s>=0;s--)for(i=0;a>i;i++){for(o=s+1;n>o;o++)u[s][i]-=u[o][i]*t[o][s];u[s][i]/=t[s][s]}return u}},r.exports=o},function(r,t,n){r.exports=t=n(116),t.Utils=n(126),t.OPLS=n(127)},function(r,t,n){"use strict";function o(r,t){for(var n=0,o=0;o<r.rows;o++)n+=r[o][t];return n}function e(r){for(var t=0,n=-(1/0),e=0;e<r.columns;++e){var i=o(r,e);i>n&&(n=i,t=e)}return t}function i(r,t){r&&(this.E=t.E,this.F=t.F,this.ssqYcal=t.ssqYcal,this.R2X=t.R2X,this.ymean=t.ymean,this.ystd=t.ystd,this.PBQ=t.PBQ,this.T=t.T,this.P=t.P,this.U=t.U,this.Q=t.Q,this.W=t.W,this.B=t.B)}r.exports=i;var s=n(117),a=n(126);i.prototype.train=function(r,t,n){void 0===n&&(n={});var o=n.latentVectors;if(void 0===o||isNaN(o))throw new RangeError("Latent vector must be a number.");var i=n.tolerance;if(void 0===i||isNaN(i))throw new RangeError("Tolerance must be a number");if(r.length!==t.length)throw new RangeError("The number of predictions and elements in the dataset must be the same");var u=a.featureNormalize(s(r,!0)).result,f=a.featureNormalize(s(t,!0));this.ymean=f.means.neg(),this.ystd=f.std;var h=f.result,c=u.rows,l=u.columns,m=h.rows,p=h.columns;if(c!=m)throw new RangeError("dataset cases is not the same as the predictions");var w=u.clone().mul(u).sum(),v=h.clone().mul(h).sum(),g=o,y=s.zeros(c,g),d=s.zeros(l,g),b=s.zeros(m,g),x=s.zeros(p,g),M=s.zeros(g,g),k=d.clone(),R=0;for(new Array(g);a.norm(h)>i&&g>R;){for(var A=u.transpose(),j=h.transpose(),S=e(u.clone().mulM(u)),V=e(h.clone().mulM(h)),E=u.getColumnVector(S),C=h.getColumnVector(V),D=s.zeros(c,1);a.norm(E.clone().sub(D))>i;){var I=A.mmul(C);I.div(a.norm(I)),D=E,E=u.mmul(I);var O=j.mmul(E);O.div(a.norm(O)),C=h.mmul(O)}D=E;var q=A.mmul(D),z=D.transpose().mmul(D)[0][0],T=q.div(z),U=a.norm(T);T.div(U),D.mul(U),I.mul(U),q=C.transpose().mmul(D),z=D.transpose().mmul(D)[0][0];var L=q.div(z)[0][0];u.sub(D.mmul(T.transpose())),h.sub(D.clone().mul(L).mmul(O.transpose())),y.setColumn(R,D),d.setColumn(R,T),b.setColumn(R,C),x.setColumn(R,O),k.setColumn(R,I),M[R][R]=L,R++}R--,y=y.subMatrix(0,y.rows-1,0,R),d=d.subMatrix(0,d.rows-1,0,R),b=b.subMatrix(0,b.rows-1,0,R),x=x.subMatrix(0,x.rows-1,0,R),k=k.subMatrix(0,k.rows-1,0,R),M=M.subMatrix(0,R,0,R),this.R2X=D.transpose().mmul(D).mmul(T.transpose().mmul(T)).divS(w)[0][0],this.ssqYcal=v,this.E=u,this.F=h,this.T=y,this.P=d,this.U=b,this.Q=x,this.W=k,this.B=M,this.PBQ=d.mmul(M).mmul(x.transpose())},i.prototype.predict=function(r){var t=s(r,!0),n=a.featureNormalize(t);t=n.result;var o=t.mmul(this.PBQ);return o.mulRowVector(this.ystd),o.addRowVector(this.ymean),o},i.prototype.getExplainedVariance=function(){return this.R2X},i.load=function(r){if("PLS"!==r.modelName)throw new RangeError("The current model is invalid!");return new i(!0,r)},i.prototype["export"]=function(){return{modelName:"PLS",E:this.E,F:this.F,R2X:this.R2X,ssqYcal:this.ssqYcal,ymean:this.ymean,ystd:this.ystd,PBQ:this.PBQ,T:this.T,P:this.P,U:this.U,Q:this.Q,W:this.W,B:this.B}}},function(r,t,n){"use strict";r.exports=n(118),r.exports.Decompositions=r.exports.DC=n(119)},function(r,t){"use strict";function n(r){for(var t=0,n=r.length,o=new Array(n);n>t;t++)o[t]=r[t];return o}function o(r,t){var e,i,s=0;if(Array.isArray(r)){if(i=t,e=i?n(r):r,r=e.length,t=e[0].length,"undefined"==typeof t)throw new TypeError("Data must be a 2D array");if(!(r>0&&t>0))throw new RangeError("Invalid dimensions: "+r+"x"+t);for(;r>s;s++){if(e[s].length!==t)throw new RangeError("Inconsistent array dimensions");i&&(e[s]=n(e[s]))}}else{if("number"!=typeof r)throw new TypeError("Invalid arguments");if(!(r>0&&t>0))throw new RangeError("Invalid dimensions: "+r+"x"+t);for(e=new Array(r);r>s;s++)e[s]=new Array(t)}return Object.defineProperty(e,"rows",{writable:!0,value:r}),Object.defineProperty(e,"columns",{writable:!0,value:t}),e.__proto__=o.prototype,e}var e=Array.prototype.splice,i=Array.prototype.concat;o.from1DArray=function(r,t,n){var e,i,s=0;if(e=r*t,e!==n.length)throw new RangeError("Data length does not match given dimensions");for(i=new Array(r);r>s;s++)i[s]=n.slice(s*t,(s+1)*t);return new o(i)},o.rowVector=function(r){return new o([r])},o.columnVector=function(r){for(var t=r.length,n=new Array(t),e=0;t>e;e++)n[e]=[r[e]];return new o(n)},o.empty=function(r,t){return new o(r,t)},o.zeros=function(r,t){return o.empty(r,t).fill(0)},o.ones=function(r,t){return o.empty(r,t).fill(1)},o.rand=function(r,t){for(var n=o.empty(r,t),e=0,i=n.rows;i>e;e++)for(var s=0,a=n.columns;a>s;s++)n[e][s]=Math.random();return n},o.eye=function(r){for(var t=o.zeros(r,r),n=t.rows,e=0;n>e;e++)t[e][e]=1;return t},o.diag=function(r){for(var t=r.length,n=o.zeros(t,t),e=0;t>e;e++)n[e][e]=r[e];return n},o.indices=function(r,t){for(var n=new Array(t-r),o=0;o<n.length;o++)n[o]=r++;return n},o.stack=function(r){var t,n,e;if(o.isMatrix(r)){var i=0,s=0;for(t=0;t<arguments.length;t++)i+=arguments[t].rows,arguments[t].columns>s&&(s=arguments[t].columns);var a=o.zeros(i,s),u=0;for(t=0;t<arguments.length;t++){var f=arguments[t];for(n=0;n<f.rows;n++){for(e=0;e<f.columns;e++)a[u][e]=f[n][e];u++}}return a}if(Array.isArray(r)){var h=o.empty(arguments.length,r.length);for(t=0;t<arguments.length;t++)h.setRow(t,arguments[t]);return h}},o.expand=function(r,t){for(var n=[],e=0;e<t.length;e++)for(var i=0;i<t[e];i++)n.push(r[e]);return new o(n)},o.checkMatrix=function(r){if(!r)throw new TypeError("Argument has to be a matrix");return"Matrix"!==r.klass&&(r=new o(r)),r},o.isMatrix=function(r){return r?"Matrix"===r.klass:!1},Object.defineProperty(o.prototype,"klass",{get:function(){return"Matrix"}}),Object.defineProperty(o.prototype,"size",{get:function(){return this.rows*this.columns}}),o.prototype.checkRowIndex=function(r){if(0>r||r>this.rows-1)throw new RangeError("Row index out of range.")},o.prototype.checkColumnIndex=function(r){if(0>r||r>this.columns-1)throw new RangeError("Column index out of range.")},o.prototype.checkDimensions=function(r){if(this.rows!==r.rows||this.columns!==r.columns)throw new RangeError("Matrices dimensions must be equal.")},o.prototype.apply=function(r){for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)r.call(this,o,e);return this},o.prototype.clone=function(){return new o(this.to2DArray())},o.prototype.to1DArray=function(){return i.apply([],this)},o.prototype.to2DArray=function(){for(var r=this.rows,t=new Array(r),o=0;r>o;o++)t[o]=n(this[o]);return t},o.prototype.isRowVector=function(){return 1===this.rows},o.prototype.isColumnVector=function(){return 1===this.columns},o.prototype.isVector=function(){return 1===this.rows||1===this.columns},o.prototype.isSquare=function(){return this.rows===this.columns},o.prototype.isSymmetric=function(){if(this.isSquare()){for(var r=this.rows,t=0;r>t;t++)for(var n=0;t>=n;n++)if(this[t][n]!==this[n][t])return!1;return!0}return!1},o.prototype.set=function(r,t,n){return this[r][t]=n,this},o.prototype.get=function(r,t){return this[r][t]},o.prototype.fill=function(r){for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]=r;return this},o.prototype.neg=function(){return this.mulS(-1)},o.prototype.add=function(r){return"number"==typeof r?this.addS(r):(r=o.checkMatrix(r),this.addM(r))},o.prototype.addS=function(r){for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]+=r;return this},o.prototype.addM=function(r){this.checkDimensions(r);for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]+=r[o][e];return this},o.prototype.sub=function(r){return"number"==typeof r?this.subS(r):(r=o.checkMatrix(r),this.subM(r))},o.prototype.subS=function(r){for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]-=r;return this},o.prototype.subM=function(r){this.checkDimensions(r);for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]-=r[o][e];return this},o.prototype.mul=function(r){return"number"==typeof r?this.mulS(r):(r=o.checkMatrix(r),this.mulM(r))},o.prototype.mulS=function(r){for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]*=r;return this},o.prototype.mulM=function(r){this.checkDimensions(r);for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]*=r[o][e];return this},o.prototype.div=function(r){return"number"==typeof r?this.divS(r):(r=o.checkMatrix(r),this.divM(r))},o.prototype.divS=function(r){for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]/=r;return this},o.prototype.divM=function(r){this.checkDimensions(r);for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]/=r[o][e];return this},o.prototype.getRow=function(r){return this.checkRowIndex(r),n(this[r])},o.prototype.getRowVector=function(r){return o.rowVector(this.getRow(r))},o.prototype.setRow=function(r,t){if(this.checkRowIndex(r),o.isMatrix(t)&&(t=t.to1DArray()),t.length!==this.columns)throw new RangeError("Invalid row size");return this[r]=n(t),this},o.prototype.removeRow=function(r){if(this.checkRowIndex(r),1===this.rows)throw new RangeError("A matrix cannot have less than one row");return e.call(this,r,1),this.rows-=1,this},o.prototype.addRow=function(r,t){if("undefined"==typeof t&&(t=r,r=this.rows),0>r||r>this.rows)throw new RangeError("Row index out of range.");if(o.isMatrix(t)&&(t=t.to1DArray()),t.length!==this.columns)throw new RangeError("Invalid row size");return e.call(this,r,0,n(t)),this.rows+=1,this},o.prototype.swapRows=function(r,t){this.checkRowIndex(r),this.checkRowIndex(t);var n=this[r];return this[r]=this[t],this[t]=n,this},o.prototype.getColumn=function(r){this.checkColumnIndex(r);for(var t=this.rows,n=new Array(t),o=0;t>o;o++)n[o]=this[o][r];return n},o.prototype.getColumnVector=function(r){return o.columnVector(this.getColumn(r))},o.prototype.setColumn=function(r,t){this.checkColumnIndex(r),o.isMatrix(t)&&(t=t.to1DArray());var n=this.rows;if(t.length!==n)throw new RangeError("Invalid column size");for(var e=0;n>e;e++)this[e][r]=t[e];return this},o.prototype.removeColumn=function(r){if(this.checkColumnIndex(r),1===this.columns)throw new RangeError("A matrix cannot have less than one column");for(var t=0,n=this.rows;n>t;t++)this[t].splice(r,1);return this.columns-=1,this},o.prototype.addColumn=function(r,t){if("undefined"==typeof t&&(t=r,r=this.columns),0>r||r>this.columns)throw new RangeError("Column index out of range.");o.isMatrix(t)&&(t=t.to1DArray());var n=this.rows;if(t.length!==n)throw new RangeError("Invalid column size");for(var e=0;n>e;e++)this[e].splice(r,0,t[e]);return this.columns+=1,this},o.prototype.swapColumns=function(r,t){this.checkRowIndex(r),this.checkRowIndex(t);for(var n,o,e=this.rows,i=0;e>i;i++)o=this[i],n=o[r],o[r]=o[t],o[t]=n;return this},o.prototype.checkRowVector=function(r){if(o.isMatrix(r)&&(r=r.to1DArray()),r.length!==this.columns)throw new RangeError("vector size must be the same as the number of columns");return r},o.prototype.checkColumnVector=function(r){if(o.isMatrix(r)&&(r=r.to1DArray()),r.length!==this.rows)throw new RangeError("vector size must be the same as the number of rows");return r},o.prototype.addRowVector=function(r){r=this.checkRowVector(r);for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]+=r[e];return this},o.prototype.subRowVector=function(r){r=this.checkRowVector(r);for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]-=r[e];return this},o.prototype.mulRowVector=function(r){r=this.checkRowVector(r);for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]*=r[e];return this},o.prototype.divRowVector=function(r){r=this.checkRowVector(r);for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]/=r[e];return this},o.prototype.addColumnVector=function(r){r=this.checkColumnVector(r);for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]+=r[o];return this},o.prototype.subColumnVector=function(r){r=this.checkColumnVector(r);for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]-=r[o];return this},o.prototype.mulColumnVector=function(r){r=this.checkColumnVector(r);for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]*=r[o];return this},o.prototype.divColumnVector=function(r){r=this.checkColumnVector(r);for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]/=r[o];return this},o.prototype.mulRow=function(r,t){this.checkRowIndex(r);for(var n=0,o=this.columns;o>n;n++)this[r][n]*=t;return this},o.prototype.mulColumn=function(r,t){this.checkColumnIndex(r);for(var n=0,o=this.rows;o>n;n++)this[n][r]*=t},o.prototype.max=function(){for(var r=-(1/0),t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]>r&&(r=this[o][e]);return r},o.prototype.maxIndex=function(){for(var r=-(1/0),t={},n=this.rows,o=this.columns,e=0;n>e;e++)for(var i=0;o>i;i++)this[e][i]>r&&(r=this[e][i],t.row=e,t.column=i);return t},o.prototype.min=function(){for(var r=1/0,t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]<r&&(r=this[o][e]);return r},o.prototype.minIndex=function(){for(var r=1/0,t={},n=this.rows,o=this.columns,e=0;n>e;e++)for(var i=0;o>i;i++)this[e][i]<r&&(r=this[e][i],t.row=e,t.column=i);return t},o.prototype.maxRow=function(r){this.checkRowIndex(r);for(var t=-(1/0),n=0,o=this.columns;o>n;n++)this[r][n]>t&&(t=this[r][n]);return t},o.prototype.maxRowIndex=function(r){this.checkRowIndex(r);for(var t=-(1/0),n={row:r},o=0,e=this.columns;e>o;o++)this[r][o]>t&&(t=this[r][o],n.column=o);return n},o.prototype.minRow=function(r){this.checkRowIndex(r);for(var t=1/0,n=0,o=this.columns;o>n;n++)this[r][n]<t&&(t=this[r][n]);return t},o.prototype.minRowIndex=function(r){this.checkRowIndex(r);for(var t=1/0,n={row:r,column:0},o=0,e=this.columns;e>o;o++)this[r][o]<t&&(t=this[r][o],n.column=o);return n},o.prototype.maxColumn=function(r){this.checkColumnIndex(r);for(var t=-(1/0),n=0,o=this.rows;o>n;n++)this[n][r]>t&&(t=this[n][r]);return t},o.prototype.maxColumnIndex=function(r){this.checkColumnIndex(r);for(var t=-(1/0),n={row:0,column:r},o=0,e=this.rows;e>o;o++)this[o][r]>t&&(t=this[o][r],n.row=o);return n},o.prototype.minColumn=function(r){this.checkColumnIndex(r);for(var t=1/0,n=0,o=this.rows;o>n;n++)this[n][r]<t&&(t=this[n][r]);return t},o.prototype.minColumnIndex=function(r){this.checkColumnIndex(r);for(var t=1/0,n={row:0,column:r},o=0,e=this.rows;e>o;o++)this[o][r]<t&&(t=this[o][r],n.row=o);return n},o.prototype.diag=function s(){if(!this.isSquare())throw new TypeError("Only square matrices have a diagonal.");for(var s=new Array(this.rows),r=0,t=this.rows;t>r;r++)s[r]=this[r][r];return s},o.prototype.sum=function(){for(var r=0,t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)r+=this[o][e];return r},o.prototype.mean=function(){return this.sum()/this.size},o.prototype.prod=function a(){for(var a=1,r=this.rows,t=this.columns,n=0;r>n;n++)for(var o=0;t>o;o++)a*=this[n][o];return a},o.prototype.cumulativeSum=function(){for(var r=0,t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)r+=this[o][e],this[o][e]=r;return this},o.prototype.dot=function u(r){if(this.size!==r.size)throw new RangeError("vectors do not have the same size");for(var t=this.to1DArray(),n=r.to1DArray(),u=0,o=t.length,e=0;o>e;e++)u+=t[e]*n[e];return u},o.prototype.mmul=function(r){if(!o.isMatrix(r))throw new TypeError('parameter "other" must be a matrix');this.columns!==r.rows&&console.warn("Number of columns of left matrix are not equal to number of rows of right matrix.");var t,n,e,i=this.rows,s=this.columns,a=r.columns,u=new o(i,a),f=new Array(s);for(n=0;a>n;n++){for(e=0;s>e;e++)f[e]=r[e][n];for(t=0;i>t;t++){var h=this[t],c=0;for(e=0;s>e;e++)c+=h[e]*f[e];u[t][n]=c}}return u},o.prototype.sortRows=function(r){for(var t=0,n=this.rows;n>t;t++)this[t].sort(r);return this},o.prototype.sortColumns=function(r){for(var t=0,n=this.columns;n>t;t++)this.setColumn(t,this.getColumn(t).sort(r));return this},o.prototype.transpose=function(){for(var r=new o(this.columns,this.rows),t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)r[i][e]=this[e][i];return r},o.prototype.subMatrix=function(r,t,n,e){if(r>t||n>e||0>r||r>=this.rows||0>t||t>=this.rows||0>n||n>=this.columns||0>e||e>=this.columns)throw new RangeError("Argument out of range");for(var i=new o(t-r+1,e-n+1),s=r;t>=s;s++)for(var a=n;e>=a;a++)i[s-r][a-n]=this[s][a];return i},o.prototype.subMatrixRow=function(r,t,n){if("undefined"==typeof t?(t=0,n=this.columns-1):"undefined"==typeof n&&(n=this.columns-1),t>n||0>t||t>=this.columns||0>n||n>=this.columns)throw new RangeError("Argument out of range.");for(var e=r.length,i=this.rows,s=new o(e,n-t+1),a=0;e>a;a++)for(var u=t;n>=u;u++){if(r[a]<0||r[a]>=i)throw new RangeError("Argument out of range.");s[a][u-t]=this[r[a]][u]}return s},o.prototype.subMatrixColumn=function(r,t,n){if("undefined"==typeof t?(t=0,n=this.rows-1):"undefined"==typeof n&&(n=this.rows-1),t>n||0>t||t>=this.rows||0>n||n>=this.rows)throw new RangeError("Argument out of range.");for(var e=r.length,i=this.columns,s=new o(n-t+1,e),a=0;e>a;a++)for(var u=t;n>=u;u++){if(r[a]<0||r[a]>=i)throw new RangeError("Argument out of range.");s[u-t][a]=this[u][r[a]]}return s},o.prototype.trace=function f(){if(!this.isSquare())throw new TypeError("The matrix is not square");for(var f=0,r=0,t=this.rows;t>r;r++)f+=this[r][r];return f},o.prototype.abs=function(){for(var r=this.rows,t=this.columns,n=0;r>n;n++)for(var o=0;t>o;o++)this[n][o]=Math.abs(this[n][o])},r.exports=o},function(r,t,n){"use strict";function o(r){return e(r,i.eye(r.rows))}function e(r,t){return r.isSquare()?new u(r).solve(t):new f(r).solve(t)}var i=n(118),s=n(120),a=n(122),u=n(123),f=n(124),h=n(125);i.prototype.inverse=function(){return o(this)},i.prototype.solve=function(r){return e(this,r)},r.exports={SingularValueDecomposition:s,SVD:s,EigenvalueDecomposition:a,EVD:a,LuDecomposition:u,LU:u,QrDecomposition:f,QR:f,CholeskyDecomposition:h,CHO:h,inverse:o,solve:e}},function(r,t,n){"use strict";function o(r,t){if(!(this instanceof o))return new o(r,t);r=e.checkMatrix(r),t=t||{};var n=r.clone(),s=r.rows,a=r.columns,u=Math.min(s,a),f=!0,h=!0;t.computeLeftSingularVectors===!1&&(f=!1),t.computeRightSingularVectors===!1&&(h=!1);var c=t.autoTranspose===!0,l=!1;if(a>s)if(c){n=n.transpose(),s=n.rows,a=n.columns,l=!0;var m=f;f=h,h=m}else console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");var p,w,v,g,y,d,b,x,M,k,R,A,j,S,V,E,C,D,I,O,q,z=new Array(Math.min(s+1,a)),T=e.zeros(s,u),U=e.zeros(a,a),L=new Array(a),_=new Array(s),N=Math.min(s-1,a),P=Math.max(0,Math.min(a-2,s));for(v=0,k=Math.max(N,P);k>v;v++){if(N>v){for(z[v]=0,p=v;s>p;p++)z[v]=i(z[v],n[p][v]);if(0!==z[v]){for(n[v][v]<0&&(z[v]=-z[v]),p=v;s>p;p++)n[p][v]/=z[v];n[v][v]+=1}z[v]=-z[v]}for(w=v+1;a>w;w++){if(N>v&&0!==z[v]){for(y=0,p=v;s>p;p++)y+=n[p][v]*n[p][w];for(y=-y/n[v][v],p=v;s>p;p++)n[p][w]+=y*n[p][v]}L[w]=n[v][w]}if(f&&N>v)for(p=v;s>p;p++)T[p][v]=n[p][v];if(P>v){for(L[v]=0,p=v+1;a>p;p++)L[v]=i(L[v],L[p]);if(0!==L[v]){for(L[v+1]<0&&(L[v]=-L[v]),p=v+1;a>p;p++)L[p]/=L[v];L[v+1]+=1}if(L[v]=-L[v],s>v+1&&0!==L[v]){for(p=v+1;s>p;p++)_[p]=0;for(w=v+1;a>w;w++)for(p=v+1;s>p;p++)_[p]+=L[w]*n[p][w];for(w=v+1;a>w;w++)for(y=-L[w]/L[v+1],p=v+1;s>p;p++)n[p][w]+=y*_[p]}if(h)for(p=v+1;a>p;p++)U[p][v]=L[p]}}if(g=Math.min(a,s+1),a>N&&(z[N]=n[N][N]),g>s&&(z[g-1]=0),g>P+1&&(L[P]=n[P][g-1]),L[g-1]=0,f){for(w=N;u>w;w++){for(p=0;s>p;p++)T[p][w]=0;T[w][w]=1}for(v=N-1;v>=0;v--)if(0!==z[v]){for(w=v+1;u>w;w++){for(y=0,p=v;s>p;p++)y+=T[p][v]*T[p][w];for(y=-y/T[v][v],p=v;s>p;p++)T[p][w]+=y*T[p][v]}for(p=v;s>p;p++)T[p][v]=-T[p][v];for(T[v][v]=1+T[v][v],p=0;v-1>p;p++)T[p][v]=0}else{for(p=0;s>p;p++)T[p][v]=0;T[v][v]=1}}if(h)for(v=a-1;v>=0;v--){if(P>v&&0!==L[v])for(w=v+1;a>w;w++){for(y=0,p=v+1;a>p;p++)y+=U[p][v]*U[p][w];for(y=-y/U[v+1][v],p=v+1;a>p;p++)U[p][w]+=y*U[p][v]}for(p=0;a>p;p++)U[p][v]=0;U[v][v]=1}for(var F=g-1,Q=0,B=Math.pow(2,-52);g>0;){for(v=g-2;v>=-1&&-1!==v;v--)if(Math.abs(L[v])<=B*(Math.abs(z[v])+Math.abs(z[v+1]))){L[v]=0;break}if(v===g-2)R=4;else{for(d=g-1;d>=v&&d!==v;d--)if(y=(d!==g?Math.abs(L[d]):0)+(d!==v+1?Math.abs(L[d-1]):0),Math.abs(z[d])<=B*y){z[d]=0;break}d===v?R=3:d===g-1?R=1:(R=2,v=d)}switch(v++,R){case 1:for(b=L[g-2],L[g-2]=0,w=g-2;w>=v;w--)if(y=i(z[w],b),x=z[w]/y,M=b/y,z[w]=y,w!==v&&(b=-M*L[w-1],L[w-1]=x*L[w-1]),h)for(p=0;a>p;p++)y=x*U[p][w]+M*U[p][g-1],U[p][g-1]=-M*U[p][w]+x*U[p][g-1],U[p][w]=y;break;case 2:for(b=L[v-1],L[v-1]=0,w=v;g>w;w++)if(y=i(z[w],b),x=z[w]/y,M=b/y,z[w]=y,b=-M*L[w],L[w]=x*L[w],f)for(p=0;s>p;p++)y=x*T[p][w]+M*T[p][v-1],T[p][v-1]=-M*T[p][w]+x*T[p][v-1],T[p][w]=y;break;case 3:for(A=Math.max(Math.max(Math.max(Math.max(Math.abs(z[g-1]),Math.abs(z[g-2])),Math.abs(L[g-2])),Math.abs(z[v])),Math.abs(L[v])),j=z[g-1]/A,S=z[g-2]/A,V=L[g-2]/A,E=z[v]/A,C=L[v]/A,D=((S+j)*(S-j)+V*V)/2,I=j*V*(j*V),O=0,(0!==D||0!==I)&&(O=Math.sqrt(D*D+I),0>D&&(O=-O),O=I/(D+O)),b=(E+j)*(E-j)+O,q=E*C,w=v;g-1>w;w++){if(y=i(b,q),x=b/y,M=q/y,w!==v&&(L[w-1]=y),b=x*z[w]+M*L[w],L[w]=x*L[w]-M*z[w],q=M*z[w+1],z[w+1]=x*z[w+1],h)for(p=0;a>p;p++)y=x*U[p][w]+M*U[p][w+1],U[p][w+1]=-M*U[p][w]+x*U[p][w+1],U[p][w]=y;if(y=i(b,q),x=b/y,M=q/y,z[w]=y,b=x*L[w]+M*z[w+1],z[w+1]=-M*L[w]+x*z[w+1],q=M*L[w+1],L[w+1]=x*L[w+1],f&&s-1>w)for(p=0;s>p;p++)y=x*T[p][w]+M*T[p][w+1],T[p][w+1]=-M*T[p][w]+x*T[p][w+1],T[p][w]=y}L[g-2]=b,Q+=1;break;case 4:if(z[v]<=0&&(z[v]=z[v]<0?-z[v]:0,h))for(p=0;F>=p;p++)U[p][v]=-U[p][v];for(;F>v&&!(z[v]>=z[v+1]);){if(y=z[v],z[v]=z[v+1],z[v+1]=y,h&&a-1>v)for(p=0;a>p;p++)y=U[p][v+1],U[p][v+1]=U[p][v],U[p][v]=y;if(f&&s-1>v)for(p=0;s>p;p++)y=T[p][v+1],T[p][v+1]=T[p][v],T[p][v]=y;v++}Q=0,g--}}if(l){var X=U;U=T,T=X}this.m=s,this.n=a,this.s=z,this.U=T,this.V=U}var e=n(118),i=n(121).hypotenuse;o.prototype={get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]},get norm2(){return this.s[0]},get rank(){for(var r=Math.pow(2,-52),t=Math.max(this.m,this.n)*this.s[0]*r,n=0,o=this.s,e=0,i=o.length;i>e;e++)o[e]>t&&n++;return n},get diagonal(){return this.s},get threshold(){return Math.pow(2,-52)/2*Math.max(this.m,this.n)*this.s[0]},get leftSingularVectors(){return this.U},get rightSingularVectors(){return this.V},get diagonalMatrix(){return e.diag(this.s)},solve:function(r){var t,n=r,o=this.threshold,i=this.s.length,s=e.zeros(i,i);for(t=0;i>t;t++)Math.abs(this.s[t])<=o?s[t][t]=0:s[t][t]=1/this.s[t];var a,u,f,h=this.V.mmul(s),c=this.V.rows,l=this.U.rows,m=e.zeros(c,l);for(t=0;c>t;t++)for(a=0;l>a;a++){for(f=0,u=0;i>u;u++)f+=h[t][u]*this.U[a][u];m[t][a]=f}return m.mmul(n)},solveForDiagonal:function(r){return this.solve(e.diag(r))},inverse:function(){var r,t,n=this.threshold,o=this.V.rows,i=this.V.columns,s=new e(o,this.s.length);for(r=0;o>r;r++)for(t=0;i>t;t++)Math.abs(this.s[t])>n?s[r][t]=this.V[r][t]/this.s[t]:s[r][t]=0;var a,u,f=this.U.rows,h=this.U.columns,c=new e(o,f);for(r=0;o>r;r++)for(t=0;f>t;t++){for(u=0,a=0;h>a;a++)u+=s[r][a]*this.U[t][a];c[r][t]=u}return c}},r.exports=o},function(r,t){"use strict";t.hypotenuse=function(r,t){var n;return Math.abs(r)>Math.abs(t)?(n=t/r,Math.abs(r)*Math.sqrt(1+n*n)):0!==t?(n=r/t,Math.abs(t)*Math.sqrt(1+n*n)):0}},function(r,t,n){"use strict";function o(r){if(!(this instanceof o))return new o(r);if(r=f.checkMatrix(r),!r.isSquare())throw new Error("Matrix is not a square matrix");var t,n,u=r.columns,h=f.zeros(u,u),c=new Array(u),l=new Array(u),m=r;if(r.isSymmetric()){for(t=0;u>t;t++)for(n=0;u>n;n++)h[t][n]=m[t][n];e(u,l,c,h),i(u,l,c,h)}else{var p=f.zeros(u,u),w=new Array(u);for(n=0;u>n;n++)for(t=0;u>t;t++)p[t][n]=m[t][n];s(u,p,w,h),a(u,l,c,h,p)}this.n=u,this.e=l,this.d=c,this.V=h}function e(r,t,n,o){var e,i,s,a,u,f,h,c;for(u=0;r>u;u++)n[u]=o[r-1][u];for(a=r-1;a>0;a--){for(c=0,s=0,f=0;a>f;f++)c+=Math.abs(n[f]);if(0===c)for(t[a]=n[a-1],u=0;a>u;u++)n[u]=o[a-1][u],o[a][u]=0,o[u][a]=0;else{for(f=0;a>f;f++)n[f]/=c,s+=n[f]*n[f];for(e=n[a-1],i=Math.sqrt(s),e>0&&(i=-i),t[a]=c*i,s-=e*i,n[a-1]=e-i,u=0;a>u;u++)t[u]=0;for(u=0;a>u;u++){for(e=n[u],o[u][a]=e,i=t[u]+o[u][u]*e,f=u+1;a-1>=f;f++)i+=o[f][u]*n[f],t[f]+=o[f][u]*e;t[u]=i}for(e=0,u=0;a>u;u++)t[u]/=s,e+=t[u]*n[u];for(h=e/(s+s),u=0;a>u;u++)t[u]-=h*n[u];for(u=0;a>u;u++){for(e=n[u],i=t[u],f=u;a-1>=f;f++)o[f][u]-=e*t[f]+i*n[f];n[u]=o[a-1][u],o[a][u]=0}}n[a]=s}for(a=0;r-1>a;a++){if(o[r-1][a]=o[a][a],o[a][a]=1,s=n[a+1],0!==s){for(f=0;a>=f;f++)n[f]=o[f][a+1]/s;for(u=0;a>=u;u++){for(i=0,f=0;a>=f;f++)i+=o[f][a+1]*o[f][u];for(f=0;a>=f;f++)o[f][u]-=i*n[f]}}for(f=0;a>=f;f++)o[f][a+1]=0}for(u=0;r>u;u++)n[u]=o[r-1][u],o[r-1][u]=0;o[r-1][r-1]=1,t[0]=0}function i(r,t,n,o){var e,i,s,a,u,f,c,l,m,p,w,v,g,y,d,b,x;for(s=1;r>s;s++)t[s-1]=t[s];t[r-1]=0;var M=0,k=0,R=Math.pow(2,-52);for(f=0;r>f;f++){for(k=Math.max(k,Math.abs(n[f])+Math.abs(t[f])),c=f;r>c&&!(Math.abs(t[c])<=R*k);)c++;if(c>f){x=0;do{for(x+=1,e=n[f],l=(n[f+1]-e)/(2*t[f]),m=h(l,1),0>l&&(m=-m),n[f]=t[f]/(l+m),n[f+1]=t[f]*(l+m),p=n[f+1],i=e-n[f],s=f+2;r>s;s++)n[s]-=i;for(M+=i,l=n[c],w=1,v=w,g=w,y=t[f+1],d=0,b=0,s=c-1;s>=f;s--)for(g=v,v=w,b=d,e=w*t[s],i=w*l,m=h(l,t[s]),t[s+1]=d*m,d=t[s]/m,w=l/m,l=w*n[s]-d*e,n[s+1]=i+d*(w*e+d*n[s]),u=0;r>u;u++)i=o[u][s+1],o[u][s+1]=d*o[u][s]+w*i,o[u][s]=w*o[u][s]-d*i;l=-d*b*g*y*t[f]/p,t[f]=d*l,n[f]=w*l}while(Math.abs(t[f])>R*k)}n[f]=n[f]+M,t[f]=0}for(s=0;r-1>s;s++){for(u=s,l=n[s],a=s+1;r>a;a++)n[a]<l&&(u=a,l=n[a]);if(u!==s)for(n[u]=n[s],n[s]=l,a=0;r>a;a++)l=o[a][s],o[a][s]=o[a][u],o[a][u]=l}}function s(r,t,n,o){var e,i,s,a,u,f,h,c=0,l=r-1;for(f=c+1;l-1>=f;f++){for(h=0,a=f;l>=a;a++)h+=Math.abs(t[a][f-1]);if(0!==h){for(s=0,a=l;a>=f;a--)n[a]=t[a][f-1]/h,s+=n[a]*n[a];for(i=Math.sqrt(s),n[f]>0&&(i=-i),s-=n[f]*i,n[f]=n[f]-i,u=f;r>u;u++){for(e=0,a=l;a>=f;a--)e+=n[a]*t[a][u];for(e/=s,a=f;l>=a;a++)t[a][u]-=e*n[a]}for(a=0;l>=a;a++){for(e=0,u=l;u>=f;u--)e+=n[u]*t[a][u];for(e/=s,u=f;l>=u;u++)t[a][u]-=e*n[u]}n[f]=h*n[f],t[f][f-1]=h*i}}for(a=0;r>a;a++)for(u=0;r>u;u++)o[a][u]=a===u?1:0;for(f=l-1;f>=c+1;f--)if(0!==t[f][f-1]){for(a=f+1;l>=a;a++)n[a]=t[a][f-1];for(u=f;l>=u;u++){for(i=0,a=f;l>=a;a++)i+=n[a]*o[a][u];for(i=i/n[f]/t[f][f-1],a=f;l>=a;a++)o[a][u]+=i*n[a]}}}function a(r,t,n,o,e){var i,s,a,f,h,c,l,m,p,w,v,g,y,d,b,x=r-1,M=0,k=r-1,R=Math.pow(2,-52),A=0,j=0,S=0,V=0,E=0,C=0,D=0,I=0;for(i=0;r>i;i++)for((M>i||i>k)&&(n[i]=e[i][i],t[i]=0),s=Math.max(i-1,0);r>s;s++)j+=Math.abs(e[i][s]);for(;x>=M;){for(f=x;f>M&&(C=Math.abs(e[f-1][f-1])+Math.abs(e[f][f]),0===C&&(C=j),!(Math.abs(e[f][f-1])<R*C));)f--;if(f===x)e[x][x]=e[x][x]+A,n[x]=e[x][x],t[x]=0,x--,I=0;else if(f===x-1){if(l=e[x][x-1]*e[x-1][x],S=(e[x-1][x-1]-e[x][x])/2,V=S*S+l,D=Math.sqrt(Math.abs(V)),e[x][x]=e[x][x]+A,e[x-1][x-1]=e[x-1][x-1]+A,m=e[x][x],V>=0){for(D=S>=0?S+D:S-D,n[x-1]=m+D,n[x]=n[x-1],0!==D&&(n[x]=m-l/D),t[x-1]=0,t[x]=0,m=e[x][x-1],C=Math.abs(m)+Math.abs(D),S=m/C,V=D/C,E=Math.sqrt(S*S+V*V),S/=E,V/=E,s=x-1;r>s;s++)D=e[x-1][s],e[x-1][s]=V*D+S*e[x][s],e[x][s]=V*e[x][s]-S*D;for(i=0;x>=i;i++)D=e[i][x-1],e[i][x-1]=V*D+S*e[i][x],e[i][x]=V*e[i][x]-S*D;for(i=M;k>=i;i++)D=o[i][x-1],o[i][x-1]=V*D+S*o[i][x],o[i][x]=V*o[i][x]-S*D}else n[x-1]=m+S,n[x]=m+S,t[x-1]=D,
t[x]=-D;x-=2,I=0}else{if(m=e[x][x],p=0,l=0,x>f&&(p=e[x-1][x-1],l=e[x][x-1]*e[x-1][x]),10===I){for(A+=m,i=M;x>=i;i++)e[i][i]-=m;C=Math.abs(e[x][x-1])+Math.abs(e[x-1][x-2]),m=p=.75*C,l=-.4375*C*C}if(30===I&&(C=(p-m)/2,C=C*C+l,C>0)){for(C=Math.sqrt(C),m>p&&(C=-C),C=m-l/((p-m)/2+C),i=M;x>=i;i++)e[i][i]-=C;A+=C,m=p=l=.964}for(I+=1,h=x-2;h>=f&&(D=e[h][h],E=m-D,C=p-D,S=(E*C-l)/e[h+1][h]+e[h][h+1],V=e[h+1][h+1]-D-E-C,E=e[h+2][h+1],C=Math.abs(S)+Math.abs(V)+Math.abs(E),S/=C,V/=C,E/=C,h!==f)&&!(Math.abs(e[h][h-1])*(Math.abs(V)+Math.abs(E))<R*(Math.abs(S)*(Math.abs(e[h-1][h-1])+Math.abs(D)+Math.abs(e[h+1][h+1]))));)h--;for(i=h+2;x>=i;i++)e[i][i-2]=0,i>h+2&&(e[i][i-3]=0);for(a=h;x-1>=a&&(d=a!==x-1,a!==h&&(S=e[a][a-1],V=e[a+1][a-1],E=d?e[a+2][a-1]:0,m=Math.abs(S)+Math.abs(V)+Math.abs(E),0!==m&&(S/=m,V/=m,E/=m)),0!==m);a++)if(C=Math.sqrt(S*S+V*V+E*E),0>S&&(C=-C),0!==C){for(a!==h?e[a][a-1]=-C*m:f!==h&&(e[a][a-1]=-e[a][a-1]),S+=C,m=S/C,p=V/C,D=E/C,V/=S,E/=S,s=a;r>s;s++)S=e[a][s]+V*e[a+1][s],d&&(S+=E*e[a+2][s],e[a+2][s]=e[a+2][s]-S*D),e[a][s]=e[a][s]-S*m,e[a+1][s]=e[a+1][s]-S*p;for(i=0;i<=Math.min(x,a+3);i++)S=m*e[i][a]+p*e[i][a+1],d&&(S+=D*e[i][a+2],e[i][a+2]=e[i][a+2]-S*E),e[i][a]=e[i][a]-S,e[i][a+1]=e[i][a+1]-S*V;for(i=M;k>=i;i++)S=m*o[i][a]+p*o[i][a+1],d&&(S+=D*o[i][a+2],o[i][a+2]=o[i][a+2]-S*E),o[i][a]=o[i][a]-S,o[i][a+1]=o[i][a+1]-S*V}}}if(0!==j){for(x=r-1;x>=0;x--)if(S=n[x],V=t[x],0===V)for(f=x,e[x][x]=1,i=x-1;i>=0;i--){for(l=e[i][i]-S,E=0,s=f;x>=s;s++)E+=e[i][s]*e[s][x];if(t[i]<0)D=l,C=E;else if(f=i,0===t[i]?e[i][x]=0!==l?-E/l:-E/(R*j):(m=e[i][i+1],p=e[i+1][i],V=(n[i]-S)*(n[i]-S)+t[i]*t[i],c=(m*C-D*E)/V,e[i][x]=c,e[i+1][x]=Math.abs(m)>Math.abs(D)?(-E-l*c)/m:(-C-p*c)/D),c=Math.abs(e[i][x]),R*c*c>1)for(s=i;x>=s;s++)e[s][x]=e[s][x]/c}else if(0>V)for(f=x-1,Math.abs(e[x][x-1])>Math.abs(e[x-1][x])?(e[x-1][x-1]=V/e[x][x-1],e[x-1][x]=-(e[x][x]-S)/e[x][x-1]):(b=u(0,-e[x-1][x],e[x-1][x-1]-S,V),e[x-1][x-1]=b[0],e[x-1][x]=b[1]),e[x][x-1]=0,e[x][x]=1,i=x-2;i>=0;i--){for(w=0,v=0,s=f;x>=s;s++)w+=e[i][s]*e[s][x-1],v+=e[i][s]*e[s][x];if(l=e[i][i]-S,t[i]<0)D=l,E=w,C=v;else if(f=i,0===t[i]?(b=u(-w,-v,l,V),e[i][x-1]=b[0],e[i][x]=b[1]):(m=e[i][i+1],p=e[i+1][i],g=(n[i]-S)*(n[i]-S)+t[i]*t[i]-V*V,y=2*(n[i]-S)*V,0===g&&0===y&&(g=R*j*(Math.abs(l)+Math.abs(V)+Math.abs(m)+Math.abs(p)+Math.abs(D))),b=u(m*E-D*w+V*v,m*C-D*v-V*w,g,y),e[i][x-1]=b[0],e[i][x]=b[1],Math.abs(m)>Math.abs(D)+Math.abs(V)?(e[i+1][x-1]=(-w-l*e[i][x-1]+V*e[i][x])/m,e[i+1][x]=(-v-l*e[i][x]-V*e[i][x-1])/m):(b=u(-E-p*e[i][x-1],-C-p*e[i][x],D,V),e[i+1][x-1]=b[0],e[i+1][x]=b[1])),c=Math.max(Math.abs(e[i][x-1]),Math.abs(e[i][x])),R*c*c>1)for(s=i;x>=s;s++)e[s][x-1]=e[s][x-1]/c,e[s][x]=e[s][x]/c}for(i=0;r>i;i++)if(M>i||i>k)for(s=i;r>s;s++)o[i][s]=e[i][s];for(s=r-1;s>=M;s--)for(i=M;k>=i;i++){for(D=0,a=M;a<=Math.min(s,k);a++)D+=o[i][a]*e[a][s];o[i][s]=D}}}function u(r,t,n,o){var e,i;return Math.abs(n)>Math.abs(o)?(e=o/n,i=n+e*o,[(r+e*t)/i,(t-e*r)/i]):(e=n/o,i=o+e*n,[(e*r+t)/i,(e*t-r)/i])}var f=n(118),h=n(121).hypotenuse;o.prototype={get realEigenvalues(){return this.d},get imaginaryEigenvalues(){return this.e},get eigenvectorMatrix(){return this.V},get diagonalMatrix(){var r,t,n=this.n,o=this.e,e=this.d,i=new f(n,n);for(r=0;n>r;r++){for(t=0;n>t;t++)i[r][t]=0;i[r][r]=e[r],o[r]>0?i[r][r+1]=o[r]:o[r]<0&&(i[r][r-1]=o[r])}return i}},r.exports=o},function(r,t,n){"use strict";function o(r){if(!(this instanceof o))return new o(r);r=e.checkMatrix(r);var t,n,i,s,a,u,f,h,c,l,m=r.clone(),p=m.rows,w=m.columns,v=new Array(p),g=1;for(t=0;p>t;t++)v[t]=t;for(c=new Array(p),n=0;w>n;n++){for(t=0;p>t;t++)c[t]=m[t][n];for(t=0;p>t;t++){for(h=m[t],l=Math.min(t,n),a=0,i=0;l>i;i++)a+=h[i]*c[i];h[n]=c[t]-=a}for(s=n,t=n+1;p>t;t++)Math.abs(c[t])>Math.abs(c[s])&&(s=t);if(s!==n){for(i=0;w>i;i++)u=m[s][i],m[s][i]=m[n][i],m[n][i]=u;f=v[s],v[s]=v[n],v[n]=f,g=-g}if(p>n&&0!==m[n][n])for(t=n+1;p>t;t++)m[t][n]/=m[n][n]}this.LU=m,this.pivotVector=v,this.pivotSign=g}var e=n(118);o.prototype={isSingular:function(){for(var r=this.LU,t=r.columns,n=0;t>n;n++)if(0===r[n][n])return!0;return!1},get determinant(){var r=this.LU;if(!r.isSquare())throw new Error("Matrix must be square");for(var t=this.pivotSign,n=r.columns,o=0;n>o;o++)t*=r[o][o];return t},get lowerTriangularFactor(){for(var r=this.LU,t=r.rows,n=r.columns,o=new e(t,n),i=0;t>i;i++)for(var s=0;n>s;s++)i>s?o[i][s]=r[i][s]:i===s?o[i][s]=1:o[i][s]=0;return o},get upperTriangularFactor(){for(var r=this.LU,t=r.rows,n=r.columns,o=new e(t,n),i=0;t>i;i++)for(var s=0;n>s;s++)s>=i?o[i][s]=r[i][s]:o[i][s]=0;return o},get pivotPermutationVector(){return this.pivotVector.slice()},solve:function(r){r=e.checkMatrix(r);var t=this.LU,n=t.rows;if(n!==r.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");var o,i,s,a=r.columns,u=r.subMatrixRow(this.pivotVector,0,a-1),f=t.columns;for(s=0;f>s;s++)for(o=s+1;f>o;o++)for(i=0;a>i;i++)u[o][i]-=u[s][i]*t[o][s];for(s=f-1;s>=0;s--){for(i=0;a>i;i++)u[s][i]/=t[s][s];for(o=0;s>o;o++)for(i=0;a>i;i++)u[o][i]-=u[s][i]*t[o][s]}return u}},r.exports=o},function(r,t,n){"use strict";function o(r){if(!(this instanceof o))return new o(r);r=e.checkMatrix(r);var t,n,s,a,u=r.clone(),f=r.rows,h=r.columns,c=new Array(h);for(s=0;h>s;s++){var l=0;for(t=s;f>t;t++)l=i(l,u[t][s]);if(0!==l){for(u[s][s]<0&&(l=-l),t=s;f>t;t++)u[t][s]/=l;for(u[s][s]+=1,n=s+1;h>n;n++){for(a=0,t=s;f>t;t++)a+=u[t][s]*u[t][n];for(a=-a/u[s][s],t=s;f>t;t++)u[t][n]+=a*u[t][s]}}c[s]=-l}this.QR=u,this.Rdiag=c}var e=n(118),i=n(121).hypotenuse;o.prototype={solve:function(r){r=e.checkMatrix(r);var t=this.QR,n=t.rows;if(r.rows!==n)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");var o,i,s,a,u=r.columns,f=r.clone(),h=t.columns;for(s=0;h>s;s++)for(i=0;u>i;i++){for(a=0,o=s;n>o;o++)a+=t[o][s]*f[o][i];for(a=-a/t[s][s],o=s;n>o;o++)f[o][i]+=a*t[o][s]}for(s=h-1;s>=0;s--){for(i=0;u>i;i++)f[s][i]/=this.Rdiag[s];for(o=0;s>o;o++)for(i=0;u>i;i++)f[o][i]-=f[s][i]*t[o][s]}return f.subMatrix(0,h-1,0,u-1)},isFullRank:function(){for(var r=this.QR.columns,t=0;r>t;t++)if(0===this.Rdiag[t])return!1;return!0},get upperTriangularFactor(){var r,t,n=this.QR,o=n.columns,i=new e(o,o);for(r=0;o>r;r++)for(t=0;o>t;t++)t>r?i[r][t]=n[r][t]:r===t?i[r][t]=this.Rdiag[r]:i[r][t]=0;return i},get orthogonalFactor(){var r,t,n,o,i=this.QR,s=i.rows,a=i.columns,u=new e(s,a);for(n=a-1;n>=0;n--){for(r=0;s>r;r++)u[r][n]=0;for(u[n][n]=1,t=n;a>t;t++)if(0!==i[n][n]){for(o=0,r=n;s>r;r++)o+=i[r][n]*u[r][t];for(o=-o/i[n][n],r=n;s>r;r++)u[r][t]+=o*i[r][n]}}return u}},r.exports=o},function(r,t,n){"use strict";function o(r){if(!(this instanceof o))return new o(r);if(r=e.checkMatrix(r),!r.isSymmetric())throw new Error("Matrix is not symmetric");var t,n,i,s=r,a=s.rows,u=new e(a,a),f=!0;for(n=0;a>n;n++){var h=u[n],c=0;for(i=0;n>i;i++){var l=u[i],m=0;for(t=0;i>t;t++)m+=l[t]*h[t];h[i]=m=(s[n][i]-m)/u[i][i],c+=m*m}for(c=s[n][n]-c,f&=c>0,u[n][n]=Math.sqrt(Math.max(c,0)),i=n+1;a>i;i++)u[n][i]=0}if(!f)throw new Error("Matrix is not positive definite");this.L=u}var e=n(118);o.prototype={get leftTriangularFactor(){return this.L},solve:function(r){r=e.checkMatrix(r);var t=this.L,n=t.rows;if(r.rows!==n)throw new Error("Matrix dimensions do not match");var o,i,s,a=r.columns,u=r.clone();for(s=0;n>s;s++)for(i=0;a>i;i++){for(o=0;s>o;o++)u[s][i]-=u[o][i]*t[s][o];u[s][i]/=t[s][s]}for(s=n-1;s>=0;s--)for(i=0;a>i;i++){for(o=s+1;n>o;o++)u[s][i]-=u[o][i]*t[o][s];u[s][i]/=t[s][s]}return u}},r.exports=o},function(r,t,n){"use strict";function o(r){return Math.sqrt(r.clone().apply(e).sum())}function e(r,t){return this[r][t]=this[r][t]*this[r][t],this}function i(r){var t=a.matrix.mean(r),n=s.rowVector(a.matrix.standardDeviation(r,t,!0));t=s.rowVector(t);var o=r.addRowVector(t.neg());return{result:o.divRowVector(n),means:t,std:n}}var s=n(117),a=n(5);r.exports={norm:o,pow2array:e,featureNormalize:i}},function(r,t,n){"use strict";function o(r,t,n){var o=e(r).clone(),s=e(t).clone();o=i.featureNormalize(o).result,s=i.featureNormalize(s).result;var a=(o.rows,o.columns,o.clone().mul(o).sum()),u=o.transpose().mmul(s);u.div(i.norm(u));for(var f=new Array(n),h=new Array(n),c=new Array(n),l=0;n>l;l++){var m=o.mmul(u),p=o.transpose().mmul(m),w=m.transpose().mmul(m)[0][0],v=p.div(w);p=u.transpose().mmul(v)[0][0],w=u.transpose().mmul(u)[0][0];var g=v.sub(u.clone().mul(p/w));g.div(i.norm(g));var y=o.mmul(g);p=o.transpose().mmul(y),w=y.transpose().mmul(y)[0][0];var d=p.div(w);o.sub(y.mmul(d.transpose())),f[l]=g.getColumn(0),h[l]=y.getColumn(0),c[l]=d.getColumn(0)}this.Xosc=o;var b=this.Xosc.clone().mul(this.Xosc).sum();this.R2X=1-b/a,this.W=f,this.T=h,this.P=c,this.numberOSC=n}var e=n(117),i=n(126);r.exports=o,o.prototype.correctDataset=function(r){for(var t=e(r).clone(),n=t.clone().mul(t).sum(),o=0;o<this.numberOSC;o++){var i=this.W.getColumnVector(o),s=this.P.getColumnVector(o),a=t.mmul(i);t.sub(a.mmul(s))}var u=t.clone().mul(t).sum(),f=1-u/n;return{datasetOsc:t,R2Dataset:f}}},function(r,t,n){r.exports=n(129)},function(r,t){"use strict";function n(r,t){for(var n=0,o=r.length,e=0;o>e;e++)n+=(r[e]-t[e])*(r[e]-t[e]);return n}function o(r,t,o){for(var e=0,i=r.length,s=0,a=0;i>a;a++)s=o[a],e+=n(r[a],t[s]);return e}function e(r,t){for(var o=r.length,e=t.length,i=0,s=new Array(o),a=0;o>a;a++)s[a]=0;for(var u=new Array(o),a=0;o>a;a++){u[a]=new Array(e);for(var f=0;e>f;f++)i=n(r[a],t[f]),u[a][f]=new Array(2),u[a][f][0]=i,u[a][f][1]=f;for(var h=u[a][0][0],c=0,f=0;e>f;f++)u[a][f][0]<h&&(h=u[a][f][0],c=u[a][f][1]);s[a]=c}return s}function i(r,t,n){for(var o=r[0].length,e=r.length,i=new Array(n),s=0;n>s;s++){i[s]=new Array(o);for(var a=0;o>a;a++)i[s][a]=0}for(var u=0;n>u;u++){for(var f=[],s=0;e>s;s++)t[s]==u&&f.push(r[s]);for(var h=0;o>h;h++){for(var c=[],s=0;e>s;s++)t[s]==u&&c.push(r[s][h]);for(var l=0,m=c.length,s=0;m>s;s++)l+=c[s];i[u][h]=l/m}}return i}function s(r,t,n){var s,a,u;"undefined"==typeof n?(s=100,a=1e-6,u=!1):(s="undefined"==typeof n.maxIter?100:n.maxIter,a="undefined"==typeof n.tol?1e-6:n.tol,u="undefined"==typeof n.withIter?!1:n.withIter);var f=r.length;if(0==f)return[];for(var h=t.length,c=new Array(f),l=0;f>l;l++)c[l]=0;if(h>=f){for(var l=0;f>l;l++)c[l]=l;return c}var m;m=1e100;for(var p=0,w=[],v=0;s>v;v++){if(c=e(r,t),t=i(r,c,h),p=o(r,t,c),u&&w.push({clusters:c,centroids:t}),a>m-p||a>(m-p)/m)return u?{clusters:c,centroids:t,iterations:w}:{clusters:c,centroids:t};m=p}return u?{clusters:c,centroids:t,iterations:w}:{clusters:c,centroids:t}}r.exports=s},function(r,t,n){t.agnes=n(131),t.diana=n(139)},function(r,t,n){"use strict";function o(r,t,n){for(var o=1e101,e=0;e<r.length;e++)for(var i=e;i<t.length;i++){var s=n(r[e],t[i]);o=Math.min(s,o)}return o}function e(r,t,n){for(var o=-1,e=0;e<r.length;e++)for(var i=e;i<t.length;i++){var s=n(r[e],t[i]);o=Math.max(s,o)}return o}function i(r,t,n){for(var o=0,e=0;e<r.length;e++)for(var i=0;i<t.length;i++)o+=n(r[e],t[i]);return o/(r.length*t.length)}function s(r,t,n){for(var o=0,e=0,i=0,s=0,a=0;a<r.length;a++)o+=r[a][0],e+=r[a][1];for(var u=0;u<t.length;u++)i+=t[u][0],s+=t[u][1];return o/=r.length,e/=r.length,i/=t.length,s/=t.length,n([o,e],[i,s])}function a(r,t,n){for(var o=0,e=0,i=0,s=0,a=0;a<r.length;a++)o+=r[a][0],e+=r[a][1];for(var u=0;u<t.length;u++)i+=t[u][0],s+=t[u][1];return o/=r.length,e/=r.length,i/=t.length,s/=t.length,n([o,e],[i,s])*r.length*t.length/(r.length+t.length)}function u(r,t){t=t||{};for(var n in l)t.hasOwnProperty(n)||(t[n]=l[n]);var u=r.length;if("string"==typeof t.kind)switch(t.kind){case"single":t.kind=o;break;case"complete":t.kind=e;break;case"average":t.kind=i;break;case"centroid":t.kind=s;break;case"ward":t.kind=a;break;default:throw new RangeError("Unknown kind of similarity")}else if("function"!=typeof t.kind)throw new TypeError("Undefined kind of similarity");for(var f=new Array(u),m=0;m<r.length;m++)f[m]=new h(m);for(var p=1e6,w={},v=0;f.length>1;){w={},p=1e6;for(var g=0;g<f.length;g++)for(var y=g+1;y<f.length;y++){var d,b;if(f[g]instanceof h)d=[r[f[g].index]];else{d=new Array(f[g].index.length);for(var x=0;x<d.length;x++)d[x]=r[f[g].index[x].index]}if(f[y]instanceof h)b=[r[f[y].index]];else{b=new Array(f[y].index.length);for(var M=0;M<b.length;M++)b[M]=r[f[y].index[M].index]}v=t.kind(d,b,t.disFunc).toFixed(4),v in w?w[v].push([f[g],f[y]]):w[v]=[[f[g],f[y]]],p=Math.min(v,p)}for(var k,R=w[p.toFixed(4)],A=new Array(R.length),j=0;R.length>0;){k=R.shift();for(var S=0;S<R.length;S++){var V=R[S].filter(function(r){return-1!==k.indexOf(r)});if(V.length>0){var E=R[S].filter(function(r){return-1===k.indexOf(r)});k=k.concat(E),R.splice(S--,1)}}A[j++]=k}A.length=j;for(var C=0;C<A.length;C++){var D=new c;D.children=A[C].concat(),D.distance=p,D.index=new Array(u);for(var I=0,O=0;O<A[C].length;O++)A[C][O]instanceof h?D.index[I++]=A[C][O]:(I+=A[C][O].index.length,D.index=A[C][O].index.concat(D.index)),f.splice(f.indexOf(A[C][O]),1);D.index.length=I,f.push(D)}}return f[0]}var f=n(132),h=n(133),c=n(134),l={disFunc:f,kind:"single"};r.exports=u},function(r,t){"use strict";function n(r,t){for(var n=0,o=0;o<r.length;o++)n+=(r[o]-t[o])*(r[o]-t[o]);return n}function o(r,t){return Math.sqrt(n(r,t))}r.exports=o,o.squared=n},function(r,t,n){"use strict";function o(r){e.call(this),this.index=r,this.distance=0,this.children=void 0}var e=n(134),i=n(135);i.inherits(o,e),r.exports=o},function(r,t){"use strict";function n(){this.children=[],this.distance=-1,this.index=[]}n.prototype.cut=function(r){if(0>r)throw new RangeError("Threshold too small");var t=new n;t.children=this.children,t.distance=this.distance,t.index=this.index;for(var o=[t],e=[];o.length>0;){var i=o.shift();r>=i.distance?e.push(i):o=o.concat(i.children)}return e},n.prototype.group=function(r){if(1>r)throw new RangeError("Number of groups too small");var t=new n;if(t.children=this.children,t.distance=this.distance,t.index=this.index,1===r)return t;for(var o,e=[t];e.length<r&&0!==e.length;)o=e.shift(),e=e.concat(o.children);if(0===e.length)throw new RangeError("Number of groups too big");for(var i=0;i<e.length;i++)e[i].distance===o.distance&&(e.concat(e[i].children.slice(1)),e[i]=e[i].children[0]);for(var s=0;s<e.length;s++)if(0!==e[s].distance){var a=e[s];a.children=a.index}return t},r.exports=n},function(r,t,n){(function(r,o){function e(r,n){var o={seen:[],stylize:s};return arguments.length>=3&&(o.depth=arguments[2]),arguments.length>=4&&(o.colors=arguments[3]),w(n)?o.showHidden=n:n&&t._extend(o,n),x(o.showHidden)&&(o.showHidden=!1),x(o.depth)&&(o.depth=2),x(o.colors)&&(o.colors=!1),x(o.customInspect)&&(o.customInspect=!0),o.colors&&(o.stylize=i),u(o,r,o.depth)}function i(r,t){var n=e.styles[t];return n?"["+e.colors[n][0]+"m"+r+"["+e.colors[n][1]+"m":r}function s(r,t){return r}function a(r){var t={};return r.forEach(function(r,n){t[r]=!0}),t}function u(r,n,o){if(r.customInspect&&n&&j(n.inspect)&&n.inspect!==t.inspect&&(!n.constructor||n.constructor.prototype!==n)){var e=n.inspect(o,r);return d(e)||(e=u(r,e,o)),e}var i=f(r,n);if(i)return i;var s=Object.keys(n),w=a(s);if(r.showHidden&&(s=Object.getOwnPropertyNames(n)),A(n)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return h(n);if(0===s.length){if(j(n)){var v=n.name?": "+n.name:"";return r.stylize("[Function"+v+"]","special")}if(M(n))return r.stylize(RegExp.prototype.toString.call(n),"regexp");if(R(n))return r.stylize(Date.prototype.toString.call(n),"date");if(A(n))return h(n)}var g="",y=!1,b=["{","}"];if(p(n)&&(y=!0,b=["[","]"]),j(n)){var x=n.name?": "+n.name:"";g=" [Function"+x+"]"}if(M(n)&&(g=" "+RegExp.prototype.toString.call(n)),R(n)&&(g=" "+Date.prototype.toUTCString.call(n)),A(n)&&(g=" "+h(n)),0===s.length&&(!y||0==n.length))return b[0]+g+b[1];if(0>o)return M(n)?r.stylize(RegExp.prototype.toString.call(n),"regexp"):r.stylize("[Object]","special");r.seen.push(n);var k;return k=y?c(r,n,o,w,s):s.map(function(t){return l(r,n,o,w,t,y)}),r.seen.pop(),m(k,g,b)}function f(r,t){if(x(t))return r.stylize("undefined","undefined");if(d(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return r.stylize(n,"string")}return y(t)?r.stylize(""+t,"number"):w(t)?r.stylize(""+t,"boolean"):v(t)?r.stylize("null","null"):void 0}function h(r){return"["+Error.prototype.toString.call(r)+"]"}function c(r,t,n,o,e){for(var i=[],s=0,a=t.length;a>s;++s)D(t,String(s))?i.push(l(r,t,n,o,String(s),!0)):i.push("");return e.forEach(function(e){e.match(/^\d+$/)||i.push(l(r,t,n,o,e,!0))}),i}function l(r,t,n,o,e,i){var s,a,f;if(f=Object.getOwnPropertyDescriptor(t,e)||{value:t[e]},f.get?a=f.set?r.stylize("[Getter/Setter]","special"):r.stylize("[Getter]","special"):f.set&&(a=r.stylize("[Setter]","special")),D(o,e)||(s="["+e+"]"),a||(r.seen.indexOf(f.value)<0?(a=v(n)?u(r,f.value,null):u(r,f.value,n-1),a.indexOf("\n")>-1&&(a=i?a.split("\n").map(function(r){return"  "+r}).join("\n").substr(2):"\n"+a.split("\n").map(function(r){return"   "+r}).join("\n"))):a=r.stylize("[Circular]","special")),x(s)){if(i&&e.match(/^\d+$/))return a;s=JSON.stringify(""+e),s.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=r.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=r.stylize(s,"string"))}return s+": "+a}function m(r,t,n){var o=0,e=r.reduce(function(r,t){return o++,t.indexOf("\n")>=0&&o++,r+t.replace(/\u001b\[\d\d?m/g,"").length+1},0);return e>60?n[0]+(""===t?"":t+"\n ")+" "+r.join(",\n  ")+" "+n[1]:n[0]+t+" "+r.join(", ")+" "+n[1]}function p(r){return Array.isArray(r)}function w(r){return"boolean"==typeof r}function v(r){return null===r}function g(r){return null==r}function y(r){return"number"==typeof r}function d(r){return"string"==typeof r}function b(r){return"symbol"==typeof r}function x(r){return void 0===r}function M(r){return k(r)&&"[object RegExp]"===V(r)}function k(r){return"object"==typeof r&&null!==r}function R(r){return k(r)&&"[object Date]"===V(r)}function A(r){return k(r)&&("[object Error]"===V(r)||r instanceof Error)}function j(r){return"function"==typeof r}function S(r){return null===r||"boolean"==typeof r||"number"==typeof r||"string"==typeof r||"symbol"==typeof r||"undefined"==typeof r}function V(r){return Object.prototype.toString.call(r)}function E(r){return 10>r?"0"+r.toString(10):r.toString(10)}function C(){var r=new Date,t=[E(r.getHours()),E(r.getMinutes()),E(r.getSeconds())].join(":");return[r.getDate(),z[r.getMonth()],t].join(" ")}function D(r,t){return Object.prototype.hasOwnProperty.call(r,t)}var I=/%[sdj%]/g;t.format=function(r){if(!d(r)){for(var t=[],n=0;n<arguments.length;n++)t.push(e(arguments[n]));return t.join(" ")}for(var n=1,o=arguments,i=o.length,s=String(r).replace(I,function(r){if("%%"===r)return"%";if(n>=i)return r;switch(r){case"%s":return String(o[n++]);case"%d":return Number(o[n++]);case"%j":try{return JSON.stringify(o[n++])}catch(t){return"[Circular]"}default:return r}}),a=o[n];i>n;a=o[++n])s+=v(a)||!k(a)?" "+a:" "+e(a);return s},t.deprecate=function(n,e){function i(){if(!s){if(o.throwDeprecation)throw new Error(e);o.traceDeprecation?console.trace(e):console.error(e),s=!0}return n.apply(this,arguments)}if(x(r.process))return function(){return t.deprecate(n,e).apply(this,arguments)};if(o.noDeprecation===!0)return n;var s=!1;return i};var O,q={};t.debuglog=function(r){if(x(O)&&(O=o.env.NODE_DEBUG||""),r=r.toUpperCase(),!q[r])if(new RegExp("\\b"+r+"\\b","i").test(O)){var n=o.pid;q[r]=function(){var o=t.format.apply(t,arguments);console.error("%s %d: %s",r,n,o)}}else q[r]=function(){};return q[r]},t.inspect=e,e.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},e.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"},t.isArray=p,t.isBoolean=w,t.isNull=v,t.isNullOrUndefined=g,t.isNumber=y,t.isString=d,t.isSymbol=b,t.isUndefined=x,t.isRegExp=M,t.isObject=k,t.isDate=R,t.isError=A,t.isFunction=j,t.isPrimitive=S,t.isBuffer=n(137);var z=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];t.log=function(){console.log("%s - %s",C(),t.format.apply(t,arguments))},t.inherits=n(138),t._extend=function(r,t){if(!t||!k(t))return r;for(var n=Object.keys(t),o=n.length;o--;)r[n[o]]=t[n[o]];return r}}).call(t,function(){return this}(),n(136))},function(r,t){function n(){f=!1,s.length?u=s.concat(u):h=-1,u.length&&o()}function o(){if(!f){var r=setTimeout(n);f=!0;for(var t=u.length;t;){for(s=u,u=[];++h<t;)s[h].run();h=-1,t=u.length}s=null,f=!1,clearTimeout(r)}}function e(r,t){this.fun=r,this.array=t}function i(){}var s,a=r.exports={},u=[],f=!1,h=-1;a.nextTick=function(r){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new e(r,t)),1!==u.length||f||setTimeout(o,0)},e.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=i,a.addListener=i,a.once=i,a.off=i,a.removeListener=i,a.removeAllListeners=i,a.emit=i,a.binding=function(r){throw new Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(r){throw new Error("process.chdir is not supported")},a.umask=function(){return 0}},function(r,t){r.exports=function(r){return r&&"object"==typeof r&&"function"==typeof r.copy&&"function"==typeof r.fill&&"function"==typeof r.readUInt8}},function(r,t){"function"==typeof Object.create?r.exports=function(r,t){r.super_=t,r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}})}:r.exports=function(r,t){r.super_=t;var n=function(){};n.prototype=t.prototype,r.prototype=new n,r.prototype.constructor=r}},function(r,t,n){"use strict";function o(r,t,n){for(var o=1e101,e=0;e<r.length;e++)for(var i=e;i<t.length;i++){var s=n(r[e],t[i]);o=Math.min(s,o)}return o}function e(r,t,n){for(var o=-1,e=0;e<r.length;e++)for(var i=e;i<t.length;i++){var s=n(r[e],t[i]);o=Math.max(s,o)}return o}function i(r,t,n){for(var o=0,e=0;e<r.length;e++)for(var i=0;i<t.length;i++)o+=n(r[e],t[i]);return o/(r.length*t.length)}function s(r,t,n){for(var o=0,e=0,i=0,s=0,a=0;a<r.length;a++)o+=r[a][0],e+=r[a][1];for(var u=0;u<t.length;u++)i+=t[u][0],s+=t[u][1];return o/=r.length,e/=r.length,i/=t.length,s/=t.length,n([o,e],[i,s])}function a(r,t,n){for(var o=0,e=0,i=0,s=0,a=0;a<r.length;a++)o+=r[a][0],e+=r[a][1];for(var u=0;u<t.length;u++)i+=t[u][0],s+=t[u][1];return o/=r.length,e/=r.length,i/=t.length,s/=t.length,n([o,e],[i,s])*r.length*t.length/(r.length+t.length)}function u(r,t,n){for(var o={d:0,p:0},e=new Array(r[0].length),i=0;i<r[0].length;i++)e[i]=t[r[0][i]];for(var s=new Array(r[1].length),a=0;a<r[1].length;a++)s[a]=t[r[1][a]];for(var u,f,h=0;h<e.length;h++){u=0;for(var c=0;c<e.length;c++)h!==c&&(u+=n(e[h],e[c]));u/=e.length-1,f=0;for(var l=0;l<s.length;l++)f+=n(e[h],s[l]);f/=s.length,u-f>o.d&&(o.d=u-f,o.p=h)}return o}function f(r,t,n){for(var o=0,e=0,i=0;i<r.length;i++)for(var s=i;s<r.length;s++)o+=n(t[r[i].index],t[r[s].index]),e++;return o/e}function h(r,t){t=t||{};for(var n in p)t.hasOwnProperty(n)||(t[n]=p[n]);if("string"==typeof t.kind)switch(t.kind){case"single":t.kind=o;break;case"complete":t.kind=e;break;case"average":t.kind=i;break;case"centroid":t.kind=s;break;case"ward":t.kind=a;break;default:throw new RangeError("Unknown kind of similarity")}else if("function"!=typeof t.kind)throw new TypeError("Undefined kind of similarity");var h=new m;h.children=new Array(r.length),h.index=new Array(r.length);for(var c=0;c<r.length;c++)h.children[c]=new l(c),h.index[c]=new l(c);h.distance=f(h.index,r,t.dist);for(var w,v,g,y,d,b=[h];b.length>0;){v=0,g=0;for(var x=0;x<b.length;x++){w=0;for(var M=0;M<b[x].length;M++)for(var k=M+1;k<b[x].length;k++)w=Math.max(t.dist(r[b[x].index[M].index],r[b[x].index[k].index]),w);w>v&&(v=w,g=x)}if(v=0,2===b[g].index.length)b[g].children=[b[g].index[0],b[g].index[1]],b[g].distance=t.dist(r[b[g].index[0].index],r[b[g].index[1].index]);else if(3===b[g].index.length){b[g].children=[b[g].index[0],b[g].index[1],b[g].index[2]];var R=[t.dist(r[b[g].index[0].index],r[b[g].index[1].index]),t.dist(r[b[g].index[1].index],r[b[g].index[2].index])];b[g].distance=(R[0]+R[1])/2}else{for(var A=new m,j=new m,S=[new Array(b[g].index.length),[]],V=0;V<S[0].length;V++)S[0][V]=V;for(var E=0;E<S[0].length;E++){y=0;for(var C=0;C<S[0].length;C++)E!==C&&(y+=t.dist(r[b[g].index[S[0][C]].index],r[b[g].index[S[0][E]].index]));y/=S[0].length-1,y>v&&(v=y,d=E)}for(S[1]=[d],S[0].splice(d,1),y=u(S,r,t.dist);y.d>0;)S[1].push(S[0][y.p]),S[0].splice(y.p,1),y=u(S,r,t.dist);var D=new Array(S[0].length);A.index=new Array(S[0].length);for(var I=0;I<D.length;I++)D[I]=r[b[g].index[S[0][I]].index],A.index[I]=b[g].index[S[0][I]],A.children[I]=b[g].index[S[0][I]];var O=new Array(S[1].length);j.index=new Array(S[1].length);for(var q=0;q<O.length;q++)O[q]=r[b[g].index[S[1][q]].index],j.index[q]=b[g].index[S[1][q]],j.children[q]=b[g].index[S[1][q]];A.distance=f(A.index,r,t.dist),j.distance=f(j.index,r,t.dist),b.push(A),b.push(j),b[g].children=[A,j]}b.splice(g,1)}return h}var c=n(132),l=n(133),m=n(134),p={dist:c,kind:"single"};r.exports=h},function(module,exports,__webpack_require__){"use strict";function SOM(r,t,n,o){this.x=r,this.y=t,n=n||{},this.options={};for(var e in defaultOptions)n.hasOwnProperty(e)?this.options[e]=n[e]:this.options[e]=defaultOptions[e];if("number"==typeof this.options.fields)this.numWeights=this.options.fields;else{if(!Array.isArray(this.options.fields))throw new Error("Invalid fields definition");this.numWeights=this.options.fields.length;var i=getConverters(this.options.fields);this.extractor=i.extractor,this.creator=i.creator}if("rect"===this.options.gridType)this.nodeType=NodeSquare,this.gridDim={x:r,y:t};else{this.nodeType=NodeHexagonal;var s=this.x-Math.floor(this.y/2);this.gridDim={x:s,y:this.y,z:-(0-s-this.y)}}if(this.torus=this.options.torus,this.distanceMethod=this.torus?"getDistanceTorus":"getDistance",this.distance=this.options.distance,this.maxDistance=getMaxDistance(this.distance,this.numWeights),o===!0)return void(this.done=!0);if(!(r>0&&t>0))throw new Error("x and y must be positive");this.times={findBMU:0,adjust:0},this.randomizer=this.options.randomizer,this.iterationCount=0,this.iterations=this.options.iterations,this.startLearningRate=this.learningRate=this.options.learningRate,this.mapRadius=Math.floor(Math.max(r,t)/2),this.algorithmMethod=this.options.method,this._initNodes(),this.done=!1}function getConverters(r){for(var t=r.length,n=new Array(t),o=new Array(t),e=0;t>e;e++)n[e]=getNormalizer(r[e].range),o[e]=getDenormalizer(r[e].range);return{extractor:function(o){for(var e=new Array(t),i=0;t>i;i++)e[i]=n[i](o[r[i].name]);return e},creator:function(n){for(var e={},i=0;t>i;i++)e[r[i].name]=o[i](n[i]);return e}}}function getNormalizer(r){return function(t){return(t-r[0])/(r[1]-r[0])}}function getDenormalizer(r){return function(t){return r[0]+t*(r[1]-r[0])}}function squareEuclidean(r,t){for(var n=0,o=0,e=r.length;e>o;o++)n+=(r[o]-t[o])*(r[o]-t[o]);return n}function getRandomValue(r,t){return r[Math.floor(t()*r.length)]}function getMaxDistance(r,t){for(var n=new Array(t),o=new Array(t),e=0;t>e;e++)n[e]=0,o[e]=1;return r(n,o)}var NodeSquare=__webpack_require__(141),NodeHexagonal=__webpack_require__(142),defaultOptions={fields:3,randomizer:Math.random,distance:squareEuclidean,iterations:10,learningRate:.1,gridType:"rect",torus:!0,method:"random"};SOM.load=function loadModel(model,distance){if("SOM"===model.name){var x=model.data.length,y=model.data[0].length;distance?model.options.distance=distance:model.options.distance&&(model.options.distance=eval("("+model.options.distance+")"));var som=new SOM(x,y,model.options,!0);som.nodes=new Array(x);for(var i=0;x>i;i++){som.nodes[i]=new Array(y);for(var j=0;y>j;j++)som.nodes[i][j]=new som.nodeType(i,j,model.data[i][j],som)}return som}throw new Error("expecting a SOM model")},SOM.prototype["export"]=function(r){if(!this.done)throw new Error("model is not ready yet");var t={name:"SOM"};t.options={fields:this.options.fields,gridType:this.options.gridType,torus:this.options.torus},t.data=new Array(this.x);for(var n=0;n<this.x;n++){t.data[n]=new Array(this.y);for(var o=0;o<this.y;o++)t.data[n][o]=this.nodes[n][o].weights}return r&&(t.options.distance=this.distance.toString()),t},SOM.prototype._initNodes=function(){var r,t,n,o=Date.now();for(this.nodes=new Array(this.x),r=0;r<this.x;r++)for(this.nodes[r]=new Array(this.y),t=0;t<this.y;t++){var e=new Array(this.numWeights);for(n=0;n<this.numWeights;n++)e[n]=this.randomizer();this.nodes[r][t]=new this.nodeType(r,t,e,this)}this.times.initNodes=Date.now()-o},SOM.prototype.setTraining=function(r){if(this.trainingSet)throw new Error("training set has already been set");var t,n=Date.now(),o=r,e=r.length;if(this.extractor)for(o=new Array(e),t=0;e>t;t++)o[t]=this.extractor(r[t]);this.numIterations=this.iterations*e,"random"===this.algorithmMethod?this.timeConstant=this.numIterations/Math.log(this.mapRadius):this.timeConstant=e/Math.log(this.mapRadius),this.trainingSet=o,this.times.setTraining=Date.now()-n},SOM.prototype.trainOne=function(){if(this.done)return!1;if(this.numIterations-->0){var r,t,n;return"random"===this.algorithmMethod?(r=this.mapRadius*Math.exp(-this.iterationCount/this.timeConstant),t=getRandomValue(this.trainingSet,this.randomizer),this._adjust(t,r),this.learningRate=this.startLearningRate*Math.exp(-this.iterationCount/this.numIterations)):(n=-Math.floor(this.iterationCount/this.trainingSet.length),r=this.mapRadius*Math.exp(n/this.timeConstant),t=this.trainingSet[this.iterationCount%this.trainingSet.length],this._adjust(t,r),(this.iterationCount+1)%this.trainingSet.length===0&&(this.learningRate=this.startLearningRate*Math.exp(n/Math.floor(this.numIterations/this.trainingSet.length)))),this.iterationCount++,!0}return this.done=!0,!1},SOM.prototype._adjust=function(r,t){var n,o,e,i,s=Date.now(),a=this._findBestMatchingUnit(r),u=Date.now();this.times.findBMU+=u-s;var f=Math.floor(t),h=a.x-f,c=a.x+f,l=a.y-f,m=a.y+f;for(n=h;c>=n;n++){var p=n;for(0>n?p+=this.x:n>=this.x&&(p-=this.x),o=l;m>=o;o++){var w=o;0>o?w+=this.y:o>=this.y&&(w-=this.y),e=a[this.distanceMethod](this.nodes[p][w]),t>e&&(i=Math.exp(-e/(2*t)),this.nodes[p][w].adjustWeights(r,this.learningRate,i))}}this.times.adjust+=Date.now()-u},SOM.prototype.train=function(r){if(!this.done)for(this.setTraining(r);this.trainOne(););},SOM.prototype.getConvertedNodes=function(){for(var r=new Array(this.x),t=0;t<this.x;t++){r[t]=new Array(this.y);for(var n=0;n<this.y;n++){var o=this.nodes[t][n];r[t][n]=this.creator?this.creator(o.weights):o.weights}}return r},SOM.prototype._findBestMatchingUnit=function(r){for(var t,n,o=1/0,e=0;e<this.x;e++)for(var i=0;i<this.y;i++)n=this.distance(this.nodes[e][i].weights,r),o>n&&(o=n,t=this.nodes[e][i]);return t},SOM.prototype.predict=function(r,t){if("boolean"==typeof r&&(t=r,r=null),r||(r=this.trainingSet),Array.isArray(r)&&(Array.isArray(r[0])||"object"==typeof r[0])){var n=this;return r.map(function(r){return n._predict(r,t)})}return this._predict(r,t)},SOM.prototype._predict=function(r,t){Array.isArray(r)||(r=this.extractor(r));var n=this._findBestMatchingUnit(r),o=[n.x,n.y];return t&&(o[2]=n.getPosition(r)),o},SOM.prototype.getQuantizationError=function(){for(var r=this.getFit(),t=r.length,n=0,o=0;t>o;o++)n+=r[o];return n/t},SOM.prototype.getFit=function(r){r||(r=this.trainingSet);for(var t,n=r.length,o=new Array(n),e=0;n>e;e++)t=this._findBestMatchingUnit(r[e]),o[e]=Math.sqrt(this.distance(r[e],t.weights));return o},module.exports=SOM},function(r,t){function n(r,t,n,o){this.x=r,this.y=t,this.weights=n,this.som=o,this.neighbors={}}n.prototype.adjustWeights=function(r,t,n){for(var o=0,e=this.weights.length;e>o;o++)this.weights[o]+=t*n*(r[o]-this.weights[o])},n.prototype.getDistance=function(r){return Math.max(Math.abs(this.x-r.x),Math.abs(this.y-r.y))},n.prototype.getDistanceTorus=function(r){
var t=Math.abs(this.x-r.x),n=Math.abs(this.y-r.y);return Math.max(Math.min(t,this.som.gridDim.x-t),Math.min(n,this.som.gridDim.y-n))},n.prototype.getNeighbors=function(r){if(!this.neighbors[r]){this.neighbors[r]=new Array(2);var t;if(this[r]>0?t=this[r]-1:this.som.torus&&(t=this.som.gridDim[r]-1),"undefined"!=typeof t){var n,o;"x"===r?(n=t,o=this.y):(n=this.x,o=t),this.neighbors[r][0]=this.som.nodes[n][o]}var e;this[r]<this.som.gridDim[r]-1?e=this[r]+1:this.som.torus&&(e=0),"undefined"!=typeof e&&("x"===r?(n=e,o=this.y):(n=this.x,o=e),this.neighbors[r][1]=this.som.nodes[n][o])}return this.neighbors[r]},n.prototype.getPos=function(r,t){var n,o,e=this.getNeighbors(r),i=this.som.distance;if(e[0])if(e[1]){var s=i(t,e[0].weights),a=i(t,e[1].weights);a>s?(n=e[0],o=-1):(n=e[1],o=1)}else n=e[0],o=-1;else n=e[1],o=1;var u=1-i(t,this.weights),f=1-i(t,n.weights),h=(u-f)/(2-u-f);return.5+.5*h*o},n.prototype.getPosition=function(r){return[this.getPos("x",r),this.getPos("y",r)]},r.exports=n},function(r,t,n){function o(r,t,n,o){e.call(this,r,t,n,o),this.hX=r-Math.floor(t/2),this.z=0-this.hX-t}var e=n(141);o.prototype=new e,o.prototype.constructor=o,o.prototype.getDistance=function(r){return Math.max(Math.abs(this.hX-r.hX),Math.abs(this.y-r.y),Math.abs(this.z-r.z))},o.prototype.getDistanceTorus=function(r){var t=Math.abs(this.hX-r.hX),n=Math.abs(this.y-r.y),o=Math.abs(this.z-r.z);return Math.max(Math.min(t,this.som.gridDim.x-t),Math.min(n,this.som.gridDim.y-n),Math.min(o,this.som.gridDim.z-o))},o.prototype.getPosition=function(){throw new Error("Unimplemented : cannot get position of the points for hexagonal grid")},r.exports=o},function(r,t,n){r.exports=n(144)},function(r,t,n){"use strict";function o(r,t){return Math.floor(Math.random()*(t-r+1)+r)}function e(r,t){r&&(this.layers=t.layers,this.inputSize=t.inputSize,this.outputSize=t.outputSize)}var i=n(145),s=n(146);r.exports=e,e.prototype.buildNetwork=function(r){r.push(this.outputSize),this.layers=new Array(r.length);for(var t=0;t<r.length;++t){var n=0==t?this.inputSize:r[t-1];this.layers[t]=new i(n,r[t])}this.layers[this.layers.length-1].isSigmoid=!1},e.prototype.forwardNN=function(r){for(var t=r.slice(),n=0;n<this.layers.length;++n)t=this.layers[n].forward(t);return t},e.prototype.iteration=function(r,t,n,o){var e=this.forwardNN(r),i=new Array(e.length);"number"==typeof t&&(t=[t]);for(var s=0;s<i.length;s++)i[s]=t[s]-e[s];var a=this.layers.length;for(s=0;a>s;++s)i=this.layers[a-1-s].train(i,n,o)},e.prototype.train=function(r,t,n){if(void 0===n&&(n={}),r.length!==t.length)throw new RangeError("the training and prediction set must have the same size.");this.inputSize=r[0].length,this.outputSize=t[0].length;var e=(void 0===n.hiddenLayers?[10]:n.hiddenLayers,void 0===n.iterations?50:n.iterations),i=void 0===n.learningRate?.1:n.learningRate,s=void 0===n.momentum?.1:n.momentum;this.buildNetwork(n.hiddenLayers);for(var a=0;e>a;++a)for(var u=0;u<t.length;++u){var f=o(0,t.length-1);this.iteration(r[f],t[f],i,s)}},e.prototype.predict=function(r){if(r[0].length!==this.inputSize)throw new RangeError("The dataset columns must have the same size of the input layer");for(var t=new Array(r.length),n=0;n<r.length;n++)t[n]=this.forwardNN(r[n]);return t=s(t),1===t.columns?t.getColumn(0):t},e.load=function(r){if("FNN"!==r.modelName)throw new RangeError("The given model is invalid!");return new e(!0,r)},e.prototype["export"]=function(){return{modelName:"FNN",layers:this.layers,inputSize:this.inputSize,outputSize:this.outputSize}}},function(r,t,n){"use strict";function o(r,t,n){var o=2.449489742783/Math.sqrt(t+n);return a.rand(1,r).mul(2*o).sub(o).getRow(0)}function e(r){return 1/(1+Math.exp(-r))}function i(r){return r*(1-r)}function s(r,t){this.output=a.zeros(1,t).getRow(0),this.input=a.zeros(1,r+1).getRow(0),this.deltaWeights=a.zeros(1,(1+r)*t).getRow(0),this.weights=o(this.deltaWeights.length,r,t),this.isSigmoid=!0}var a=n(146);r.exports=s,s.prototype.forward=function(r){this.input=r.slice(),this.input.push(1);var t=0;this.output=a.zeros(1,this.output.length).getRow(0);for(var n=0;n<this.output.length;++n){for(var o=0;o<this.input.length;++o)this.output[n]+=this.weights[t+o]*this.input[o];this.isSigmoid&&(this.output[n]=e(this.output[n])),t+=this.input.length}return this.output.slice()},s.prototype.train=function(r,t,n){for(var o=0,e=a.zeros(1,this.input.length).getRow(0),s=0;s<this.output.length;++s){var u=r[s];this.isSigmoid&&(u*=i(this.output[s]));for(var f=0;f<this.input.length;++f){var h=o+f;e[f]+=this.weights[h]*u;var c=this.input[f]*u*t;this.weights[h]+=this.deltaWeights[h]*n+c,this.deltaWeights[h]=c}o+=this.input.length}return e}},function(r,t,n){"use strict";r.exports=n(147),r.exports.Decompositions=r.exports.DC=n(148)},function(r,t){"use strict";function n(r){for(var t=0,n=r.length,o=new Array(n);n>t;t++)o[t]=r[t];return o}function o(r,t){var e,i,s=0;if(Array.isArray(r)){if(i=t,e=i?n(r):r,r=e.length,t=e[0].length,"undefined"==typeof t)throw new TypeError("Data must be a 2D array");if(!(r>0&&t>0))throw new RangeError("Invalid dimensions: "+r+"x"+t);for(;r>s;s++){if(e[s].length!==t)throw new RangeError("Inconsistent array dimensions");i&&(e[s]=n(e[s]))}}else{if("number"!=typeof r)throw new TypeError("Invalid arguments");if(!(r>0&&t>0))throw new RangeError("Invalid dimensions: "+r+"x"+t);for(e=new Array(r);r>s;s++)e[s]=new Array(t)}return Object.defineProperty(e,"rows",{writable:!0,value:r}),Object.defineProperty(e,"columns",{writable:!0,value:t}),e.__proto__=o.prototype,e}var e=Array.prototype.splice,i=Array.prototype.concat;o.from1DArray=function(r,t,n){var e,i,s=0;if(e=r*t,e!==n.length)throw new RangeError("Data length does not match given dimensions");for(i=new Array(r);r>s;s++)i[s]=n.slice(s*t,(s+1)*t);return new o(i)},o.rowVector=function(r){return new o([r])},o.columnVector=function(r){for(var t=r.length,n=new Array(t),e=0;t>e;e++)n[e]=[r[e]];return new o(n)},o.empty=function(r,t){return new o(r,t)},o.zeros=function(r,t){return o.empty(r,t).fill(0)},o.ones=function(r,t){return o.empty(r,t).fill(1)},o.rand=function(r,t){for(var n=o.empty(r,t),e=0,i=n.rows;i>e;e++)for(var s=0,a=n.columns;a>s;s++)n[e][s]=Math.random();return n},o.eye=function(r){for(var t=o.zeros(r,r),n=t.rows,e=0;n>e;e++)t[e][e]=1;return t},o.diag=function(r){for(var t=r.length,n=o.zeros(t,t),e=0;t>e;e++)n[e][e]=r[e];return n},o.indices=function(r,t){for(var n=new Array(t-r),o=0;o<n.length;o++)n[o]=r++;return n},o.stack=function(r){var t,n,e;if(o.isMatrix(r)){var i=0,s=0;for(t=0;t<arguments.length;t++)i+=arguments[t].rows,arguments[t].columns>s&&(s=arguments[t].columns);var a=o.zeros(i,s),u=0;for(t=0;t<arguments.length;t++){var f=arguments[t];for(n=0;n<f.rows;n++){for(e=0;e<f.columns;e++)a[u][e]=f[n][e];u++}}return a}if(Array.isArray(r)){var h=o.empty(arguments.length,r.length);for(t=0;t<arguments.length;t++)h.setRow(t,arguments[t]);return h}},o.expand=function(r,t){for(var n=[],e=0;e<t.length;e++)for(var i=0;i<t[e];i++)n.push(r[e]);return new o(n)},o.checkMatrix=function(r){if(!r)throw new TypeError("Argument has to be a matrix");return"Matrix"!==r.klass&&(r=new o(r)),r},o.isMatrix=function(r){return r?"Matrix"===r.klass:!1},Object.defineProperty(o.prototype,"klass",{get:function(){return"Matrix"}}),Object.defineProperty(o.prototype,"size",{get:function(){return this.rows*this.columns}}),o.prototype.checkRowIndex=function(r){if(0>r||r>this.rows-1)throw new RangeError("Row index out of range.")},o.prototype.checkColumnIndex=function(r){if(0>r||r>this.columns-1)throw new RangeError("Column index out of range.")},o.prototype.checkDimensions=function(r){if(this.rows!==r.rows||this.columns!==r.columns)throw new RangeError("Matrices dimensions must be equal.")},o.prototype.apply=function(r){for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)r.call(this,o,e);return this},o.prototype.clone=function(){return new o(this.to2DArray())},o.prototype.to1DArray=function(){return i.apply([],this)},o.prototype.to2DArray=function(){for(var r=this.rows,t=new Array(r),o=0;r>o;o++)t[o]=n(this[o]);return t},o.prototype.isRowVector=function(){return 1===this.rows},o.prototype.isColumnVector=function(){return 1===this.columns},o.prototype.isVector=function(){return 1===this.rows||1===this.columns},o.prototype.isSquare=function(){return this.rows===this.columns},o.prototype.isSymmetric=function(){if(this.isSquare()){for(var r=this.rows,t=0;r>t;t++)for(var n=0;t>=n;n++)if(this[t][n]!==this[n][t])return!1;return!0}return!1},o.prototype.set=function(r,t,n){return this[r][t]=n,this},o.prototype.get=function(r,t){return this[r][t]},o.prototype.fill=function(r){for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]=r;return this},o.prototype.neg=function(){return this.mulS(-1)},o.prototype.add=function(r){return"number"==typeof r?this.addS(r):(r=o.checkMatrix(r),this.addM(r))},o.prototype.addS=function(r){for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]+=r;return this},o.prototype.addM=function(r){this.checkDimensions(r);for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]+=r[o][e];return this},o.prototype.sub=function(r){return"number"==typeof r?this.subS(r):(r=o.checkMatrix(r),this.subM(r))},o.prototype.subS=function(r){for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]-=r;return this},o.prototype.subM=function(r){this.checkDimensions(r);for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]-=r[o][e];return this},o.prototype.mul=function(r){return"number"==typeof r?this.mulS(r):(r=o.checkMatrix(r),this.mulM(r))},o.prototype.mulS=function(r){for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]*=r;return this},o.prototype.mulM=function(r){this.checkDimensions(r);for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]*=r[o][e];return this},o.prototype.div=function(r){return"number"==typeof r?this.divS(r):(r=o.checkMatrix(r),this.divM(r))},o.prototype.divS=function(r){for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]/=r;return this},o.prototype.divM=function(r){this.checkDimensions(r);for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]/=r[o][e];return this},o.prototype.getRow=function(r){return this.checkRowIndex(r),n(this[r])},o.prototype.getRowVector=function(r){return o.rowVector(this.getRow(r))},o.prototype.setRow=function(r,t){if(this.checkRowIndex(r),o.isMatrix(t)&&(t=t.to1DArray()),t.length!==this.columns)throw new RangeError("Invalid row size");return this[r]=n(t),this},o.prototype.removeRow=function(r){if(this.checkRowIndex(r),1===this.rows)throw new RangeError("A matrix cannot have less than one row");return e.call(this,r,1),this.rows-=1,this},o.prototype.addRow=function(r,t){if("undefined"==typeof t&&(t=r,r=this.rows),0>r||r>this.rows)throw new RangeError("Row index out of range.");if(o.isMatrix(t)&&(t=t.to1DArray()),t.length!==this.columns)throw new RangeError("Invalid row size");return e.call(this,r,0,n(t)),this.rows+=1,this},o.prototype.swapRows=function(r,t){this.checkRowIndex(r),this.checkRowIndex(t);var n=this[r];return this[r]=this[t],this[t]=n,this},o.prototype.getColumn=function(r){this.checkColumnIndex(r);for(var t=this.rows,n=new Array(t),o=0;t>o;o++)n[o]=this[o][r];return n},o.prototype.getColumnVector=function(r){return o.columnVector(this.getColumn(r))},o.prototype.setColumn=function(r,t){this.checkColumnIndex(r),o.isMatrix(t)&&(t=t.to1DArray());var n=this.rows;if(t.length!==n)throw new RangeError("Invalid column size");for(var e=0;n>e;e++)this[e][r]=t[e];return this},o.prototype.removeColumn=function(r){if(this.checkColumnIndex(r),1===this.columns)throw new RangeError("A matrix cannot have less than one column");for(var t=0,n=this.rows;n>t;t++)this[t].splice(r,1);return this.columns-=1,this},o.prototype.addColumn=function(r,t){if("undefined"==typeof t&&(t=r,r=this.columns),0>r||r>this.columns)throw new RangeError("Column index out of range.");o.isMatrix(t)&&(t=t.to1DArray());var n=this.rows;if(t.length!==n)throw new RangeError("Invalid column size");for(var e=0;n>e;e++)this[e].splice(r,0,t[e]);return this.columns+=1,this},o.prototype.swapColumns=function(r,t){this.checkRowIndex(r),this.checkRowIndex(t);for(var n,o,e=this.rows,i=0;e>i;i++)o=this[i],n=o[r],o[r]=o[t],o[t]=n;return this},o.prototype.checkRowVector=function(r){if(o.isMatrix(r)&&(r=r.to1DArray()),r.length!==this.columns)throw new RangeError("vector size must be the same as the number of columns");return r},o.prototype.checkColumnVector=function(r){if(o.isMatrix(r)&&(r=r.to1DArray()),r.length!==this.rows)throw new RangeError("vector size must be the same as the number of rows");return r},o.prototype.addRowVector=function(r){r=this.checkRowVector(r);for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]+=r[e];return this},o.prototype.subRowVector=function(r){r=this.checkRowVector(r);for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]-=r[e];return this},o.prototype.mulRowVector=function(r){r=this.checkRowVector(r);for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]*=r[e];return this},o.prototype.divRowVector=function(r){r=this.checkRowVector(r);for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]/=r[e];return this},o.prototype.addColumnVector=function(r){r=this.checkColumnVector(r);for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]+=r[o];return this},o.prototype.subColumnVector=function(r){r=this.checkColumnVector(r);for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]-=r[o];return this},o.prototype.mulColumnVector=function(r){r=this.checkColumnVector(r);for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]*=r[o];return this},o.prototype.divColumnVector=function(r){r=this.checkColumnVector(r);for(var t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]/=r[o];return this},o.prototype.mulRow=function(r,t){this.checkRowIndex(r);for(var n=0,o=this.columns;o>n;n++)this[r][n]*=t;return this},o.prototype.mulColumn=function(r,t){this.checkColumnIndex(r);for(var n=0,o=this.rows;o>n;n++)this[n][r]*=t},o.prototype.max=function(){for(var r=-(1/0),t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]>r&&(r=this[o][e]);return r},o.prototype.maxIndex=function(){for(var r=-(1/0),t={},n=this.rows,o=this.columns,e=0;n>e;e++)for(var i=0;o>i;i++)this[e][i]>r&&(r=this[e][i],t.row=e,t.column=i);return t},o.prototype.min=function(){for(var r=1/0,t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)this[o][e]<r&&(r=this[o][e]);return r},o.prototype.minIndex=function(){for(var r=1/0,t={},n=this.rows,o=this.columns,e=0;n>e;e++)for(var i=0;o>i;i++)this[e][i]<r&&(r=this[e][i],t.row=e,t.column=i);return t},o.prototype.maxRow=function(r){this.checkRowIndex(r);for(var t=-(1/0),n=0,o=this.columns;o>n;n++)this[r][n]>t&&(t=this[r][n]);return t},o.prototype.maxRowIndex=function(r){this.checkRowIndex(r);for(var t=-(1/0),n={row:r},o=0,e=this.columns;e>o;o++)this[r][o]>t&&(t=this[r][o],n.column=o);return n},o.prototype.minRow=function(r){this.checkRowIndex(r);for(var t=1/0,n=0,o=this.columns;o>n;n++)this[r][n]<t&&(t=this[r][n]);return t},o.prototype.minRowIndex=function(r){this.checkRowIndex(r);for(var t=1/0,n={row:r,column:0},o=0,e=this.columns;e>o;o++)this[r][o]<t&&(t=this[r][o],n.column=o);return n},o.prototype.maxColumn=function(r){this.checkColumnIndex(r);for(var t=-(1/0),n=0,o=this.rows;o>n;n++)this[n][r]>t&&(t=this[n][r]);return t},o.prototype.maxColumnIndex=function(r){this.checkColumnIndex(r);for(var t=-(1/0),n={row:0,column:r},o=0,e=this.rows;e>o;o++)this[o][r]>t&&(t=this[o][r],n.row=o);return n},o.prototype.minColumn=function(r){this.checkColumnIndex(r);for(var t=1/0,n=0,o=this.rows;o>n;n++)this[n][r]<t&&(t=this[n][r]);return t},o.prototype.minColumnIndex=function(r){this.checkColumnIndex(r);for(var t=1/0,n={row:0,column:r},o=0,e=this.rows;e>o;o++)this[o][r]<t&&(t=this[o][r],n.row=o);return n},o.prototype.diag=function s(){if(!this.isSquare())throw new TypeError("Only square matrices have a diagonal.");for(var s=new Array(this.rows),r=0,t=this.rows;t>r;r++)s[r]=this[r][r];return s},o.prototype.sum=function(){for(var r=0,t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)r+=this[o][e];return r},o.prototype.mean=function(){return this.sum()/this.size},o.prototype.prod=function a(){for(var a=1,r=this.rows,t=this.columns,n=0;r>n;n++)for(var o=0;t>o;o++)a*=this[n][o];return a},o.prototype.cumulativeSum=function(){for(var r=0,t=this.rows,n=this.columns,o=0;t>o;o++)for(var e=0;n>e;e++)r+=this[o][e],this[o][e]=r;return this},o.prototype.dot=function u(r){if(this.size!==r.size)throw new RangeError("vectors do not have the same size");for(var t=this.to1DArray(),n=r.to1DArray(),u=0,o=t.length,e=0;o>e;e++)u+=t[e]*n[e];return u},o.prototype.mmul=function(r){if(!o.isMatrix(r))throw new TypeError('parameter "other" must be a matrix');this.columns!==r.rows&&console.warn("Number of columns of left matrix are not equal to number of rows of right matrix.");var t,n,e,i=this.rows,s=this.columns,a=r.columns,u=new o(i,a),f=new Array(s);for(n=0;a>n;n++){for(e=0;s>e;e++)f[e]=r[e][n];for(t=0;i>t;t++){var h=this[t],c=0;for(e=0;s>e;e++)c+=h[e]*f[e];u[t][n]=c}}return u},o.prototype.sortRows=function(r){for(var t=0,n=this.rows;n>t;t++)this[t].sort(r);return this},o.prototype.sortColumns=function(r){for(var t=0,n=this.columns;n>t;t++)this.setColumn(t,this.getColumn(t).sort(r));return this},o.prototype.transpose=function(){for(var r=new o(this.columns,this.rows),t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)r[i][e]=this[e][i];return r},o.prototype.subMatrix=function(r,t,n,e){if(r>t||n>e||0>r||r>=this.rows||0>t||t>=this.rows||0>n||n>=this.columns||0>e||e>=this.columns)throw new RangeError("Argument out of range");for(var i=new o(t-r+1,e-n+1),s=r;t>=s;s++)for(var a=n;e>=a;a++)i[s-r][a-n]=this[s][a];return i},o.prototype.subMatrixRow=function(r,t,n){if("undefined"==typeof t?(t=0,n=this.columns-1):"undefined"==typeof n&&(n=this.columns-1),t>n||0>t||t>=this.columns||0>n||n>=this.columns)throw new RangeError("Argument out of range.");for(var e=r.length,i=this.rows,s=new o(e,n-t+1),a=0;e>a;a++)for(var u=t;n>=u;u++){if(r[a]<0||r[a]>=i)throw new RangeError("Argument out of range.");s[a][u-t]=this[r[a]][u]}return s},o.prototype.subMatrixColumn=function(r,t,n){if("undefined"==typeof t?(t=0,n=this.rows-1):"undefined"==typeof n&&(n=this.rows-1),t>n||0>t||t>=this.rows||0>n||n>=this.rows)throw new RangeError("Argument out of range.");for(var e=r.length,i=this.columns,s=new o(n-t+1,e),a=0;e>a;a++)for(var u=t;n>=u;u++){if(r[a]<0||r[a]>=i)throw new RangeError("Argument out of range.");s[u-t][a]=this[u][r[a]]}return s},o.prototype.trace=function f(){if(!this.isSquare())throw new TypeError("The matrix is not square");for(var f=0,r=0,t=this.rows;t>r;r++)f+=this[r][r];return f},o.prototype.abs=function(){for(var r=this.rows,t=this.columns,n=0;r>n;n++)for(var o=0;t>o;o++)this[n][o]=Math.abs(this[n][o])},r.exports=o},function(r,t,n){"use strict";function o(r){return e(r,i.eye(r.rows))}function e(r,t){return r.isSquare()?new u(r).solve(t):new f(r).solve(t)}var i=n(147),s=n(149),a=n(151),u=n(152),f=n(153),h=n(154);i.prototype.inverse=function(){return o(this)},i.prototype.solve=function(r){return e(this,r)},r.exports={SingularValueDecomposition:s,SVD:s,EigenvalueDecomposition:a,EVD:a,LuDecomposition:u,LU:u,QrDecomposition:f,QR:f,CholeskyDecomposition:h,CHO:h,inverse:o,solve:e}},function(r,t,n){"use strict";function o(r,t){if(!(this instanceof o))return new o(r,t);r=e.checkMatrix(r),t=t||{};var n=r.clone(),s=r.rows,a=r.columns,u=Math.min(s,a),f=!0,h=!0;t.computeLeftSingularVectors===!1&&(f=!1),t.computeRightSingularVectors===!1&&(h=!1);var c=t.autoTranspose===!0,l=!1;if(a>s)if(c){n=n.transpose(),s=n.rows,a=n.columns,l=!0;var m=f;f=h,h=m}else console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");var p,w,v,g,y,d,b,x,M,k,R,A,j,S,V,E,C,D,I,O,q,z=new Array(Math.min(s+1,a)),T=e.zeros(s,u),U=e.zeros(a,a),L=new Array(a),_=new Array(s),N=Math.min(s-1,a),P=Math.max(0,Math.min(a-2,s));for(v=0,k=Math.max(N,P);k>v;v++){if(N>v){for(z[v]=0,p=v;s>p;p++)z[v]=i(z[v],n[p][v]);if(0!==z[v]){for(n[v][v]<0&&(z[v]=-z[v]),p=v;s>p;p++)n[p][v]/=z[v];n[v][v]+=1}z[v]=-z[v]}for(w=v+1;a>w;w++){if(N>v&&0!==z[v]){for(y=0,p=v;s>p;p++)y+=n[p][v]*n[p][w];for(y=-y/n[v][v],p=v;s>p;p++)n[p][w]+=y*n[p][v]}L[w]=n[v][w]}if(f&&N>v)for(p=v;s>p;p++)T[p][v]=n[p][v];if(P>v){for(L[v]=0,p=v+1;a>p;p++)L[v]=i(L[v],L[p]);if(0!==L[v]){for(L[v+1]<0&&(L[v]=-L[v]),p=v+1;a>p;p++)L[p]/=L[v];L[v+1]+=1}if(L[v]=-L[v],s>v+1&&0!==L[v]){for(p=v+1;s>p;p++)_[p]=0;for(w=v+1;a>w;w++)for(p=v+1;s>p;p++)_[p]+=L[w]*n[p][w];for(w=v+1;a>w;w++)for(y=-L[w]/L[v+1],p=v+1;s>p;p++)n[p][w]+=y*_[p]}if(h)for(p=v+1;a>p;p++)U[p][v]=L[p]}}if(g=Math.min(a,s+1),a>N&&(z[N]=n[N][N]),g>s&&(z[g-1]=0),g>P+1&&(L[P]=n[P][g-1]),L[g-1]=0,f){for(w=N;u>w;w++){for(p=0;s>p;p++)T[p][w]=0;T[w][w]=1}for(v=N-1;v>=0;v--)if(0!==z[v]){for(w=v+1;u>w;w++){for(y=0,p=v;s>p;p++)y+=T[p][v]*T[p][w];for(y=-y/T[v][v],p=v;s>p;p++)T[p][w]+=y*T[p][v]}for(p=v;s>p;p++)T[p][v]=-T[p][v];for(T[v][v]=1+T[v][v],p=0;v-1>p;p++)T[p][v]=0}else{for(p=0;s>p;p++)T[p][v]=0;T[v][v]=1}}if(h)for(v=a-1;v>=0;v--){if(P>v&&0!==L[v])for(w=v+1;a>w;w++){for(y=0,p=v+1;a>p;p++)y+=U[p][v]*U[p][w];for(y=-y/U[v+1][v],p=v+1;a>p;p++)U[p][w]+=y*U[p][v]}for(p=0;a>p;p++)U[p][v]=0;U[v][v]=1}for(var F=g-1,Q=0,B=Math.pow(2,-52);g>0;){for(v=g-2;v>=-1&&-1!==v;v--)if(Math.abs(L[v])<=B*(Math.abs(z[v])+Math.abs(z[v+1]))){L[v]=0;break}if(v===g-2)R=4;else{for(d=g-1;d>=v&&d!==v;d--)if(y=(d!==g?Math.abs(L[d]):0)+(d!==v+1?Math.abs(L[d-1]):0),Math.abs(z[d])<=B*y){z[d]=0;break}d===v?R=3:d===g-1?R=1:(R=2,v=d)}switch(v++,R){case 1:for(b=L[g-2],L[g-2]=0,w=g-2;w>=v;w--)if(y=i(z[w],b),x=z[w]/y,M=b/y,z[w]=y,w!==v&&(b=-M*L[w-1],L[w-1]=x*L[w-1]),h)for(p=0;a>p;p++)y=x*U[p][w]+M*U[p][g-1],U[p][g-1]=-M*U[p][w]+x*U[p][g-1],U[p][w]=y;break;case 2:for(b=L[v-1],L[v-1]=0,w=v;g>w;w++)if(y=i(z[w],b),x=z[w]/y,M=b/y,z[w]=y,b=-M*L[w],L[w]=x*L[w],f)for(p=0;s>p;p++)y=x*T[p][w]+M*T[p][v-1],T[p][v-1]=-M*T[p][w]+x*T[p][v-1],T[p][w]=y;break;case 3:for(A=Math.max(Math.max(Math.max(Math.max(Math.abs(z[g-1]),Math.abs(z[g-2])),Math.abs(L[g-2])),Math.abs(z[v])),Math.abs(L[v])),j=z[g-1]/A,S=z[g-2]/A,V=L[g-2]/A,E=z[v]/A,C=L[v]/A,D=((S+j)*(S-j)+V*V)/2,I=j*V*(j*V),O=0,(0!==D||0!==I)&&(O=Math.sqrt(D*D+I),0>D&&(O=-O),O=I/(D+O)),b=(E+j)*(E-j)+O,q=E*C,w=v;g-1>w;w++){if(y=i(b,q),x=b/y,M=q/y,w!==v&&(L[w-1]=y),b=x*z[w]+M*L[w],L[w]=x*L[w]-M*z[w],q=M*z[w+1],z[w+1]=x*z[w+1],h)for(p=0;a>p;p++)y=x*U[p][w]+M*U[p][w+1],U[p][w+1]=-M*U[p][w]+x*U[p][w+1],U[p][w]=y;if(y=i(b,q),x=b/y,M=q/y,z[w]=y,b=x*L[w]+M*z[w+1],z[w+1]=-M*L[w]+x*z[w+1],q=M*L[w+1],L[w+1]=x*L[w+1],f&&s-1>w)for(p=0;s>p;p++)y=x*T[p][w]+M*T[p][w+1],T[p][w+1]=-M*T[p][w]+x*T[p][w+1],T[p][w]=y}L[g-2]=b,Q+=1;break;case 4:if(z[v]<=0&&(z[v]=z[v]<0?-z[v]:0,h))for(p=0;F>=p;p++)U[p][v]=-U[p][v];for(;F>v&&!(z[v]>=z[v+1]);){if(y=z[v],z[v]=z[v+1],z[v+1]=y,h&&a-1>v)for(p=0;a>p;p++)y=U[p][v+1],U[p][v+1]=U[p][v],U[p][v]=y;if(f&&s-1>v)for(p=0;s>p;p++)y=T[p][v+1],T[p][v+1]=T[p][v],T[p][v]=y;v++}Q=0,g--}}if(l){var X=U;U=T,T=X}this.m=s,this.n=a,this.s=z,this.U=T,this.V=U}var e=n(147),i=n(150).hypotenuse;o.prototype={get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]},get norm2(){return this.s[0]},get rank(){for(var r=Math.pow(2,-52),t=Math.max(this.m,this.n)*this.s[0]*r,n=0,o=this.s,e=0,i=o.length;i>e;e++)o[e]>t&&n++;return n},get diagonal(){return this.s},get threshold(){return Math.pow(2,-52)/2*Math.max(this.m,this.n)*this.s[0]},get leftSingularVectors(){return this.U},get rightSingularVectors(){return this.V},get diagonalMatrix(){return e.diag(this.s)},solve:function(r){var t,n=r,o=this.threshold,i=this.s.length,s=e.zeros(i,i);for(t=0;i>t;t++)Math.abs(this.s[t])<=o?s[t][t]=0:s[t][t]=1/this.s[t];var a,u,f,h=this.V.mmul(s),c=this.V.rows,l=this.U.rows,m=e.zeros(c,l);for(t=0;c>t;t++)for(a=0;l>a;a++){for(f=0,u=0;i>u;u++)f+=h[t][u]*this.U[a][u];m[t][a]=f}return m.mmul(n)},solveForDiagonal:function(r){return this.solve(e.diag(r))},inverse:function(){var r,t,n=this.threshold,o=this.V.rows,i=this.V.columns,s=new e(o,this.s.length);for(r=0;o>r;r++)for(t=0;i>t;t++)Math.abs(this.s[t])>n?s[r][t]=this.V[r][t]/this.s[t]:s[r][t]=0;var a,u,f=this.U.rows,h=this.U.columns,c=new e(o,f);for(r=0;o>r;r++)for(t=0;f>t;t++){for(u=0,a=0;h>a;a++)u+=s[r][a]*this.U[t][a];c[r][t]=u}return c}},r.exports=o},function(r,t){"use strict";t.hypotenuse=function(r,t){var n;return Math.abs(r)>Math.abs(t)?(n=t/r,Math.abs(r)*Math.sqrt(1+n*n)):0!==t?(n=r/t,Math.abs(t)*Math.sqrt(1+n*n)):0}},function(r,t,n){"use strict";function o(r){if(!(this instanceof o))return new o(r);if(r=f.checkMatrix(r),!r.isSquare())throw new Error("Matrix is not a square matrix");var t,n,u=r.columns,h=f.zeros(u,u),c=new Array(u),l=new Array(u),m=r;if(r.isSymmetric()){for(t=0;u>t;t++)for(n=0;u>n;n++)h[t][n]=m[t][n];e(u,l,c,h),i(u,l,c,h)}else{var p=f.zeros(u,u),w=new Array(u);for(n=0;u>n;n++)for(t=0;u>t;t++)p[t][n]=m[t][n];s(u,p,w,h),a(u,l,c,h,p)}this.n=u,this.e=l,this.d=c,this.V=h}function e(r,t,n,o){var e,i,s,a,u,f,h,c;for(u=0;r>u;u++)n[u]=o[r-1][u];for(a=r-1;a>0;a--){for(c=0,s=0,f=0;a>f;f++)c+=Math.abs(n[f]);if(0===c)for(t[a]=n[a-1],u=0;a>u;u++)n[u]=o[a-1][u],o[a][u]=0,o[u][a]=0;else{for(f=0;a>f;f++)n[f]/=c,s+=n[f]*n[f];for(e=n[a-1],i=Math.sqrt(s),e>0&&(i=-i),t[a]=c*i,s-=e*i,n[a-1]=e-i,u=0;a>u;u++)t[u]=0;for(u=0;a>u;u++){for(e=n[u],o[u][a]=e,i=t[u]+o[u][u]*e,f=u+1;a-1>=f;f++)i+=o[f][u]*n[f],t[f]+=o[f][u]*e;t[u]=i}for(e=0,u=0;a>u;u++)t[u]/=s,e+=t[u]*n[u];for(h=e/(s+s),u=0;a>u;u++)t[u]-=h*n[u];for(u=0;a>u;u++){for(e=n[u],i=t[u],f=u;a-1>=f;f++)o[f][u]-=e*t[f]+i*n[f];n[u]=o[a-1][u],o[a][u]=0}}n[a]=s}for(a=0;r-1>a;a++){if(o[r-1][a]=o[a][a],o[a][a]=1,s=n[a+1],0!==s){for(f=0;a>=f;f++)n[f]=o[f][a+1]/s;for(u=0;a>=u;u++){for(i=0,f=0;a>=f;f++)i+=o[f][a+1]*o[f][u];for(f=0;a>=f;f++)o[f][u]-=i*n[f]}}for(f=0;a>=f;f++)o[f][a+1]=0}for(u=0;r>u;u++)n[u]=o[r-1][u],o[r-1][u]=0;o[r-1][r-1]=1,t[0]=0}function i(r,t,n,o){var e,i,s,a,u,f,c,l,m,p,w,v,g,y,d,b,x;for(s=1;r>s;s++)t[s-1]=t[s];t[r-1]=0;var M=0,k=0,R=Math.pow(2,-52);for(f=0;r>f;f++){for(k=Math.max(k,Math.abs(n[f])+Math.abs(t[f])),c=f;r>c&&!(Math.abs(t[c])<=R*k);)c++;if(c>f){x=0;do{for(x+=1,e=n[f],l=(n[f+1]-e)/(2*t[f]),m=h(l,1),0>l&&(m=-m),n[f]=t[f]/(l+m),n[f+1]=t[f]*(l+m),p=n[f+1],i=e-n[f],s=f+2;r>s;s++)n[s]-=i;for(M+=i,l=n[c],w=1,v=w,g=w,y=t[f+1],d=0,b=0,s=c-1;s>=f;s--)for(g=v,v=w,b=d,e=w*t[s],i=w*l,m=h(l,t[s]),t[s+1]=d*m,d=t[s]/m,w=l/m,l=w*n[s]-d*e,n[s+1]=i+d*(w*e+d*n[s]),u=0;r>u;u++)i=o[u][s+1],o[u][s+1]=d*o[u][s]+w*i,o[u][s]=w*o[u][s]-d*i;l=-d*b*g*y*t[f]/p,t[f]=d*l,n[f]=w*l}while(Math.abs(t[f])>R*k)}n[f]=n[f]+M,t[f]=0}for(s=0;r-1>s;s++){for(u=s,l=n[s],a=s+1;r>a;a++)n[a]<l&&(u=a,l=n[a]);if(u!==s)for(n[u]=n[s],n[s]=l,a=0;r>a;a++)l=o[a][s],o[a][s]=o[a][u],o[a][u]=l}}function s(r,t,n,o){var e,i,s,a,u,f,h,c=0,l=r-1;for(f=c+1;l-1>=f;f++){for(h=0,a=f;l>=a;a++)h+=Math.abs(t[a][f-1]);if(0!==h){for(s=0,a=l;a>=f;a--)n[a]=t[a][f-1]/h,s+=n[a]*n[a];for(i=Math.sqrt(s),n[f]>0&&(i=-i),s-=n[f]*i,n[f]=n[f]-i,u=f;r>u;u++){for(e=0,a=l;a>=f;a--)e+=n[a]*t[a][u];for(e/=s,a=f;l>=a;a++)t[a][u]-=e*n[a]}for(a=0;l>=a;a++){for(e=0,u=l;u>=f;u--)e+=n[u]*t[a][u];for(e/=s,u=f;l>=u;u++)t[a][u]-=e*n[u]}n[f]=h*n[f],t[f][f-1]=h*i}}for(a=0;r>a;a++)for(u=0;r>u;u++)o[a][u]=a===u?1:0;for(f=l-1;f>=c+1;f--)if(0!==t[f][f-1]){for(a=f+1;l>=a;a++)n[a]=t[a][f-1];for(u=f;l>=u;u++){for(i=0,a=f;l>=a;a++)i+=n[a]*o[a][u];for(i=i/n[f]/t[f][f-1],a=f;l>=a;a++)o[a][u]+=i*n[a]}}}function a(r,t,n,o,e){var i,s,a,f,h,c,l,m,p,w,v,g,y,d,b,x=r-1,M=0,k=r-1,R=Math.pow(2,-52),A=0,j=0,S=0,V=0,E=0,C=0,D=0,I=0;for(i=0;r>i;i++)for((M>i||i>k)&&(n[i]=e[i][i],t[i]=0),s=Math.max(i-1,0);r>s;s++)j+=Math.abs(e[i][s]);for(;x>=M;){for(f=x;f>M&&(C=Math.abs(e[f-1][f-1])+Math.abs(e[f][f]),0===C&&(C=j),!(Math.abs(e[f][f-1])<R*C));)f--;if(f===x)e[x][x]=e[x][x]+A,n[x]=e[x][x],t[x]=0,x--,I=0;else if(f===x-1){if(l=e[x][x-1]*e[x-1][x],S=(e[x-1][x-1]-e[x][x])/2,V=S*S+l,D=Math.sqrt(Math.abs(V)),e[x][x]=e[x][x]+A,e[x-1][x-1]=e[x-1][x-1]+A,m=e[x][x],V>=0){for(D=S>=0?S+D:S-D,n[x-1]=m+D,n[x]=n[x-1],0!==D&&(n[x]=m-l/D),t[x-1]=0,t[x]=0,m=e[x][x-1],C=Math.abs(m)+Math.abs(D),S=m/C,V=D/C,E=Math.sqrt(S*S+V*V),S/=E,V/=E,s=x-1;r>s;s++)D=e[x-1][s],e[x-1][s]=V*D+S*e[x][s],e[x][s]=V*e[x][s]-S*D;for(i=0;x>=i;i++)D=e[i][x-1],e[i][x-1]=V*D+S*e[i][x],e[i][x]=V*e[i][x]-S*D;for(i=M;k>=i;i++)D=o[i][x-1],o[i][x-1]=V*D+S*o[i][x],o[i][x]=V*o[i][x]-S*D}else n[x-1]=m+S,n[x]=m+S,t[x-1]=D,t[x]=-D;x-=2,I=0}else{if(m=e[x][x],p=0,l=0,x>f&&(p=e[x-1][x-1],l=e[x][x-1]*e[x-1][x]),10===I){for(A+=m,i=M;x>=i;i++)e[i][i]-=m;C=Math.abs(e[x][x-1])+Math.abs(e[x-1][x-2]),m=p=.75*C,l=-.4375*C*C}if(30===I&&(C=(p-m)/2,C=C*C+l,C>0)){for(C=Math.sqrt(C),m>p&&(C=-C),C=m-l/((p-m)/2+C),i=M;x>=i;i++)e[i][i]-=C;A+=C,m=p=l=.964}for(I+=1,h=x-2;h>=f&&(D=e[h][h],E=m-D,C=p-D,S=(E*C-l)/e[h+1][h]+e[h][h+1],V=e[h+1][h+1]-D-E-C,E=e[h+2][h+1],C=Math.abs(S)+Math.abs(V)+Math.abs(E),S/=C,V/=C,E/=C,h!==f)&&!(Math.abs(e[h][h-1])*(Math.abs(V)+Math.abs(E))<R*(Math.abs(S)*(Math.abs(e[h-1][h-1])+Math.abs(D)+Math.abs(e[h+1][h+1]))));)h--;for(i=h+2;x>=i;i++)e[i][i-2]=0,i>h+2&&(e[i][i-3]=0);for(a=h;x-1>=a&&(d=a!==x-1,a!==h&&(S=e[a][a-1],V=e[a+1][a-1],E=d?e[a+2][a-1]:0,m=Math.abs(S)+Math.abs(V)+Math.abs(E),0!==m&&(S/=m,V/=m,E/=m)),0!==m);a++)if(C=Math.sqrt(S*S+V*V+E*E),0>S&&(C=-C),0!==C){for(a!==h?e[a][a-1]=-C*m:f!==h&&(e[a][a-1]=-e[a][a-1]),S+=C,m=S/C,p=V/C,D=E/C,V/=S,E/=S,s=a;r>s;s++)S=e[a][s]+V*e[a+1][s],d&&(S+=E*e[a+2][s],e[a+2][s]=e[a+2][s]-S*D),e[a][s]=e[a][s]-S*m,e[a+1][s]=e[a+1][s]-S*p;for(i=0;i<=Math.min(x,a+3);i++)S=m*e[i][a]+p*e[i][a+1],d&&(S+=D*e[i][a+2],e[i][a+2]=e[i][a+2]-S*E),e[i][a]=e[i][a]-S,e[i][a+1]=e[i][a+1]-S*V;for(i=M;k>=i;i++)S=m*o[i][a]+p*o[i][a+1],d&&(S+=D*o[i][a+2],o[i][a+2]=o[i][a+2]-S*E),o[i][a]=o[i][a]-S,o[i][a+1]=o[i][a+1]-S*V}}}if(0!==j){for(x=r-1;x>=0;x--)if(S=n[x],V=t[x],0===V)for(f=x,e[x][x]=1,i=x-1;i>=0;i--){for(l=e[i][i]-S,E=0,s=f;x>=s;s++)E+=e[i][s]*e[s][x];if(t[i]<0)D=l,C=E;else if(f=i,0===t[i]?e[i][x]=0!==l?-E/l:-E/(R*j):(m=e[i][i+1],p=e[i+1][i],V=(n[i]-S)*(n[i]-S)+t[i]*t[i],c=(m*C-D*E)/V,e[i][x]=c,e[i+1][x]=Math.abs(m)>Math.abs(D)?(-E-l*c)/m:(-C-p*c)/D),c=Math.abs(e[i][x]),R*c*c>1)for(s=i;x>=s;s++)e[s][x]=e[s][x]/c}else if(0>V)for(f=x-1,Math.abs(e[x][x-1])>Math.abs(e[x-1][x])?(e[x-1][x-1]=V/e[x][x-1],e[x-1][x]=-(e[x][x]-S)/e[x][x-1]):(b=u(0,-e[x-1][x],e[x-1][x-1]-S,V),e[x-1][x-1]=b[0],e[x-1][x]=b[1]),e[x][x-1]=0,e[x][x]=1,i=x-2;i>=0;i--){for(w=0,v=0,s=f;x>=s;s++)w+=e[i][s]*e[s][x-1],v+=e[i][s]*e[s][x];if(l=e[i][i]-S,t[i]<0)D=l,E=w,C=v;else if(f=i,0===t[i]?(b=u(-w,-v,l,V),e[i][x-1]=b[0],e[i][x]=b[1]):(m=e[i][i+1],p=e[i+1][i],g=(n[i]-S)*(n[i]-S)+t[i]*t[i]-V*V,y=2*(n[i]-S)*V,0===g&&0===y&&(g=R*j*(Math.abs(l)+Math.abs(V)+Math.abs(m)+Math.abs(p)+Math.abs(D))),b=u(m*E-D*w+V*v,m*C-D*v-V*w,g,y),e[i][x-1]=b[0],e[i][x]=b[1],Math.abs(m)>Math.abs(D)+Math.abs(V)?(e[i+1][x-1]=(-w-l*e[i][x-1]+V*e[i][x])/m,e[i+1][x]=(-v-l*e[i][x]-V*e[i][x-1])/m):(b=u(-E-p*e[i][x-1],-C-p*e[i][x],D,V),e[i+1][x-1]=b[0],e[i+1][x]=b[1])),c=Math.max(Math.abs(e[i][x-1]),Math.abs(e[i][x])),R*c*c>1)for(s=i;x>=s;s++)e[s][x-1]=e[s][x-1]/c,e[s][x]=e[s][x]/c}for(i=0;r>i;i++)if(M>i||i>k)for(s=i;r>s;s++)o[i][s]=e[i][s];for(s=r-1;s>=M;s--)for(i=M;k>=i;i++){for(D=0,a=M;a<=Math.min(s,k);a++)D+=o[i][a]*e[a][s];o[i][s]=D}}}function u(r,t,n,o){var e,i;return Math.abs(n)>Math.abs(o)?(e=o/n,i=n+e*o,[(r+e*t)/i,(t-e*r)/i]):(e=n/o,i=o+e*n,[(e*r+t)/i,(e*t-r)/i])}var f=n(147),h=n(150).hypotenuse;o.prototype={get realEigenvalues(){return this.d},get imaginaryEigenvalues(){return this.e},get eigenvectorMatrix(){return this.V},get diagonalMatrix(){var r,t,n=this.n,o=this.e,e=this.d,i=new f(n,n);for(r=0;n>r;r++){for(t=0;n>t;t++)i[r][t]=0;i[r][r]=e[r],o[r]>0?i[r][r+1]=o[r]:o[r]<0&&(i[r][r-1]=o[r])}return i}},r.exports=o},function(r,t,n){"use strict";function o(r){if(!(this instanceof o))return new o(r);
r=e.checkMatrix(r);var t,n,i,s,a,u,f,h,c,l,m=r.clone(),p=m.rows,w=m.columns,v=new Array(p),g=1;for(t=0;p>t;t++)v[t]=t;for(c=new Array(p),n=0;w>n;n++){for(t=0;p>t;t++)c[t]=m[t][n];for(t=0;p>t;t++){for(h=m[t],l=Math.min(t,n),a=0,i=0;l>i;i++)a+=h[i]*c[i];h[n]=c[t]-=a}for(s=n,t=n+1;p>t;t++)Math.abs(c[t])>Math.abs(c[s])&&(s=t);if(s!==n){for(i=0;w>i;i++)u=m[s][i],m[s][i]=m[n][i],m[n][i]=u;f=v[s],v[s]=v[n],v[n]=f,g=-g}if(p>n&&0!==m[n][n])for(t=n+1;p>t;t++)m[t][n]/=m[n][n]}this.LU=m,this.pivotVector=v,this.pivotSign=g}var e=n(147);o.prototype={isSingular:function(){for(var r=this.LU,t=r.columns,n=0;t>n;n++)if(0===r[n][n])return!0;return!1},get determinant(){var r=this.LU;if(!r.isSquare())throw new Error("Matrix must be square");for(var t=this.pivotSign,n=r.columns,o=0;n>o;o++)t*=r[o][o];return t},get lowerTriangularFactor(){for(var r=this.LU,t=r.rows,n=r.columns,o=new e(t,n),i=0;t>i;i++)for(var s=0;n>s;s++)i>s?o[i][s]=r[i][s]:i===s?o[i][s]=1:o[i][s]=0;return o},get upperTriangularFactor(){for(var r=this.LU,t=r.rows,n=r.columns,o=new e(t,n),i=0;t>i;i++)for(var s=0;n>s;s++)s>=i?o[i][s]=r[i][s]:o[i][s]=0;return o},get pivotPermutationVector(){return this.pivotVector.slice()},solve:function(r){r=e.checkMatrix(r);var t=this.LU,n=t.rows;if(n!==r.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");var o,i,s,a=r.columns,u=r.subMatrixRow(this.pivotVector,0,a-1),f=t.columns;for(s=0;f>s;s++)for(o=s+1;f>o;o++)for(i=0;a>i;i++)u[o][i]-=u[s][i]*t[o][s];for(s=f-1;s>=0;s--){for(i=0;a>i;i++)u[s][i]/=t[s][s];for(o=0;s>o;o++)for(i=0;a>i;i++)u[o][i]-=u[s][i]*t[o][s]}return u}},r.exports=o},function(r,t,n){"use strict";function o(r){if(!(this instanceof o))return new o(r);r=e.checkMatrix(r);var t,n,s,a,u=r.clone(),f=r.rows,h=r.columns,c=new Array(h);for(s=0;h>s;s++){var l=0;for(t=s;f>t;t++)l=i(l,u[t][s]);if(0!==l){for(u[s][s]<0&&(l=-l),t=s;f>t;t++)u[t][s]/=l;for(u[s][s]+=1,n=s+1;h>n;n++){for(a=0,t=s;f>t;t++)a+=u[t][s]*u[t][n];for(a=-a/u[s][s],t=s;f>t;t++)u[t][n]+=a*u[t][s]}}c[s]=-l}this.QR=u,this.Rdiag=c}var e=n(147),i=n(150).hypotenuse;o.prototype={solve:function(r){r=e.checkMatrix(r);var t=this.QR,n=t.rows;if(r.rows!==n)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");var o,i,s,a,u=r.columns,f=r.clone(),h=t.columns;for(s=0;h>s;s++)for(i=0;u>i;i++){for(a=0,o=s;n>o;o++)a+=t[o][s]*f[o][i];for(a=-a/t[s][s],o=s;n>o;o++)f[o][i]+=a*t[o][s]}for(s=h-1;s>=0;s--){for(i=0;u>i;i++)f[s][i]/=this.Rdiag[s];for(o=0;s>o;o++)for(i=0;u>i;i++)f[o][i]-=f[s][i]*t[o][s]}return f.subMatrix(0,h-1,0,u-1)},isFullRank:function(){for(var r=this.QR.columns,t=0;r>t;t++)if(0===this.Rdiag[t])return!1;return!0},get upperTriangularFactor(){var r,t,n=this.QR,o=n.columns,i=new e(o,o);for(r=0;o>r;r++)for(t=0;o>t;t++)t>r?i[r][t]=n[r][t]:r===t?i[r][t]=this.Rdiag[r]:i[r][t]=0;return i},get orthogonalFactor(){var r,t,n,o,i=this.QR,s=i.rows,a=i.columns,u=new e(s,a);for(n=a-1;n>=0;n--){for(r=0;s>r;r++)u[r][n]=0;for(u[n][n]=1,t=n;a>t;t++)if(0!==i[n][n]){for(o=0,r=n;s>r;r++)o+=i[r][n]*u[r][t];for(o=-o/i[n][n],r=n;s>r;r++)u[r][t]+=o*i[r][n]}}return u}},r.exports=o},function(r,t,n){"use strict";function o(r){if(!(this instanceof o))return new o(r);if(r=e.checkMatrix(r),!r.isSymmetric())throw new Error("Matrix is not symmetric");var t,n,i,s=r,a=s.rows,u=new e(a,a),f=!0;for(n=0;a>n;n++){var h=u[n],c=0;for(i=0;n>i;i++){var l=u[i],m=0;for(t=0;i>t;t++)m+=l[t]*h[t];h[i]=m=(s[n][i]-m)/u[i][i],c+=m*m}for(c=s[n][n]-c,f&=c>0,u[n][n]=Math.sqrt(Math.max(c,0)),i=n+1;a>i;i++)u[n][i]=0}if(!f)throw new Error("Matrix is not positive definite");this.L=u}var e=n(147);o.prototype={get leftTriangularFactor(){return this.L},solve:function(r){r=e.checkMatrix(r);var t=this.L,n=t.rows;if(r.rows!==n)throw new Error("Matrix dimensions do not match");var o,i,s,a=r.columns,u=r.clone();for(s=0;n>s;s++)for(i=0;a>i;i++){for(o=0;s>o;o++)u[s][i]-=u[o][i]*t[s][o];u[s][i]/=t[s][s]}for(s=n-1;s>=0;s--)for(i=0;a>i;i++){for(o=s+1;n>o;o++)u[s][i]-=u[o][i]*t[o][s];u[s][i]/=t[s][s]}return u}},r.exports=o}])});
//# sourceMappingURL=ml.min.js.map