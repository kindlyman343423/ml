// ml@v0.4.0, MIT licensed. https://github.com/mljs/ml
!function(r){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=r();else if("function"==typeof define&&define.amd)define([],r);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.ML=r()}}(function(){var define,module,exports;return function r(t,n,e){function i(s,a){if(!n[s]){if(!t[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var f=n[s]={exports:{}};t[s][0].call(f.exports,function(r){var n=t[s][1][r];return i(n?n:r)},f,f.exports,r,t,n,e)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<e.length;s++)i(e[s]);return i}({1:[function(r,t,n){"use strict";n.ArrayUtils=n.AU=r("ml-array-utils"),n.BitArray=r("ml-bit-array"),n.Matrix=r("ml-matrix");var e=n.Math={};e.Distance=r("ml-distance"),e.SG=r("ml-savitzky-golay");var i=n.Stat={};i.array=r("ml-stat/array"),i.matrix=r("ml-stat/matrix"),i.PCA=r("ml-pca");var o=n.RNG={};o.XSadd=r("ml-xsadd");var s=n.SL={};s.SVM=r("ml-svm"),s.KNN=r("ml-knn"),s.NaiveBayes=r("ml-naivebayes"),s.PLS=r("ml-pls");var a=n.Clust={};a.kmeans=r("ml-kmeans"),a.hclust=r("ml-hclust");var u=n.NN=n.nn={};u.SOM=r("ml-som"),u.FNN=r("ml-fnn")},{"ml-array-utils":17,"ml-bit-array":20,"ml-distance":66,"ml-fnn":86,"ml-hclust":93,"ml-kmeans":94,"ml-knn":96,"ml-matrix":106,"ml-naivebayes":117,"ml-pca":128,"ml-pls":139,"ml-savitzky-golay":144,"ml-som":145,"ml-stat/array":148,"ml-stat/matrix":150,"ml-svm":151,"ml-xsadd":154}],2:[function(r,t){t.exports="function"==typeof Object.create?function(r,t){r.super_=t,r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}})}:function(r,t){r.super_=t;var n=function(){};n.prototype=t.prototype,r.prototype=new n,r.prototype.constructor=r}},{}],3:[function(r,t){function n(){if(!s){s=!0;for(var r,t=o.length;t;){r=o,o=[];for(var n=-1;++n<t;)r[n]();t=o.length}s=!1}}function e(){}var i=t.exports={},o=[],s=!1;i.nextTick=function(r){o.push(r),s||setTimeout(n,0)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=e,i.addListener=e,i.once=e,i.off=e,i.removeListener=e,i.removeAllListeners=e,i.emit=e,i.binding=function(){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],4:[function(r,t){t.exports=function(r){return r&&"object"==typeof r&&"function"==typeof r.copy&&"function"==typeof r.fill&&"function"==typeof r.readUInt8}},{}],5:[function(r,t,n){(function(t,e){function i(r,t){var e={seen:[],stylize:s};return arguments.length>=3&&(e.depth=arguments[2]),arguments.length>=4&&(e.colors=arguments[3]),d(t)?e.showHidden=t:t&&n._extend(e,t),b(e.showHidden)&&(e.showHidden=!1),b(e.depth)&&(e.depth=2),b(e.colors)&&(e.colors=!1),b(e.customInspect)&&(e.customInspect=!0),e.colors&&(e.stylize=o),u(e,r,e.depth)}function o(r,t){var n=i.styles[t];return n?"["+i.colors[n][0]+"m"+r+"["+i.colors[n][1]+"m":r}function s(r){return r}function a(r){var t={};return r.forEach(function(r){t[r]=!0}),t}function u(r,t,e){if(r.customInspect&&t&&j(t.inspect)&&t.inspect!==n.inspect&&(!t.constructor||t.constructor.prototype!==t)){var i=t.inspect(e,r);return w(i)||(i=u(r,i,e)),i}var o=c(r,t);if(o)return o;var s=Object.keys(t),d=a(s);if(r.showHidden&&(s=Object.getOwnPropertyNames(t)),S(t)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return f(t);if(0===s.length){if(j(t)){var g=t.name?": "+t.name:"";return r.stylize("[Function"+g+"]","special")}if(M(t))return r.stylize(RegExp.prototype.toString.call(t),"regexp");if(A(t))return r.stylize(Date.prototype.toString.call(t),"date");if(S(t))return f(t)}var v="",y=!1,x=["{","}"];if(p(t)&&(y=!0,x=["[","]"]),j(t)){var b=t.name?": "+t.name:"";v=" [Function"+b+"]"}if(M(t)&&(v=" "+RegExp.prototype.toString.call(t)),A(t)&&(v=" "+Date.prototype.toUTCString.call(t)),S(t)&&(v=" "+f(t)),0===s.length&&(!y||0==t.length))return x[0]+v+x[1];if(0>e)return M(t)?r.stylize(RegExp.prototype.toString.call(t),"regexp"):r.stylize("[Object]","special");r.seen.push(t);var k;return k=y?h(r,t,e,d,s):s.map(function(n){return l(r,t,e,d,n,y)}),r.seen.pop(),m(k,v,x)}function c(r,t){if(b(t))return r.stylize("undefined","undefined");if(w(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return r.stylize(n,"string")}return y(t)?r.stylize(""+t,"number"):d(t)?r.stylize(""+t,"boolean"):g(t)?r.stylize("null","null"):void 0}function f(r){return"["+Error.prototype.toString.call(r)+"]"}function h(r,t,n,e,i){for(var o=[],s=0,a=t.length;a>s;++s)o.push(q(t,String(s))?l(r,t,n,e,String(s),!0):"");return i.forEach(function(i){i.match(/^\d+$/)||o.push(l(r,t,n,e,i,!0))}),o}function l(r,t,n,e,i,o){var s,a,c;if(c=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]},c.get?a=c.set?r.stylize("[Getter/Setter]","special"):r.stylize("[Getter]","special"):c.set&&(a=r.stylize("[Setter]","special")),q(e,i)||(s="["+i+"]"),a||(r.seen.indexOf(c.value)<0?(a=g(n)?u(r,c.value,null):u(r,c.value,n-1),a.indexOf("\n")>-1&&(a=o?a.split("\n").map(function(r){return"  "+r}).join("\n").substr(2):"\n"+a.split("\n").map(function(r){return"   "+r}).join("\n"))):a=r.stylize("[Circular]","special")),b(s)){if(o&&i.match(/^\d+$/))return a;s=JSON.stringify(""+i),s.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=r.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=r.stylize(s,"string"))}return s+": "+a}function m(r,t,n){var e=0,i=r.reduce(function(r,t){return e++,t.indexOf("\n")>=0&&e++,r+t.replace(/\u001b\[\d\d?m/g,"").length+1},0);return i>60?n[0]+(""===t?"":t+"\n ")+" "+r.join(",\n  ")+" "+n[1]:n[0]+t+" "+r.join(", ")+" "+n[1]}function p(r){return Array.isArray(r)}function d(r){return"boolean"==typeof r}function g(r){return null===r}function v(r){return null==r}function y(r){return"number"==typeof r}function w(r){return"string"==typeof r}function x(r){return"symbol"==typeof r}function b(r){return void 0===r}function M(r){return k(r)&&"[object RegExp]"===T(r)}function k(r){return"object"==typeof r&&null!==r}function A(r){return k(r)&&"[object Date]"===T(r)}function S(r){return k(r)&&("[object Error]"===T(r)||r instanceof Error)}function j(r){return"function"==typeof r}function R(r){return null===r||"boolean"==typeof r||"number"==typeof r||"string"==typeof r||"symbol"==typeof r||"undefined"==typeof r}function T(r){return Object.prototype.toString.call(r)}function V(r){return 10>r?"0"+r.toString(10):r.toString(10)}function z(){var r=new Date,t=[V(r.getHours()),V(r.getMinutes()),V(r.getSeconds())].join(":");return[r.getDate(),O[r.getMonth()],t].join(" ")}function q(r,t){return Object.prototype.hasOwnProperty.call(r,t)}var C=/%[sdj%]/g;n.format=function(r){if(!w(r)){for(var t=[],n=0;n<arguments.length;n++)t.push(i(arguments[n]));return t.join(" ")}for(var n=1,e=arguments,o=e.length,s=String(r).replace(C,function(r){if("%%"===r)return"%";if(n>=o)return r;switch(r){case"%s":return String(e[n++]);case"%d":return Number(e[n++]);case"%j":try{return JSON.stringify(e[n++])}catch(t){return"[Circular]"}default:return r}}),a=e[n];o>n;a=e[++n])s+=g(a)||!k(a)?" "+a:" "+i(a);return s},n.deprecate=function(r,i){function o(){if(!s){if(t.throwDeprecation)throw new Error(i);t.traceDeprecation?console.trace(i):console.error(i),s=!0}return r.apply(this,arguments)}if(b(e.process))return function(){return n.deprecate(r,i).apply(this,arguments)};if(t.noDeprecation===!0)return r;var s=!1;return o};var E,D={};n.debuglog=function(r){if(b(E)&&(E=t.env.NODE_DEBUG||""),r=r.toUpperCase(),!D[r])if(new RegExp("\\b"+r+"\\b","i").test(E)){var e=t.pid;D[r]=function(){var t=n.format.apply(n,arguments);console.error("%s %d: %s",r,e,t)}}else D[r]=function(){};return D[r]},n.inspect=i,i.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},i.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"},n.isArray=p,n.isBoolean=d,n.isNull=g,n.isNullOrUndefined=v,n.isNumber=y,n.isString=w,n.isSymbol=x,n.isUndefined=b,n.isRegExp=M,n.isObject=k,n.isDate=A,n.isError=S,n.isFunction=j,n.isPrimitive=R,n.isBuffer=r("./support/isBuffer");var O=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];n.log=function(){console.log("%s - %s",z(),n.format.apply(n,arguments))},n.inherits=r("inherits"),n._extend=function(r,t){if(!t||!k(t))return r;for(var n=Object.keys(t),e=n.length;e--;)r[n[e]]=t[n[e]];return r}}).call(this,r("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":4,_process:3,inherits:2}],6:[function(r,t){"use strict";function n(r){if(!(this instanceof n))return new n(r);if(r=e.checkMatrix(r),!r.isSymmetric())throw new Error("Matrix is not symmetric");var t,i,o,s=r,a=s.rows,u=new e(a,a),c=!0;for(i=0;a>i;i++){var f=u[i],h=0;for(o=0;i>o;o++){var l=u[o],m=0;for(t=0;o>t;t++)m+=l[t]*f[t];f[o]=m=(s[i][o]-m)/u[o][o],h+=m*m}for(h=s[i][i]-h,c&=h>0,u[i][i]=Math.sqrt(Math.max(h,0)),o=i+1;a>o;o++)u[i][o]=0}if(!c)throw new Error("Matrix is not positive definite");this.L=u}var e=r("../matrix");n.prototype={get leftTriangularFactor(){return this.L},solve:function(r){r=e.checkMatrix(r);var t=this.L,n=t.rows;if(r.rows!==n)throw new Error("Matrix dimensions do not match");var i,o,s,a=r.columns,u=r.clone();for(s=0;n>s;s++)for(o=0;a>o;o++){for(i=0;s>i;i++)u[s][o]-=u[i][o]*t[s][i];u[s][o]/=t[s][s]}for(s=n-1;s>=0;s--)for(o=0;a>o;o++){for(i=s+1;n>i;i++)u[s][o]-=u[i][o]*t[i][s];u[s][o]/=t[s][s]}return u}},t.exports=n},{"../matrix":14}],7:[function(r,t){"use strict";function n(r){if(!(this instanceof n))return new n(r);if(r=u.checkMatrix(r),!r.isSquare())throw new Error("Matrix is not a square matrix");var t,a,c=r.columns,f=u.zeros(c,c),h=new Array(c),l=new Array(c),m=r;if(r.isSymmetric()){for(t=0;c>t;t++)for(a=0;c>a;a++)f[t][a]=m[t][a];e(c,l,h,f),i(c,l,h,f)}else{var p=u.zeros(c,c),d=new Array(c);for(a=0;c>a;a++)for(t=0;c>t;t++)p[t][a]=m[t][a];o(c,p,d,f),s(c,l,h,f,p)}this.n=c,this.e=l,this.d=h,this.V=f}function e(r,t,n,e){var i,o,s,a,u,c,f,h;for(u=0;r>u;u++)n[u]=e[r-1][u];for(a=r-1;a>0;a--){for(h=0,s=0,c=0;a>c;c++)h+=Math.abs(n[c]);if(0===h)for(t[a]=n[a-1],u=0;a>u;u++)n[u]=e[a-1][u],e[a][u]=0,e[u][a]=0;else{for(c=0;a>c;c++)n[c]/=h,s+=n[c]*n[c];for(i=n[a-1],o=Math.sqrt(s),i>0&&(o=-o),t[a]=h*o,s-=i*o,n[a-1]=i-o,u=0;a>u;u++)t[u]=0;for(u=0;a>u;u++){for(i=n[u],e[u][a]=i,o=t[u]+e[u][u]*i,c=u+1;a-1>=c;c++)o+=e[c][u]*n[c],t[c]+=e[c][u]*i;t[u]=o}for(i=0,u=0;a>u;u++)t[u]/=s,i+=t[u]*n[u];for(f=i/(s+s),u=0;a>u;u++)t[u]-=f*n[u];for(u=0;a>u;u++){for(i=n[u],o=t[u],c=u;a-1>=c;c++)e[c][u]-=i*t[c]+o*n[c];n[u]=e[a-1][u],e[a][u]=0}}n[a]=s}for(a=0;r-1>a;a++){if(e[r-1][a]=e[a][a],e[a][a]=1,s=n[a+1],0!==s){for(c=0;a>=c;c++)n[c]=e[c][a+1]/s;for(u=0;a>=u;u++){for(o=0,c=0;a>=c;c++)o+=e[c][a+1]*e[c][u];for(c=0;a>=c;c++)e[c][u]-=o*n[c]}}for(c=0;a>=c;c++)e[c][a+1]=0}for(u=0;r>u;u++)n[u]=e[r-1][u],e[r-1][u]=0;e[r-1][r-1]=1,t[0]=0}function i(r,t,n,e){var i,o,s,a,u,f,h,l,m,p,d,g,v,y,w,x,b;for(s=1;r>s;s++)t[s-1]=t[s];t[r-1]=0;var M=0,k=0,A=Math.pow(2,-52);for(f=0;r>f;f++){for(k=Math.max(k,Math.abs(n[f])+Math.abs(t[f])),h=f;r>h&&!(Math.abs(t[h])<=A*k);)h++;if(h>f){b=0;do{for(b+=1,i=n[f],l=(n[f+1]-i)/(2*t[f]),m=c(l,1),0>l&&(m=-m),n[f]=t[f]/(l+m),n[f+1]=t[f]*(l+m),p=n[f+1],o=i-n[f],s=f+2;r>s;s++)n[s]-=o;for(M+=o,l=n[h],d=1,g=d,v=d,y=t[f+1],w=0,x=0,s=h-1;s>=f;s--)for(v=g,g=d,x=w,i=d*t[s],o=d*l,m=c(l,t[s]),t[s+1]=w*m,w=t[s]/m,d=l/m,l=d*n[s]-w*i,n[s+1]=o+w*(d*i+w*n[s]),u=0;r>u;u++)o=e[u][s+1],e[u][s+1]=w*e[u][s]+d*o,e[u][s]=d*e[u][s]-w*o;l=-w*x*v*y*t[f]/p,t[f]=w*l,n[f]=d*l}while(Math.abs(t[f])>A*k)}n[f]=n[f]+M,t[f]=0}for(s=0;r-1>s;s++){for(u=s,l=n[s],a=s+1;r>a;a++)n[a]<l&&(u=a,l=n[a]);if(u!==s)for(n[u]=n[s],n[s]=l,a=0;r>a;a++)l=e[a][s],e[a][s]=e[a][u],e[a][u]=l}}function o(r,t,n,e){var i,o,s,a,u,c,f,h=0,l=r-1;for(c=h+1;l-1>=c;c++){for(f=0,a=c;l>=a;a++)f+=Math.abs(t[a][c-1]);if(0!==f){for(s=0,a=l;a>=c;a--)n[a]=t[a][c-1]/f,s+=n[a]*n[a];for(o=Math.sqrt(s),n[c]>0&&(o=-o),s-=n[c]*o,n[c]=n[c]-o,u=c;r>u;u++){for(i=0,a=l;a>=c;a--)i+=n[a]*t[a][u];for(i/=s,a=c;l>=a;a++)t[a][u]-=i*n[a]}for(a=0;l>=a;a++){for(i=0,u=l;u>=c;u--)i+=n[u]*t[a][u];for(i/=s,u=c;l>=u;u++)t[a][u]-=i*n[u]}n[c]=f*n[c],t[c][c-1]=f*o}}for(a=0;r>a;a++)for(u=0;r>u;u++)e[a][u]=a===u?1:0;for(c=l-1;c>=h+1;c--)if(0!==t[c][c-1]){for(a=c+1;l>=a;a++)n[a]=t[a][c-1];for(u=c;l>=u;u++){for(o=0,a=c;l>=a;a++)o+=n[a]*e[a][u];for(o=o/n[c]/t[c][c-1],a=c;l>=a;a++)e[a][u]+=o*n[a]}}}function s(r,t,n,e,i){var o,s,u,c,f,h,l,m,p,d,g,v,y,w,x,b=r-1,M=0,k=r-1,A=Math.pow(2,-52),S=0,j=0,R=0,T=0,V=0,z=0,q=0,C=0;for(o=0;r>o;o++)for((M>o||o>k)&&(n[o]=i[o][o],t[o]=0),s=Math.max(o-1,0);r>s;s++)j+=Math.abs(i[o][s]);for(;b>=M;){for(c=b;c>M&&(z=Math.abs(i[c-1][c-1])+Math.abs(i[c][c]),0===z&&(z=j),!(Math.abs(i[c][c-1])<A*z));)c--;if(c===b)i[b][b]=i[b][b]+S,n[b]=i[b][b],t[b]=0,b--,C=0;else if(c===b-1){if(l=i[b][b-1]*i[b-1][b],R=(i[b-1][b-1]-i[b][b])/2,T=R*R+l,q=Math.sqrt(Math.abs(T)),i[b][b]=i[b][b]+S,i[b-1][b-1]=i[b-1][b-1]+S,m=i[b][b],T>=0){for(q=R>=0?R+q:R-q,n[b-1]=m+q,n[b]=n[b-1],0!==q&&(n[b]=m-l/q),t[b-1]=0,t[b]=0,m=i[b][b-1],z=Math.abs(m)+Math.abs(q),R=m/z,T=q/z,V=Math.sqrt(R*R+T*T),R/=V,T/=V,s=b-1;r>s;s++)q=i[b-1][s],i[b-1][s]=T*q+R*i[b][s],i[b][s]=T*i[b][s]-R*q;for(o=0;b>=o;o++)q=i[o][b-1],i[o][b-1]=T*q+R*i[o][b],i[o][b]=T*i[o][b]-R*q;for(o=M;k>=o;o++)q=e[o][b-1],e[o][b-1]=T*q+R*e[o][b],e[o][b]=T*e[o][b]-R*q}else n[b-1]=m+R,n[b]=m+R,t[b-1]=q,t[b]=-q;b-=2,C=0}else{if(m=i[b][b],p=0,l=0,b>c&&(p=i[b-1][b-1],l=i[b][b-1]*i[b-1][b]),10===C){for(S+=m,o=M;b>=o;o++)i[o][o]-=m;z=Math.abs(i[b][b-1])+Math.abs(i[b-1][b-2]),m=p=.75*z,l=-.4375*z*z}if(30===C&&(z=(p-m)/2,z=z*z+l,z>0)){for(z=Math.sqrt(z),m>p&&(z=-z),z=m-l/((p-m)/2+z),o=M;b>=o;o++)i[o][o]-=z;S+=z,m=p=l=.964}for(C+=1,f=b-2;f>=c&&(q=i[f][f],V=m-q,z=p-q,R=(V*z-l)/i[f+1][f]+i[f][f+1],T=i[f+1][f+1]-q-V-z,V=i[f+2][f+1],z=Math.abs(R)+Math.abs(T)+Math.abs(V),R/=z,T/=z,V/=z,f!==c)&&!(Math.abs(i[f][f-1])*(Math.abs(T)+Math.abs(V))<A*Math.abs(R)*(Math.abs(i[f-1][f-1])+Math.abs(q)+Math.abs(i[f+1][f+1])));)f--;for(o=f+2;b>=o;o++)i[o][o-2]=0,o>f+2&&(i[o][o-3]=0);for(u=f;b-1>=u&&(w=u!==b-1,u!==f&&(R=i[u][u-1],T=i[u+1][u-1],V=w?i[u+2][u-1]:0,m=Math.abs(R)+Math.abs(T)+Math.abs(V),0!==m&&(R/=m,T/=m,V/=m)),0!==m);u++)if(z=Math.sqrt(R*R+T*T+V*V),0>R&&(z=-z),0!==z){for(u!==f?i[u][u-1]=-z*m:c!==f&&(i[u][u-1]=-i[u][u-1]),R+=z,m=R/z,p=T/z,q=V/z,T/=R,V/=R,s=u;r>s;s++)R=i[u][s]+T*i[u+1][s],w&&(R+=V*i[u+2][s],i[u+2][s]=i[u+2][s]-R*q),i[u][s]=i[u][s]-R*m,i[u+1][s]=i[u+1][s]-R*p;for(o=0;o<=Math.min(b,u+3);o++)R=m*i[o][u]+p*i[o][u+1],w&&(R+=q*i[o][u+2],i[o][u+2]=i[o][u+2]-R*V),i[o][u]=i[o][u]-R,i[o][u+1]=i[o][u+1]-R*T;for(o=M;k>=o;o++)R=m*e[o][u]+p*e[o][u+1],w&&(R+=q*e[o][u+2],e[o][u+2]=e[o][u+2]-R*V),e[o][u]=e[o][u]-R,e[o][u+1]=e[o][u+1]-R*T}}}if(0!==j){for(b=r-1;b>=0;b--)if(R=n[b],T=t[b],0===T)for(c=b,i[b][b]=1,o=b-1;o>=0;o--){for(l=i[o][o]-R,V=0,s=c;b>=s;s++)V+=i[o][s]*i[s][b];if(t[o]<0)q=l,z=V;else if(c=o,0===t[o]?i[o][b]=0!==l?-V/l:-V/(A*j):(m=i[o][o+1],p=i[o+1][o],T=(n[o]-R)*(n[o]-R)+t[o]*t[o],h=(m*z-q*V)/T,i[o][b]=h,i[o+1][b]=Math.abs(m)>Math.abs(q)?(-V-l*h)/m:(-z-p*h)/q),h=Math.abs(i[o][b]),A*h*h>1)for(s=o;b>=s;s++)i[s][b]=i[s][b]/h}else if(0>T)for(c=b-1,Math.abs(i[b][b-1])>Math.abs(i[b-1][b])?(i[b-1][b-1]=T/i[b][b-1],i[b-1][b]=-(i[b][b]-R)/i[b][b-1]):(x=a(0,-i[b-1][b],i[b-1][b-1]-R,T),i[b-1][b-1]=x[0],i[b-1][b]=x[1]),i[b][b-1]=0,i[b][b]=1,o=b-2;o>=0;o--){for(d=0,g=0,s=c;b>=s;s++)d+=i[o][s]*i[s][b-1],g+=i[o][s]*i[s][b];if(l=i[o][o]-R,t[o]<0)q=l,V=d,z=g;else if(c=o,0===t[o]?(x=a(-d,-g,l,T),i[o][b-1]=x[0],i[o][b]=x[1]):(m=i[o][o+1],p=i[o+1][o],v=(n[o]-R)*(n[o]-R)+t[o]*t[o]-T*T,y=2*(n[o]-R)*T,0===v&&0===y&&(v=A*j*(Math.abs(l)+Math.abs(T)+Math.abs(m)+Math.abs(p)+Math.abs(q))),x=a(m*V-q*d+T*g,m*z-q*g-T*d,v,y),i[o][b-1]=x[0],i[o][b]=x[1],Math.abs(m)>Math.abs(q)+Math.abs(T)?(i[o+1][b-1]=(-d-l*i[o][b-1]+T*i[o][b])/m,i[o+1][b]=(-g-l*i[o][b]-T*i[o][b-1])/m):(x=a(-V-p*i[o][b-1],-z-p*i[o][b],q,T),i[o+1][b-1]=x[0],i[o+1][b]=x[1])),h=Math.max(Math.abs(i[o][b-1]),Math.abs(i[o][b])),A*h*h>1)for(s=o;b>=s;s++)i[s][b-1]=i[s][b-1]/h,i[s][b]=i[s][b]/h}for(o=0;r>o;o++)if(M>o||o>k)for(s=o;r>s;s++)e[o][s]=i[o][s];for(s=r-1;s>=M;s--)for(o=M;k>=o;o++){for(q=0,u=M;u<=Math.min(s,k);u++)q+=e[o][u]*i[u][s];e[o][s]=q}}}function a(r,t,n,e){var i,o;return Math.abs(n)>Math.abs(e)?(i=e/n,o=n+i*e,[(r+i*t)/o,(t-i*r)/o]):(i=n/e,o=e+i*n,[(i*r+t)/o,(i*t-r)/o])}var u=r("../matrix"),c=r("./util").hypotenuse;n.prototype={get realEigenvalues(){return this.d},get imaginaryEigenvalues(){return this.e},get eigenvectorMatrix(){return this.V},get diagonalMatrix(){var r,t,n=this.n,e=this.e,i=this.d,o=new u(n,n);for(r=0;n>r;r++){for(t=0;n>t;t++)o[r][t]=0;o[r][r]=i[r],e[r]>0?o[r][r+1]=e[r]:e[r]<0&&(o[r][r-1]=e[r])}return o}},t.exports=n},{"../matrix":14,"./util":11}],8:[function(r,t){"use strict";function n(r){if(!(this instanceof n))return new n(r);r=e.checkMatrix(r);var t,i,o,s,a,u,c,f,h,l,m=r.clone(),p=m.rows,d=m.columns,g=new Array(p),v=1;for(t=0;p>t;t++)g[t]=t;for(h=new Array(p),i=0;d>i;i++){for(t=0;p>t;t++)h[t]=m[t][i];for(t=0;p>t;t++){for(f=m[t],l=Math.min(t,i),a=0,o=0;l>o;o++)a+=f[o]*h[o];f[i]=h[t]-=a}for(s=i,t=i+1;p>t;t++)Math.abs(h[t])>Math.abs(h[s])&&(s=t);if(s!==i){for(o=0;d>o;o++)u=m[s][o],m[s][o]=m[i][o],m[i][o]=u;c=g[s],g[s]=g[i],g[i]=c,v=-v}if(p>i&&0!==m[i][i])for(t=i+1;p>t;t++)m[t][i]/=m[i][i]}this.LU=m,this.pivotVector=g,this.pivotSign=v}var e=r("../matrix");n.prototype={isSingular:function(){for(var r=this.LU,t=r.columns,n=0;t>n;n++)if(0===r[n][n])return!0;return!1},get determinant(){var r=this.LU;if(!r.isSquare())throw new Error("Matrix must be square");for(var t=this.pivotSign,n=r.columns,e=0;n>e;e++)t*=r[e][e];return t},get lowerTriangularFactor(){for(var r=this.LU,t=r.rows,n=r.columns,i=new e(t,n),o=0;t>o;o++)for(var s=0;n>s;s++)i[o][s]=o>s?r[o][s]:o===s?1:0;return i},get upperTriangularFactor(){for(var r=this.LU,t=r.rows,n=r.columns,i=new e(t,n),o=0;t>o;o++)for(var s=0;n>s;s++)i[o][s]=s>=o?r[o][s]:0;return i},get pivotPermutationVector(){return this.pivotVector.slice()},solve:function(r){r=e.checkMatrix(r);var t=this.LU,n=t.rows;if(n!==r.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");var i,o,s,a=r.columns,u=r.subMatrixRow(this.pivotVector,0,a-1),c=t.columns;for(s=0;c>s;s++)for(i=s+1;c>i;i++)for(o=0;a>o;o++)u[i][o]-=u[s][o]*t[i][s];for(s=c-1;s>=0;s--){for(o=0;a>o;o++)u[s][o]/=t[s][s];for(i=0;s>i;i++)for(o=0;a>o;o++)u[i][o]-=u[s][o]*t[i][s]}return u}},t.exports=n},{"../matrix":14}],9:[function(r,t){"use strict";function n(r){if(!(this instanceof n))return new n(r);r=e.checkMatrix(r);var t,o,s,a,u=r.clone(),c=r.rows,f=r.columns,h=new Array(f);for(s=0;f>s;s++){var l=0;for(t=s;c>t;t++)l=i(l,u[t][s]);if(0!==l){for(u[s][s]<0&&(l=-l),t=s;c>t;t++)u[t][s]/=l;for(u[s][s]+=1,o=s+1;f>o;o++){for(a=0,t=s;c>t;t++)a+=u[t][s]*u[t][o];for(a=-a/u[s][s],t=s;c>t;t++)u[t][o]+=a*u[t][s]}}h[s]=-l}this.QR=u,this.Rdiag=h}var e=r("../matrix"),i=r("./util").hypotenuse;n.prototype={solve:function(r){r=e.checkMatrix(r);var t=this.QR,n=t.rows;if(r.rows!==n)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");var i,o,s,a,u=r.columns,c=r.clone(),f=t.columns;for(s=0;f>s;s++)for(o=0;u>o;o++){for(a=0,i=s;n>i;i++)a+=t[i][s]*c[i][o];for(a=-a/t[s][s],i=s;n>i;i++)c[i][o]+=a*t[i][s]}for(s=f-1;s>=0;s--){for(o=0;u>o;o++)c[s][o]/=this.Rdiag[s];for(i=0;s>i;i++)for(o=0;u>o;o++)c[i][o]-=c[s][o]*t[i][s]}return c.subMatrix(0,f-1,0,u-1)},isFullRank:function(){for(var r=this.QR.columns,t=0;r>t;t++)if(0===this.Rdiag[t])return!1;return!0},get upperTriangularFactor(){var r,t,n=this.QR,i=n.columns,o=new e(i,i);for(r=0;i>r;r++)for(t=0;i>t;t++)o[r][t]=t>r?n[r][t]:r===t?this.Rdiag[r]:0;return o},get orthogonalFactor(){var r,t,n,i,o=this.QR,s=o.rows,a=o.columns,u=new e(s,a);for(n=a-1;n>=0;n--){for(r=0;s>r;r++)u[r][n]=0;for(u[n][n]=1,t=n;a>t;t++)if(0!==o[n][n]){for(i=0,r=n;s>r;r++)i+=o[r][n]*u[r][t];for(i=-i/o[n][n],r=n;s>r;r++)u[r][t]+=i*o[r][n]}}return u}},t.exports=n},{"../matrix":14,"./util":11}],10:[function(r,t){"use strict";function n(r,t){if(!(this instanceof n))return new n(r,t);r=e.checkMatrix(r),t=t||{};var o=r.clone(),s=r.rows,a=r.columns,u=Math.min(s,a),c=!0,f=!0;t.computeLeftSingularVectors===!1&&(c=!1),t.computeRightSingularVectors===!1&&(f=!1);var h=t.autoTranspose===!0,l=!1;if(a>s)if(h){o=o.transpose(),s=o.rows,a=o.columns,l=!0;var m=c;c=f,f=m}else console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");var p,d,g,v,y,w,x,b,M,k,A,S,j,R,T,V,z,q,C,E,D,O=new Array(Math.min(s+1,a)),N=e.zeros(s,u),P=e.zeros(a,a),_=new Array(a),I=new Array(s),U=Math.min(s-1,a),F=Math.max(0,Math.min(a-2,s));for(g=0,k=Math.max(U,F);k>g;g++){if(U>g){for(O[g]=0,p=g;s>p;p++)O[g]=i(O[g],o[p][g]);if(0!==O[g]){for(o[g][g]<0&&(O[g]=-O[g]),p=g;s>p;p++)o[p][g]/=O[g];o[g][g]+=1}O[g]=-O[g]}for(d=g+1;a>d;d++){if(U>g&&0!==O[g]){for(y=0,p=g;s>p;p++)y+=o[p][g]*o[p][d];for(y=-y/o[g][g],p=g;s>p;p++)o[p][d]+=y*o[p][g]}_[d]=o[g][d]}if(c&&U>g)for(p=g;s>p;p++)N[p][g]=o[p][g];if(F>g){for(_[g]=0,p=g+1;a>p;p++)_[g]=i(_[g],_[p]);if(0!==_[g]){for(_[g+1]<0&&(_[g]=-_[g]),p=g+1;a>p;p++)_[p]/=_[g];_[g+1]+=1}if(_[g]=-_[g],s>g+1&&0!==_[g]){for(p=g+1;s>p;p++)I[p]=0;for(d=g+1;a>d;d++)for(p=g+1;s>p;p++)I[p]+=_[d]*o[p][d];for(d=g+1;a>d;d++)for(y=-_[d]/_[g+1],p=g+1;s>p;p++)o[p][d]+=y*I[p]}if(f)for(p=g+1;a>p;p++)P[p][g]=_[p]}}if(v=Math.min(a,s+1),a>U&&(O[U]=o[U][U]),v>s&&(O[v-1]=0),v>F+1&&(_[F]=o[F][v-1]),_[v-1]=0,c){for(d=U;u>d;d++){for(p=0;s>p;p++)N[p][d]=0;N[d][d]=1}for(g=U-1;g>=0;g--)if(0!==O[g]){for(d=g+1;u>d;d++){for(y=0,p=g;s>p;p++)y+=N[p][g]*N[p][d];for(y=-y/N[g][g],p=g;s>p;p++)N[p][d]+=y*N[p][g]}for(p=g;s>p;p++)N[p][g]=-N[p][g];for(N[g][g]=1+N[g][g],p=0;g-1>p;p++)N[p][g]=0}else{for(p=0;s>p;p++)N[p][g]=0;N[g][g]=1}}if(f)for(g=a-1;g>=0;g--){if(F>g&&0!==_[g])for(d=g+1;a>d;d++){for(y=0,p=g+1;a>p;p++)y+=P[p][g]*P[p][d];for(y=-y/P[g+1][g],p=g+1;a>p;p++)P[p][d]+=y*P[p][g]}for(p=0;a>p;p++)P[p][g]=0;P[g][g]=1}for(var L=v-1,B=0,X=Math.pow(2,-52);v>0;){for(g=v-2;g>=-1&&-1!==g;g--)if(Math.abs(_[g])<=X*(Math.abs(O[g])+Math.abs(O[g+1]))){_[g]=0;break}if(g===v-2)A=4;else{for(w=v-1;w>=g&&w!==g;w--)if(y=(w!==v?Math.abs(_[w]):0)+(w!==g+1?Math.abs(_[w-1]):0),Math.abs(O[w])<=X*y){O[w]=0;break}w===g?A=3:w===v-1?A=1:(A=2,g=w)}switch(g++,A){case 1:for(x=_[v-2],_[v-2]=0,d=v-2;d>=g;d--)if(y=i(O[d],x),b=O[d]/y,M=x/y,O[d]=y,d!==g&&(x=-M*_[d-1],_[d-1]=b*_[d-1]),f)for(p=0;a>p;p++)y=b*P[p][d]+M*P[p][v-1],P[p][v-1]=-M*P[p][d]+b*P[p][v-1],P[p][d]=y;break;case 2:for(x=_[g-1],_[g-1]=0,d=g;v>d;d++)if(y=i(O[d],x),b=O[d]/y,M=x/y,O[d]=y,x=-M*_[d],_[d]=b*_[d],c)for(p=0;s>p;p++)y=b*N[p][d]+M*N[p][g-1],N[p][g-1]=-M*N[p][d]+b*N[p][g-1],N[p][d]=y;break;case 3:for(S=Math.max(Math.max(Math.max(Math.max(Math.abs(O[v-1]),Math.abs(O[v-2])),Math.abs(_[v-2])),Math.abs(O[g])),Math.abs(_[g])),j=O[v-1]/S,R=O[v-2]/S,T=_[v-2]/S,V=O[g]/S,z=_[g]/S,q=((R+j)*(R-j)+T*T)/2,C=j*T*j*T,E=0,(0!==q||0!==C)&&(E=Math.sqrt(q*q+C),0>q&&(E=-E),E=C/(q+E)),x=(V+j)*(V-j)+E,D=V*z,d=g;v-1>d;d++){if(y=i(x,D),b=x/y,M=D/y,d!==g&&(_[d-1]=y),x=b*O[d]+M*_[d],_[d]=b*_[d]-M*O[d],D=M*O[d+1],O[d+1]=b*O[d+1],f)for(p=0;a>p;p++)y=b*P[p][d]+M*P[p][d+1],P[p][d+1]=-M*P[p][d]+b*P[p][d+1],P[p][d]=y;if(y=i(x,D),b=x/y,M=D/y,O[d]=y,x=b*_[d]+M*O[d+1],O[d+1]=-M*_[d]+b*O[d+1],D=M*_[d+1],_[d+1]=b*_[d+1],c&&s-1>d)for(p=0;s>p;p++)y=b*N[p][d]+M*N[p][d+1],N[p][d+1]=-M*N[p][d]+b*N[p][d+1],N[p][d]=y}_[v-2]=x,B+=1;break;case 4:if(O[g]<=0&&(O[g]=O[g]<0?-O[g]:0,f))for(p=0;L>=p;p++)P[p][g]=-P[p][g];for(;L>g&&!(O[g]>=O[g+1]);){if(y=O[g],O[g]=O[g+1],O[g+1]=y,f&&a-1>g)for(p=0;a>p;p++)y=P[p][g+1],P[p][g+1]=P[p][g],P[p][g]=y;if(c&&s-1>g)for(p=0;s>p;p++)y=N[p][g+1],N[p][g+1]=N[p][g],N[p][g]=y;g++}B=0,v--}}if(l){var Q=P;P=N,N=Q}this.m=s,this.n=a,this.s=O,this.U=N,this.V=P}var e=r("../matrix"),i=r("./util").hypotenuse;n.prototype={get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]},get norm2(){return this.s[0]},get rank(){for(var r=Math.pow(2,-52),t=Math.max(this.m,this.n)*this.s[0]*r,n=0,e=this.s,i=0,o=e.length;o>i;i++)e[i]>t&&n++;return n},get diagonal(){return this.s},get threshold(){return Math.pow(2,-52)/2*Math.max(this.m,this.n)*this.s[0]},get leftSingularVectors(){return this.U},get rightSingularVectors(){return this.V},get diagonalMatrix(){return e.diag(this.s)},solve:function(r){var t,n=r,i=this.threshold,o=this.s.length,s=e.zeros(o,o);for(t=0;o>t;t++)s[t][t]=Math.abs(this.s[t])<=i?0:1/this.s[t];var a,u,c,f=this.V.mmul(s),h=this.V.rows,l=this.U.rows,m=e.zeros(h,l);for(t=0;h>t;t++)for(a=0;l>a;a++){for(c=0,u=0;o>u;u++)c+=f[t][u]*this.U[a][u];m[t][a]=c}return m.mmul(n)},solveForDiagonal:function(r){return this.solve(e.diag(r))},inverse:function(){var r,t,n=this.threshold,i=this.V.rows,o=this.V.columns,s=new e(i,this.s.length);for(r=0;i>r;r++)for(t=0;o>t;t++)s[r][t]=Math.abs(this.s[t])>n?this.V[r][t]/this.s[t]:0;var a,u,c=this.U.rows,f=this.U.columns,h=new e(i,c);for(r=0;i>r;r++)for(t=0;c>t;t++){for(u=0,a=0;f>a;a++)u+=s[r][a]*this.U[t][a];h[r][t]=u}return h}},t.exports=n},{"../matrix":14,"./util":11}],11:[function(r,t,n){"use strict";n.hypotenuse=function(r,t){var n;return Math.abs(r)>Math.abs(t)?(n=t/r,Math.abs(r)*Math.sqrt(1+n*n)):0!==t?(n=r/t,Math.abs(t)*Math.sqrt(1+n*n)):0}},{}],12:[function(r,t){"use strict";function n(r){return e(r,i.eye(r.rows))}function e(r,t){return r.isSquare()?new a(r).solve(t):new u(r).solve(t)}var i=r("./matrix"),o=r("./dc/svd"),s=r("./dc/evd"),a=r("./dc/lu"),u=r("./dc/qr"),c=r("./dc/cholesky");i.prototype.inverse=function(){return n(this)},i.prototype.solve=function(r){return e(this,r)},t.exports={SingularValueDecomposition:o,SVD:o,EigenvalueDecomposition:s,EVD:s,LuDecomposition:a,LU:a,QrDecomposition:u,QR:u,CholeskyDecomposition:c,CHO:c,inverse:n,solve:e}},{"./dc/cholesky":6,"./dc/evd":7,"./dc/lu":8,"./dc/qr":9,"./dc/svd":10,"./matrix":14}],13:[function(r,t){"use strict";t.exports=r("./matrix"),t.exports.Decompositions=t.exports.DC=r("./decompositions")},{"./decompositions":12,"./matrix":14}],14:[function(r,t){"use strict";function n(r){for(var t=0,n=r.length,e=new Array(n);n>t;t++)e[t]=r[t];return e}function e(r,t){var i,o,s=0;if(Array.isArray(r)){if(o=t,i=o?n(r):r,r=i.length,t=i[0].length,"undefined"==typeof t)throw new TypeError("Data must be a 2D array");if(!(r>0&&t>0))throw new RangeError("Invalid dimensions: "+r+"x"+t);for(;r>s;s++){if(i[s].length!==t)throw new RangeError("Inconsistent array dimensions");o&&(i[s]=n(i[s]))}}else{if("number"!=typeof r)throw new TypeError("Invalid arguments");if(!(r>0&&t>0))throw new RangeError("Invalid dimensions: "+r+"x"+t);for(i=new Array(r);r>s;s++)i[s]=new Array(t)}return Object.defineProperty(i,"rows",{writable:!0,value:r}),Object.defineProperty(i,"columns",{writable:!0,value:t}),i.__proto__=e.prototype,i}var i=Array.prototype.splice,o=Array.prototype.concat;e.from1DArray=function(r,t,n){var i,o,s=0;if(i=r*t,i!==n.length)throw new RangeError("Data length does not match given dimensions");for(o=new Array(r);r>s;s++)o[s]=n.slice(s*t,(s+1)*t);return new e(o)},e.rowVector=function(r){return new e([r])},e.columnVector=function(r){for(var t=r.length,n=new Array(t),i=0;t>i;i++)n[i]=[r[i]];return new e(n)},e.empty=function(r,t){return new e(r,t)},e.zeros=function(r,t){return e.empty(r,t).fill(0)},e.ones=function(r,t){return e.empty(r,t).fill(1)},e.rand=function(r,t){for(var n=e.empty(r,t),i=0,o=n.rows;o>i;i++)for(var s=0,a=n.columns;a>s;s++)n[i][s]=Math.random();return n},e.eye=function(r){for(var t=e.zeros(r,r),n=t.rows,i=0;n>i;i++)t[i][i]=1;return t},e.diag=function(r){for(var t=r.length,n=e.zeros(t,t),i=0;t>i;i++)n[i][i]=r[i];return n},e.indices=function(r,t){for(var n=new Array(t-r),e=0;e<n.length;e++)n[e]=r++;return n},e.stack=function(r){var t,n,i;if(e.isMatrix(r)){var o=0,s=0;for(t=0;t<arguments.length;t++)o+=arguments[t].rows,arguments[t].columns>s&&(s=arguments[t].columns);var a=e.zeros(o,s),u=0;for(t=0;t<arguments.length;t++){var c=arguments[t];for(n=0;n<c.rows;n++){for(i=0;i<c.columns;i++)a[u][i]=c[n][i];u++}}return a}if(Array.isArray(r)){var f=e.empty(arguments.length,r.length);for(t=0;t<arguments.length;t++)f.setRow(t,arguments[t]);return f}},e.expand=function(r,t){for(var n=[],i=0;i<t.length;i++)for(var o=0;o<t[i];o++)n.push(r[i]);return new e(n)},e.checkMatrix=function(r){if(!r)throw new TypeError("Argument has to be a matrix");return"Matrix"!==r.klass&&(r=new e(r)),r},e.isMatrix=function(r){return r?"Matrix"===r.klass:!1},Object.defineProperty(e.prototype,"klass",{get:function(){return"Matrix"}}),Object.defineProperty(e.prototype,"size",{get:function(){return this.rows*this.columns}}),e.prototype.checkRowIndex=function(r){if(0>r||r>this.rows-1)throw new RangeError("Row index out of range.")},e.prototype.checkColumnIndex=function(r){if(0>r||r>this.columns-1)throw new RangeError("Column index out of range.")},e.prototype.checkDimensions=function(r){if(this.rows!==r.rows||this.columns!==r.columns)throw new RangeError("Matrices dimensions must be equal.")},e.prototype.apply=function(r){for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)r.call(this,e,i);return this},e.prototype.clone=function(){return new e(this.to2DArray())},e.prototype.to1DArray=function(){return o.apply([],this)},e.prototype.to2DArray=function(){for(var r=this.rows,t=new Array(r),e=0;r>e;e++)t[e]=n(this[e]);return t},e.prototype.isRowVector=function(){return 1===this.rows},e.prototype.isColumnVector=function(){return 1===this.columns},e.prototype.isVector=function(){return 1===this.rows||1===this.columns},e.prototype.isSquare=function(){return this.rows===this.columns},e.prototype.isSymmetric=function(){if(this.isSquare()){for(var r=this.rows,t=0;r>t;t++)for(var n=0;t>=n;n++)if(this[t][n]!==this[n][t])return!1;return!0}return!1},e.prototype.set=function(r,t,n){return this[r][t]=n,this},e.prototype.get=function(r,t){return this[r][t]},e.prototype.fill=function(r){for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]=r;return this},e.prototype.neg=function(){return this.mulS(-1)},e.prototype.add=function(r){return"number"==typeof r?this.addS(r):(r=e.checkMatrix(r),this.addM(r))},e.prototype.addS=function(r){for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]+=r;return this},e.prototype.addM=function(r){this.checkDimensions(r);for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]+=r[e][i];return this},e.prototype.sub=function(r){return"number"==typeof r?this.subS(r):(r=e.checkMatrix(r),this.subM(r))},e.prototype.subS=function(r){for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]-=r;return this},e.prototype.subM=function(r){this.checkDimensions(r);for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]-=r[e][i];return this},e.prototype.mul=function(r){return"number"==typeof r?this.mulS(r):(r=e.checkMatrix(r),this.mulM(r))},e.prototype.mulS=function(r){for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]*=r;return this},e.prototype.mulM=function(r){this.checkDimensions(r);for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]*=r[e][i];return this},e.prototype.div=function(r){return"number"==typeof r?this.divS(r):(r=e.checkMatrix(r),this.divM(r))},e.prototype.divS=function(r){for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]/=r;return this},e.prototype.divM=function(r){this.checkDimensions(r);for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]/=r[e][i];return this},e.prototype.getRow=function(r){return this.checkRowIndex(r),n(this[r])},e.prototype.getRowVector=function(r){return e.rowVector(this.getRow(r))
},e.prototype.setRow=function(r,t){if(this.checkRowIndex(r),e.isMatrix(t)&&(t=t.to1DArray()),t.length!==this.columns)throw new RangeError("Invalid row size");return this[r]=n(t),this},e.prototype.removeRow=function(r){if(this.checkRowIndex(r),1===this.rows)throw new RangeError("A matrix cannot have less than one row");return i.call(this,r,1),this.rows-=1,this},e.prototype.addRow=function(r,t){if("undefined"==typeof t&&(t=r,r=this.rows),0>r||r>this.rows)throw new RangeError("Row index out of range.");if(e.isMatrix(t)&&(t=t.to1DArray()),t.length!==this.columns)throw new RangeError("Invalid row size");return i.call(this,r,0,n(t)),this.rows+=1,this},e.prototype.swapRows=function(r,t){this.checkRowIndex(r),this.checkRowIndex(t);var n=this[r];return this[r]=this[t],this[t]=n,this},e.prototype.getColumn=function(r){this.checkColumnIndex(r);for(var t=this.rows,n=new Array(t),e=0;t>e;e++)n[e]=this[e][r];return n},e.prototype.getColumnVector=function(r){return e.columnVector(this.getColumn(r))},e.prototype.setColumn=function(r,t){this.checkColumnIndex(r),e.isMatrix(t)&&(t=t.to1DArray());var n=this.rows;if(t.length!==n)throw new RangeError("Invalid column size");for(var i=0;n>i;i++)this[i][r]=t[i];return this},e.prototype.removeColumn=function(r){if(this.checkColumnIndex(r),1===this.columns)throw new RangeError("A matrix cannot have less than one column");for(var t=0,n=this.rows;n>t;t++)this[t].splice(r,1);return this.columns-=1,this},e.prototype.addColumn=function(r,t){if("undefined"==typeof t&&(t=r,r=this.columns),0>r||r>this.columns)throw new RangeError("Column index out of range.");e.isMatrix(t)&&(t=t.to1DArray());var n=this.rows;if(t.length!==n)throw new RangeError("Invalid column size");for(var i=0;n>i;i++)this[i].splice(r,0,t[i]);return this.columns+=1,this},e.prototype.swapColumns=function(r,t){this.checkRowIndex(r),this.checkRowIndex(t);for(var n,e,i=this.rows,o=0;i>o;o++)e=this[o],n=e[r],e[r]=e[t],e[t]=n;return this},e.prototype.checkRowVector=function(r){if(e.isMatrix(r)&&(r=r.to1DArray()),r.length!==this.columns)throw new RangeError("vector size must be the same as the number of columns");return r},e.prototype.checkColumnVector=function(r){if(e.isMatrix(r)&&(r=r.to1DArray()),r.length!==this.rows)throw new RangeError("vector size must be the same as the number of rows");return r},e.prototype.addRowVector=function(r){r=this.checkRowVector(r);for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]+=r[i];return this},e.prototype.subRowVector=function(r){r=this.checkRowVector(r);for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]-=r[i];return this},e.prototype.mulRowVector=function(r){r=this.checkRowVector(r);for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]*=r[i];return this},e.prototype.divRowVector=function(r){r=this.checkRowVector(r);for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]/=r[i];return this},e.prototype.addColumnVector=function(r){r=this.checkColumnVector(r);for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]+=r[e];return this},e.prototype.subColumnVector=function(r){r=this.checkColumnVector(r);for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]-=r[e];return this},e.prototype.mulColumnVector=function(r){r=this.checkColumnVector(r);for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]*=r[e];return this},e.prototype.divColumnVector=function(r){r=this.checkColumnVector(r);for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]/=r[e];return this},e.prototype.mulRow=function(r,t){this.checkRowIndex(r);for(var n=0,e=this.columns;e>n;n++)this[r][n]*=t;return this},e.prototype.mulColumn=function(r,t){this.checkColumnIndex(r);for(var n=0,e=this.rows;e>n;n++)this[n][r]*=t},e.prototype.max=function(){for(var r=-1/0,t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]>r&&(r=this[e][i]);return r},e.prototype.maxIndex=function(){for(var r=-1/0,t={},n=this.rows,e=this.columns,i=0;n>i;i++)for(var o=0;e>o;o++)this[i][o]>r&&(r=this[i][o],t.row=i,t.column=o);return t},e.prototype.min=function(){for(var r=1/0,t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]<r&&(r=this[e][i]);return r},e.prototype.minIndex=function(){for(var r=1/0,t={},n=this.rows,e=this.columns,i=0;n>i;i++)for(var o=0;e>o;o++)this[i][o]<r&&(r=this[i][o],t.row=i,t.column=o);return t},e.prototype.maxRow=function(r){this.checkRowIndex(r);for(var t=-1/0,n=0,e=this.columns;e>n;n++)this[r][n]>t&&(t=this[r][n]);return t},e.prototype.maxRowIndex=function(r){this.checkRowIndex(r);for(var t=-1/0,n={row:r},e=0,i=this.columns;i>e;e++)this[r][e]>t&&(t=this[r][e],n.column=e);return n},e.prototype.minRow=function(r){this.checkRowIndex(r);for(var t=1/0,n=0,e=this.columns;e>n;n++)this[r][n]<t&&(t=this[r][n]);return t},e.prototype.minRowIndex=function(r){this.checkRowIndex(r);for(var t=1/0,n={row:r,column:0},e=0,i=this.columns;i>e;e++)this[r][e]<t&&(t=this[r][e],n.column=e);return n},e.prototype.maxColumn=function(r){this.checkColumnIndex(r);for(var t=-1/0,n=0,e=this.rows;e>n;n++)this[n][r]>t&&(t=this[n][r]);return t},e.prototype.maxColumnIndex=function(r){this.checkColumnIndex(r);for(var t=-1/0,n={row:0,column:r},e=0,i=this.rows;i>e;e++)this[e][r]>t&&(t=this[e][r],n.row=e);return n},e.prototype.minColumn=function(r){this.checkColumnIndex(r);for(var t=1/0,n=0,e=this.rows;e>n;n++)this[n][r]<t&&(t=this[n][r]);return t},e.prototype.minColumnIndex=function(r){this.checkColumnIndex(r);for(var t=1/0,n={row:0,column:r},e=0,i=this.rows;i>e;e++)this[e][r]<t&&(t=this[e][r],n.row=e);return n},e.prototype.diag=function s(){if(!this.isSquare())throw new TypeError("Only square matrices have a diagonal.");for(var s=new Array(this.rows),r=0,t=this.rows;t>r;r++)s[r]=this[r][r];return s},e.prototype.sum=function(){for(var r=0,t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)r+=this[e][i];return r},e.prototype.mean=function(){return this.sum()/this.size},e.prototype.prod=function a(){for(var a=1,r=this.rows,t=this.columns,n=0;r>n;n++)for(var e=0;t>e;e++)a*=this[n][e];return a},e.prototype.cumulativeSum=function(){for(var r=0,t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)r+=this[e][i],this[e][i]=r;return this},e.prototype.dot=function u(r){if(this.size!==r.size)throw new RangeError("vectors do not have the same size");for(var t=this.to1DArray(),n=r.to1DArray(),u=0,e=t.length,i=0;e>i;i++)u+=t[i]*n[i];return u},e.prototype.mmul=function(r){if(!e.isMatrix(r))throw new TypeError('parameter "other" must be a matrix');this.columns!==r.rows&&console.warn("Number of columns of left matrix are not equal to number of rows of right matrix.");var t,n,i,o=this.rows,s=this.columns,a=r.columns,u=new e(o,a),c=new Array(s);for(n=0;a>n;n++){for(i=0;s>i;i++)c[i]=r[i][n];for(t=0;o>t;t++){var f=this[t],h=0;for(i=0;s>i;i++)h+=f[i]*c[i];u[t][n]=h}}return u},e.prototype.sortRows=function(r){for(var t=0,n=this.rows;n>t;t++)this[t].sort(r);return this},e.prototype.sortColumns=function(r){for(var t=0,n=this.columns;n>t;t++)this.setColumn(t,this.getColumn(t).sort(r));return this},e.prototype.transpose=function(){for(var r=new e(this.columns,this.rows),t=this.rows,n=this.columns,i=0;t>i;i++)for(var o=0;n>o;o++)r[o][i]=this[i][o];return r},e.prototype.subMatrix=function(r,t,n,i){if(r>t||n>i||0>r||r>=this.rows||0>t||t>=this.rows||0>n||n>=this.columns||0>i||i>=this.columns)throw new RangeError("Argument out of range");for(var o=new e(t-r+1,i-n+1),s=r;t>=s;s++)for(var a=n;i>=a;a++)o[s-r][a-n]=this[s][a];return o},e.prototype.subMatrixRow=function(r,t,n){if("undefined"==typeof t?(t=0,n=this.columns-1):"undefined"==typeof n&&(n=this.columns-1),t>n||0>t||t>=this.columns||0>n||n>=this.columns)throw new RangeError("Argument out of range.");for(var i=r.length,o=this.rows,s=new e(i,n-t+1),a=0;i>a;a++)for(var u=t;n>=u;u++){if(r[a]<0||r[a]>=o)throw new RangeError("Argument out of range.");s[a][u-t]=this[r[a]][u]}return s},e.prototype.subMatrixColumn=function(r,t,n){if("undefined"==typeof t?(t=0,n=this.rows-1):"undefined"==typeof n&&(n=this.rows-1),t>n||0>t||t>=this.rows||0>n||n>=this.rows)throw new RangeError("Argument out of range.");for(var i=r.length,o=this.columns,s=new e(n-t+1,i),a=0;i>a;a++)for(var u=t;n>=u;u++){if(r[a]<0||r[a]>=o)throw new RangeError("Argument out of range.");s[u-t][a]=this[u][r[a]]}return s},e.prototype.trace=function c(){if(!this.isSquare())throw new TypeError("The matrix is not square");for(var c=0,r=0,t=this.rows;t>r;r++)c+=this[r][r];return c},e.prototype.abs=function(){for(var r=this.rows,t=this.columns,n=0;r>n;n++)for(var e=0;t>e;e++)this[n][e]=Math.abs(this[n][e])},t.exports=e},{}],15:[function(r,t){"use strict";function n(r,t){if(r.length%t!==0)throw new RangeError("Dimensions number must be accordance with the size of the array.");for(var n=r.length/t,e=new Array(n),i=0,o=0;o<r.length;o+=t){for(var s=new Array(t),a=0;t>a;++a)s[a]=r[o+a];e[i]=s,i++}return e}function e(r,t){if(r.length%t!==0)throw new RangeError("Dimensions number must be accordance with the size of the array.");for(var n=new Array(t),e=r.length/t,i=0;i<n.length;i++)n[i]=new Array(e);for(i=0;i<r.length;i+=t)for(var o=0;t>o;++o){var s=Math.floor(i/t);n[o][s]=r[i+o]}return n}function i(r){for(var t=new Array(r.length*r[0].length),n=0,e=0;e<r[0].length;++e)for(var i=0;i<r.length;++i)t[n]=r[i][e],++n;return t}function o(r){for(var t=new Array(r[0].length),n=0;n<t.length;++n)t[n]=new Array(r.length);for(n=0;n<r.length;++n)for(var e=0;e<r[0].length;++e)t[e][n]=r[n][e];return t}function s(r){for(var t=new Array(r.length*r[0].length),n=0,e=0;e<r.length;++e)for(var i=0;i<r[0].length;++i)t[n]=r[e][i],++n;return t}function a(r,t){var n,e;r.length<=t.length?(e=r,n=t):(e=t,n=r);for(var i=n.length-e.length+1,o=new Array(i),s=0;i>s;++s){for(var a=0,u=0;u<e.length;++u)a+=e[u]*n[s+u];o[s]=a}return o}t.exports={coordArrayToPoints:n,coordArrayToCoordMatrix:e,coordMatrixToCoordArray:i,coordMatrixToPoints:o,pointsToCoordArray:s,pointsToCoordMatrix:o,applyDotProduct:a}},{}],16:[function(r,t,n){"use strict";function e(r,t,n){var e=r.length;if(e!==t.length)throw new RangeError("the x and y vector doesn't have the same size.");void 0===n&&(n={});var s=void 0===n.from?r[0]:n.from;if(isNaN(s)||!isFinite(s))throw new RangeError("'From' value must be a number");var a=void 0===n.to?r[r.length-1]:n.to;if(isNaN(a)||!isFinite(a))throw new RangeError("'To' value must be a number");var u=s>a;if(u){var c=s;s=a,a=c}var f=void 0===n.numberOfPoints?100:n.numberOfPoints;if(isNaN(f)||!isFinite(f))throw new RangeError("'Number of points' value must be a number");if(1>f)throw new RangeError("the number of point must be higher than 1");var h="slot"===n.variant?"slot":"smooth",l="slot"===h?o(r,t,s,a,f):i(r,t,s,a,f);return u?l.reverse():l}function i(r,t,n,e,i){function o(r,t,n,e){return(e-t)/(n-r)}var a=r.length,u=(e-n)/(i-1),c=u/2,f=n-c,h=new Array(i),l=r[1]-r[0],m=r[r.length-1]-r[r.length-2],p=f,d=f+u,g=-Number.MAX_VALUE,v=0,y=r[0]-l,w=0,x=0,b=0,M=0,k=0,A=0,S=0,j=0;r:for(;;){for(;y-d>=0;){var R=s(0,d-g,b,v);if(A=x+R,h[j]=(A-k)/u,j++,j===i)break r;p=d,d+=u,k=A}p>=g&&y>=p&&(R=s(0,p-g,b,v),k=x+R),x+=s(g,y,b,M),g=y,v=w,a>S?(y=r[S],w=t[S],S++):S===a&&(y+=m,w=0),b=o(g,v,y,w),M=-b*g+v}return h}function o(r,t,n,e,i){var o=r.length,s=(e-n)/(i-1),a=s/2,u=r[r.length-1]-r[r.length-2],c=n-a,f=new Array(i),h=c,l=c+s,m=-Number.MAX_VALUE,p=0,d=r[0],g=t[0],v=0,y=!0,w=0,x=0,b=1,M=0;r:for(;;){for(;m-l>0;){if(y&&(x++,y=!1),f[M]=0>=x?0:w/x,M++,M===i)break r;h=l,l+=s,w=0,x=0}m>h&&(w+=p,x++),(m===-Number.MAX_VALUE||v>1)&&x--,m=d,p=g,o>b?(d=r[b],g=t[b],b++):(d+=u,g=0,v++)}return f}function s(r,t,n,e){return.5*n*t*t+e*t-(.5*n*r*r+e*r)}n.getEquallySpacedData=e,n.integral=s},{}],17:[function(r,t,n){t.exports=n=r("./ArrayUtils"),n.getEquallySpacedData=r("./getEquallySpaced").getEquallySpacedData,n.SNV=r("./snv").SNV},{"./ArrayUtils":15,"./getEquallySpaced":16,"./snv":18}],18:[function(r,t,n){"use strict";function e(r){var t=i.array.mean(r),n=i.array.standardDeviation(r);return new o([r]).clone().sub(t).div(n).getRow(0)}n.SNV=e;var i=r("ml-stat"),o=r("ml-matrix")},{"ml-matrix":13,"ml-stat":149}],19:[function(r,t){for(var n=new Array(256),e=0;256>e;e++){for(var i=e,o=0;i;)i&=i-1,o++;n[e]=o}t.exports=n},{}],20:[function(r,t){"use strict";function n(r){for(var t=0,n=0;n<r.length;n++)t+=p[255&r[n]]+p[r[n]>>8&255]+p[r[n]>>16&255]+p[r[n]>>24&255];return t}function e(r,t){for(var n=new Array(r.length),e=0;e<r.length;e++)n[e]=r[e]&t[e];return n}function i(r,t){for(var n=new Array(r.length),e=0;e<r.length;e++)n[e]=r[e]|t[e];return n}function o(r,t){for(var n=new Array(r.length),e=0;e<r.length;e++)n[e]=r[e]^t[e];return n}function s(r){for(var t=new Array(r.length),n=0;n<t.length;n++)t[n]=~r[n];return t}function a(r,t){var n=t>>5,e=1<<31-t%32;return Boolean(r[n]&e)}function u(r,t,n){var e=t>>5,i=1<<31-t%32;return r[e]=n?i|r[e]:~i&r[e],r}function c(r){for(var t="",n=0;n<r.length;n++){var e=(r[n]>>>0).toString(2);t+="00000000000000000000000000000000".substr(e.length)+e}return t}function f(r){for(var t=r.length/32,n=new Array(t),e=0;t>e;e++)n[e]=0|parseInt(r.substr(32*e,32),2);return n}function h(r){for(var t="",n=0;n<r.length;n++){var e=(r[n]>>>0).toString(16);t+="00000000".substr(e.length)+e}return t}function l(r){for(var t=r.length/8,n=new Array(t),e=0;t>e;e++)n[e]=0|parseInt(r.substr(8*e,8),16);return n}function m(r){for(var t=c(r),n="",e=0;e<r.length;e++){n+="0000".substr((32*e).toString(16).length)+(32*e).toString(16)+":";for(var i=0;32>i;i+=4)n+=" "+t.substr(32*e+i,4);e<r.length-1&&(n+="\n")}return n}var p=r("./creator");t.exports={count:n,and:e,or:i,xor:o,not:s,getBit:a,setBit:u,toBinaryString:c,parseBinaryString:f,toHexString:h,parseHexString:l,toDebug:m}},{"./creator":19}],21:[function(r,t){"use strict";function n(r,t){for(var n=0,e=0;e<r.length;e++)n+=(r[e]-t[e])*(r[e]-t[e]);return n}function e(r,t){return Math.sqrt(n(r,t))}t.exports=e,e.squared=n},{}],22:[function(r,t){"use strict";function n(r,t,e,i,o,s){if(o=o||.16,s=s||.01,o>i-e)return void 0;for(var a=0,u=0;r[u]<i;u++)r[u]>e&&(a+=t[u]);if(s>a)return void 0;for(var c=0,f=0;r[f]<i;f++)r[u]>e&&(c+=r[f]*t[f]);return c/=a,1e-5>c-e||1e-5>i-c?void 0:o/4>c-e?n(r,t,c,i,o,s):o/4>i-c?n(r,t,e,c,o,s):{sum:a,center:c,left:n(r,t,e,c,o,s),right:n(r,t,c,i,o,s)}}function e(r,t,n,i,o){if(void 0===r||void 0===t)return 0;var s=n*Math.min(r.sum,t.sum)/Math.max(r.sum,t.sum)+(1-n)*Math.exp(-o*Math.abs(r.center-t.center));return i*s+(1-i)*(e(r.left,t.left,n,i,o)+e(r.right,t.right,n,i,o))}function i(r,t,i,s,a){a=a||{};for(var u in o)a.hasOwnProperty(u)||(a[u]=o[u]);var c,f;return c=r.sum?r:n(r.x,r.y,i,s,a.minWindow,a.threshold),f=t.sum?t:n(t.x,t.y,i,s,a.minWindow,a.threshold),e(c,f,a.alpha,a.beta,a.gamma)}var o={minWindow:.16,threshold:.01,alpha:.1,beta:.33,gamma:.001};t.exports={calc:i,createTree:n}},{}],23:[function(r,t,n){"use strict";n.euclidean=r("ml-euclidean-distance"),n.squaredEuclidean=r("ml-euclidean-distance").squared,n.manhattan=r("./distances/manhattan"),n.minkowski=r("./distances/minkowski"),n.chebyshev=r("./distances/chebyshev"),n.sorensen=r("./distances/sorensen"),n.gower=r("./distances/gower"),n.soergel=r("./distances/soergel"),n.kulczynski=r("./distances/kulczynski"),n.canberra=r("./distances/canberra"),n.lorentzian=r("./distances/lorentzian"),n.intersection=r("./distances/intersection"),n.waveHedges=r("./distances/waveHedges"),n.czekanowski=r("./distances/czekanowski"),n.motyka=r("./distances/motyka"),n.ruzicka=r("./distances/ruzicka"),n.tanimoto=r("./distances/tanimoto"),n.innerProduct=r("./distances/innerProduct"),n.harmonicMean=r("./distances/harmonicMean"),n.cosine=r("./distances/cosine"),n.kumarHassebrook=r("./distances/kumarHassebrook"),n.jaccard=r("./distances/jaccard"),n.dice=r("./distances/dice"),n.fidelity=r("./distances/fidelity"),n.bhattacharyya=r("./distances/bhattacharyya"),n.hellinger=r("./distances/hellinger"),n.matusita=r("./distances/matusita"),n.squaredChord=r("./distances/squaredChord"),n.pearson=r("./distances/pearson"),n.neyman=r("./distances/neyman"),n.squared=r("./distances/squared"),n.probabilisticSymmetric=r("./distances/probabilisticSymmetric"),n.divergence=r("./distances/divergence"),n.clark=r("./distances/clark"),n.kullbackLeibler=r("./distances/kullbackLeibler"),n.jeffreys=r("./distances/jeffreys"),n.kdivergence=r("./distances/kdivergence"),n.topsoe=r("./distances/topsoe"),n.jensenDifference=r("./distances/jensenDifference"),n.taneja=r("./distances/taneja"),n.kumarJohnson=r("./distances/kumarJohnson"),n.avg=r("./distances/avg"),n.tree=r("ml-tree-similarity"),n.additiveSymmetric=r("./distances/additiveSymmetric"),n.jensenShannon=r("./distances/jensenShannon")},{"./distances/additiveSymmetric":24,"./distances/avg":25,"./distances/bhattacharyya":26,"./distances/canberra":27,"./distances/chebyshev":28,"./distances/clark":29,"./distances/cosine":30,"./distances/czekanowski":31,"./distances/dice":32,"./distances/divergence":33,"./distances/fidelity":34,"./distances/gower":35,"./distances/harmonicMean":36,"./distances/hellinger":37,"./distances/innerProduct":38,"./distances/intersection":39,"./distances/jaccard":40,"./distances/jeffreys":41,"./distances/jensenDifference":42,"./distances/jensenShannon":43,"./distances/kdivergence":44,"./distances/kulczynski":45,"./distances/kullbackLeibler":46,"./distances/kumarHassebrook":47,"./distances/kumarJohnson":48,"./distances/lorentzian":49,"./distances/manhattan":50,"./distances/matusita":51,"./distances/minkowski":52,"./distances/motyka":53,"./distances/neyman":54,"./distances/pearson":55,"./distances/probabilisticSymmetric":56,"./distances/ruzicka":57,"./distances/soergel":58,"./distances/sorensen":59,"./distances/squared":60,"./distances/squaredChord":61,"./distances/taneja":62,"./distances/tanimoto":63,"./distances/topsoe":64,"./distances/waveHedges":65,"ml-euclidean-distance":21,"ml-tree-similarity":22}],24:[function(r,t){t.exports=function(r,t){for(var n=0,e=r.length,i=0;e>n;n++)i+=(r[n]-t[n])*(r[n]-t[n])*(r[n]+t[n])/(r[n]*t[n]);return 2*i}},{}],25:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0,o=0,s=0;n>s;s++)o=Math.abs(r[s]-t[s]),i+=o,o>e&&(e=o);return(e+i)/2}},{}],26:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0;n>i;i++)e+=Math.sqrt(r[i]*t[i]);return-Math.log(e)}},{}],27:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0;n>i;i++)e+=Math.abs(r[i]-t[i])/(r[i]+t[i]);return e}},{}],28:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0,o=0;n>o;o++)i=Math.abs(r[o]-t[o]),i>e&&(e=i);return e}},{}],29:[function(r,t){t.exports=function(r,t){for(var n=0,e=r.length,i=0;e>n;n++)i+=Math.sqrt((r[n]-t[n])*(r[n]-t[n])/((r[n]+t[n])*(r[n]+t[n])));return 2*i}},{}],30:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0,o=0,s=0;n>s;s++)e+=r[s]*t[s],i+=r[s]*r[s],o+=t[s]*t[s];return e/(Math.sqrt(i)*Math.sqrt(o))}},{}],31:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0,o=0;n>o;o++)e+=Math.min(r[o],t[o]),i+=r[o]+t[o];return 1-2*e/i}},{}],32:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0,o=0,s=0;n>s;s++)e+=r[s]*r[s],i+=t[s]*t[s],o+=(r[s]-t[s])*(r[s]-t[s]);return o/(e+i)}},{}],33:[function(r,t){t.exports=function(r,t){for(var n=0,e=r.length,i=0;e>n;n++)i+=(r[n]-t[n])*(r[n]-t[n])/((r[n]+t[n])*(r[n]+t[n]));return 2*i}},{}],34:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0;n>i;i++)e+=Math.sqrt(r[i]*t[i]);return e}},{}],35:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0;n>i;i++)e+=Math.abs(r[i]-t[i]);return e/n}},{}],36:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0;n>i;i++)e+=r[i]*t[i]/(r[i]+t[i]);return 2*e}},{}],37:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0;n>i;i++)e+=Math.sqrt(r[i]*t[i]);return 2*Math.sqrt(1-e)}},{}],38:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0;n>i;i++)e+=r[i]*t[i];return e}},{}],39:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0;n>i;i++)e+=Math.min(r[i],t[i]);return 1-e}},{}],40:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0,o=0,s=0,a=0;n>a;a++)e+=r[a]*t[a],i+=r[a]*r[a],o+=t[a]*t[a],s+=(r[a]-t[a])*(r[a]-t[a]);return s/(i+o-e)}},{}],41:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0;n>i;i++)e+=(r[i]-t[i])*Math.log(r[i]/t[i]);return e}},{}],42:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0;n>i;i++)e+=(r[i]*Math.log(r[i])+t[i]*Math.log(t[i]))/2-(r[i]+t[i])/2*Math.log((r[i]+t[i])/2);return e}},{}],43:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0,o=0;n>o;o++)e+=r[o]*Math.log(2*r[o]/(r[o]+t[o])),i+=t[o]*Math.log(2*t[o]/(r[o]+t[o]));return(e+i)/2}},{}],44:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0;n>i;i++)e+=r[i]*Math.log(2*r[i]/(r[i]+t[i]));return e}},{}],45:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0,o=0;n>o;o++)e+=Math.abs(r[o]-t[o]),i+=Math.min(r[o],t[o]);return e/i}},{}],46:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0;n>i;i++)e+=r[i]*Math.log(r[i]/t[i]);return e}},{}],47:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0,o=0,s=0;n>s;s++)e+=r[s]*t[s],i+=r[s]*r[s],o+=t[s]*t[s];return e/(i+o-e)}},{}],48:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0;n>i;i++)e+=Math.pow(r[i]*r[i]-t[i]*t[i],2)/(2*Math.pow(r[i]*t[i],1.5));return e}},{}],49:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0;n>i;i++)e+=Math.log(Math.abs(r[i]-t[i])+1);return e}},{}],50:[function(r,t){t.exports=function(r,t){for(var n=0,e=r.length,i=0;e>n;n++)i+=Math.abs(r[n]-t[n]);return i}},{}],51:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0;n>i;i++)e+=Math.sqrt(r[i]*t[i]);return Math.sqrt(2-2*e)}},{}],52:[function(r,t){t.exports=function(r,t,n){for(var e=0,i=r.length,o=0;i>e;e++)o+=Math.pow(Math.abs(r[e]-t[e]),n);return Math.pow(o,1/n)}},{}],53:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0,o=0;n>o;o++)e+=Math.min(r[o],t[o]),i+=r[o]+t[o];return 1-e/i}},{}],54:[function(r,t){t.exports=function(r,t){for(var n=0,e=r.length,i=0;e>n;n++)i+=(r[n]-t[n])*(r[n]-t[n])/r[n];return i}},{}],55:[function(r,t){t.exports=function(r,t){for(var n=0,e=r.length,i=0;e>n;n++)i+=(r[n]-t[n])*(r[n]-t[n])/t[n];return i}},{}],56:[function(r,t){t.exports=function(r,t){for(var n=0,e=r.length,i=0;e>n;n++)i+=(r[n]-t[n])*(r[n]-t[n])/(r[n]+t[n]);return 2*i}},{}],57:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0,o=0;n>o;o++)e+=Math.min(r[o],t[o]),i+=Math.max(r[o],t[o]);return e/i}},{}],58:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0,o=0;n>o;o++)e+=Math.abs(r[o]-t[o]),i+=Math.max(r[o],t[o]);return e/i}},{}],59:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0,o=0;n>o;o++)e+=Math.abs(r[o]-t[o]),i+=r[o]+t[o];return e/i}},{}],60:[function(r,t){t.exports=function(r,t){for(var n=0,e=r.length,i=0;e>n;n++)i+=(r[n]-t[n])*(r[n]-t[n])/(r[n]+t[n]);return i}},{}],61:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0;n>i;i++)e+=(Math.sqrt(r[i])-Math.sqrt(t[i]))*(Math.sqrt(r[i])-Math.sqrt(t[i]));return e}},{}],62:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0;n>i;i++)e+=(r[i]+t[i])/2*Math.log((r[i]+t[i])/(2*Math.sqrt(r[i]*t[i])));return e}},{}],63:[function(r,t){var n=r("./../similarities/tanimoto");t.exports=function(r,t,e){if(e)return 1-n(r,t,e);for(var i=r.length,o=0,s=0,a=0,u=0;i>u;u++)o+=r[u],s+=t[u],a+=Math.min(r[u],t[u]);return(o+s-2*a)/(o+s-a)}},{"./../similarities/tanimoto":75}],64:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0;n>i;i++)e+=r[i]*Math.log(2*r[i]/(r[i]+t[i]))+t[i]*Math.log(2*t[i]/(r[i]+t[i]));return e}},{}],65:[function(r,t){t.exports=function(r,t){for(var n=r.length,e=0,i=0;n>i;i++)e+=1-Math.min(r[i],t[i])/Math.max(r[i],t[i]);return e}},{}],66:[function(r,t,n){"use strict";n.distance=r("./distances"),n.similarity=r("./similarities")},{"./distances":23,"./similarities":67}],67:[function(r,t,n){"use strict";n.motyka=r("./similarities/motyka"),n.squaredChord=r("./similarities/squaredChord"),n.dice=r("./similarities/dice"),n.jaccard=r("./similarities/jaccard"),n.tanimoto=r("./similarities/tanimoto"),n.kulczynski=r("./similarities/kulczynski"),n.czekanowski=r("./similarities/czekanowski"),n.intersection=r("./similarities/intersection")},{"./similarities/czekanowski":68,"./similarities/dice":69,"./similarities/intersection":70,"./similarities/jaccard":71,"./similarities/kulczynski":72,"./similarities/motyka":73,"./similarities/squaredChord":74,"./similarities/tanimoto":75}],68:[function(r,t){var n=r("./../distances/czekanowski");t.exports=function(r,t){return 1-n(r,t)}},{"./../distances/czekanowski":31}],69:[function(r,t){var n=r("./../distances/dice");t.exports=function(r,t){return 1-n(r,t)}},{"./../distances/dice":32}],70:[function(r,t){var n=r("./../distances/intersection");t.exports=function(r,t){return 1-n(r,t)}},{"./../distances/intersection":39}],71:[function(r,t){var n=r("./../distances/jaccard");t.exports=function(r,t){return 1-n(r,t)}},{"./../distances/jaccard":40}],72:[function(r,t){var n=r("./../distances/kulczynski");t.exports=function(r,t){return 1/n(r,t)}},{"./../distances/kulczynski":45}],73:[function(r,t){var n=r("./../distances/motyka");t.exports=function(r,t){return 1-n(r,t)}},{"./../distances/motyka":53}],74:[function(r,t){var n=r("./../distances/squaredChord");t.exports=function(r,t){return 1-n(r,t)}},{"./../distances/squaredChord":61}],75:[function(r,t){t.exports=function(r,t,n){if(n){for(var e=0,i=0,o=0;o<r.length;o++)e+=r[o]&&t[o],i+=r[o]||t[o];return 0===i?1:e/i}for(var s=r.length,a=0,u=0,c=0,f=0;s>f;f++)a+=r[f],u+=t[f],c+=Math.min(r[f],t[f]);return 1-(a+u-2*c)/(a+u-c)}},{}],76:[function(r,t,n){arguments[4][6][0].apply(n,arguments)},{"../matrix":84,dup:6}],77:[function(r,t,n){arguments[4][7][0].apply(n,arguments)},{"../matrix":84,"./util":81,dup:7}],78:[function(r,t,n){arguments[4][8][0].apply(n,arguments)},{"../matrix":84,dup:8}],79:[function(r,t,n){arguments[4][9][0].apply(n,arguments)},{"../matrix":84,"./util":81,dup:9}],80:[function(r,t,n){arguments[4][10][0].apply(n,arguments)},{"../matrix":84,"./util":81,dup:10}],81:[function(r,t,n){arguments[4][11][0].apply(n,arguments)},{dup:11}],82:[function(r,t,n){arguments[4][12][0].apply(n,arguments)},{"./dc/cholesky":76,"./dc/evd":77,"./dc/lu":78,"./dc/qr":79,"./dc/svd":80,"./matrix":84,dup:12}],83:[function(r,t,n){arguments[4][13][0].apply(n,arguments)},{"./decompositions":82,"./matrix":84,dup:13}],84:[function(r,t,n){arguments[4][14][0].apply(n,arguments)},{dup:14}],85:[function(r,t){"use strict";function n(r,t){return Math.floor(Math.random()*(t-r+1)+r)}function e(r,t,n){if(t)this.layers=n.layers,this.inputSize=n.inputSize,this.outputSize=n.outputSize;else{this.inputSize=r[0],this.outputSize=r[r.length-1],r.shift(),this.layers=new Array(r.length);for(var e=0;e<r.length;++e){var o=0==e?this.inputSize:r[e-1];this.layers[e]=new i(o,r[e])}this.layers[this.layers.length-1].isSigmoid=!1}}var i=r("./layer"),o=r("ml-matrix");t.exports=e,e.prototype.forwardNN=function(r){for(var t=r.slice(),n=0;n<this.layers.length;++n)t=this.layers[n].forward(t);return t},e.prototype.iteration=function(r,t,n,e){var i=this.forwardNN(r),o=new Array(i.length);"number"==typeof t&&(t=[t]);for(var s=0;s<o.length;s++)o[s]=t[s]-i[s];var a=this.layers.length;for(s=0;a>s;++s)o=this.layers[a-1-s].train(o,n,e)},e.prototype.train=function(r,t,e,i,o){if(r.length!==t.length)throw new RangeError("the training and prediction set must have the same size.");if(r[0].length!==this.inputSize)throw new RangeError("The training set columns must have the same size of the input layer");if(t[0].length!==this.outputSize)throw new RangeError("The prediction set columns must have the same size of the output layer");for(var s=0;e>s;++s)for(var a=0;a<t.length;++a){var u=n(0,t.length-1);this.iteration(r[u],t[u],i,o)}},e.prototype.predict=function(r){if(r[0].length!==this.inputSize)throw new RangeError("The dataset columns must have the same size of the input layer");for(var t=new Array(r.length),n=0;n<r.length;n++)t[n]=this.forwardNN(r[n]);return t=o(t),1===t.columns?t.getColumn(0):t},e.load=function(r){if("FNN"!==r.modelName)throw new RangeError("The given model is invalid!");return new e(null,!0,r)},e.prototype["export"]=function(){return{modelName:"FNN",layers:this.layers,inputSize:this.inputSize,outputSize:this.outputSize}}},{"./layer":87,"ml-matrix":83}],86:[function(r,t){t.exports=r("./feedforwardNeuralNetwork")},{"./feedforwardNeuralNetwork":85}],87:[function(r,t){"use strict";function n(r){return s.rand(1,r).sub(.5).mul(4).getRow(0)}function e(r){return 1/(1+Math.exp(-r))}function i(r){return r*(1-r)}function o(r,t){this.output=s.zeros(1,t).getRow(0),this.input=s.zeros(1,r+1).getRow(0),this.deltaWeights=s.zeros(1,(1+r)*t).getRow(0),this.weights=n(this.deltaWeights.length),this.isSigmoid=!0}var s=r("ml-matrix");t.exports=o,o.prototype.forward=function(r){this.input=r.slice(),this.input.push(1);var t=0;this.output=s.zeros(1,this.output.length).getRow(0);for(var n=0;n<this.output.length;++n){for(var i=0;i<this.input.length;++i)this.output[n]+=this.weights[t+i]*this.input[i];this.isSigmoid&&(this.output[n]=e(this.output[n])),t+=this.input.length}return this.output.slice()},o.prototype.train=function(r,t,n){for(var e=0,o=s.zeros(1,this.input.length).getRow(0),a=0;a<this.output.length;++a){var u=r[a];this.isSigmoid&&(u*=i(this.output[a]));for(var c=0;c<this.input.length;++c){var f=e+c;o[c]+=this.weights[f]*u;var h=this.input[c]*u*t;this.weights[f]+=this.deltaWeights[f]*n+h,this.deltaWeights[f]=h}e+=this.input.length}return o}},{"ml-matrix":83}],88:[function(r,t,n){arguments[4][21][0].apply(n,arguments)},{dup:21}],89:[function(r,t){"use strict";function n(){this.children=[],this.distance=-1,this.index=[]}n.prototype.cut=function(r){if(0>r)throw new RangeError("Threshold too small");var t=new n;t.children=this.children,t.distance=this.distance,t.index=this.index;for(var e=[t],i=[];e.length>0;){var o=e.shift();r>=o.distance?i.push(o):e=e.concat(o.children)}return i},n.prototype.group=function(r){if(1>r)throw new RangeError("Number of groups too small");var t=new n;if(t.children=this.children,t.distance=this.distance,t.index=this.index,1===r)return t;for(var e,i=[t];i.length<r&&0!==i.length;)e=i.shift(),i=i.concat(e.children);if(0===i.length)throw new RangeError("Number of groups too big");for(var o=0;o<i.length;o++)i[o].distance===e.distance&&(i.concat(i[o].children.slice(1)),i[o]=i[o].children[0]);for(var s=0;s<i.length;s++)if(0!==i[s].distance){var a=i[s];a.children=a.index}return t},t.exports=n},{}],90:[function(r,t){"use strict";function n(r){e.call(this),this.index=r,this.distance=0,this.children=void 0}var e=r("./Cluster"),i=r("util");i.inherits(n,e),t.exports=n},{"./Cluster":89,util:5}],91:[function(r,t){"use strict";function n(r,t,n){for(var e=1e101,i=0;i<r.length;i++)for(var o=i;o<t.length;o++){var s=n(r[i],t[o]);e=Math.min(s,e)}return e}function e(r,t,n){for(var e=-1,i=0;i<r.length;i++)for(var o=i;o<t.length;o++){var s=n(r[i],t[o]);e=Math.max(s,e)}return e}function i(r,t,n){for(var e=0,i=0;i<r.length;i++)for(var o=0;o<t.length;o++)e+=n(r[i],t[o]);return e/(r.length*t.length)}function o(r,t,n){for(var e=0,i=0,o=0,s=0,a=0;a<r.length;a++)e+=r[a][0],i+=r[a][1];for(var u=0;u<t.length;u++)o+=t[u][0],s+=t[u][1];return e/=r.length,i/=r.length,o/=t.length,s/=t.length,n([e,i],[o,s])}function s(r,t,n){for(var e=0,i=0,o=0,s=0,a=0;a<r.length;a++)e+=r[a][0],i+=r[a][1];for(var u=0;u<t.length;u++)o+=t[u][0],s+=t[u][1];return e/=r.length,i/=r.length,o/=t.length,s/=t.length,n([e,i],[o,s])*r.length*t.length/(r.length+t.length)}function a(r,t){t=t||{};for(var a in h)t.hasOwnProperty(a)||(t[a]=h[a]);var u=r.length;if("string"==typeof t.kind)switch(t.kind){case"single":t.kind=n;break;case"complete":t.kind=e;break;case"average":t.kind=i;break;case"centroid":t.kind=o;break;case"ward":t.kind=s;break;default:throw new RangeError("Unknown kind of similarity")
}else if("function"!=typeof t.kind)throw new TypeError("Undefined kind of similarity");for(var l=new Array(u),m=0;m<r.length;m++)l[m]=new c(m);for(var p=1e6,d={},g=0;l.length>1;){d={},p=1e6;for(var v=0;v<l.length;v++)for(var y=v+1;y<l.length;y++){var w,x;if(l[v]instanceof c)w=[r[l[v].index]];else{w=new Array(l[v].index.length);for(var b=0;b<w.length;b++)w[b]=r[l[v].index[b].index]}if(l[y]instanceof c)x=[r[l[y].index]];else{x=new Array(l[y].index.length);for(var M=0;M<x.length;M++)x[M]=r[l[y].index[M].index]}g=t.kind(w,x,t.disFunc).toFixed(4),g in d?d[g].push([l[v],l[y]]):d[g]=[[l[v],l[y]]],p=Math.min(g,p)}for(var k,A=d[p.toFixed(4)],S=new Array(A.length),j=0;A.length>0;){k=A.shift();for(var R=0;R<A.length;R++){var T=A[R].filter(function(r){return-1!==k.indexOf(r)});if(T.length>0){var V=A[R].filter(function(r){return-1===k.indexOf(r)});k=k.concat(V),A.splice(R--,1)}}S[j++]=k}S.length=j;for(var z=0;z<S.length;z++){var q=new f;q.children=S[z].concat(),q.distance=p,q.index=new Array(u);for(var C=0,E=0;E<S[z].length;E++)S[z][E]instanceof c?q.index[C++]=S[z][E]:(C+=S[z][E].index.length,q.index=S[z][E].index.concat(q.index)),l.splice(l.indexOf(S[z][E]),1);q.index.length=C,l.push(q)}}return l[0]}var u=r("ml-euclidean-distance"),c=r("./ClusterLeaf"),f=r("./Cluster"),h={disFunc:u,kind:"single"};t.exports=a},{"./Cluster":89,"./ClusterLeaf":90,"ml-euclidean-distance":88}],92:[function(r,t){"use strict";function n(r,t,n){for(var e=1e101,i=0;i<r.length;i++)for(var o=i;o<t.length;o++){var s=n(r[i],t[o]);e=Math.min(s,e)}return e}function e(r,t,n){for(var e=-1,i=0;i<r.length;i++)for(var o=i;o<t.length;o++){var s=n(r[i],t[o]);e=Math.max(s,e)}return e}function i(r,t,n){for(var e=0,i=0;i<r.length;i++)for(var o=0;o<t.length;o++)e+=n(r[i],t[o]);return e/(r.length*t.length)}function o(r,t,n){for(var e=0,i=0,o=0,s=0,a=0;a<r.length;a++)e+=r[a][0],i+=r[a][1];for(var u=0;u<t.length;u++)o+=t[u][0],s+=t[u][1];return e/=r.length,i/=r.length,o/=t.length,s/=t.length,n([e,i],[o,s])}function s(r,t,n){for(var e=0,i=0,o=0,s=0,a=0;a<r.length;a++)e+=r[a][0],i+=r[a][1];for(var u=0;u<t.length;u++)o+=t[u][0],s+=t[u][1];return e/=r.length,i/=r.length,o/=t.length,s/=t.length,n([e,i],[o,s])*r.length*t.length/(r.length+t.length)}function a(r,t,n){for(var e={d:0,p:0},i=new Array(r[0].length),o=0;o<r[0].length;o++)i[o]=t[r[0][o]];for(var s=new Array(r[1].length),a=0;a<r[1].length;a++)s[a]=t[r[1][a]];for(var u,c,f=0;f<i.length;f++){u=0;for(var h=0;h<i.length;h++)f!==h&&(u+=n(i[f],i[h]));u/=i.length-1,c=0;for(var l=0;l<s.length;l++)c+=n(i[f],s[l]);c/=s.length,u-c>e.d&&(e.d=u-c,e.p=f)}return e}function u(r,t,n){for(var e=0,i=0,o=0;o<r.length;o++)for(var s=o;s<r.length;s++)e+=n(t[r[o].index],t[r[s].index]),i++;return e/i}function c(r,t){t=t||{};for(var c in m)t.hasOwnProperty(c)||(t[c]=m[c]);if("string"==typeof t.kind)switch(t.kind){case"single":t.kind=n;break;case"complete":t.kind=e;break;case"average":t.kind=i;break;case"centroid":t.kind=o;break;case"ward":t.kind=s;break;default:throw new RangeError("Unknown kind of similarity")}else if("function"!=typeof t.kind)throw new TypeError("Undefined kind of similarity");var f=new l;f.children=new Array(r.length),f.index=new Array(r.length);for(var p=0;p<r.length;p++)f.children[p]=new h(p),f.index[p]=new h(p);f.distance=u(f.index,r,t.dist);for(var d,g,v,y,w,x=[f];x.length>0;){g=0,v=0;for(var b=0;b<x.length;b++){d=0;for(var M=0;M<x[b].length;M++)for(var k=M+1;k<x[b].length;k++)d=Math.max(t.dist(r[x[b].index[M].index],r[x[b].index[k].index]),d);d>g&&(g=d,v=b)}if(g=0,2===x[v].index.length)x[v].children=[x[v].index[0],x[v].index[1]],x[v].distance=t.dist(r[x[v].index[0].index],r[x[v].index[1].index]);else if(3===x[v].index.length){x[v].children=[x[v].index[0],x[v].index[1],x[v].index[2]];var A=[t.dist(r[x[v].index[0].index],r[x[v].index[1].index]),t.dist(r[x[v].index[1].index],r[x[v].index[2].index])];x[v].distance=(A[0]+A[1])/2}else{for(var S=new l,j=new l,R=[new Array(x[v].index.length),[]],T=0;T<R[0].length;T++)R[0][T]=T;for(var V=0;V<R[0].length;V++){y=0;for(var z=0;z<R[0].length;z++)V!==z&&(y+=t.dist(r[x[v].index[R[0][z]].index],r[x[v].index[R[0][V]].index]));y/=R[0].length-1,y>g&&(g=y,w=V)}for(R[1]=[w],R[0].splice(w,1),y=a(R,r,t.dist);y.d>0;)R[1].push(R[0][y.p]),R[0].splice(y.p,1),y=a(R,r,t.dist);var q=new Array(R[0].length);S.index=new Array(R[0].length);for(var C=0;C<q.length;C++)q[C]=r[x[v].index[R[0][C]].index],S.index[C]=x[v].index[R[0][C]],S.children[C]=x[v].index[R[0][C]];var E=new Array(R[1].length);j.index=new Array(R[1].length);for(var D=0;D<E.length;D++)E[D]=r[x[v].index[R[1][D]].index],j.index[D]=x[v].index[R[1][D]],j.children[D]=x[v].index[R[1][D]];S.distance=u(S.index,r,t.dist),j.distance=u(j.index,r,t.dist),x.push(S),x.push(j),x[v].children=[S,j]}x.splice(v,1)}return f}var f=r("ml-euclidean-distance"),h=r("./ClusterLeaf"),l=r("./Cluster"),m={dist:f,kind:"single"};t.exports=c},{"./Cluster":89,"./ClusterLeaf":90,"ml-euclidean-distance":88}],93:[function(r,t,n){n.agnes=r("./agnes"),n.diana=r("./diana")},{"./agnes":91,"./diana":92}],94:[function(r,t){t.exports=r("./kmeans")},{"./kmeans":95}],95:[function(r,t){"use strict";function n(r,t){for(var n=0,e=r.length,i=0;e>i;i++)n+=(r[i]-t[i])*(r[i]-t[i]);return n}function e(r,t,e){for(var i=0,o=r.length,s=0,a=0;o>a;a++)s=e[a],i+=n(r[a],t[s]);return i}function i(r,t){for(var e=r.length,i=t.length,o=0,s=new Array(e),a=0;e>a;a++)s[a]=0;for(var u=new Array(e),a=0;e>a;a++){u[a]=new Array(i);for(var c=0;i>c;c++)o=n(r[a],t[c]),u[a][c]=new Array(2),u[a][c][0]=o,u[a][c][1]=c;for(var f=u[a][0][0],h=0,c=0;i>c;c++)u[a][c][0]<f&&(f=u[a][c][0],h=u[a][c][1]);s[a]=h}return s}function o(r,t,n){for(var e=r[0].length,i=r.length,o=new Array(n),s=0;n>s;s++){o[s]=new Array(e);for(var a=0;e>a;a++)o[s][a]=0}for(var u=0;n>u;u++){for(var c=[],s=0;i>s;s++)t[s]==u&&c.push(r[s]);for(var f=0;e>f;f++){for(var h=[],s=0;i>s;s++)t[s]==u&&h.push(r[s][f]);for(var l=0,m=h.length,s=0;m>s;s++)l+=h[s];o[u][f]=l/m}}return o}function s(r,t,n){var s,a,u;"undefined"==typeof n?(s=100,a=1e-6,u=!1):(s="undefined"==typeof n.maxIter?100:n.maxIter,a="undefined"==typeof n.tol?1e-6:n.tol,u="undefined"==typeof n.withIter?!1:n.withIter);var c=r.length;if(0==c)return[];for(var f=t.length,h=new Array(c),l=0;c>l;l++)h[l]=0;if(f>=c){for(var l=0;c>l;l++)h[l]=l;return h}var m;m=1e100;for(var p=0,d=[],g=0;s>g;g++){if(h=i(r,t),t=o(r,h,f),p=e(r,t,h),u&&d.push({clusters:h,centroids:t}),a>m-p||a>(m-p)/m)return u?{clusters:h,centroids:t,iterations:d}:{clusters:h,centroids:t};m=p}return u?{clusters:h,centroids:t,iterations:d}:{clusters:h,centroids:t}}t.exports=s},{}],96:[function(r,t){"use strict";t.exports=r("./knn")},{"./knn":98}],97:[function(r,t,n){"use strict";function e(r,t,n){this.obj=r,this.left=null,this.right=null,this.parent=n,this.dimension=t}function i(r,t,n){function i(r,t,o){var s,a,u=t%n.length;return 0===r.length?null:1===r.length?new e(r[0],u,o):(r.sort(function(r,t){return r[n[u]]-t[n[u]]}),s=Math.floor(r.length/2),a=new e(r[s],u,o),a.left=i(r.slice(0,s),t+1,a),a.right=i(r.slice(s+1),t+1,a),a)}function s(r){function t(r){r.left&&(r.left.parent=r,t(r.left)),r.right&&(r.right.parent=r,t(r.right))}a.root=r,t(a.root)}var a=this;Array.isArray(r)?this.root=i(r,0,null):s(r,t,n),this.toJSON=function(r){r||(r=this.root);var t=new e(r.obj,r.dimension,null);return r.left&&(t.left=a.toJSON(r.left)),r.right&&(t.right=a.toJSON(r.right)),t},this.insert=function(r){function t(e,i){if(null===e)return i;var o=n[e.dimension];return r[o]<e.obj[o]?t(e.left,e):t(e.right,e)}var i,o,s=t(this.root,null);return null===s?void(this.root=new e(r,0,null)):(i=new e(r,(s.dimension+1)%n.length,s),o=n[s.dimension],void(r[o]<s.obj[o]?s.left=i:s.right=i))},this.remove=function(r){function t(e){if(null===e)return null;if(e.obj===r)return e;var i=n[e.dimension];return r[i]<e.obj[i]?t(e.left,e):t(e.right,e)}function e(r){function t(r,e){var i,o,s,a,u;return null===r?null:(i=n[e],r.dimension===e?null!==r.left?t(r.left,e):r:(o=r.obj[i],s=t(r.left,e),a=t(r.right,e),u=r,null!==s&&s.obj[i]<o&&(u=s),null!==a&&a.obj[i]<u.obj[i]&&(u=a),u))}var i,o,s;return null===r.left&&null===r.right?null===r.parent?void(a.root=null):(s=n[r.parent.dimension],void(r.obj[s]<r.parent.obj[s]?r.parent.left=null:r.parent.right=null)):void(null!==r.right?(i=t(r.right,r.dimension),o=i.obj,e(i),r.obj=o):(i=t(r.left,r.dimension),o=i.obj,e(i),r.right=r.left,r.left=null,r.obj=o))}var i;i=t(a.root),null!==i&&e(i)},this.nearest=function(r,e,i){function s(i){function o(r,t){f.push([r,t]),f.size()>e&&f.pop()}var a,u,c,h,l=n[i.dimension],m=t(r,i.obj),p={};for(h=0;h<n.length;h+=1)p[n[h]]=h===i.dimension?r[n[h]]:i.obj[n[h]];return u=t(p,i.obj),null===i.right&&null===i.left?void((f.size()<e||m<f.peek()[1])&&o(i,m)):(a=null===i.right?i.left:null===i.left?i.right:r[l]<i.obj[l]?i.left:i.right,s(a),(f.size()<e||m<f.peek()[1])&&o(i,m),void((f.size()<e||Math.abs(u)<f.peek()[1])&&(c=a===i.left?i.right:i.left,null!==c&&s(c))))}var u,c,f;if(f=new o(function(r){return-r[1]}),i)for(u=0;e>u;u+=1)f.push([null,i]);for(a.root&&s(a.root),c=[],u=0;u<Math.min(e,f.content.length);u+=1)f.content[u][0]&&c.push([f.content[u][0].obj,f.content[u][1]]);return c},this.balanceFactor=function(){function r(t){return null===t?0:Math.max(r(t.left),r(t.right))+1}function t(r){return null===r?0:t(r.left)+t(r.right)+1}return r(a.root)/(Math.log(t(a.root))/Math.log(2))}}function o(r){this.content=[],this.scoreFunction=r}o.prototype={push:function(r){this.content.push(r),this.bubbleUp(this.content.length-1)},pop:function(){var r=this.content[0],t=this.content.pop();return this.content.length>0&&(this.content[0]=t,this.sinkDown(0)),r},peek:function(){return this.content[0]},remove:function(r){for(var t=this.content.length,n=0;t>n;n++)if(this.content[n]==r){var e=this.content.pop();return void(n!=t-1&&(this.content[n]=e,this.scoreFunction(e)<this.scoreFunction(r)?this.bubbleUp(n):this.sinkDown(n)))}throw new Error("Node not found.")},size:function(){return this.content.length},bubbleUp:function(r){for(var t=this.content[r];r>0;){var n=Math.floor((r+1)/2)-1,e=this.content[n];if(!(this.scoreFunction(t)<this.scoreFunction(e)))break;this.content[n]=t,this.content[r]=e,r=n}},sinkDown:function(r){for(var t=this.content.length,n=this.content[r],e=this.scoreFunction(n);;){var i=2*(r+1),o=i-1,s=null;if(t>o){var a=this.content[o],u=this.scoreFunction(a);e>u&&(s=o)}if(t>i){var c=this.content[i],f=this.scoreFunction(c);(null==s?e:u)>f&&(s=i)}if(null==s)break;this.content[r]=this.content[s],this.content[s]=n,r=s}}},this.kdTree=i,n.kdTree=i,n.BinaryHeap=o},{}],98:[function(r,t){"use strict";function n(r,t){r&&(this.kdtree=t.kdtree,this.k=t.k,this.classes=t.classes)}t.exports=n;var e=r("./kdtree").kdTree,i=r("ml-distance");n.prototype.train=function(r,t,n){void 0===n&&(n={}),void 0===n.distance&&(n.distance=i.euclidean),void 0===n.k&&(n.k=r[0].length+1);for(var o=0,s=new Array(1e3),a=0,u=0;u<t.length;++u)-1===s.indexOf(t[u])&&(o++,s[a]=t[u],a++);var c=new Array(r.length);for(u=0;u<c.length;++u)c[u]=r[u].slice();for(this.features=r[0].length,u=0;u<t.length;++u)c[u].push(t[u]);var f=new Array(r[0].length);for(u=0;u<f.length;++u)f[u]=u;this.kdtree=new e(c,n.distance,f),this.k=n.k,this.classes=o},n.prototype.predict=function(r){for(var t=new Array(r.length),n=0;n<r.length;++n)t[n]=this.getSinglePrediction(r[n]);return t},n.prototype.getSinglePrediction=function(r){for(var t=this.kdtree.nearest(r,this.k),n=new Array(this.classes),e=-1,i=-1,o=t[0][0].length-1,s=0;s<n.length;++s)n[s]=0;for(s=0;s<t.length;++s){var a=t[s][0][o],u=++n[a];u>i&&(e=a,i=u)}return e},n.load=function(r){if("KNN"!==r.modelName)throw new RangeError("The given model is invalid!");return new n(!0,r)},n.prototype["export"]=function(){return{modelName:"KNN",kdtree:this.kdtree,k:this.k,classes:this.classes}}},{"./kdtree":97,"ml-distance":66}],99:[function(r,t,n){arguments[4][6][0].apply(n,arguments)},{"../matrix":107,dup:6}],100:[function(r,t,n){arguments[4][7][0].apply(n,arguments)},{"../matrix":107,"./util":104,dup:7}],101:[function(r,t,n){arguments[4][8][0].apply(n,arguments)},{"../matrix":107,dup:8}],102:[function(r,t,n){arguments[4][9][0].apply(n,arguments)},{"../matrix":107,"./util":104,dup:9}],103:[function(r,t,n){arguments[4][10][0].apply(n,arguments)},{"../matrix":107,"./util":104,dup:10}],104:[function(r,t,n){arguments[4][11][0].apply(n,arguments)},{dup:11}],105:[function(r,t,n){arguments[4][12][0].apply(n,arguments)},{"./dc/cholesky":99,"./dc/evd":100,"./dc/lu":101,"./dc/qr":102,"./dc/svd":103,"./matrix":107,dup:12}],106:[function(r,t,n){arguments[4][13][0].apply(n,arguments)},{"./decompositions":105,"./matrix":107,dup:13}],107:[function(r,t){"use strict";function n(r){for(var t=0,n=r.length,e=new Array(n);n>t;t++)e[t]=r[t];return e}function e(r){this.message=r||"Unknown matrix error"}function i(r,t){var o,s,a=0;if(Array.isArray(r)){if(s=t,o=s?n(r):r,r=o.length,t=o[0].length,"undefined"==typeof t)throw new e("Data must be a 2D array");if(!(r>0&&t>0))throw new e("Invalid dimensions: "+r+"x"+t);for(;r>a;a++){if(o[a].length!==t)throw new e("Inconsistent array dimensions");s&&(o[a]=n(o[a]))}}else{if("number"!=typeof r)throw new e("Invalid arguments");if(!(r>0&&t>0))throw new e("Invalid dimensions: "+r+"x"+t);for(o=new Array(r);r>a;a++)o[a]=new Array(t)}return Object.defineProperty(o,"rows",{writable:!0,value:r}),Object.defineProperty(o,"columns",{writable:!0,value:t}),o.__proto__=i.prototype,o}var o=Array.prototype.splice,s=Array.prototype.concat;e.prototype=Object.create(Error.prototype),e.prototype.name="MatrixError",e.prototype.constructor=e,i.from1DArray=function(r,t,n){var o,s,a=0;if(o=r*t,o!==n.length)throw new e("Data length does not match given dimensions");for(s=new Array(r);r>a;a++)s[a]=n.slice(a*t,(a+1)*t);return new i(s)},i.rowVector=function(r){return new i([r])},i.columnVector=function(r){for(var t=r.length,n=new Array(t),e=0;t>e;e++)n[e]=[r[e]];return new i(n)},i.empty=function(r,t){return new i(r,t)},i.zeros=function(r,t){return i.empty(r,t).fill(0)},i.ones=function(r,t){return i.empty(r,t).fill(1)},i.rand=function(r,t){for(var n=i.empty(r,t),e=0,o=n.rows;o>e;e++)for(var s=0,a=n.columns;a>s;s++)n[e][s]=Math.random();return n},i.eye=function(r){for(var t=i.zeros(r,r),n=t.rows,e=0;n>e;e++)t[e][e]=1;return t},i.diag=function(r){for(var t=r.length,n=i.zeros(t,t),e=0;t>e;e++)n[e][e]=r[e];return n},i.indices=function(r,t){for(var n=new Array(t-r),e=0;e<n.length;e++)n[e]=r++;return n},i.stack=function(r){var t,n,e;if(i.isMatrix(r)){var o=0,s=0;for(t=0;t<arguments.length;t++)o+=arguments[t].rows,arguments[t].columns>s&&(s=arguments[t].columns);var a=i.zeros(o,s),u=0;for(t=0;t<arguments.length;t++){var c=arguments[t];for(n=0;n<c.rows;n++){for(e=0;e<c.columns;e++)a[u][e]=c[n][e];u++}}return a}if(Array.isArray(r)){var f=i.empty(arguments.length,r.length);for(t=0;t<arguments.length;t++)f.setRow(t,arguments[t]);return f}},i.expand=function(r,t){for(var n=[],e=0;e<t.length;e++)for(var o=0;o<t[e];o++)n.push(r[e]);return new i(n)},i.checkMatrix=function(r){if(!r)throw new e("Argument has to be a matrix");return"Matrix"!==r.klass&&(r=new i(r)),r},i.isMatrix=function(r){return r?"Matrix"===r.klass:!1},Object.defineProperty(i.prototype,"klass",{get:function(){return"Matrix"}}),Object.defineProperty(i.prototype,"size",{get:function(){return this.rows*this.columns}}),i.prototype.checkRowIndex=function(r){if(0>r||r>this.rows-1)throw new e("Row index out of range.")},i.prototype.checkColumnIndex=function(r){if(0>r||r>this.columns-1)throw new e("Column index out of range.")},i.prototype.checkDimensions=function(r){if(this.rows!==r.rows||this.columns!==r.columns)throw new e("Matrices dimensions must be equal.")},i.prototype.apply=function(r){for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)r.call(this,e,i);return this},i.prototype.clone=function(){return new i(this.to2DArray())},i.prototype.to1DArray=function(){return s.apply([],this)},i.prototype.to2DArray=function(){for(var r=this.rows,t=new Array(r),e=0;r>e;e++)t[e]=n(this[e]);return t},i.prototype.isRowVector=function(){return 1===this.rows},i.prototype.isColumnVector=function(){return 1===this.columns},i.prototype.isVector=function(){return 1===this.rows||1===this.columns},i.prototype.isSquare=function(){return this.rows===this.columns},i.prototype.isSymmetric=function(){if(this.isSquare()){for(var r=this.rows,t=0;r>t;t++)for(var n=0;t>=n;n++)if(this[t][n]!==this[n][t])return!1;return!0}return!1},i.prototype.set=function(r,t,n){return this[r][t]=n,this},i.prototype.get=function(r,t){return this[r][t]},i.prototype.fill=function(r){for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]=r;return this},i.prototype.neg=function(){return this.mulS(-1)},i.prototype.add=function(r){return"number"==typeof r?this.addS(r):(r=i.checkMatrix(r),this.addM(r))},i.prototype.addS=function(r){for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]+=r;return this},i.prototype.addM=function(r){this.checkDimensions(r);for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]+=r[e][i];return this},i.prototype.sub=function(r){return"number"==typeof r?this.subS(r):(r=i.checkMatrix(r),this.subM(r))},i.prototype.subS=function(r){for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]-=r;return this},i.prototype.subM=function(r){this.checkDimensions(r);for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]-=r[e][i];return this},i.prototype.mul=function(r){return"number"==typeof r?this.mulS(r):(r=i.checkMatrix(r),this.mulM(r))},i.prototype.mulS=function(r){for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]*=r;return this},i.prototype.mulM=function(r){this.checkDimensions(r);for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]*=r[e][i];return this},i.prototype.div=function(r){return"number"==typeof r?this.divS(r):(r=i.checkMatrix(r),this.divM(r))},i.prototype.divS=function(r){for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]/=r;return this},i.prototype.divM=function(r){this.checkDimensions(r);for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]/=r[e][i];return this},i.prototype.getRow=function(r){return this.checkRowIndex(r),n(this[r])},i.prototype.setRow=function(r,t){if(this.checkRowIndex(r),i.isMatrix(t)&&(t=t.to1DArray()),t.length!==this.columns)throw new e("Invalid row size");return this[r]=n(t),this},i.prototype.removeRow=function(r){if(this.checkRowIndex(r),1===this.rows)throw new e("A matrix cannot have less than one row");return o.call(this,r,1),this.rows-=1,this},i.prototype.addRow=function(r,t){if("undefined"==typeof t&&(t=r,r=this.rows),0>r||r>this.rows)throw new e("Row index out of range.");if(i.isMatrix(t)&&(t=t.to1DArray()),t.length!==this.columns)throw new e("Invalid row size");return o.call(this,r,0,n(t)),this.rows+=1,this},i.prototype.swapRows=function(r,t){this.checkRowIndex(r),this.checkRowIndex(t);var n=this[r];return this[r]=this[t],this[t]=n,this},i.prototype.getColumn=function(r){this.checkColumnIndex(r);for(var t=this.rows,n=new Array(t),e=0;t>e;e++)n[e]=this[e][r];return n},i.prototype.setColumn=function(r,t){this.checkColumnIndex(r),i.isMatrix(t)&&(t=t.to1DArray());var n=this.rows;if(t.length!==n)throw new e("Invalid column size");for(var o=0;n>o;o++)this[o][r]=t[o];return this},i.prototype.removeColumn=function(r){if(this.checkColumnIndex(r),1===this.columns)throw new e("A matrix cannot have less than one column");for(var t=0,n=this.rows;n>t;t++)this[t].splice(r,1);return this.columns-=1,this},i.prototype.addColumn=function(r,t){if("undefined"==typeof t&&(t=r,r=this.columns),0>r||r>this.columns)throw new e("Column index out of range.");i.isMatrix(t)&&(t=t.to1DArray());var n=this.rows;if(t.length!==n)throw new e("Invalid column size");for(var o=0;n>o;o++)this[o].splice(r,0,t[o]);return this.columns+=1,this},i.prototype.swapColumns=function(r,t){this.checkRowIndex(r),this.checkRowIndex(t);for(var n,e,i=this.rows,o=0;i>o;o++)e=this[o],n=e[r],e[r]=e[t],e[t]=n;return this},i.prototype.checkRowVector=function(r){if(i.isMatrix(r)&&(r=r.to1DArray()),r.length!==this.columns)throw new e("vector size must be the same as the number of columns");return r},i.prototype.checkColumnVector=function(r){if(i.isMatrix(r)&&(r=r.to1DArray()),r.length!==this.rows)throw new e("vector size must be the same as the number of rows");return r},i.prototype.addRowVector=function(r){r=this.checkRowVector(r);for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]+=r[i];return this},i.prototype.subRowVector=function(r){r=this.checkRowVector(r);for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]-=r[i];return this},i.prototype.mulRowVector=function(r){r=this.checkRowVector(r);for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]*=r[i];return this},i.prototype.divRowVector=function(r){r=this.checkRowVector(r);for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]/=r[i];return this},i.prototype.addColumnVector=function(r){r=this.checkColumnVector(r);for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]+=r[e];return this},i.prototype.subColumnVector=function(r){r=this.checkColumnVector(r);for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]-=r[e];return this},i.prototype.mulColumnVector=function(r){r=this.checkColumnVector(r);for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]*=r[e];return this},i.prototype.divColumnVector=function(r){r=this.checkColumnVector(r);for(var t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]/=r[e];return this},i.prototype.mulRow=function(r,t){this.checkRowIndex(r);for(var n=0,e=this.columns;e>n;n++)this[r][n]*=t;return this},i.prototype.mulColumn=function(r,t){this.checkColumnIndex(r);for(var n=0,e=this.rows;e>n;n++)this[n][r]*=t},i.prototype.max=function(){for(var r=-1/0,t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]>r&&(r=this[e][i]);return r},i.prototype.maxIndex=function(){for(var r=-1/0,t={},n=this.rows,e=this.columns,i=0;n>i;i++)for(var o=0;e>o;o++)this[i][o]>r&&(r=this[i][o],t.row=i,t.column=o);return t},i.prototype.min=function(){for(var r=1/0,t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)this[e][i]<r&&(r=this[e][i]);return r},i.prototype.minIndex=function(){for(var r=1/0,t={},n=this.rows,e=this.columns,i=0;n>i;i++)for(var o=0;e>o;o++)this[i][o]<r&&(r=this[i][o],t.row=i,t.column=o);return t},i.prototype.maxRow=function(r){this.checkRowIndex(r);for(var t=-1/0,n=0,e=this.columns;e>n;n++)this[r][n]>t&&(t=this[r][n]);return t},i.prototype.maxRowIndex=function(r){this.checkRowIndex(r);for(var t=-1/0,n={row:r},e=0,i=this.columns;i>e;e++)this[r][e]>t&&(t=this[r][e],n.column=e);return n},i.prototype.minRow=function(r){this.checkRowIndex(r);for(var t=1/0,n=0,e=this.columns;e>n;n++)this[r][n]<t&&(t=this[r][n]);return t},i.prototype.minRowIndex=function(r){this.checkRowIndex(r);for(var t=1/0,n={row:r,column:0},e=0,i=this.columns;i>e;e++)this[r][e]<t&&(t=this[r][e],n.column=e);return n},i.prototype.maxColumn=function(r){this.checkColumnIndex(r);for(var t=-1/0,n=0,e=this.rows;e>n;n++)this[n][r]>t&&(t=this[n][r]);return t},i.prototype.maxColumnIndex=function(r){this.checkColumnIndex(r);for(var t=-1/0,n={row:0,column:r},e=0,i=this.rows;i>e;e++)this[e][r]>t&&(t=this[e][r],n.row=e);return n},i.prototype.minColumn=function(r){this.checkColumnIndex(r);for(var t=1/0,n=0,e=this.rows;e>n;n++)this[n][r]<t&&(t=this[n][r]);return t},i.prototype.minColumnIndex=function(r){this.checkColumnIndex(r);for(var t=1/0,n={row:0,column:r},e=0,i=this.rows;i>e;e++)this[e][r]<t&&(t=this[e][r],n.row=e);return n},i.prototype.diag=function a(){if(!this.isSquare())throw new e("Only square matrices have a diagonal.");for(var a=new Array(this.rows),r=0,t=this.rows;t>r;r++)a[r]=this[r][r];return a},i.prototype.sum=function(){for(var r=0,t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)r+=this[e][i];return r},i.prototype.mean=function(){return this.sum()/this.size},i.prototype.prod=function u(){for(var u=1,r=this.rows,t=this.columns,n=0;r>n;n++)for(var e=0;t>e;e++)u*=this[n][e];return u},i.prototype.cumulativeSum=function(){for(var r=0,t=this.rows,n=this.columns,e=0;t>e;e++)for(var i=0;n>i;i++)r+=this[e][i],this[e][i]=r;return this},i.prototype.dot=function c(r){if(this.size!==r.size)throw new e("vectors do not have the same size");for(var t=this.to1DArray(),n=r.to1DArray(),c=0,i=t.length,o=0;i>o;o++)c+=t[o]*n[o];return c},i.prototype.mmul=function(r){if(!i.isMatrix(r))throw new e('parameter "other" must be a matrix');this.columns!==r.rows&&console.warn("Number of columns of left matrix are not equal to number of rows of right matrix.");var t,n,o,s=this.rows,a=this.columns,u=r.columns,c=new i(s,u),f=new Array(a);for(n=0;u>n;n++){for(o=0;a>o;o++)f[o]=r[o][n];for(t=0;s>t;t++){var h=this[t],l=0;for(o=0;a>o;o++)l+=h[o]*f[o];c[t][n]=l}}return c},i.prototype.sortRows=function(r){for(var t=0,n=this.rows;n>t;t++)this[t].sort(r);return this},i.prototype.sortColumns=function(r){for(var t=0,n=this.columns;n>t;t++)this.setColumn(t,this.getColumn(t).sort(r));return this},i.prototype.transpose=function(){for(var r=new i(this.columns,this.rows),t=this.rows,n=this.columns,e=0;t>e;e++)for(var o=0;n>o;o++)r[o][e]=this[e][o];return r},i.prototype.subMatrix=function(r,t,n,o){if(r>t||n>o||0>r||r>=this.rows||0>t||t>=this.rows||0>n||n>=this.columns||0>o||o>=this.columns)throw new e("Argument out of range");for(var s=new i(t-r+1,o-n+1),a=r;t>=a;a++)for(var u=n;o>=u;u++)s[a-r][u-n]=this[a][u];return s},i.prototype.subMatrixRow=function(r,t,n){if("undefined"==typeof t?(t=0,n=this.columns-1):"undefined"==typeof n&&(n=this.columns-1),t>n||0>t||t>=this.columns||0>n||n>=this.columns)throw new e("Argument out of range.");for(var o=r.length,s=this.rows,a=new i(o,n-t+1),u=0;o>u;u++)for(var c=t;n>=c;c++){if(r[u]<0||r[u]>=s)throw new e("Argument out of range.");a[u][c-t]=this[r[u]][c]}return a},i.prototype.subMatrixColumn=function(r,t,n){if("undefined"==typeof t?(t=0,n=this.rows-1):"undefined"==typeof n&&(n=this.rows-1),t>n||0>t||t>=this.rows||0>n||n>=this.rows)throw new e("Argument out of range.");for(var o=r.length,s=this.columns,a=new i(n-t+1,o),u=0;o>u;u++)for(var c=t;n>=c;c++){if(r[u]<0||r[u]>=s)throw new e("Argument out of range.");a[c-t][u]=this[c][r[u]]}return a},i.prototype.trace=function f(){if(!this.isSquare())throw new e("The matrix is not square");for(var f=0,r=0,t=this.rows;t>r;r++)f+=this[r][r];return f},i.prototype.abs=function(){for(var r=this.rows,t=this.columns,n=0;r>n;n++)for(var e=0;t>e;e++)this[n][e]=Math.abs(this[n][e])},i.MatrixError=e,t.exports=i},{}],108:[function(r,t,n){arguments[4][6][0].apply(n,arguments)},{"../matrix":116,dup:6}],109:[function(r,t,n){arguments[4][7][0].apply(n,arguments)},{"../matrix":116,"./util":113,dup:7}],110:[function(r,t,n){arguments[4][8][0].apply(n,arguments)},{"../matrix":116,dup:8}],111:[function(r,t,n){arguments[4][9][0].apply(n,arguments)},{"../matrix":116,"./util":113,dup:9}],112:[function(r,t,n){arguments[4][10][0].apply(n,arguments)},{"../matrix":116,"./util":113,dup:10}],113:[function(r,t,n){arguments[4][11][0].apply(n,arguments)},{dup:11}],114:[function(r,t,n){arguments[4][12][0].apply(n,arguments)},{"./dc/cholesky":108,"./dc/evd":109,"./dc/lu":110,"./dc/qr":111,"./dc/svd":112,"./matrix":116,dup:12}],115:[function(r,t,n){arguments[4][13][0].apply(n,arguments)},{"./decompositions":114,"./matrix":116,dup:13}],116:[function(r,t,n){arguments[4][14][0].apply(n,arguments)},{dup:14}],117:[function(r,t,n){t.exports=n=r("./naiveBayes").NaiveBayes,n.separateClasses=r("./naiveBayes").separateClasses},{"./naiveBayes":118}],118:[function(r,t){"use strict";function n(r,t){r&&(this.means=t.means,this.calculateProbabilities=t.calculateProbabilities)}function e(r,t,n){for(var e=0,o=-1,s=0;s<n.length;++s){for(var a=n[s][0],u=1;u<n[0][1].length+1;++u)a+=i(r[u-1],t[s][u-1],n[s][u][0],n[s][u][1]);a=Math.exp(a),a>e&&(e=a,o=s)}return o}function i(r,t,n,e){var r=r-t;return Math.log(n*Math.exp(r*r/e))}function o(r,t){for(var n=r.columns,e=0,i=new Array(100),o=0;o<t.length;o++)void 0===i[t[o]]&&(i[t[o]]=0,e++),i[t[o]]++;var a=new Array(e),u=new Array(e);for(o=0;e>o;++o)a[o]=new s(i[o],n),u[o]=0;for(o=0;o<r.rows;++o)a[t[o]].setRow(u[t[o]],r.getRow(o)),u[t[o]]++;return a}var s=r("ml-matrix"),a=r("ml-stat");t.exports.NaiveBayes=n,t.exports.separateClasses=o,n.prototype.train=function(r,t){var n=Math.sqrt(2*Math.PI);if(s.isMatrix(r))e=r.clone();else var e=s(r);if(e.rows!==t.length)throw new RangeError("the size of the training set and the training labels must be the same.");var i=o(r,t),u=new Array(i.length);this.means=new Array(i.length);for(var c=0;c<i.length;++c){var f=a.matrix.mean(i[c]),h=a.matrix.standardDeviation(i[c],f),l=Math.log(i[c].rows/e.rows);u[c]=new Array(f.length+1),u[c][0]=l;for(var m=1;m<f.length+1;++m){var p=h[m-1];u[c][m]=[1/(n*p),-2*p*p]}this.means[c]=f}this.calculateProbabilities=u},n.prototype.predict=function(r){if(r[0].length===this.calculateProbabilities[0].length)throw new RangeError("the dataset must have the same features as the training set");for(var t=new Array(r.length),n=0;n<t.length;++n)t[n]=e(r[n],this.means,this.calculateProbabilities);return t},n.prototype["export"]=function(){return{modelName:"NaiveBayes",means:this.means,calculateProbabilities:this.calculateProbabilities}},n.load=function(r){if("NaiveBayes"!==r.modelName)throw new RangeError("The given model is invalid!");return new n(!0,r)}},{"ml-matrix":115,"ml-stat":149}],119:[function(r,t,n){arguments[4][6][0].apply(n,arguments)},{"../matrix":127,dup:6}],120:[function(r,t,n){arguments[4][7][0].apply(n,arguments)},{"../matrix":127,"./util":124,dup:7}],121:[function(r,t,n){arguments[4][8][0].apply(n,arguments)},{"../matrix":127,dup:8}],122:[function(r,t,n){arguments[4][9][0].apply(n,arguments)},{"../matrix":127,"./util":124,dup:9}],123:[function(r,t,n){arguments[4][10][0].apply(n,arguments)},{"../matrix":127,"./util":124,dup:10}],124:[function(r,t,n){arguments[4][11][0].apply(n,arguments)},{dup:11}],125:[function(r,t,n){arguments[4][12][0].apply(n,arguments)},{"./dc/cholesky":119,"./dc/evd":120,"./dc/lu":121,"./dc/qr":122,"./dc/svd":123,"./matrix":127,dup:12}],126:[function(r,t,n){arguments[4][13][0].apply(n,arguments)},{"./decompositions":125,"./matrix":127,dup:13}],127:[function(r,t,n){arguments[4][14][0].apply(n,arguments)},{dup:14}],128:[function(r,t){t.exports=r("./pca")},{"./pca":129}],129:[function(r,t){"use strict";function n(r,t,n){if(t)this.U=n.U,this.S=n.S,this.means=n.means,this.std=n.std;else{r=i.isMatrix(r)?r.clone():new i(r,!0);var o=e(r),a=o.result,u=a.transpose().mmul(a).divS(r.rows),c=new s(u,{computeLeftSingularVectors:!0,computeRightSingularVectors:!0,autoTranspose:!1});this.U=c.leftSingularVectors,this.S=c.diagonal,this.means=o.means,this.std=o.std}}function e(r){var t=o.matrix.mean(r),n=i.rowVector(o.matrix.standardDeviation(r,t,!0));t=i.rowVector(t);var e=r.subRowVector(t);return{result:e.divRowVector(n),means:t,std:n}}var i=r("ml-matrix"),o=r("ml-stat"),s=i.DC.SVD;t.exports=n,n.load=function(r){if("PCA"!==r.modelName)throw new RangeError("The current model is invalid!");return new n(null,!0,r)},n.prototype["export"]=function(){return{modelName:"PCA",U:this.U,S:this.S,means:this.means,std:this.std}},n.prototype.project=function(r,t){var n=t-1;if(t>this.U.columns)throw new RangeError("the number of dimensions must not be larger than "+this.U.columns);var o=e(i(r).clone()).result;return o.mmul(this.U.subMatrix(0,this.U.rows-1,0,n))},n.prototype.getExplainedVariance=function(){var r=this.S.reduce(function(r,t){return r+t});return this.S.map(function(t){return t/r})},n.prototype.getEigenvectors=function(){return this.U},n.prototype.getEigenvalues=function(){return this.S}},{"ml-matrix":126,"ml-stat":149}],130:[function(r,t,n){arguments[4][6][0].apply(n,arguments)},{"../matrix":138,dup:6}],131:[function(r,t,n){arguments[4][7][0].apply(n,arguments)
},{"../matrix":138,"./util":135,dup:7}],132:[function(r,t,n){arguments[4][8][0].apply(n,arguments)},{"../matrix":138,dup:8}],133:[function(r,t,n){arguments[4][9][0].apply(n,arguments)},{"../matrix":138,"./util":135,dup:9}],134:[function(r,t,n){arguments[4][10][0].apply(n,arguments)},{"../matrix":138,"./util":135,dup:10}],135:[function(r,t,n){arguments[4][11][0].apply(n,arguments)},{dup:11}],136:[function(r,t,n){arguments[4][12][0].apply(n,arguments)},{"./dc/cholesky":130,"./dc/evd":131,"./dc/lu":132,"./dc/qr":133,"./dc/svd":134,"./matrix":138,dup:12}],137:[function(r,t,n){arguments[4][13][0].apply(n,arguments)},{"./decompositions":136,"./matrix":138,dup:13}],138:[function(r,t,n){arguments[4][14][0].apply(n,arguments)},{dup:14}],139:[function(r,t,n){t.exports=n=r("./pls"),n.Utils=r("./utils"),n.OPLS=r("./opls")},{"./opls":140,"./pls":141,"./utils":142}],140:[function(r,t){"use strict";function n(r,t,n){var o=e(r).clone(),s=e(t).clone();o=i.featureNormalize(o).result,s=i.featureNormalize(s).result;var a=(o.rows,o.columns,o.clone().mul(o).sum()),u=o.transpose().mmul(s);u.div(i.norm(u));for(var c=new Array(n),f=new Array(n),h=new Array(n),l=0;n>l;l++){var m=o.mmul(u),p=o.transpose().mmul(m),d=m.transpose().mmul(m)[0][0],g=p.div(d);p=u.transpose().mmul(g)[0][0],d=u.transpose().mmul(u)[0][0];var v=g.sub(u.clone().mul(p/d));v.div(i.norm(v));var y=o.mmul(v);p=o.transpose().mmul(y),d=y.transpose().mmul(y)[0][0];var w=p.div(d);o.sub(y.mmul(w.transpose())),c[l]=v.getColumn(0),f[l]=y.getColumn(0),h[l]=w.getColumn(0)}this.Xosc=o;var x=this.Xosc.clone().mul(this.Xosc).sum();this.R2X=1-x/a,this.W=c,this.T=f,this.P=h,this.numberOSC=n}var e=r("ml-matrix"),i=r("./utils");t.exports=n,n.prototype.correctDataset=function(r){for(var t=e(r).clone(),n=t.clone().mul(t).sum(),i=0;i<this.numberOSC;i++){var o=this.W.getColumnVector(i),s=this.P.getColumnVector(i),a=t.mmul(o);t.sub(a.mmul(s))}var u=t.clone().mul(t).sum(),c=1-u/n;return{datasetOsc:t,R2Dataset:c}}},{"./utils":142,"ml-matrix":137}],141:[function(r,t){"use strict";function n(r){for(var t=0,n=-1/0,e=0;e<r.columns;++e){var i=r.getColumnVector(e).sum();i>n&&(n=i,t=e)}return t}function e(r,t){r&&(this.E=t.E,this.F=t.F,this.ymean=t.ymean,this.ystd=t.ystd,this.PBQ=t.PBQ,this.T=t.T,this.P=t.P,this.U=t.U,this.Q=t.Q,this.W=t.W,this.B=t.B)}t.exports=e;var i=r("ml-matrix"),o=r("./utils");e.prototype.fit=function(r,t,e,s){if(r.length!==t.length)throw new RangeError("The number of predictions and elements in the dataset must be the same");var a=o.featureNormalize(i(r).clone()).result,u=o.featureNormalize(i(t).clone());this.ymean=u.means,this.ystd=u.std;var c=u.result,f=a.rows,h=a.columns,l=c.rows,m=c.columns,p=a.clone().mul(a).sum();if(f!=l)throw new RangeError("dataset cases is not the same as the predictions");for(var d=e,g=i.zeros(f,d),v=i.zeros(h,d),y=i.zeros(l,d),w=i.zeros(m,d),x=i.zeros(d,d),b=v.clone(),M=0;o.norm(c)>s&&d>M;){for(var k=a.transpose(),A=c.transpose(),S=n(a.clone().mulM(a)),j=n(c.clone().mulM(c)),R=a.getColumnVector(S),T=c.getColumnVector(j),V=i.zeros(f,1);o.norm(R.clone().sub(V))>s;){var z=k.mmul(T);z.div(o.norm(z)),V=R,R=a.mmul(z);var q=A.mmul(R);q.div(o.norm(q)),T=c.mmul(q)}V=R;var C=k.mmul(V),E=V.transpose().mmul(V)[0][0],D=C.div(E),O=o.norm(D);D.div(O),V.mul(O),z.mul(O),C=T.transpose().mmul(V),E=V.transpose().mmul(V)[0][0];var N=C.div(E)[0][0];a.sub(V.mmul(D.transpose())),c.sub(V.clone().mul(N).mmul(q.transpose())),g.setColumn(M,V),v.setColumn(M,D),y.setColumn(M,T),w.setColumn(M,q),b.setColumn(M,z),x[M][M]=N,M++}M--,g=g.subMatrix(0,g.rows-1,0,M),v=v.subMatrix(0,v.rows-1,0,M),y=y.subMatrix(0,y.rows-1,0,M),w=w.subMatrix(0,w.rows-1,0,M),b=b.subMatrix(0,b.rows-1,0,M),x=x.subMatrix(0,M,0,M),this.r2cal=(1-a.clone().mul(a).sum())/p,this.E=a,this.F=c,this.T=g,this.P=v,this.U=y,this.Q=w,this.W=b,this.B=x,this.PBQ=v.mmul(x).mmul(w.transpose())},e.prototype.predict=function(r){var t=i(r).clone(),n=o.featureNormalize(t);t=n.result;var e=t.mmul(this.PBQ).add(this.F);return e.mulRowVector(this.ystd),e.subRowVector(this.ymean),e},e.prototype.getExplainedVariance=function(){return this.r2cal},e.load=function(r){if("PLS"!==r.modelName)throw new RangeError("The current model is invalid!");return new e(!0,r)},e.prototype["export"]=function(){return{modelName:"PLS",E:this.E,F:this.F,ymean:this.ymean,ystd:this.ystd,PBQ:this.PBQ,T:this.T,P:this.P,U:this.U,Q:this.Q,W:this.W,B:this.B}}},{"./utils":142,"ml-matrix":137}],142:[function(r,t){"use strict";function n(r){return Math.sqrt(r.clone().apply(e).sum())}function e(r,t){return this[r][t]=this[r][t]*this[r][t],this}function i(r){var t=s.matrix.mean(r),n=o.rowVector(s.matrix.standardDeviation(r,t,!0));t=o.rowVector(t);var e=r.addRowVector(t.neg());return{result:e.divRowVector(n),means:t,std:n}}var o=r("ml-matrix"),s=r("ml-stat");t.exports={norm:n,pow2array:e,featureNormalize:i}},{"ml-matrix":137,"ml-stat":149}],143:[function(require,module,exports){(function(global){"use strict";var numeric="undefined"==typeof exports?function(){}:exports;"undefined"!=typeof global&&(global.numeric=numeric),numeric.version="1.2.6",numeric.bench=function(r,t){var n,e,i,o;for("undefined"==typeof t&&(t=15),i=.5,n=new Date;;){for(i*=2,o=i;o>3;o-=4)r(),r(),r(),r();for(;o>0;)r(),o--;if(e=new Date,e-n>t)break}for(o=i;o>3;o-=4)r(),r(),r(),r();for(;o>0;)r(),o--;return e=new Date,1e3*(3*i-1)/(e-n)},numeric._myIndexOf=function(r){var t,n=this.length;for(t=0;n>t;++t)if(this[t]===r)return t;return-1},numeric.myIndexOf=Array.prototype.indexOf?Array.prototype.indexOf:numeric._myIndexOf,numeric.Function=Function,numeric.precision=4,numeric.largeArray=50,numeric.prettyPrint=function(r){function t(r){if(0===r)return"0";if(isNaN(r))return"NaN";if(0>r)return"-"+t(-r);if(isFinite(r)){var n=Math.floor(Math.log(r)/Math.log(10)),e=r/Math.pow(10,n),i=e.toPrecision(numeric.precision);return 10===parseFloat(i)&&(n++,e=1,i=e.toPrecision(numeric.precision)),parseFloat(i).toString()+"e"+n.toString()}return"Infinity"}function n(r){var i;if("undefined"==typeof r)return e.push(Array(numeric.precision+8).join(" ")),!1;if("string"==typeof r)return e.push('"'+r+'"'),!1;if("boolean"==typeof r)return e.push(r.toString()),!1;if("number"==typeof r){var o=t(r),s=r.toPrecision(numeric.precision),a=parseFloat(r.toString()).toString(),u=[o,s,a,parseFloat(s).toString(),parseFloat(a).toString()];for(i=1;i<u.length;i++)u[i].length<o.length&&(o=u[i]);return e.push(Array(numeric.precision+8-o.length).join(" ")+o),!1}if(null===r)return e.push("null"),!1;if("function"==typeof r){e.push(r.toString());var c=!1;for(i in r)r.hasOwnProperty(i)&&(e.push(c?",\n":"\n{"),c=!0,e.push(i),e.push(": \n"),n(r[i]));return c&&e.push("}\n"),!0}if(r instanceof Array){if(r.length>numeric.largeArray)return e.push("...Large Array..."),!0;var c=!1;for(e.push("["),i=0;i<r.length;i++)i>0&&(e.push(","),c&&e.push("\n ")),c=n(r[i]);return e.push("]"),!0}e.push("{");var c=!1;for(i in r)r.hasOwnProperty(i)&&(c&&e.push(",\n"),c=!0,e.push(i),e.push(": \n"),n(r[i]));return e.push("}"),!0}var e=[];return n(r),e.join("")},numeric.parseDate=function(r){function t(r){if("string"==typeof r)return Date.parse(r.replace(/-/g,"/"));if(!(r instanceof Array))throw new Error("parseDate: parameter must be arrays of strings");var n,e=[];for(n=0;n<r.length;n++)e[n]=t(r[n]);return e}return t(r)},numeric.parseFloat=function(r){function t(r){if("string"==typeof r)return parseFloat(r);if(!(r instanceof Array))throw new Error("parseFloat: parameter must be arrays of strings");var n,e=[];for(n=0;n<r.length;n++)e[n]=t(r[n]);return e}return t(r)},numeric.parseCSV=function(r){var t,n,e=r.split("\n"),i=[],o=/(([^'",]*)|('[^']*')|("[^"]*")),/g,s=/^\s*(([+-]?[0-9]+(\.[0-9]*)?(e[+-]?[0-9]+)?)|([+-]?[0-9]*(\.[0-9]+)?(e[+-]?[0-9]+)?))\s*$/,a=function(r){return r.substr(0,r.length-1)},u=0;for(n=0;n<e.length;n++){var c,f=(e[n]+",").match(o);if(f.length>0){for(i[u]=[],t=0;t<f.length;t++)c=a(f[t]),i[u][t]=s.test(c)?parseFloat(c):c;u++}}return i},numeric.toCSV=function(r){var t,n,e,i,o,s,a=numeric.dim(r);for(e=a[0],i=a[1],s=[],t=0;e>t;t++){for(o=[],n=0;e>n;n++)o[n]=r[t][n].toString();s[t]=o.join(", ")}return s.join("\n")+"\n"},numeric.getURL=function(r){var t=new XMLHttpRequest;return t.open("GET",r,!1),t.send(),t},numeric.imageURL=function(r){function t(r){var t,n,e,i,o,s,a,u,c=r.length,f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",h="";for(t=0;c>t;t+=3)n=r[t],e=r[t+1],i=r[t+2],o=n>>2,s=((3&n)<<4)+(e>>4),a=((15&e)<<2)+(i>>6),u=63&i,t+1>=c?a=u=64:t+2>=c&&(u=64),h+=f.charAt(o)+f.charAt(s)+f.charAt(a)+f.charAt(u);return h}function n(r,t,n){"undefined"==typeof t&&(t=0),"undefined"==typeof n&&(n=r.length);{var e,i=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],o=-1,s=0;r.length}for(e=t;n>e;e++)s=255&(o^r[e]),o=o>>>8^i[s];return-1^o}var e,i,o,s,a,u,c,f,h,l,m=r[0].length,p=r[0][0].length,d=[137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,p>>24&255,p>>16&255,p>>8&255,255&p,m>>24&255,m>>16&255,m>>8&255,255&m,8,2,0,0,0,-1,-2,-3,-4,-5,-6,-7,-8,73,68,65,84,8,29];for(l=n(d,12,29),d[29]=l>>24&255,d[30]=l>>16&255,d[31]=l>>8&255,d[32]=255&l,e=1,i=0,c=0;m>c;c++){for(d.push(m-1>c?0:1),a=3*p+1+(0===c)&255,u=3*p+1+(0===c)>>8&255,d.push(a),d.push(u),d.push(255&~a),d.push(255&~u),0===c&&d.push(0),f=0;p>f;f++)for(o=0;3>o;o++)a=r[o][c][f],a=a>255?255:0>a?0:Math.round(a),e=(e+a)%65521,i=(i+e)%65521,d.push(a);d.push(0)}return h=(i<<16)+e,d.push(h>>24&255),d.push(h>>16&255),d.push(h>>8&255),d.push(255&h),s=d.length-41,d[33]=s>>24&255,d[34]=s>>16&255,d[35]=s>>8&255,d[36]=255&s,l=n(d,37),d.push(l>>24&255),d.push(l>>16&255),d.push(l>>8&255),d.push(255&l),d.push(0),d.push(0),d.push(0),d.push(0),d.push(73),d.push(69),d.push(78),d.push(68),d.push(174),d.push(66),d.push(96),d.push(130),"data:image/png;base64,"+t(d)},numeric._dim=function(r){for(var t=[];"object"==typeof r;)t.push(r.length),r=r[0];return t},numeric.dim=function(r){var t,n;return"object"==typeof r?(t=r[0],"object"==typeof t?(n=t[0],"object"==typeof n?numeric._dim(r):[r.length,t.length]):[r.length]):[]},numeric.mapreduce=function(r,t){return Function("x","accum","_s","_k",'if(typeof accum === "undefined") accum = '+t+';\nif(typeof x === "number") { var xi = x; '+r+'; return accum; }\nif(typeof _s === "undefined") _s = numeric.dim(x);\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i,xi;\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) {\n        accum = arguments.callee(x[i],accum,_s,_k+1);\n    }    return accum;\n}\nfor(i=_n-1;i>=1;i-=2) { \n    xi = x[i];\n    '+r+";\n    xi = x[i-1];\n    "+r+";\n}\nif(i === 0) {\n    xi = x[i];\n    "+r+"\n}\nreturn accum;")},numeric.mapreduce2=function(r,t){return Function("x","var n = x.length;\nvar i,xi;\n"+t+";\nfor(i=n-1;i!==-1;--i) { \n    xi = x[i];\n    "+r+";\n}\nreturn accum;")},numeric.same=function r(t,n){var e,i;if(!(t instanceof Array&&n instanceof Array))return!1;if(i=t.length,i!==n.length)return!1;for(e=0;i>e;e++)if(t[e]!==n[e]){if("object"!=typeof t[e])return!1;if(!r(t[e],n[e]))return!1}return!0},numeric.rep=function(r,t,n){"undefined"==typeof n&&(n=0);var e,i=r[n],o=Array(i);if(n===r.length-1){for(e=i-2;e>=0;e-=2)o[e+1]=t,o[e]=t;return-1===e&&(o[0]=t),o}for(e=i-1;e>=0;e--)o[e]=numeric.rep(r,t,n+1);return o},numeric.dotMMsmall=function(r,t){var n,e,i,o,s,a,u,c,f,h,l;for(o=r.length,s=t.length,a=t[0].length,u=Array(o),n=o-1;n>=0;n--){for(c=Array(a),f=r[n],i=a-1;i>=0;i--){for(h=f[s-1]*t[s-1][i],e=s-2;e>=1;e-=2)l=e-1,h+=f[e]*t[e][i]+f[l]*t[l][i];0===e&&(h+=f[0]*t[0][i]),c[i]=h}u[n]=c}return u},numeric._getCol=function(r,t,n){var e,i=r.length;for(e=i-1;e>0;--e)n[e]=r[e][t],--e,n[e]=r[e][t];0===e&&(n[0]=r[0][t])},numeric.dotMMbig=function(r,t){var n,e,i,o,s=numeric._getCol,a=t.length,u=Array(a),c=r.length,f=t[0].length,h=new Array(c),l=numeric.dotVV;for(--a,--c,e=c;-1!==e;--e)h[e]=Array(f);for(--f,e=f;-1!==e;--e)for(s(t,e,u),i=c;-1!==i;--i)o=0,n=r[i],h[i][e]=l(n,u);return h},numeric.dotMV=function(r,t){var n,e=r.length,i=(t.length,Array(e)),o=numeric.dotVV;for(n=e-1;n>=0;n--)i[n]=o(r[n],t);return i},numeric.dotVM=function(r,t){var n,e,i,o,s,a,u;for(i=r.length,o=t[0].length,s=Array(o),e=o-1;e>=0;e--){for(a=r[i-1]*t[i-1][e],n=i-2;n>=1;n-=2)u=n-1,a+=r[n]*t[n][e]+r[u]*t[u][e];0===n&&(a+=r[0]*t[0][e]),s[e]=a}return s},numeric.dotVV=function(r,t){var n,e,i=r.length,o=r[i-1]*t[i-1];for(n=i-2;n>=1;n-=2)e=n-1,o+=r[n]*t[n]+r[e]*t[e];return 0===n&&(o+=r[0]*t[0]),o},numeric.dot=function(r,t){var n=numeric.dim;switch(1e3*n(r).length+n(t).length){case 2002:return t.length<10?numeric.dotMMsmall(r,t):numeric.dotMMbig(r,t);case 2001:return numeric.dotMV(r,t);case 1002:return numeric.dotVM(r,t);case 1001:return numeric.dotVV(r,t);case 1e3:return numeric.mulVS(r,t);case 1:return numeric.mulSV(r,t);case 0:return r*t;default:throw new Error("numeric.dot only works on vectors and matrices")}},numeric.diag=function(r){var t,n,e,i,o=r.length,s=Array(o);for(t=o-1;t>=0;t--){for(i=Array(o),n=t+2,e=o-1;e>=n;e-=2)i[e]=0,i[e-1]=0;for(e>t&&(i[e]=0),i[t]=r[t],e=t-1;e>=1;e-=2)i[e]=0,i[e-1]=0;0===e&&(i[0]=0),s[t]=i}return s},numeric.getDiag=function(r){var t,n=Math.min(r.length,r[0].length),e=Array(n);for(t=n-1;t>=1;--t)e[t]=r[t][t],--t,e[t]=r[t][t];return 0===t&&(e[0]=r[0][0]),e},numeric.identity=function(r){return numeric.diag(numeric.rep([r],1))},numeric.pointwise=function(r,t,n){"undefined"==typeof n&&(n="");var e,i,o=[],s=/\[i\]$/,a="",u=!1;for(e=0;e<r.length;e++)s.test(r[e])?(i=r[e].substring(0,r[e].length-3),a=i):i=r[e],"ret"===i&&(u=!0),o.push(i);return o[r.length]="_s",o[r.length+1]="_k",o[r.length+2]='if(typeof _s === "undefined") _s = numeric.dim('+a+');\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i'+(u?"":", ret = Array(_n)")+";\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) ret[i] = arguments.callee("+r.join(",")+",_s,_k+1);\n    return ret;\n}\n"+n+"\nfor(i=_n-1;i!==-1;--i) {\n    "+t+"\n}\nreturn ret;",Function.apply(null,o)},numeric.pointwise2=function(r,t,n){"undefined"==typeof n&&(n="");var e,i,o=[],s=/\[i\]$/,a="",u=!1;for(e=0;e<r.length;e++)s.test(r[e])?(i=r[e].substring(0,r[e].length-3),a=i):i=r[e],"ret"===i&&(u=!0),o.push(i);return o[r.length]="var _n = "+a+".length;\nvar i"+(u?"":", ret = Array(_n)")+";\n"+n+"\nfor(i=_n-1;i!==-1;--i) {\n"+t+"\n}\nreturn ret;",Function.apply(null,o)},numeric._biforeach=function t(r,n,e,i,o){if(i===e.length-1)return void o(r,n);var s,a=e[i];for(s=a-1;s>=0;s--)t("object"==typeof r?r[s]:r,"object"==typeof n?n[s]:n,e,i+1,o)},numeric._biforeach2=function n(r,t,e,i,o){if(i===e.length-1)return o(r,t);var s,a=e[i],u=Array(a);for(s=a-1;s>=0;--s)u[s]=n("object"==typeof r?r[s]:r,"object"==typeof t?t[s]:t,e,i+1,o);return u},numeric._foreach=function e(r,t,n,i){if(n===t.length-1)return void i(r);var o,s=t[n];for(o=s-1;o>=0;o--)e(r[o],t,n+1,i)},numeric._foreach2=function i(r,t,n,e){if(n===t.length-1)return e(r);var o,s=t[n],a=Array(s);for(o=s-1;o>=0;o--)a[o]=i(r[o],t,n+1,e);return a},numeric.ops2={add:"+",sub:"-",mul:"*",div:"/",mod:"%",and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">=",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"},numeric.opseq={addeq:"+=",subeq:"-=",muleq:"*=",diveq:"/=",modeq:"%=",lshifteq:"<<=",rshifteq:">>=",rrshifteq:">>>=",bandeq:"&=",boreq:"|=",bxoreq:"^="},numeric.mathfuns=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan","isNaN","isFinite"],numeric.mathfuns2=["atan2","pow","max","min"],numeric.ops1={neg:"-",not:"!",bnot:"~",clone:""},numeric.mapreducers={any:["if(xi) return true;","var accum = false;"],all:["if(!xi) return false;","var accum = true;"],sum:["accum += xi;","var accum = 0;"],prod:["accum *= xi;","var accum = 1;"],norm2Squared:["accum += xi*xi;","var accum = 0;"],norminf:["accum = max(accum,abs(xi));","var accum = 0, max = Math.max, abs = Math.abs;"],norm1:["accum += abs(xi)","var accum = 0, abs = Math.abs;"],sup:["accum = max(accum,xi);","var accum = -Infinity, max = Math.max;"],inf:["accum = min(accum,xi);","var accum = Infinity, min = Math.min;"]},function(){var r,t;for(r=0;r<numeric.mathfuns2.length;++r)t=numeric.mathfuns2[r],numeric.ops2[t]=t;for(r in numeric.ops2)if(numeric.ops2.hasOwnProperty(r)){t=numeric.ops2[r];var n,e,i="";-1!==numeric.myIndexOf.call(numeric.mathfuns2,r)?(i="var "+t+" = Math."+t+";\n",n=function(r,n,e){return r+" = "+t+"("+n+","+e+")"},e=function(r,n){return r+" = "+t+"("+r+","+n+")"}):(n=function(r,n,e){return r+" = "+n+" "+t+" "+e},e=numeric.opseq.hasOwnProperty(r+"eq")?function(r,n){return r+" "+t+"= "+n}:function(r,n){return r+" = "+r+" "+t+" "+n}),numeric[r+"VV"]=numeric.pointwise2(["x[i]","y[i]"],n("ret[i]","x[i]","y[i]"),i),numeric[r+"SV"]=numeric.pointwise2(["x","y[i]"],n("ret[i]","x","y[i]"),i),numeric[r+"VS"]=numeric.pointwise2(["x[i]","y"],n("ret[i]","x[i]","y"),i),numeric[r]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar VV = numeric."+r+"VV, VS = numeric."+r+"VS, SV = numeric."+r+'SV;\nvar dim = numeric.dim;\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof x === "object") {\n      if(typeof y === "object") x = numeric._biforeach2(x,y,dim(x),0,VV);\n      else x = numeric._biforeach2(x,y,dim(x),0,VS);\n  } else if(typeof y === "object") x = numeric._biforeach2(x,y,dim(y),0,SV);\n  else '+e("x","y")+"\n}\nreturn x;\n"),numeric[t]=numeric[r],numeric[r+"eqV"]=numeric.pointwise2(["ret[i]","x[i]"],e("ret[i]","x[i]"),i),numeric[r+"eqS"]=numeric.pointwise2(["ret[i]","x"],e("ret[i]","x"),i),numeric[r+"eq"]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar V = numeric."+r+"eqV, S = numeric."+r+'eqS\nvar s = numeric.dim(x);\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof y === "object") numeric._biforeach(x,y,s,0,V);\n  else numeric._biforeach(x,y,s,0,S);\n}\nreturn x;\n')}for(r=0;r<numeric.mathfuns2.length;++r)t=numeric.mathfuns2[r],delete numeric.ops2[t];for(r=0;r<numeric.mathfuns.length;++r)t=numeric.mathfuns[r],numeric.ops1[t]=t;for(r in numeric.ops1)numeric.ops1.hasOwnProperty(r)&&(i="",t=numeric.ops1[r],-1!==numeric.myIndexOf.call(numeric.mathfuns,r)&&Math.hasOwnProperty(t)&&(i="var "+t+" = Math."+t+";\n"),numeric[r+"eqV"]=numeric.pointwise2(["ret[i]"],"ret[i] = "+t+"(ret[i]);",i),numeric[r+"eq"]=Function("x",'if(typeof x !== "object") return '+t+"x\nvar i;\nvar V = numeric."+r+"eqV;\nvar s = numeric.dim(x);\nnumeric._foreach(x,s,0,V);\nreturn x;\n"),numeric[r+"V"]=numeric.pointwise2(["x[i]"],"ret[i] = "+t+"(x[i]);",i),numeric[r]=Function("x",'if(typeof x !== "object") return '+t+"(x)\nvar i;\nvar V = numeric."+r+"V;\nvar s = numeric.dim(x);\nreturn numeric._foreach2(x,s,0,V);\n"));for(r=0;r<numeric.mathfuns.length;++r)t=numeric.mathfuns[r],delete numeric.ops1[t];for(r in numeric.mapreducers)numeric.mapreducers.hasOwnProperty(r)&&(t=numeric.mapreducers[r],numeric[r+"V"]=numeric.mapreduce2(t[0],t[1]),numeric[r]=Function("x","s","k",t[1]+'if(typeof x !== "object") {    xi = x;\n'+t[0]+';\n    return accum;\n}if(typeof s === "undefined") s = numeric.dim(x);\nif(typeof k === "undefined") k = 0;\nif(k === s.length-1) return numeric.'+r+"V(x);\nvar xi;\nvar n = x.length, i;\nfor(i=n-1;i!==-1;--i) {\n   xi = arguments.callee(x[i]);\n"+t[0]+";\n}\nreturn accum;\n"))}(),numeric.truncVV=numeric.pointwise(["x[i]","y[i]"],"ret[i] = round(x[i]/y[i])*y[i];","var round = Math.round;"),numeric.truncVS=numeric.pointwise(["x[i]","y"],"ret[i] = round(x[i]/y)*y;","var round = Math.round;"),numeric.truncSV=numeric.pointwise(["x","y[i]"],"ret[i] = round(x/y[i])*y[i];","var round = Math.round;"),numeric.trunc=function(r,t){return"object"==typeof r?"object"==typeof t?numeric.truncVV(r,t):numeric.truncVS(r,t):"object"==typeof t?numeric.truncSV(r,t):Math.round(r/t)*t},numeric.inv=function(r){var t,n,e,i,o,s,a,r,u=numeric.dim(r),c=Math.abs,f=u[0],h=u[1],l=numeric.clone(r),m=numeric.identity(f);for(s=0;h>s;++s){var p=-1,d=-1;for(o=s;o!==f;++o)a=c(l[o][s]),a>d&&(p=o,d=a);for(n=l[p],l[p]=l[s],l[s]=n,i=m[p],m[p]=m[s],m[s]=i,r=n[s],a=s;a!==h;++a)n[a]/=r;for(a=h-1;-1!==a;--a)i[a]/=r;for(o=f-1;-1!==o;--o)if(o!==s){for(t=l[o],e=m[o],r=t[s],a=s+1;a!==h;++a)t[a]-=n[a]*r;for(a=h-1;a>0;--a)e[a]-=i[a]*r,--a,e[a]-=i[a]*r;0===a&&(e[0]-=i[0]*r)}}return m},numeric.det=function(r){var t=numeric.dim(r);if(2!==t.length||t[0]!==t[1])throw new Error("numeric: det() only works on square matrices");var n,e,i,o,s,a,u,c,f=t[0],h=1,l=numeric.clone(r);for(e=0;f-1>e;e++){for(i=e,n=e+1;f>n;n++)Math.abs(l[n][e])>Math.abs(l[i][e])&&(i=n);for(i!==e&&(u=l[i],l[i]=l[e],l[e]=u,h*=-1),o=l[e],n=e+1;f>n;n++){for(s=l[n],a=s[e]/o[e],i=e+1;f-1>i;i+=2)c=i+1,s[i]-=o[i]*a,s[c]-=o[c]*a;i!==f&&(s[i]-=o[i]*a)}if(0===o[e])return 0;h*=o[e]}return h*l[e][e]},numeric.transpose=function(r){var t,n,e,i,o,s=r.length,a=r[0].length,u=Array(a);for(n=0;a>n;n++)u[n]=Array(s);for(t=s-1;t>=1;t-=2){for(i=r[t],e=r[t-1],n=a-1;n>=1;--n)o=u[n],o[t]=i[n],o[t-1]=e[n],--n,o=u[n],o[t]=i[n],o[t-1]=e[n];0===n&&(o=u[0],o[t]=i[0],o[t-1]=e[0])}if(0===t){for(e=r[0],n=a-1;n>=1;--n)u[n][0]=e[n],--n,u[n][0]=e[n];0===n&&(u[0][0]=e[0])}return u},numeric.negtranspose=function(r){var t,n,e,i,o,s=r.length,a=r[0].length,u=Array(a);for(n=0;a>n;n++)u[n]=Array(s);for(t=s-1;t>=1;t-=2){for(i=r[t],e=r[t-1],n=a-1;n>=1;--n)o=u[n],o[t]=-i[n],o[t-1]=-e[n],--n,o=u[n],o[t]=-i[n],o[t-1]=-e[n];0===n&&(o=u[0],o[t]=-i[0],o[t-1]=-e[0])}if(0===t){for(e=r[0],n=a-1;n>=1;--n)u[n][0]=-e[n],--n,u[n][0]=-e[n];0===n&&(u[0][0]=-e[0])}return u},numeric._random=function o(r,t){var n,e,i=r[t],s=Array(i);if(t===r.length-1){for(e=Math.random,n=i-1;n>=1;n-=2)s[n]=e(),s[n-1]=e();return 0===n&&(s[0]=e()),s}for(n=i-1;n>=0;n--)s[n]=o(r,t+1);return s},numeric.random=function(r){return numeric._random(r,0)},numeric.norm2=function(r){return Math.sqrt(numeric.norm2Squared(r))},numeric.linspace=function(r,t,n){if("undefined"==typeof n&&(n=Math.max(Math.round(t-r)+1,1)),2>n)return 1===n?[r]:[];var e,i=Array(n);for(n--,e=n;e>=0;e--)i[e]=(e*t+(n-e)*r)/n;return i},numeric.getBlock=function(r,t,n){function e(r,o){var s,a=t[o],u=n[o]-a,c=Array(u);if(o===i.length-1){for(s=u;s>=0;s--)c[s]=r[s+a];return c}for(s=u;s>=0;s--)c[s]=e(r[s+a],o+1);return c}var i=numeric.dim(r);return e(r,0)},numeric.setBlock=function(r,t,n,e){function i(r,e,s){var a,u=t[s],c=n[s]-u;if(s===o.length-1)for(a=c;a>=0;a--)r[a+u]=e[a];for(a=c;a>=0;a--)i(r[a+u],e[a],s+1)}var o=numeric.dim(r);return i(r,e,0),r},numeric.getRange=function(r,t,n){var e,i,o,s,a=t.length,u=n.length,c=Array(a);for(e=a-1;-1!==e;--e)for(c[e]=Array(u),o=c[e],s=r[t[e]],i=u-1;-1!==i;--i)o[i]=s[n[i]];return c},numeric.blockMatrix=function(r){var t=numeric.dim(r);if(t.length<4)return numeric.blockMatrix([r]);var n,e,i,o,s,a=t[0],u=t[1];for(n=0,e=0,i=0;a>i;++i)n+=r[i][0].length;for(o=0;u>o;++o)e+=r[0][o][0].length;var c=Array(n);for(i=0;n>i;++i)c[i]=Array(e);var f,h,l,m,p,d=0;for(i=0;a>i;++i){for(f=e,o=u-1;-1!==o;--o)for(s=r[i][o],f-=s[0].length,l=s.length-1;-1!==l;--l)for(p=s[l],h=c[d+l],m=p.length-1;-1!==m;--m)h[f+m]=p[m];d+=r[i][0].length}return c},numeric.tensor=function(r,t){if("number"==typeof r||"number"==typeof t)return numeric.mul(r,t);var n=numeric.dim(r),e=numeric.dim(t);if(1!==n.length||1!==e.length)throw new Error("numeric: tensor product is only defined for vectors");var i,o,s,a,u=n[0],c=e[0],f=Array(u);for(o=u-1;o>=0;o--){for(i=Array(c),a=r[o],s=c-1;s>=3;--s)i[s]=a*t[s],--s,i[s]=a*t[s],--s,i[s]=a*t[s],--s,i[s]=a*t[s];for(;s>=0;)i[s]=a*t[s],--s;f[o]=i}return f},numeric.T=function(r,t){this.x=r,this.y=t},numeric.t=function(r,t){return new numeric.T(r,t)},numeric.Tbinop=function(r,t,n,e,i){numeric.indexOf;if("string"!=typeof i){var o;i="";for(o in numeric)numeric.hasOwnProperty(o)&&(r.indexOf(o)>=0||t.indexOf(o)>=0||n.indexOf(o)>=0||e.indexOf(o)>=0)&&o.length>1&&(i+="var "+o+" = numeric."+o+";\n")}return Function(["y"],"var x = this;\nif(!(y instanceof numeric.T)) { y = new numeric.T(y); }\n"+i+"\nif(x.y) {  if(y.y) {    return new numeric.T("+e+");\n  }\n  return new numeric.T("+n+");\n}\nif(y.y) {\n  return new numeric.T("+t+");\n}\nreturn new numeric.T("+r+");\n")},numeric.T.prototype.add=numeric.Tbinop("add(x.x,y.x)","add(x.x,y.x),y.y","add(x.x,y.x),x.y","add(x.x,y.x),add(x.y,y.y)"),numeric.T.prototype.sub=numeric.Tbinop("sub(x.x,y.x)","sub(x.x,y.x),neg(y.y)","sub(x.x,y.x),x.y","sub(x.x,y.x),sub(x.y,y.y)"),numeric.T.prototype.mul=numeric.Tbinop("mul(x.x,y.x)","mul(x.x,y.x),mul(x.x,y.y)","mul(x.x,y.x),mul(x.y,y.x)","sub(mul(x.x,y.x),mul(x.y,y.y)),add(mul(x.x,y.y),mul(x.y,y.x))"),numeric.T.prototype.reciprocal=function(){var r=numeric.mul,t=numeric.div;if(this.y){var n=numeric.add(r(this.x,this.x),r(this.y,this.y));return new numeric.T(t(this.x,n),t(numeric.neg(this.y),n))}return new T(t(1,this.x))},numeric.T.prototype.div=function s(r){if(r instanceof numeric.T||(r=new numeric.T(r)),r.y)return this.mul(r.reciprocal());var s=numeric.div;return this.y?new numeric.T(s(this.x,r.x),s(this.y,r.x)):new numeric.T(s(this.x,r.x))},numeric.T.prototype.dot=numeric.Tbinop("dot(x.x,y.x)","dot(x.x,y.x),dot(x.x,y.y)","dot(x.x,y.x),dot(x.y,y.x)","sub(dot(x.x,y.x),dot(x.y,y.y)),add(dot(x.x,y.y),dot(x.y,y.x))"),numeric.T.prototype.transpose=function(){var r=numeric.transpose,t=this.x,n=this.y;return n?new numeric.T(r(t),r(n)):new numeric.T(r(t))},numeric.T.prototype.transjugate=function(){var r=numeric.transpose,t=this.x,n=this.y;return n?new numeric.T(r(t),numeric.negtranspose(n)):new numeric.T(r(t))},numeric.Tunop=function(r,t,n){return"string"!=typeof n&&(n=""),Function("var x = this;\n"+n+"\nif(x.y) {  "+t+";\n}\n"+r+";\n")},numeric.T.prototype.exp=numeric.Tunop("return new numeric.T(ex)","return new numeric.T(mul(cos(x.y),ex),mul(sin(x.y),ex))","var ex = numeric.exp(x.x), cos = numeric.cos, sin = numeric.sin, mul = numeric.mul;"),numeric.T.prototype.conj=numeric.Tunop("return new numeric.T(x.x);","return new numeric.T(x.x,numeric.neg(x.y));"),numeric.T.prototype.neg=numeric.Tunop("return new numeric.T(neg(x.x));","return new numeric.T(neg(x.x),neg(x.y));","var neg = numeric.neg;"),numeric.T.prototype.sin=numeric.Tunop("return new numeric.T(numeric.sin(x.x))","return x.exp().sub(x.neg().exp()).div(new numeric.T(0,2));"),numeric.T.prototype.cos=numeric.Tunop("return new numeric.T(numeric.cos(x.x))","return x.exp().add(x.neg().exp()).div(2);"),numeric.T.prototype.abs=numeric.Tunop("return new numeric.T(numeric.abs(x.x));","return new numeric.T(numeric.sqrt(numeric.add(mul(x.x,x.x),mul(x.y,x.y))));","var mul = numeric.mul;"),numeric.T.prototype.log=numeric.Tunop("return new numeric.T(numeric.log(x.x));","var theta = new numeric.T(numeric.atan2(x.y,x.x)), r = x.abs();\nreturn new numeric.T(numeric.log(r.x),theta.x);"),numeric.T.prototype.norm2=numeric.Tunop("return numeric.norm2(x.x);","var f = numeric.norm2Squared;\nreturn Math.sqrt(f(x.x)+f(x.y));"),numeric.T.prototype.inv=function(){var r=this;if("undefined"==typeof r.y)return new numeric.T(numeric.inv(r.x));var t,n,e,i,o,s,a,u,c,f,h,t,n,e,l,m,p,d,g,v,y,w=r.x.length,x=numeric.identity(w),b=numeric.rep([w,w],0),M=numeric.clone(r.x),k=numeric.clone(r.y);for(t=0;w>t;t++){for(p=M[t][t],d=k[t][t],l=p*p+d*d,e=t,n=t+1;w>n;n++)p=M[n][t],d=k[n][t],m=p*p+d*d,m>l&&(e=n,l=m);for(e!==t&&(y=M[t],M[t]=M[e],M[e]=y,y=k[t],k[t]=k[e],k[e]=y,y=x[t],x[t]=x[e],x[e]=y,y=b[t],b[t]=b[e],b[e]=y),i=M[t],o=k[t],u=x[t],c=b[t],p=i[t],d=o[t],n=t+1;w>n;n++)g=i[n],v=o[n],i[n]=(g*p+v*d)/l,o[n]=(v*p-g*d)/l;for(n=0;w>n;n++)g=u[n],v=c[n],u[n]=(g*p+v*d)/l,c[n]=(v*p-g*d)/l;for(n=t+1;w>n;n++){for(s=M[n],a=k[n],f=x[n],h=b[n],p=s[t],d=a[t],e=t+1;w>e;e++)g=i[e],v=o[e],s[e]-=g*p-v*d,a[e]-=v*p+g*d;for(e=0;w>e;e++)g=u[e],v=c[e],f[e]-=g*p-v*d,h[e]-=v*p+g*d}}for(t=w-1;t>0;t--)for(u=x[t],c=b[t],n=t-1;n>=0;n--)for(f=x[n],h=b[n],p=M[n][t],d=k[n][t],e=w-1;e>=0;e--)g=u[e],v=c[e],f[e]-=p*g-d*v,h[e]-=p*v+d*g;return new numeric.T(x,b)},numeric.T.prototype.get=function(r){var t,n=this.x,e=this.y,i=0,o=r.length;if(e){for(;o>i;)t=r[i],n=n[t],e=e[t],i++;return new numeric.T(n,e)}for(;o>i;)t=r[i],n=n[t],i++;return new numeric.T(n)},numeric.T.prototype.set=function(r,t){var n,e=this.x,i=this.y,o=0,s=r.length,a=t.x,u=t.y;if(0===s)return u?this.y=u:i&&(this.y=void 0),this.x=e,this;if(u){for(i||(i=numeric.rep(numeric.dim(e),0),this.y=i);s-1>o;)n=r[o],e=e[n],i=i[n],o++;return n=r[o],e[n]=a,i[n]=u,this}if(i){for(;s-1>o;)n=r[o],e=e[n],i=i[n],o++;return n=r[o],e[n]=a,i[n]=a instanceof Array?numeric.rep(numeric.dim(a),0):0,this}for(;s-1>o;)n=r[o],e=e[n],o++;return n=r[o],e[n]=a,this},numeric.T.prototype.getRows=function(r,t){var n,e,i=t-r+1,o=Array(i),s=this.x,a=this.y;for(n=r;t>=n;n++)o[n-r]=s[n];if(a){for(e=Array(i),n=r;t>=n;n++)e[n-r]=a[n];return new numeric.T(o,e)}return new numeric.T(o)},numeric.T.prototype.setRows=function(r,t,n){var e,i=this.x,o=this.y,s=n.x,a=n.y;for(e=r;t>=e;e++)i[e]=s[e-r];if(a)for(o||(o=numeric.rep(numeric.dim(i),0),this.y=o),e=r;t>=e;e++)o[e]=a[e-r];else if(o)for(e=r;t>=e;e++)o[e]=numeric.rep([s[e-r].length],0);return this},numeric.T.prototype.getRow=function(r){var t=this.x,n=this.y;return n?new numeric.T(t[r],n[r]):new numeric.T(t[r])},numeric.T.prototype.setRow=function(r,t){var n=this.x,e=this.y,i=t.x,o=t.y;return n[r]=i,o?(e||(e=numeric.rep(numeric.dim(n),0),this.y=e),e[r]=o):e&&(e=numeric.rep([i.length],0)),this},numeric.T.prototype.getBlock=function(r,t){var n=this.x,e=this.y,i=numeric.getBlock;return e?new numeric.T(i(n,r,t),i(e,r,t)):new numeric.T(i(n,r,t))},numeric.T.prototype.setBlock=function(r,t,n){n instanceof numeric.T||(n=new numeric.T(n));var e=this.x,i=this.y,o=numeric.setBlock,s=n.x,a=n.y;
return a?(i||(this.y=numeric.rep(numeric.dim(this),0),i=this.y),o(e,r,t,s),o(i,r,t,a),this):(o(e,r,t,s),void(i&&o(i,r,t,numeric.rep(numeric.dim(s),0))))},numeric.T.rep=function(r,t){var n=numeric.T;t instanceof n||(t=new n(t));var e=t.x,i=t.y,o=numeric.rep;return i?new n(o(r,e),o(r,i)):new n(o(r,e))},numeric.T.diag=function a(r){r instanceof numeric.T||(r=new numeric.T(r));var t=r.x,n=r.y,a=numeric.diag;return n?new numeric.T(a(t),a(n)):new numeric.T(a(t))},numeric.T.eig=function(){if(this.y)throw new Error("eig: not implemented for complex matrices.");return numeric.eig(this.x)},numeric.T.identity=function(r){return new numeric.T(numeric.identity(r))},numeric.T.prototype.getDiag=function(){var r=numeric,t=this.x,n=this.y;return n?new r.T(r.getDiag(t),r.getDiag(n)):new r.T(r.getDiag(t))},numeric.house=function(r){var t=numeric.clone(r),n=r[0]>=0?1:-1,e=n*numeric.norm2(r);t[0]+=e;var i=numeric.norm2(t);if(0===i)throw new Error("eig: internal error");return numeric.div(t,i)},numeric.toUpperHessenberg=function(r){var t=numeric.dim(r);if(2!==t.length||t[0]!==t[1])throw new Error("numeric: toUpperHessenberg() only works on square matrices");var n,e,i,o,s,a,u,c,f,h,l=t[0],m=numeric.clone(r),p=numeric.identity(l);for(e=0;l-2>e;e++){for(o=Array(l-e-1),n=e+1;l>n;n++)o[n-e-1]=m[n][e];if(numeric.norm2(o)>0){for(s=numeric.house(o),a=numeric.getBlock(m,[e+1,e],[l-1,l-1]),u=numeric.tensor(s,numeric.dot(s,a)),n=e+1;l>n;n++)for(c=m[n],f=u[n-e-1],i=e;l>i;i++)c[i]-=2*f[i-e];for(a=numeric.getBlock(m,[0,e+1],[l-1,l-1]),u=numeric.tensor(numeric.dot(a,s),s),n=0;l>n;n++)for(c=m[n],f=u[n],i=e+1;l>i;i++)c[i]-=2*f[i-e-1];for(a=Array(l-e-1),n=e+1;l>n;n++)a[n-e-1]=p[n];for(u=numeric.tensor(s,numeric.dot(s,a)),n=e+1;l>n;n++)for(h=p[n],f=u[n-e-1],i=0;l>i;i++)h[i]-=2*f[i]}}return{H:m,Q:p}},numeric.epsilon=2.220446049250313e-16,numeric.QRFrancis=function(r,t){"undefined"==typeof t&&(t=1e4),r=numeric.clone(r);var n,e,i,o,s,a,u,c,f,h,l,m,p,d,g,v,y,w,x=(numeric.clone(r),numeric.dim(r)),b=x[0],M=numeric.identity(b);if(3>b)return{Q:M,B:[[0,b-1]]};var k=numeric.epsilon;for(w=0;t>w;w++){for(v=0;b-1>v;v++)if(Math.abs(r[v+1][v])<k*(Math.abs(r[v][v])+Math.abs(r[v+1][v+1]))){var A=numeric.QRFrancis(numeric.getBlock(r,[0,0],[v,v]),t),S=numeric.QRFrancis(numeric.getBlock(r,[v+1,v+1],[b-1,b-1]),t);for(m=Array(v+1),g=0;v>=g;g++)m[g]=M[g];for(p=numeric.dot(A.Q,m),g=0;v>=g;g++)M[g]=p[g];for(m=Array(b-v-1),g=v+1;b>g;g++)m[g-v-1]=M[g];for(p=numeric.dot(S.Q,m),g=v+1;b>g;g++)M[g]=p[g-v-1];return{Q:M,B:A.B.concat(numeric.add(S.B,v+1))}}if(i=r[b-2][b-2],o=r[b-2][b-1],s=r[b-1][b-2],a=r[b-1][b-1],c=i+a,u=i*a-o*s,f=numeric.getBlock(r,[0,0],[2,2]),c*c>=4*u){var j,R;j=.5*(c+Math.sqrt(c*c-4*u)),R=.5*(c-Math.sqrt(c*c-4*u)),f=numeric.add(numeric.sub(numeric.dot(f,f),numeric.mul(f,j+R)),numeric.diag(numeric.rep([3],j*R)))}else f=numeric.add(numeric.sub(numeric.dot(f,f),numeric.mul(f,c)),numeric.diag(numeric.rep([3],u)));for(n=[f[0][0],f[1][0],f[2][0]],e=numeric.house(n),m=[r[0],r[1],r[2]],p=numeric.tensor(e,numeric.dot(e,m)),g=0;3>g;g++)for(l=r[g],d=p[g],y=0;b>y;y++)l[y]-=2*d[y];for(m=numeric.getBlock(r,[0,0],[b-1,2]),p=numeric.tensor(numeric.dot(m,e),e),g=0;b>g;g++)for(l=r[g],d=p[g],y=0;3>y;y++)l[y]-=2*d[y];for(m=[M[0],M[1],M[2]],p=numeric.tensor(e,numeric.dot(e,m)),g=0;3>g;g++)for(h=M[g],d=p[g],y=0;b>y;y++)h[y]-=2*d[y];var T;for(v=0;b-2>v;v++){for(y=v;v+1>=y;y++)if(Math.abs(r[y+1][y])<k*(Math.abs(r[y][y])+Math.abs(r[y+1][y+1]))){var A=numeric.QRFrancis(numeric.getBlock(r,[0,0],[y,y]),t),S=numeric.QRFrancis(numeric.getBlock(r,[y+1,y+1],[b-1,b-1]),t);for(m=Array(y+1),g=0;y>=g;g++)m[g]=M[g];for(p=numeric.dot(A.Q,m),g=0;y>=g;g++)M[g]=p[g];for(m=Array(b-y-1),g=y+1;b>g;g++)m[g-y-1]=M[g];for(p=numeric.dot(S.Q,m),g=y+1;b>g;g++)M[g]=p[g-y-1];return{Q:M,B:A.B.concat(numeric.add(S.B,y+1))}}for(T=Math.min(b-1,v+3),n=Array(T-v),g=v+1;T>=g;g++)n[g-v-1]=r[g][v];for(e=numeric.house(n),m=numeric.getBlock(r,[v+1,v],[T,b-1]),p=numeric.tensor(e,numeric.dot(e,m)),g=v+1;T>=g;g++)for(l=r[g],d=p[g-v-1],y=v;b>y;y++)l[y]-=2*d[y-v];for(m=numeric.getBlock(r,[0,v+1],[b-1,T]),p=numeric.tensor(numeric.dot(m,e),e),g=0;b>g;g++)for(l=r[g],d=p[g],y=v+1;T>=y;y++)l[y]-=2*d[y-v-1];for(m=Array(T-v),g=v+1;T>=g;g++)m[g-v-1]=M[g];for(p=numeric.tensor(e,numeric.dot(e,m)),g=v+1;T>=g;g++)for(h=M[g],d=p[g-v-1],y=0;b>y;y++)h[y]-=2*d[y]}}throw new Error("numeric: eigenvalue iteration does not converge -- increase maxiter?")},numeric.eig=function(r,t){var n,e,i,o,s,a,u,c,f,h,l,m,p,d,g,v,y,w=numeric.toUpperHessenberg(r),x=numeric.QRFrancis(w.H,t),b=numeric.T,M=r.length,k=x.B,A=numeric.dot(x.Q,numeric.dot(w.H,numeric.transpose(x.Q))),S=new b(numeric.dot(x.Q,w.Q)),j=k.length,R=Math.sqrt;for(e=0;j>e;e++)if(n=k[e][0],n===k[e][1]);else{if(o=n+1,s=A[n][n],a=A[n][o],u=A[o][n],c=A[o][o],0===a&&0===u)continue;f=-s-c,h=s*c-a*u,l=f*f-4*h,l>=0?(m=0>f?-.5*(f-R(l)):-.5*(f+R(l)),v=(s-m)*(s-m)+a*a,y=u*u+(c-m)*(c-m),v>y?(v=R(v),d=(s-m)/v,g=a/v):(y=R(y),d=u/y,g=(c-m)/y),i=new b([[g,-d],[d,g]]),S.setRows(n,o,i.dot(S.getRows(n,o)))):(m=-.5*f,p=.5*R(-l),v=(s-m)*(s-m)+a*a,y=u*u+(c-m)*(c-m),v>y?(v=R(v+p*p),d=(s-m)/v,g=a/v,m=0,p/=v):(y=R(y+p*p),d=u/y,g=(c-m)/y,m=p/y,p=0),i=new b([[g,-d],[d,g]],[[m,p],[p,-m]]),S.setRows(n,o,i.dot(S.getRows(n,o))))}var T=S.dot(r).dot(S.transjugate()),M=r.length,V=numeric.T.identity(M);for(o=0;M>o;o++)if(o>0)for(e=o-1;e>=0;e--){var z=T.get([e,e]),q=T.get([o,o]);numeric.neq(z.x,q.x)||numeric.neq(z.y,q.y)?(m=T.getRow(e).getBlock([e],[o-1]),p=V.getRow(o).getBlock([e],[o-1]),V.set([o,e],T.get([e,o]).neg().sub(m.dot(p)).div(z.sub(q)))):V.setRow(o,V.getRow(e))}for(o=0;M>o;o++)m=V.getRow(o),V.setRow(o,m.div(m.norm2()));return V=V.transpose(),V=S.transjugate().dot(V),{lambda:T.getDiag(),E:V}},numeric.ccsSparse=function(r){var t,n,e,i,o=r.length,s=[];for(e=o-1;-1!==e;--e){n=r[e];for(i in n){for(i=parseInt(i);i>=s.length;)s[s.length]=0;0!==n[i]&&s[i]++}}var t=s.length,a=Array(t+1);for(a[0]=0,e=0;t>e;++e)a[e+1]=a[e]+s[e];var u=Array(a[t]),c=Array(a[t]);for(e=o-1;-1!==e;--e){n=r[e];for(i in n)0!==n[i]&&(s[i]--,u[a[i]+s[i]]=e,c[a[i]+s[i]]=n[i])}return[a,u,c]},numeric.ccsFull=function(r){var t,n,e,i,o=r[0],s=r[1],a=r[2],u=numeric.ccsDim(r),c=u[0],f=u[1],h=numeric.rep([c,f],0);for(t=0;f>t;t++)for(e=o[t],i=o[t+1],n=e;i>n;++n)h[s[n]][t]=a[n];return h},numeric.ccsTSolve=function(r,t,n,e,i){function o(r){var t;if(0===n[r]){for(n[r]=1,t=s[r];t<s[r+1];++t)o(a[t]);i[h]=r,++h}}var s=r[0],a=r[1],u=r[2],c=s.length-1,f=Math.max,h=0;"undefined"==typeof e&&(n=numeric.rep([c],0)),"undefined"==typeof e&&(e=numeric.linspace(0,n.length-1)),"undefined"==typeof i&&(i=[]);var l,m,p,d,g,v,y;for(l=e.length-1;-1!==l;--l)o(e[l]);for(i.length=h,l=i.length-1;-1!==l;--l)n[i[l]]=0;for(l=e.length-1;-1!==l;--l)m=e[l],n[m]=t[m];for(l=i.length-1;-1!==l;--l){for(m=i[l],p=s[m],d=f(s[m+1],p),g=p;g!==d;++g)if(a[g]===m){n[m]/=u[g];break}for(y=n[m],g=p;g!==d;++g)v=a[g],v!==m&&(n[v]-=y*u[g])}return n},numeric.ccsDFS=function(r){this.k=Array(r),this.k1=Array(r),this.j=Array(r)},numeric.ccsDFS.prototype.dfs=function(r,t,n,e,i,o){var s,a,u,c=0,f=i.length,h=this.k,l=this.k1,m=this.j;if(0===e[r])for(e[r]=1,m[0]=r,h[0]=a=t[r],l[0]=u=t[r+1];;)if(a>=u){if(i[f]=m[c],0===c)return;++f,--c,a=h[c],u=l[c]}else s=o[n[a]],0===e[s]?(e[s]=1,h[c]=a,++c,m[c]=s,a=t[s],l[c]=u=t[s+1]):++a},numeric.ccsLPSolve=function(r,t,n,e,i,o,s){var a,u,c,f,h,l,m,p,d,g=r[0],v=r[1],y=r[2],w=(g.length-1,t[0]),x=t[1],b=t[2];for(u=w[i],c=w[i+1],e.length=0,a=u;c>a;++a)s.dfs(o[x[a]],g,v,n,e,o);for(a=e.length-1;-1!==a;--a)n[e[a]]=0;for(a=u;a!==c;++a)f=o[x[a]],n[f]=b[a];for(a=e.length-1;-1!==a;--a){for(f=e[a],h=g[f],l=g[f+1],m=h;l>m;++m)if(o[v[m]]===f){n[f]/=y[m];break}for(d=n[f],m=h;l>m;++m)p=o[v[m]],p!==f&&(n[p]-=d*y[m])}return n},numeric.ccsLUP1=function(r,t){var n,e,i,o,s,a,u,c=r[0].length-1,f=[numeric.rep([c+1],0),[],[]],h=[numeric.rep([c+1],0),[],[]],l=f[0],m=f[1],p=f[2],d=h[0],g=h[1],v=h[2],y=numeric.rep([c],0),w=numeric.rep([c],0),x=numeric.ccsLPSolve,b=(Math.max,Math.abs),M=numeric.linspace(0,c-1),k=numeric.linspace(0,c-1),A=new numeric.ccsDFS(c);for("undefined"==typeof t&&(t=1),n=0;c>n;++n){for(x(f,r,y,w,n,k,A),o=-1,s=-1,e=w.length-1;-1!==e;--e)i=w[e],n>=i||(a=b(y[i]),a>o&&(s=i,o=a));for(b(y[n])<t*o&&(e=M[n],o=M[s],M[n]=o,k[o]=n,M[s]=e,k[e]=s,o=y[n],y[n]=y[s],y[s]=o),o=l[n],s=d[n],u=y[n],m[o]=M[n],p[o]=1,++o,e=w.length-1;-1!==e;--e)i=w[e],a=y[i],w[e]=0,y[i]=0,n>=i?(g[s]=i,v[s]=a,++s):(m[o]=M[i],p[o]=a/u,++o);l[n+1]=o,d[n+1]=s}for(e=m.length-1;-1!==e;--e)m[e]=k[m[e]];return{L:f,U:h,P:M,Pinv:k}},numeric.ccsDFS0=function(r){this.k=Array(r),this.k1=Array(r),this.j=Array(r)},numeric.ccsDFS0.prototype.dfs=function(r,t,n,e,i,o){var s,a,u,c=0,f=i.length,h=this.k,l=this.k1,m=this.j;if(0===e[r])for(e[r]=1,m[0]=r,h[0]=a=t[o[r]],l[0]=u=t[o[r]+1];;){if(isNaN(a))throw new Error("Ow!");if(a>=u){if(i[f]=o[m[c]],0===c)return;++f,--c,a=h[c],u=l[c]}else s=n[a],0===e[s]?(e[s]=1,h[c]=a,++c,m[c]=s,s=o[s],a=t[s],l[c]=u=t[s+1]):++a}},numeric.ccsLPSolve0=function(r,t,n,e,i,o,s,a){var u,c,f,h,l,m,p,d,g,v=r[0],y=r[1],w=r[2],x=(v.length-1,t[0]),b=t[1],M=t[2];for(c=x[i],f=x[i+1],e.length=0,u=c;f>u;++u)a.dfs(b[u],v,y,n,e,o,s);for(u=e.length-1;-1!==u;--u)h=e[u],n[s[h]]=0;for(u=c;u!==f;++u)h=b[u],n[h]=M[u];for(u=e.length-1;-1!==u;--u){for(h=e[u],d=s[h],l=v[h],m=v[h+1],p=l;m>p;++p)if(y[p]===d){n[d]/=w[p];break}for(g=n[d],p=l;m>p;++p)n[y[p]]-=g*w[p];n[d]=g}},numeric.ccsLUP0=function(r,t){var n,e,i,o,s,a,u,c=r[0].length-1,f=[numeric.rep([c+1],0),[],[]],h=[numeric.rep([c+1],0),[],[]],l=f[0],m=f[1],p=f[2],d=h[0],g=h[1],v=h[2],y=numeric.rep([c],0),w=numeric.rep([c],0),x=numeric.ccsLPSolve0,b=(Math.max,Math.abs),M=numeric.linspace(0,c-1),k=numeric.linspace(0,c-1),A=new numeric.ccsDFS0(c);for("undefined"==typeof t&&(t=1),n=0;c>n;++n){for(x(f,r,y,w,n,k,M,A),o=-1,s=-1,e=w.length-1;-1!==e;--e)i=w[e],n>=i||(a=b(y[M[i]]),a>o&&(s=i,o=a));for(b(y[M[n]])<t*o&&(e=M[n],o=M[s],M[n]=o,k[o]=n,M[s]=e,k[e]=s),o=l[n],s=d[n],u=y[M[n]],m[o]=M[n],p[o]=1,++o,e=w.length-1;-1!==e;--e)i=w[e],a=y[M[i]],w[e]=0,y[M[i]]=0,n>=i?(g[s]=i,v[s]=a,++s):(m[o]=M[i],p[o]=a/u,++o);l[n+1]=o,d[n+1]=s}for(e=m.length-1;-1!==e;--e)m[e]=k[m[e]];return{L:f,U:h,P:M,Pinv:k}},numeric.ccsLUP=numeric.ccsLUP0,numeric.ccsDim=function(r){return[numeric.sup(r[1])+1,r[0].length-1]},numeric.ccsGetBlock=function(r,t,n){var e=numeric.ccsDim(r),i=e[0],o=e[1];"undefined"==typeof t?t=numeric.linspace(0,i-1):"number"==typeof t&&(t=[t]),"undefined"==typeof n?n=numeric.linspace(0,o-1):"number"==typeof n&&(n=[n]);var s,a,u,c,f,h=t.length,l=n.length,m=numeric.rep([o],0),p=[],d=[],g=[m,p,d],v=r[0],y=r[1],w=r[2],x=numeric.rep([i],0),b=0,M=numeric.rep([i],0);for(a=0;l>a;++a){c=n[a];var k=v[c],A=v[c+1];for(s=k;A>s;++s)u=y[s],M[u]=1,x[u]=w[s];for(s=0;h>s;++s)f=t[s],M[f]&&(p[b]=s,d[b]=x[t[s]],++b);for(s=k;A>s;++s)u=y[s],M[u]=0;m[a+1]=b}return g},numeric.ccsDot=function(r,t){var n,e,i,o,s,a,u,c,f,h,l,m=r[0],p=r[1],d=r[2],g=t[0],v=t[1],y=t[2],w=numeric.ccsDim(r),x=numeric.ccsDim(t),b=w[0],M=(w[1],x[1]),k=numeric.rep([b],0),A=numeric.rep([b],0),S=Array(b),j=numeric.rep([M],0),R=[],T=[],V=[j,R,T];for(i=0;i!==M;++i){for(o=g[i],s=g[i+1],f=0,e=o;s>e;++e)for(h=v[e],l=y[e],a=m[h],u=m[h+1],n=a;u>n;++n)c=p[n],0===A[c]&&(S[f]=c,A[c]=1,f+=1),k[c]=k[c]+d[n]*l;for(o=j[i],s=o+f,j[i+1]=s,e=f-1;-1!==e;--e)l=o+e,n=S[e],R[l]=n,T[l]=k[n],A[n]=0,k[n]=0;j[i+1]=j[i]+f}return V},numeric.ccsLUPSolve=function(r,t){var n=r.L,e=r.U,i=(r.P,t[0]),o=!1;"object"!=typeof i&&(t=[[0,t.length],numeric.linspace(0,t.length-1),t],i=t[0],o=!0);var s,a,u,c,f,h,l=t[1],m=t[2],p=n[0].length-1,d=i.length-1,g=numeric.rep([p],0),v=Array(p),y=numeric.rep([p],0),w=Array(p),x=numeric.rep([d+1],0),b=[],M=[],k=numeric.ccsTSolve,A=0;for(s=0;d>s;++s){for(f=0,u=i[s],c=i[s+1],a=u;c>a;++a)h=r.Pinv[l[a]],w[f]=h,y[h]=m[a],++f;for(w.length=f,k(n,y,g,w,v),a=w.length-1;-1!==a;--a)y[w[a]]=0;if(k(e,g,y,v,w),o)return y;for(a=v.length-1;-1!==a;--a)g[v[a]]=0;for(a=w.length-1;-1!==a;--a)h=w[a],b[A]=h,M[A]=y[h],y[h]=0,++A;x[s+1]=A}return[x,b,M]},numeric.ccsbinop=function(r,t){return"undefined"==typeof t&&(t=""),Function("X","Y","var Xi = X[0], Xj = X[1], Xv = X[2];\nvar Yi = Y[0], Yj = Y[1], Yv = Y[2];\nvar n = Xi.length-1,m = Math.max(numeric.sup(Xj),numeric.sup(Yj))+1;\nvar Zi = numeric.rep([n+1],0), Zj = [], Zv = [];\nvar x = numeric.rep([m],0),y = numeric.rep([m],0);\nvar xk,yk,zk;\nvar i,j,j0,j1,k,p=0;\n"+t+"for(i=0;i<n;++i) {\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Xj[j];\n    x[k] = 1;\n    Zj[p] = k;\n    ++p;\n  }\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Yj[j];\n    y[k] = Yv[j];\n    if(x[k] === 0) {\n      Zj[p] = k;\n      ++p;\n    }\n  }\n  Zi[i+1] = p;\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = Xv[j];\n  j0 = Zi[i]; j1 = Zi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Zj[j];\n    xk = x[k];\n    yk = y[k];\n"+r+"\n    Zv[j] = zk;\n  }\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = 0;\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) y[Yj[j]] = 0;\n}\nreturn [Zi,Zj,Zv];")},function(){var k,A,B,C;for(k in numeric.ops2)A=isFinite(eval("1"+numeric.ops2[k]+"0"))?"[Y[0],Y[1],numeric."+k+"(X,Y[2])]":"NaN",B=isFinite(eval("0"+numeric.ops2[k]+"1"))?"[X[0],X[1],numeric."+k+"(X[2],Y)]":"NaN",C=isFinite(eval("1"+numeric.ops2[k]+"0"))&&isFinite(eval("0"+numeric.ops2[k]+"1"))?"numeric.ccs"+k+"MM(X,Y)":"NaN",numeric["ccs"+k+"MM"]=numeric.ccsbinop("zk = xk "+numeric.ops2[k]+"yk;"),numeric["ccs"+k]=Function("X","Y",'if(typeof X === "number") return '+A+';\nif(typeof Y === "number") return '+B+";\nreturn "+C+";\n")}(),numeric.ccsScatter=function(r){var t,n=r[0],e=r[1],i=r[2],o=numeric.sup(e)+1,s=n.length,a=numeric.rep([o],0),u=Array(s),c=Array(s),f=numeric.rep([o],0);for(t=0;s>t;++t)f[e[t]]++;for(t=0;o>t;++t)a[t+1]=a[t]+f[t];var h,l,m=a.slice(0);for(t=0;s>t;++t)l=e[t],h=m[l],u[h]=n[t],c[h]=i[t],m[l]=m[l]+1;return[a,u,c]},numeric.ccsGather=function(r){var t,n,e,i,o,s=r[0],a=r[1],u=r[2],c=s.length-1,f=a.length,h=Array(f),l=Array(f),m=Array(f);for(o=0,t=0;c>t;++t)for(e=s[t],i=s[t+1],n=e;n!==i;++n)l[o]=t,h[o]=a[n],m[o]=u[n],++o;return[h,l,m]},numeric.sdim=function u(r,t,n){if("undefined"==typeof t&&(t=[]),"object"!=typeof r)return t;"undefined"==typeof n&&(n=0),n in t||(t[n]=0),r.length>t[n]&&(t[n]=r.length);var e;for(e in r)r.hasOwnProperty(e)&&u(r[e],t,n+1);return t},numeric.sclone=function c(r,t,n){"undefined"==typeof t&&(t=0),"undefined"==typeof n&&(n=numeric.sdim(r).length);var e,i=Array(r.length);if(t===n-1){for(e in r)r.hasOwnProperty(e)&&(i[e]=r[e]);return i}for(e in r)r.hasOwnProperty(e)&&(i[e]=c(r[e],t+1,n));return i},numeric.sdiag=function(r){var t,n,e=r.length,i=Array(e);for(t=e-1;t>=1;t-=2)n=t-1,i[t]=[],i[t][t]=r[t],i[n]=[],i[n][n]=r[n];return 0===t&&(i[0]=[],i[0][0]=r[t]),i},numeric.sidentity=function(r){return numeric.sdiag(numeric.rep([r],1))},numeric.stranspose=function(r){{var t,n,e,i=[];r.length}for(t in r)if(r.hasOwnProperty(t)){e=r[t];for(n in e)e.hasOwnProperty(n)&&("object"!=typeof i[n]&&(i[n]=[]),i[n][t]=e[n])}return i},numeric.sLUP=function(){throw new Error("The function numeric.sLUP had a bug in it and has been removed. Please use the new numeric.ccsLUP function instead.")},numeric.sdotMM=function(r,t){var n,e,i,o,s,a,u,c=r.length,f=(t.length,numeric.stranspose(t)),h=f.length,l=Array(c);for(i=c-1;i>=0;i--){for(u=[],n=r[i],s=h-1;s>=0;s--){a=0,e=f[s];for(o in n)n.hasOwnProperty(o)&&o in e&&(a+=n[o]*e[o]);a&&(u[s]=a)}l[i]=u}return l},numeric.sdotMV=function(r,t){var n,e,i,o,s=r.length,a=Array(s);for(e=s-1;e>=0;e--){n=r[e],o=0;for(i in n)n.hasOwnProperty(i)&&t[i]&&(o+=n[i]*t[i]);o&&(a[e]=o)}return a},numeric.sdotVM=function(r,t){var n,e,i,o,s=[];for(n in r)if(r.hasOwnProperty(n)){i=t[n],o=r[n];for(e in i)i.hasOwnProperty(e)&&(s[e]||(s[e]=0),s[e]+=o*i[e])}return s},numeric.sdotVV=function(r,t){var n,e=0;for(n in r)r[n]&&t[n]&&(e+=r[n]*t[n]);return e},numeric.sdot=function(r,t){var n=numeric.sdim(r).length,e=numeric.sdim(t).length,i=1e3*n+e;switch(i){case 0:return r*t;case 1001:return numeric.sdotVV(r,t);case 2001:return numeric.sdotMV(r,t);case 1002:return numeric.sdotVM(r,t);case 2002:return numeric.sdotMM(r,t);default:throw new Error("numeric.sdot not implemented for tensors of order "+n+" and "+e)}},numeric.sscatter=function(r){var t,n,e,i,o=r[0].length,s=r.length,a=[];for(n=o-1;n>=0;--n)if(r[s-1][n]){for(i=a,e=0;s-2>e;e++)t=r[e][n],i[t]||(i[t]=[]),i=i[t];i[r[e][n]]=r[e+1][n]}return a},numeric.sgather=function f(r,t,n){"undefined"==typeof t&&(t=[]),"undefined"==typeof n&&(n=[]);var e,i,o;e=n.length;for(i in r)if(r.hasOwnProperty(i))if(n[e]=parseInt(i),o=r[i],"number"==typeof o){if(o){if(0===t.length)for(i=e+1;i>=0;--i)t[i]=[];for(i=e;i>=0;--i)t[i].push(n[i]);t[e+1].push(o)}}else f(o,t,n);return n.length>e&&n.pop(),t},numeric.cLU=function(r){var t,n,e,i,o,s,a=r[0],u=r[1],c=r[2],f=a.length,h=0;for(t=0;f>t;t++)a[t]>h&&(h=a[t]);h++;var l,m,p,d=Array(h),g=Array(h),v=numeric.rep([h],1/0),y=numeric.rep([h],-1/0);for(e=0;f>e;e++)t=a[e],n=u[e],n<v[t]&&(v[t]=n),n>y[t]&&(y[t]=n);for(t=0;h-1>t;t++)y[t]>y[t+1]&&(y[t+1]=y[t]);for(t=h-1;t>=1;t--)v[t]<v[t-1]&&(v[t-1]=v[t]);var w=0,x=0;for(t=0;h>t;t++)g[t]=numeric.rep([y[t]-v[t]+1],0),d[t]=numeric.rep([t-v[t]],0),w+=t-v[t]+1,x+=y[t]-t+1;for(e=0;f>e;e++)t=a[e],g[t][u[e]-v[t]]=c[e];for(t=0;h-1>t;t++)for(i=t-v[t],l=g[t],n=t+1;v[n]<=t&&h>n;n++)if(o=t-v[n],s=y[t]-t,m=g[n],p=m[o]/l[i]){for(e=1;s>=e;e++)m[e+o]-=p*l[e+i];d[n][t-v[n]]=p}var f,b,M,l=[],m=[],k=[],A=[],S=[],j=[];for(f=0,b=0,t=0;h>t;t++){for(i=v[t],o=y[t],M=g[t],n=t;o>=n;n++)M[n-i]&&(l[f]=t,m[f]=n,k[f]=M[n-i],f++);for(M=d[t],n=i;t>n;n++)M[n-i]&&(A[b]=t,S[b]=n,j[b]=M[n-i],b++);A[b]=t,S[b]=t,j[b]=1,b++}return{U:[l,m,k],L:[A,S,j]}},numeric.cLUsolve=function(r,t){var n,e,i=r.L,o=r.U,s=numeric.clone(t),a=i[0],u=i[1],c=i[2],f=o[0],h=o[1],l=o[2],m=f.length,p=(a.length,s.length);for(e=0,n=0;p>n;n++){for(;u[e]<n;)s[n]-=c[e]*s[u[e]],e++;e++}for(e=m-1,n=p-1;n>=0;n--){for(;h[e]>n;)s[n]-=l[e]*s[h[e]],e--;s[n]/=l[e],e--}return s},numeric.cgrid=function(r,t){"number"==typeof r&&(r=[r,r]);var n,e,i,o=numeric.rep(r,-1);if("function"!=typeof t)switch(t){case"L":t=function(t,n){return t>=r[0]/2||n<r[1]/2};break;default:t=function(){return!0}}for(i=0,n=1;n<r[0]-1;n++)for(e=1;e<r[1]-1;e++)t(n,e)&&(o[n][e]=i,i++);return o},numeric.cdelsq=function(r){var t,n,e,i,o,s=[[-1,0],[0,-1],[0,1],[1,0]],a=numeric.dim(r),u=a[0],c=a[1],f=[],h=[],l=[];for(t=1;u-1>t;t++)for(n=1;c-1>n;n++)if(!(r[t][n]<0)){for(e=0;4>e;e++)i=t+s[e][0],o=n+s[e][1],r[i][o]<0||(f.push(r[t][n]),h.push(r[i][o]),l.push(-1));f.push(r[t][n]),h.push(r[t][n]),l.push(4)}return[f,h,l]},numeric.cdotMV=function(r,t){var n,e,i,o=r[0],s=r[1],a=r[2],u=o.length;for(i=0,e=0;u>e;e++)o[e]>i&&(i=o[e]);for(i++,n=numeric.rep([i],0),e=0;u>e;e++)n[o[e]]+=a[e]*t[s[e]];return n},numeric.Spline=function(r,t,n,e,i){this.x=r,this.yl=t,this.yr=n,this.kl=e,this.kr=i},numeric.Spline.prototype._at=function(r,t){var r,n,e,i,o=this.x,s=this.yl,a=this.yr,u=this.kl,c=this.kr,f=numeric.add,h=numeric.sub,l=numeric.mul;n=h(l(u[t],o[t+1]-o[t]),h(a[t+1],s[t])),e=f(l(c[t+1],o[t]-o[t+1]),h(a[t+1],s[t])),i=(r-o[t])/(o[t+1]-o[t]);var m=i*(1-i);return f(f(f(l(1-i,s[t]),l(i,a[t+1])),l(n,m*(1-i))),l(e,m*i))},numeric.Spline.prototype.at=function(r){if("number"==typeof r){var t,n,e,i=this.x,o=i.length,s=Math.floor;for(t=0,n=o-1;n-t>1;)e=s((t+n)/2),i[e]<=r?t=e:n=e;return this._at(r,t)}var a,o=r.length,u=Array(o);for(a=o-1;-1!==a;--a)u[a]=this.at(r[a]);return u},numeric.Spline.prototype.diff=function(){var r,t,n,e=this.x,i=this.yl,o=this.yr,s=this.kl,a=this.kr,u=i.length,c=s,f=a,h=Array(u),l=Array(u),m=numeric.add,p=numeric.mul,d=numeric.div,g=numeric.sub;for(r=u-1;-1!==r;--r)t=e[r+1]-e[r],n=g(o[r+1],i[r]),h[r]=d(m(p(n,6),p(s[r],-4*t),p(a[r+1],-2*t)),t*t),l[r+1]=d(m(p(n,-6),p(s[r],2*t),p(a[r+1],4*t)),t*t);return new numeric.Spline(e,c,f,h,l)},numeric.Spline.prototype.roots=function(){function r(r){return r*r}var t=[],n=this.x,e=this.yl,i=this.yr,o=this.kl,s=this.kr;"number"==typeof e[0]&&(e=[e],i=[i],o=[o],s=[s]);var a,u,c,f,h,l,m,p,d,g,v,y,w,x,b,M,k,A,S,j,R,T,V,z,q=e.length,C=n.length-1,t=Array(q),E=Math.sqrt;for(a=0;a!==q;++a){for(f=e[a],h=i[a],l=o[a],m=s[a],p=[],u=0;u!==C;u++){for(u>0&&h[u]*f[u]<0&&p.push(n[u]),M=n[u+1]-n[u],k=n[u],v=f[u],y=h[u+1],d=l[u]/M,g=m[u+1]/M,b=r(d-g+3*(v-y))+12*g*v,w=g+3*v+2*d-3*y,x=3*(g+d+2*(v-y)),0>=b?(S=w/x,A=S>n[u]&&S<n[u+1]?[n[u],S,n[u+1]]:[n[u],n[u+1]]):(S=(w-E(b))/x,j=(w+E(b))/x,A=[n[u]],S>n[u]&&S<n[u+1]&&A.push(S),j>n[u]&&j<n[u+1]&&A.push(j),A.push(n[u+1])),T=A[0],S=this._at(T,u),c=0;c<A.length-1;c++)if(V=A[c+1],j=this._at(V,u),0!==S)if(0===j||S*j>0)T=V,S=j;else{for(var D=0;;){if(z=(S*V-j*T)/(S-j),T>=z||z>=V)break;if(R=this._at(z,u),R*j>0)V=z,j=R,-1===D&&(S*=.5),D=-1;else{if(!(R*S>0))break;T=z,S=R,1===D&&(j*=.5),D=1}}p.push(z),T=A[c+1],S=this._at(T,u)}else p.push(T),T=V,S=j;0===j&&p.push(V)}t[a]=p}return"number"==typeof this.yl[0]?t[0]:t},numeric.spline=function(r,t,n,e){var i,o=r.length,s=[],a=[],u=[],c=numeric.sub,f=numeric.mul,h=numeric.add;for(i=o-2;i>=0;i--)a[i]=r[i+1]-r[i],u[i]=c(t[i+1],t[i]);("string"==typeof n||"string"==typeof e)&&(n=e="periodic");var l=[[],[],[]];switch(typeof n){case"undefined":s[0]=f(3/(a[0]*a[0]),u[0]),l[0].push(0,0),l[1].push(0,1),l[2].push(2/a[0],1/a[0]);break;case"string":s[0]=h(f(3/(a[o-2]*a[o-2]),u[o-2]),f(3/(a[0]*a[0]),u[0])),l[0].push(0,0,0),l[1].push(o-2,0,1),l[2].push(1/a[o-2],2/a[o-2]+2/a[0],1/a[0]);break;default:s[0]=n,l[0].push(0),l[1].push(0),l[2].push(1)}for(i=1;o-1>i;i++)s[i]=h(f(3/(a[i-1]*a[i-1]),u[i-1]),f(3/(a[i]*a[i]),u[i])),l[0].push(i,i,i),l[1].push(i-1,i,i+1),l[2].push(1/a[i-1],2/a[i-1]+2/a[i],1/a[i]);switch(typeof e){case"undefined":s[o-1]=f(3/(a[o-2]*a[o-2]),u[o-2]),l[0].push(o-1,o-1),l[1].push(o-2,o-1),l[2].push(1/a[o-2],2/a[o-2]);break;case"string":l[1][l[1].length-1]=0;break;default:s[o-1]=e,l[0].push(o-1),l[1].push(o-1),l[2].push(1)}s="number"!=typeof s[0]?numeric.transpose(s):[s];var m=Array(s.length);if("string"==typeof n)for(i=m.length-1;-1!==i;--i)m[i]=numeric.ccsLUPSolve(numeric.ccsLUP(numeric.ccsScatter(l)),s[i]),m[i][o-1]=m[i][0];else for(i=m.length-1;-1!==i;--i)m[i]=numeric.cLUsolve(numeric.cLU(l),s[i]);return m="number"==typeof t[0]?m[0]:numeric.transpose(m),new numeric.Spline(r,t,t,m,m)},numeric.fftpow2=function h(r,t){var n=r.length;if(1!==n){var e,i,o=Math.cos,s=Math.sin,a=Array(n/2),u=Array(n/2),c=Array(n/2),f=Array(n/2);for(i=n/2,e=n-1;-1!==e;--e)--i,c[i]=r[e],f[i]=t[e],--e,a[i]=r[e],u[i]=t[e];h(a,u),h(c,f),i=n/2;var l,m,p,d=-6.283185307179586/n;for(e=n-1;-1!==e;--e)--i,-1===i&&(i=n/2-1),l=d*e,m=o(l),p=s(l),r[e]=a[i]+m*c[i]-p*f[i],t[e]=u[i]+m*f[i]+p*c[i]}},numeric._ifftpow2=function l(r,t){var n=r.length;if(1!==n){var e,i,o=Math.cos,s=Math.sin,a=Array(n/2),u=Array(n/2),c=Array(n/2),f=Array(n/2);for(i=n/2,e=n-1;-1!==e;--e)--i,c[i]=r[e],f[i]=t[e],--e,a[i]=r[e],u[i]=t[e];l(a,u),l(c,f),i=n/2;var h,m,p,d=6.283185307179586/n;for(e=n-1;-1!==e;--e)--i,-1===i&&(i=n/2-1),h=d*e,m=o(h),p=s(h),r[e]=a[i]+m*c[i]-p*f[i],t[e]=u[i]+m*f[i]+p*c[i]}},numeric.ifftpow2=function(r,t){numeric._ifftpow2(r,t),numeric.diveq(r,r.length),numeric.diveq(t,t.length)},numeric.convpow2=function(r,t,n,e){numeric.fftpow2(r,t),numeric.fftpow2(n,e);var i,o,s,a,u,c=r.length;for(i=c-1;-1!==i;--i)o=r[i],a=t[i],s=n[i],u=e[i],r[i]=o*s-a*u,t[i]=o*u+a*s;numeric.ifftpow2(r,t)},numeric.T.prototype.fft=function(){{var r,t,n=this.x,e=this.y,i=n.length,o=Math.log,s=o(2),a=Math.ceil(o(2*i-1)/s),u=Math.pow(2,a),c=numeric.rep([u],0),f=numeric.rep([u],0),h=Math.cos,l=Math.sin,m=-3.141592653589793/i,p=numeric.rep([u],0),d=numeric.rep([u],0);Math.floor(i/2)}for(r=0;i>r;r++)p[r]=n[r];if("undefined"!=typeof e)for(r=0;i>r;r++)d[r]=e[r];for(c[0]=1,r=1;u/2>=r;r++)t=m*r*r,c[r]=h(t),f[r]=l(t),c[u-r]=h(t),f[u-r]=l(t);var g=new numeric.T(p,d),v=new numeric.T(c,f);return g=g.mul(v),numeric.convpow2(g.x,g.y,numeric.clone(v.x),numeric.neg(v.y)),g=g.mul(v),g.x.length=i,g.y.length=i,g},numeric.T.prototype.ifft=function(){{var r,t,n=this.x,e=this.y,i=n.length,o=Math.log,s=o(2),a=Math.ceil(o(2*i-1)/s),u=Math.pow(2,a),c=numeric.rep([u],0),f=numeric.rep([u],0),h=Math.cos,l=Math.sin,m=3.141592653589793/i,p=numeric.rep([u],0),d=numeric.rep([u],0);Math.floor(i/2)}for(r=0;i>r;r++)p[r]=n[r];if("undefined"!=typeof e)for(r=0;i>r;r++)d[r]=e[r];for(c[0]=1,r=1;u/2>=r;r++)t=m*r*r,c[r]=h(t),f[r]=l(t),c[u-r]=h(t),f[u-r]=l(t);var g=new numeric.T(p,d),v=new numeric.T(c,f);return g=g.mul(v),numeric.convpow2(g.x,g.y,numeric.clone(v.x),numeric.neg(v.y)),g=g.mul(v),g.x.length=i,g.y.length=i,g.div(i)},numeric.gradient=function(r,t){var n=t.length,e=r(t);if(isNaN(e))throw new Error("gradient: f(x) is a NaN!");var i,o,s,a,u,c,f,h,l,m,p=Math.max,d=numeric.clone(t),g=Array(n),p=(numeric.div,numeric.sub,Math.max),v=.001,y=Math.abs,w=Math.min,x=0;for(i=0;n>i;i++)for(var b=p(1e-6*e,1e-8);;){if(++x,x>20)throw new Error("Numerical gradient fails");if(d[i]=t[i]+b,o=r(d),d[i]=t[i]-b,s=r(d),d[i]=t[i],isNaN(o)||isNaN(s))b/=16;else{if(g[i]=(o-s)/(2*b),u=t[i]-b,c=t[i],f=t[i]+b,h=(o-e)/b,l=(e-s)/b,m=p(y(g[i]),y(e),y(o),y(s),y(u),y(c),y(f),1e-8),a=w(p(y(h-g[i]),y(l-g[i]),y(h-l))/m,b/m),!(a>v))break;b/=16}}return g},numeric.uncmin=function(r,t,n,e,i,o,s){var a=numeric.gradient;"undefined"==typeof s&&(s={}),"undefined"==typeof n&&(n=1e-8),"undefined"==typeof e&&(e=function(t){return a(r,t)}),"undefined"==typeof i&&(i=1e3),t=numeric.clone(t);var u,c,f=t.length,h=r(t);if(isNaN(h))throw new Error("uncmin: f(x0) is a NaN!");var l=Math.max,m=numeric.norm2;n=l(n,numeric.epsilon);var p,d,g,v,y,w,x,b,M,k,A=s.Hinv||numeric.identity(f),S=numeric.dot,j=(numeric.inv,numeric.sub),R=numeric.add,T=numeric.tensor,V=numeric.div,z=numeric.mul,q=numeric.all,C=numeric.isFinite,E=numeric.neg,D=0,O="";for(d=e(t);i>D;){if("function"==typeof o&&o(D,t,h,d,A)){O="Callback returned true";break}if(!q(C(d))){O="Gradient has Infinity or NaN";break}if(p=E(S(A,d)),!q(C(p))){O="Search direction has Infinity or NaN";break}if(k=m(p),n>k){O="Newton step smaller than tol";break}for(M=1,c=S(d,p),y=t;i>D&&!(n>M*k)&&(v=z(p,M),y=R(t,v),u=r(y),u-h>=.1*M*c||isNaN(u));)M*=.5,++D;if(n>M*k){O="Line search step size smaller than tol";break}if(D===i){O="maxit reached during line search";break}g=e(y),w=j(g,d),b=S(w,v),x=S(A,w),A=j(R(A,z((b+S(w,x))/(b*b),T(v,v))),V(R(T(x,v),T(v,x)),b)),t=y,h=u,d=g,++D}return{solution:t,f:h,gradient:d,invHessian:A,iterations:D,message:O}},numeric.Dopri=function(r,t,n,e,i,o,s){this.x=r,this.y=t,this.f=n,this.ymid=e,this.iterations=i,this.events=s,this.message=o},numeric.Dopri.prototype._at=function(r,t){function n(r){return r*r}var e,i,o,s,a,u,r,c,f,h,l,m=this,p=m.x,d=m.y,g=m.f,v=m.ymid,y=(p.length,Math.floor,.5),w=numeric.add,x=numeric.mul,b=numeric.sub;return e=p[t],i=p[t+1],s=d[t],a=d[t+1],c=i-e,o=e+y*c,u=v[t],f=b(g[t],x(s,1/(e-o)+2/(e-i))),h=b(g[t+1],x(a,1/(i-o)+2/(i-e))),l=[n(r-i)*(r-o)/n(e-i)/(e-o),n(r-e)*n(r-i)/n(e-o)/n(i-o),n(r-e)*(r-o)/n(i-e)/(i-o),(r-e)*n(r-i)*(r-o)/n(e-i)/(e-o),(r-i)*n(r-e)*(r-o)/n(e-i)/(i-o)],w(w(w(w(x(s,l[0]),x(u,l[1])),x(a,l[2])),x(f,l[3])),x(h,l[4]))},numeric.Dopri.prototype.at=function(r){var t,n,e,i=Math.floor;if("number"!=typeof r){var o=r.length,s=Array(o);for(t=o-1;-1!==t;--t)s[t]=this.at(r[t]);return s}var a=this.x;for(t=0,n=a.length-1;n-t>1;)e=i(.5*(t+n)),a[e]<=r?t=e:n=e;return this._at(r,t)},numeric.dopri=function(r,t,n,e,i,o,s){"undefined"==typeof i&&(i=1e-6),"undefined"==typeof o&&(o=1e3);var a,u,c,f,h,l,m,p,d,g,v,y,w,x=[r],b=[n],M=[e(r,n)],k=[],A=.2,S=[.075,.225],j=[44/45,-56/15,32/9],R=[19372/6561,-25360/2187,64448/6561,-212/729],T=[9017/3168,-355/33,46732/5247,49/176,-5103/18656],V=[35/384,0,500/1113,125/192,-2187/6784,11/84],z=[.10013431883002395,0,.3918321794184259,-0.02982460176594817,.05893268337240795,-0.04497888809104361,.023904308236133973],q=[.2,.3,.8,8/9,1,1],C=[-71/57600,0,71/16695,-71/1920,17253/339200,-22/525,.025],E=0,D=(t-r)/10,O=0,N=numeric.add,P=numeric.mul,_=(Math.max,Math.min),I=Math.abs,U=numeric.norminf,F=Math.pow,L=numeric.any,B=numeric.lt,X=numeric.and,Q=(numeric.sub,new numeric.Dopri(x,b,M,k,-1,""));for("function"==typeof s&&(v=s(r,n));t>r&&o>O;)if(++O,r+D>t&&(D=t-r),a=e(r+q[0]*D,N(n,P(A*D,M[E]))),u=e(r+q[1]*D,N(N(n,P(S[0]*D,M[E])),P(S[1]*D,a))),c=e(r+q[2]*D,N(N(N(n,P(j[0]*D,M[E])),P(j[1]*D,a)),P(j[2]*D,u))),f=e(r+q[3]*D,N(N(N(N(n,P(R[0]*D,M[E])),P(R[1]*D,a)),P(R[2]*D,u)),P(R[3]*D,c))),h=e(r+q[4]*D,N(N(N(N(N(n,P(T[0]*D,M[E])),P(T[1]*D,a)),P(T[2]*D,u)),P(T[3]*D,c)),P(T[4]*D,f))),d=N(N(N(N(N(n,P(M[E],D*V[0])),P(u,D*V[2])),P(c,D*V[3])),P(f,D*V[4])),P(h,D*V[5])),l=e(r+D,d),m=N(N(N(N(N(P(M[E],D*C[0]),P(u,D*C[2])),P(c,D*C[3])),P(f,D*C[4])),P(h,D*C[5])),P(l,D*C[6])),g="number"==typeof m?I(m):U(m),g>i){if(D=.2*D*F(i/g,.25),r+D===r){Q.msg="Step size became too small";break}}else{if(k[E]=N(N(N(N(N(N(n,P(M[E],D*z[0])),P(u,D*z[2])),P(c,D*z[3])),P(f,D*z[4])),P(h,D*z[5])),P(l,D*z[6])),++E,x[E]=r+D,b[E]=d,M[E]=l,"function"==typeof s){var W,H,Y=r,Z=r+.5*D;if(y=s(Z,k[E-1]),w=X(B(v,0),B(0,y)),L(w)||(Y=Z,Z=r+D,v=y,y=s(Z,d),w=X(B(v,0),B(0,y))),L(w)){for(var J,G,$=0,K=1,rt=1;;){if("number"==typeof v)H=(rt*y*Y-K*v*Z)/(rt*y-K*v);else for(H=Z,p=v.length-1;-1!==p;--p)v[p]<0&&y[p]>0&&(H=_(H,(rt*y[p]*Y-K*v[p]*Z)/(rt*y[p]-K*v[p])));if(Y>=H||H>=Z)break;W=Q._at(H,E-1),G=s(H,W),J=X(B(v,0),B(0,G)),L(J)?(Z=H,y=G,w=J,rt=1,-1===$?K*=.5:K=1,$=-1):(Y=H,v=G,K=1,1===$?rt*=.5:rt=1,$=1)}return d=Q._at(.5*(r+H),E-1),Q.f[E]=e(H,W),Q.x[E]=H,Q.y[E]=W,Q.ymid[E-1]=d,Q.events=w,Q.iterations=O,Q}}r+=D,n=d,v=y,D=_(.8*D*F(i/g,.25),4*D)}return Q.iterations=O,Q},numeric.LU=function(r,t){t=t||!1;var n,e,i,o,s,a,u,c,f,h=Math.abs,l=r.length,m=l-1,p=new Array(l);for(t||(r=numeric.clone(r)),i=0;l>i;++i){for(u=i,a=r[i],f=h(a[i]),e=i+1;l>e;++e)o=h(r[e][i]),o>f&&(f=o,u=e);for(p[i]=u,u!=i&&(r[i]=r[u],r[u]=a,a=r[i]),s=a[i],n=i+1;l>n;++n)r[n][i]/=s;for(n=i+1;l>n;++n){for(c=r[n],e=i+1;m>e;++e)c[e]-=c[i]*a[e],++e,c[e]-=c[i]*a[e];e===m&&(c[e]-=c[i]*a[e])}}return{LU:r,P:p}},numeric.LUsolve=function(r,t){var n,e,i,o,s,a=r.LU,u=a.length,c=numeric.clone(t),f=r.P;for(n=u-1;-1!==n;--n)c[n]=t[n];for(n=0;u>n;++n)for(i=f[n],f[n]!==n&&(s=c[n],c[n]=c[i],c[i]=s),o=a[n],e=0;n>e;++e)c[n]-=c[e]*o[e];for(n=u-1;n>=0;--n){for(o=a[n],e=n+1;u>e;++e)c[n]-=c[e]*o[e];c[n]/=o[n]}return c},numeric.solve=function(r,t,n){return numeric.LUsolve(numeric.LU(r,n),t)},numeric.echelonize=function(r){var t,n,e,i,o,s,a,u,c=numeric.dim(r),f=c[0],h=c[1],l=numeric.identity(f),m=Array(f),p=Math.abs,d=numeric.diveq;for(r=numeric.clone(r),t=0;f>t;++t){for(e=0,o=r[t],s=l[t],n=1;h>n;++n)p(o[e])<p(o[n])&&(e=n);for(m[t]=e,d(s,o[e]),d(o,o[e]),n=0;f>n;++n)if(n!==t){for(a=r[n],u=a[e],i=h-1;-1!==i;--i)a[i]-=o[i]*u;for(a=l[n],i=f-1;-1!==i;--i)a[i]-=s[i]*u}}return{I:l,A:r,P:m}},numeric.__solveLP=function(r,t,n,e,i,o,s){var a,u,c,f,h=numeric.sum,l=(numeric.log,numeric.mul),m=numeric.sub,p=numeric.dot,d=numeric.div,g=numeric.add,v=r.length,y=n.length,w=!1,x=0,b=1,M=(numeric.transpose(t),numeric.svd,numeric.transpose),k=(numeric.leq,Math.sqrt),A=Math.abs,S=(numeric.muleq,numeric.norminf,numeric.any,Math.min),j=numeric.all,R=numeric.gt,T=Array(v),V=Array(y),z=(numeric.rep([y],1),numeric.solve),q=m(n,p(t,o)),C=p(r,r);for(c=x;i>c;++c){var E,D;for(E=y-1;-1!==E;--E)V[E]=d(t[E],q[E]);var O=M(V);for(E=v-1;-1!==E;--E)T[E]=h(O[E]);b=.25*A(C/p(r,T));var N=100*k(C/p(T,T));for((!isFinite(b)||b>N)&&(b=N),f=g(r,l(b,T)),u=p(O,V),E=v-1;-1!==E;--E)u[E][E]+=1;D=z(u,d(f,b),!0);var P=d(q,p(t,D)),_=1;for(E=y-1;-1!==E;--E)P[E]<0&&(_=S(_,-.999*P[E]));if(a=m(o,l(D,_)),q=m(n,p(t,a)),!j(R(q,0)))return{solution:o,message:"",iterations:c};if(o=a,e>b)return{solution:a,message:"",iterations:c};if(s){var I=p(r,f),U=p(t,f);for(w=!0,E=y-1;-1!==E;--E)if(I*U[E]<0){w=!1;break}}else w=o[v-1]>=0?!1:!0;if(w)return{solution:a,message:"Unbounded",iterations:c}}return{solution:o,message:"maximum iteration count exceeded",iterations:c}},numeric._solveLP=function(r,t,n,e,i){var o,s=r.length,a=n.length,u=(numeric.sum,numeric.log,numeric.mul,numeric.sub),c=numeric.dot,f=(numeric.div,numeric.add,numeric.rep([s],0).concat([1])),h=numeric.rep([a,1],-1),l=numeric.blockMatrix([[t,h]]),m=n,o=numeric.rep([s],0).concat(Math.max(0,numeric.sup(numeric.neg(n)))+1),p=numeric.__solveLP(f,l,m,e,i,o,!1),d=numeric.clone(p.solution);
d.length=s;var g=numeric.inf(u(n,c(t,d)));if(0>g)return{solution:0/0,message:"Infeasible",iterations:p.iterations};var v=numeric.__solveLP(r,t,n,e,i-p.iterations,d,!0);return v.iterations+=p.iterations,v},numeric.solveLP=function(r,t,n,e,i,o,s){if("undefined"==typeof s&&(s=1e3),"undefined"==typeof o&&(o=numeric.epsilon),"undefined"==typeof e)return numeric._solveLP(r,t,n,o,s);var a,u=e.length,c=e[0].length,f=t.length,h=numeric.echelonize(e),l=numeric.rep([c],0),m=h.P,p=[];for(a=m.length-1;-1!==a;--a)l[m[a]]=1;for(a=c-1;-1!==a;--a)0===l[a]&&p.push(a);var d=numeric.getRange,g=numeric.linspace(0,u-1),v=numeric.linspace(0,f-1),y=d(e,g,p),w=d(t,v,m),x=d(t,v,p),b=numeric.dot,M=numeric.sub,k=b(w,h.I),A=M(x,b(k,y)),S=M(n,b(k,i)),j=Array(m.length),R=Array(p.length);for(a=m.length-1;-1!==a;--a)j[a]=r[m[a]];for(a=p.length-1;-1!==a;--a)R[a]=r[p[a]];var T=M(R,b(j,b(h.I,y))),V=numeric._solveLP(T,A,S,o,s),z=V.solution;if(z!==z)return V;var q=b(h.I,M(i,b(y,z))),C=Array(r.length);for(a=m.length-1;-1!==a;--a)C[m[a]]=q[a];for(a=p.length-1;-1!==a;--a)C[p[a]]=z[a];return{solution:C,message:V.message,iterations:V.iterations}},numeric.MPStoLP=function(r){function t(t){throw new Error("MPStoLP: "+t+"\nLine "+n+": "+r[n]+"\nCurrent state: "+a[s]+"\n")}r instanceof String&&r.split("\n");var n,e,i,o,s=0,a=["Initial state","NAME","ROWS","COLUMNS","RHS","BOUNDS","ENDATA"],u=r.length,c=0,f={},h=[],l=0,m={},p=0,d=[],g=[],v=[];for(n=0;u>n;++n){i=r[n];var y=i.match(/\S*/g),w=[];for(e=0;e<y.length;++e)""!==y[e]&&w.push(y[e]);if(0!==w.length){for(e=0;e<a.length&&i.substr(0,a[e].length)!==a[e];++e);if(e<a.length){if(s=e,1===e&&(o=w[1]),6===e)return{name:o,c:d,A:numeric.transpose(g),b:v,rows:f,vars:m}}else switch(s){case 0:case 1:t("Unexpected line");case 2:switch(w[0]){case"N":0===c?c=w[1]:t("Two or more N rows");break;case"L":f[w[1]]=l,h[l]=1,v[l]=0,++l;break;case"G":f[w[1]]=l,h[l]=-1,v[l]=0,++l;break;case"E":f[w[1]]=l,h[l]=0,v[l]=0,++l;break;default:t("Parse error "+numeric.prettyPrint(w))}break;case 3:m.hasOwnProperty(w[0])||(m[w[0]]=p,d[p]=0,g[p]=numeric.rep([l],0),++p);var x=m[w[0]];for(e=1;e<w.length;e+=2)if(w[e]!==c){var b=f[w[e]];g[x][b]=(h[b]<0?-1:1)*parseFloat(w[e+1])}else d[x]=parseFloat(w[e+1]);break;case 4:for(e=1;e<w.length;e+=2)v[f[w[e]]]=(h[f[w[e]]]<0?-1:1)*parseFloat(w[e+1]);break;case 5:break;case 6:t("Internal error")}}}t("Reached end of file without ENDATA")},numeric.seedrandom={pow:Math.pow,random:Math.random},function(r,t,n,e,i,o,s){function a(r){var t,e,i=this,o=r.length,s=0,a=i.i=i.j=i.m=0;for(i.S=[],i.c=[],o||(r=[o++]);n>s;)i.S[s]=s++;for(s=0;n>s;s++)t=i.S[s],a=f(a+t+r[s%o]),e=i.S[a],i.S[s]=e,i.S[a]=t;i.g=function(r){var t=i.S,e=f(i.i+1),o=t[e],s=f(i.j+o),a=t[s];t[e]=a,t[s]=o;for(var u=t[f(o+a)];--r;)e=f(e+1),o=t[e],s=f(s+o),a=t[s],t[e]=a,t[s]=o,u=u*n+t[f(o+a)];return i.i=e,i.j=s,u},i.g(n)}function u(r,t,n,e,i){if(n=[],i=typeof r,t&&"object"==i)for(e in r)if(e.indexOf("S")<5)try{n.push(u(r[e],t-1))}catch(o){}return n.length?n:r+("string"!=i?"\x00":"")}function c(r,t,n,e){for(r+="",n=0,e=0;e<r.length;e++)t[f(e)]=f((n^=19*t[f(e)])+r.charCodeAt(e));r="";for(e in t)r+=String.fromCharCode(t[e]);return r}function f(r){return r&n-1}t.seedrandom=function(f,h){var l,m=[];return f=c(u(h?[f,r]:arguments.length?f:[(new Date).getTime(),r,window],3),m),l=new a(m),c(l.S,r),t.random=function(){for(var r=l.g(e),t=s,a=0;i>r;)r=(r+a)*n,t*=n,a=l.g(1);for(;r>=o;)r/=2,t/=2,a>>>=1;return(r+a)/t},f},s=t.pow(n,e),i=t.pow(2,i),o=2*i,c(t.random(),r)}([],numeric.seedrandom,256,6,52),function(r){function t(r){if("object"!=typeof r)return r;var n,e=[],i=r.length;for(n=0;i>n;n++)e[n+1]=t(r[n]);return e}function n(r){if("object"!=typeof r)return r;var t,e=[],i=r.length;for(t=1;i>t;t++)e[t-1]=n(r[t]);return e}function e(r,t,n){var e,i,o,s,a;for(o=1;n>=o;o+=1){for(r[o][o]=1/r[o][o],a=-r[o][o],e=1;o>e;e+=1)r[e][o]=a*r[e][o];if(s=o+1,s>n)break;for(i=s;n>=i;i+=1)for(a=r[o][i],r[o][i]=0,e=1;o>=e;e+=1)r[e][i]=r[e][i]+a*r[e][o]}}function i(r,t,n,e){var i,o,s,a;for(o=1;n>=o;o+=1){for(a=0,i=1;o>i;i+=1)a+=r[i][o]*e[i];e[o]=(e[o]-a)/r[o][o]}for(s=1;n>=s;s+=1)for(o=n+1-s,e[o]=e[o]/r[o][o],a=-e[o],i=1;o>i;i+=1)e[i]=e[i]+a*r[i][o]}function o(r,t,n,e){var i,o,s,a,u,c;for(o=1;n>=o;o+=1){if(e[1]=o,c=0,s=o-1,1>s){if(c=r[o][o]-c,0>=c)break;r[o][o]=Math.sqrt(c)}else{for(a=1;s>=a;a+=1){for(u=r[a][o],i=1;a>i;i+=1)u-=r[i][o]*r[i][a];u/=r[a][a],r[a][o]=u,c+=u*u}if(c=r[o][o]-c,0>=c)break;r[o][o]=Math.sqrt(c)}e[1]=0}}function s(r,t,n,s,a,u,c,f,h,l,m,p,d,g,v,y){function w(){for(g[1]=g[1]+1,j=E,A=1;l>=A;A+=1){for(j+=1,I=-f[A],S=1;s>=S;S+=1)I+=c[S][A]*a[S];if(Math.abs(I)<H&&(I=0),A>m)v[j]=I;else if(v[j]=-Math.abs(I),I>0){for(S=1;s>=S;S+=1)c[S][A]=-c[S][A];f[A]=-f[A]}}for(A=1;d>=A;A+=1)v[E+p[A]]=0;for(O=0,_=0,A=1;l>=A;A+=1)v[E+A]<_*v[P+A]&&(O=A,_=v[E+A]/v[P+A]);return 0===O?999:0}function x(){for(A=1;s>=A;A+=1){for(I=0,S=1;s>=S;S+=1)I+=r[S][A]*c[S][O];v[A]=I}for(R=z,A=1;s>=A;A+=1)v[R+A]=0;for(S=d+1;s>=S;S+=1)for(A=1;s>=A;A+=1)v[R+A]=v[R+A]+r[A][S]*v[S];for(Q=!0,A=d;A>=1;A-=1){for(I=v[A],j=C+A*(A+3)/2,R=j-A,S=A+1;d>=S;S+=1)I-=v[j]*v[q+S],j+=S;if(I/=v[R],v[q+A]=I,p[A]<m)break;if(0>I)break;Q=!1,V=A}if(!Q)for(U=v[D+V]/v[q+V],A=1;d>=A&&!(p[A]<m)&&!(v[q+A]<0);A+=1)_=v[D+A]/v[q+A],U>_&&(U=_,V=A);for(I=0,A=z+1;z+s>=A;A+=1)I+=v[A]*v[A];if(Math.abs(I)<=H){if(Q)return y[1]=1,999;for(A=1;d>=A;A+=1)v[D+A]=v[D+A]-U*v[q+A];return v[D+d+1]=v[D+d+1]+U,700}for(I=0,A=1;s>=A;A+=1)I+=v[z+A]*c[A][O];for(F=-v[E+O]/I,W=!0,Q||F>U&&(F=U,W=!1),A=1;s>=A;A+=1)a[A]=a[A]+F*v[z+A],Math.abs(a[A])<H&&(a[A]=0);for(u[1]=u[1]+F*I*(F/2+v[D+d+1]),A=1;d>=A;A+=1)v[D+A]=v[D+A]-F*v[q+A];if(v[D+d+1]=v[D+d+1]+F,!W){for(I=-f[O],S=1;s>=S;S+=1)I+=a[S]*c[S][O];if(O>m)v[E+O]=I;else if(v[E+O]=-Math.abs(I),I>0){for(S=1;s>=S;S+=1)c[S][O]=-c[S][O];f[O]=-f[O]}return 700}for(d+=1,p[d]=O,j=C+(d-1)*d/2+1,A=1;d-1>=A;A+=1)v[j]=v[A],j+=1;if(d===s)v[j]=v[s];else{for(A=s;A>=d+1&&0!==v[A]&&(L=Math.max(Math.abs(v[A-1]),Math.abs(v[A])),B=Math.min(Math.abs(v[A-1]),Math.abs(v[A])),_=v[A-1]>=0?Math.abs(L*Math.sqrt(1+B*B/(L*L))):-Math.abs(L*Math.sqrt(1+B*B/(L*L))),L=v[A-1]/_,B=v[A]/_,1!==L);A-=1)if(0===L)for(v[A-1]=B*_,S=1;s>=S;S+=1)_=r[S][A-1],r[S][A-1]=r[S][A],r[S][A]=_;else for(v[A-1]=_,X=B/(1+L),S=1;s>=S;S+=1)_=L*r[S][A-1]+B*r[S][A],r[S][A]=X*(r[S][A-1]+_)-r[S][A],r[S][A-1]=_;v[j]=v[d]}return 0}function b(){if(j=C+V*(V+1)/2+1,R=j+V,0===v[R])return 798;if(L=Math.max(Math.abs(v[R-1]),Math.abs(v[R])),B=Math.min(Math.abs(v[R-1]),Math.abs(v[R])),_=v[R-1]>=0?Math.abs(L*Math.sqrt(1+B*B/(L*L))):-Math.abs(L*Math.sqrt(1+B*B/(L*L))),L=v[R-1]/_,B=v[R]/_,1===L)return 798;if(0===L){for(A=V+1;d>=A;A+=1)_=v[R-1],v[R-1]=v[R],v[R]=_,R+=A;for(A=1;s>=A;A+=1)_=r[A][V],r[A][V]=r[A][V+1],r[A][V+1]=_}else{for(X=B/(1+L),A=V+1;d>=A;A+=1)_=L*v[R-1]+B*v[R],v[R]=X*(v[R-1]+_)-v[R],v[R-1]=_,R+=A;for(A=1;s>=A;A+=1)_=L*r[A][V]+B*r[A][V+1],r[A][V+1]=X*(r[A][V]+_)-r[A][V+1],r[A][V]=_}return 0}function M(){for(R=j-V,A=1;V>=A;A+=1)v[R]=v[j],j+=1,R+=1;return v[D+V]=v[D+V+1],p[V]=p[V+1],V+=1,d>V?797:0}function k(){return v[D+d]=v[D+d+1],v[D+d+1]=0,p[d]=0,d-=1,g[2]=g[2]+1,0}var A,S,j,R,T,V,z,q,C,E,D,O,N,P,_,I,U,F,L,B,X,Q,W,H,Y,Z,J;N=Math.min(s,l),j=2*s+N*(N+5)/2+2*l+1,H=1e-60;do H+=H,Y=1+.1*H,Z=1+.2*H;while(1>=Y||1>=Z);for(A=1;s>=A;A+=1)v[A]=t[A];for(A=s+1;j>=A;A+=1)v[A]=0;for(A=1;l>=A;A+=1)p[A]=0;if(T=[],0===y[1]){if(o(r,n,s,T),0!==T[1])return void(y[1]=2);i(r,n,s,t),e(r,n,s)}else{for(S=1;s>=S;S+=1)for(a[S]=0,A=1;S>=A;A+=1)a[S]=a[S]+r[A][S]*t[A];for(S=1;s>=S;S+=1)for(t[S]=0,A=S;s>=A;A+=1)t[S]=t[S]+r[S][A]*a[A]}for(u[1]=0,S=1;s>=S;S+=1)for(a[S]=t[S],u[1]=u[1]+v[S]*a[S],v[S]=0,A=S+1;s>=A;A+=1)r[A][S]=0;for(u[1]=-u[1]/2,y[1]=0,z=s,q=z+s,D=q+N,C=D+N+1,E=C+N*(N+1)/2,P=E+l,A=1;l>=A;A+=1){for(I=0,S=1;s>=S;S+=1)I+=c[S][A]*c[S][A];v[P+A]=Math.sqrt(I)}for(d=0,g[1]=0,g[2]=0,J=0;;){if(J=w(),999===J)return;for(;;){if(J=x(),0===J)break;if(999===J)return;if(700===J)if(V===d)k();else{for(;;)if(b(),J=M(),797!==J)break;k()}}}}function a(r,e,i,o,a,u){r=t(r),e=t(e),i=t(i);var c,f,h,l,m,p,d=[],g=[],v=[],y=[],w=[];if(a=a||0,u=u?t(u):[void 0,0],o=o?t(o):[],f=r.length-1,h=i[1].length-1,!o)for(c=1;h>=c;c+=1)o[c]=0;for(c=1;h>=c;c+=1)g[c]=0;for(l=0,m=Math.min(f,h),c=1;f>=c;c+=1)v[c]=0;for(d[1]=0,c=1;2*f+m*(m+5)/2+2*h+1>=c;c+=1)y[c]=0;for(c=1;2>=c;c+=1)w[c]=0;return s(r,e,f,f,v,d,i,o,f,h,a,g,l,w,y,u),p="",1===u[1]&&(p="constraints are inconsistent, no solution!"),2===u[1]&&(p="matrix D in quadratic function is not positive definite!"),{solution:n(v),value:n(d),unconstrained_solution:n(e),iterations:n(w),iact:n(g),message:p}}r.solveQP=a}(numeric),numeric.svd=function(r){function t(r,t){return r=Math.abs(r),t=Math.abs(t),r>t?r*Math.sqrt(1+t*t/r/r):0==t?r:t*Math.sqrt(1+r*r/t/t)}var n,e=numeric.epsilon,i=1e-64/e,o=50,s=0,a=0,u=0,c=0,f=0,h=numeric.clone(r),l=h.length,m=h[0].length;if(m>l)throw"Need more rows than columns";var p=new Array(m),d=new Array(m);for(a=0;m>a;a++)p[a]=d[a]=0;var g=numeric.rep([m,m],0),v=0,y=0,w=0,x=0,b=0,M=0,k=0;for(a=0;m>a;a++){for(p[a]=y,k=0,f=a+1,u=a;l>u;u++)k+=h[u][a]*h[u][a];if(i>=k)y=0;else for(v=h[a][a],y=Math.sqrt(k),v>=0&&(y=-y),w=v*y-k,h[a][a]=v-y,u=f;m>u;u++){for(k=0,c=a;l>c;c++)k+=h[c][a]*h[c][u];for(v=k/w,c=a;l>c;c++)h[c][u]+=v*h[c][a]}for(d[a]=y,k=0,u=f;m>u;u++)k+=h[a][u]*h[a][u];if(i>=k)y=0;else{for(v=h[a][a+1],y=Math.sqrt(k),v>=0&&(y=-y),w=v*y-k,h[a][a+1]=v-y,u=f;m>u;u++)p[u]=h[a][u]/w;for(u=f;l>u;u++){for(k=0,c=f;m>c;c++)k+=h[u][c]*h[a][c];for(c=f;m>c;c++)h[u][c]+=k*p[c]}}b=Math.abs(d[a])+Math.abs(p[a]),b>x&&(x=b)}for(a=m-1;-1!=a;a+=-1){if(0!=y){for(w=y*h[a][a+1],u=f;m>u;u++)g[u][a]=h[a][u]/w;for(u=f;m>u;u++){for(k=0,c=f;m>c;c++)k+=h[a][c]*g[c][u];for(c=f;m>c;c++)g[c][u]+=k*g[c][a]}}for(u=f;m>u;u++)g[a][u]=0,g[u][a]=0;g[a][a]=1,y=p[a],f=a}for(a=m-1;-1!=a;a+=-1){for(f=a+1,y=d[a],u=f;m>u;u++)h[a][u]=0;if(0!=y){for(w=h[a][a]*y,u=f;m>u;u++){for(k=0,c=f;l>c;c++)k+=h[c][a]*h[c][u];for(v=k/w,c=a;l>c;c++)h[c][u]+=v*h[c][a]}for(u=a;l>u;u++)h[u][a]=h[u][a]/y}else for(u=a;l>u;u++)h[u][a]=0;h[a][a]+=1}for(e*=x,c=m-1;-1!=c;c+=-1)for(var A=0;o>A;A++){var S=!1;for(f=c;-1!=f;f+=-1){if(Math.abs(p[f])<=e){S=!0;break}if(Math.abs(d[f-1])<=e)break}if(!S){s=0,k=1;var j=f-1;for(a=f;c+1>a&&(v=k*p[a],p[a]=s*p[a],!(Math.abs(v)<=e));a++)for(y=d[a],w=t(v,y),d[a]=w,s=y/w,k=-v/w,u=0;l>u;u++)b=h[u][j],M=h[u][a],h[u][j]=b*s+M*k,h[u][a]=-b*k+M*s}if(M=d[c],f==c){if(0>M)for(d[c]=-M,u=0;m>u;u++)g[u][c]=-g[u][c];break}if(A>=o-1)throw"Error: no convergence.";for(x=d[f],b=d[c-1],y=p[c-1],w=p[c],v=((b-M)*(b+M)+(y-w)*(y+w))/(2*w*b),y=t(v,1),v=0>v?((x-M)*(x+M)+w*(b/(v-y)-w))/x:((x-M)*(x+M)+w*(b/(v+y)-w))/x,s=1,k=1,a=f+1;c+1>a;a++){for(y=p[a],b=d[a],w=k*y,y=s*y,M=t(v,w),p[a-1]=M,s=v/M,k=w/M,v=x*s+y*k,y=-x*k+y*s,w=b*k,b*=s,u=0;m>u;u++)x=g[u][a-1],M=g[u][a],g[u][a-1]=x*s+M*k,g[u][a]=-x*k+M*s;for(M=t(v,w),d[a-1]=M,s=v/M,k=w/M,v=s*y+k*b,x=-k*y+s*b,u=0;l>u;u++)b=h[u][a-1],M=h[u][a],h[u][a-1]=b*s+M*k,h[u][a]=-b*k+M*s}p[f]=0,p[c]=v,d[c]=x}for(a=0;a<d.length;a++)d[a]<e&&(d[a]=0);for(a=0;m>a;a++)for(u=a-1;u>=0;u--)if(d[u]<d[a]){for(s=d[u],d[u]=d[a],d[a]=s,c=0;c<h.length;c++)n=h[c][a],h[c][a]=h[c][u],h[c][u]=n;for(c=0;c<g.length;c++)n=g[c][a],g[c][a]=g[c][u],g[c][u]=n;a=u}return{U:h,S:d,V:g}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],144:[function(r,t){"use strict";function n(r,t){this.data=r,this.h=t}var e=r("numeric"),i={windSize:5,deriv:1,pol:2};n.prototype.calc=function(r){r=r||{},this.options={};for(var t in i)this.options[t]=r.hasOwnProperty(t)?r[t]:i[t];if(this.options.windSize%2===0||this.options.windSize<5)throw new RangeError("Invalid window size");if(this.options.deriv<0||this.options.pol<1)throw new RangeError("Number too small");if(this.options.pol!==Math.floor(this.options.pol)||this.options.deriv!==Math.floor(this.options.deriv)||this.options.windSize!==Math.floor(this.options.windSize))throw new TypeError("Only integers allowed");var n,o;if(5!==this.options.windSize||2!==this.options.pol||1!==this.options.deriv&&2!==this.options.deriv){for(var s=new Array(this.options.windSize),a=0;a<s.length;a++){s[a]=new Array(this.options.pol+1);for(var u=-(this.options.windSize-1)/2,c=0;c<s[a].length;c++)s[a][c]=u+1===0&&0===c?1:Math.pow(u+a,c)}n=e.dot(e.inv(e.dot(e.transpose(s),s)),e.transpose(s)),n=n[this.options.deriv].concat(),o=1}else 1===this.options.deriv?(n=[-2,-1,0,1,2],o=10):(n=[2,-1,-2,-1,2],o=7);for(var f=new Array(this.data.length),h=Math.ceil(this.options.windSize/2);h<f.length-Math.floor(this.options.windSize/2);h++){for(var l=0,m=0;m<n.length;m++)l+=n[m]*this.data[m+h-Math.floor(this.options.windSize/2)]/(o*Math.pow(this.h,this.options.deriv));f[h]=l}for(var p=0;p<Math.ceil(this.options.windSize/2);p++)f[p]=f[Math.ceil(this.options.windSize/2)];for(var d=f.length-Math.floor(this.options.windSize/2);d<f.length;d++)f[d]=f[f.length-Math.floor(this.options.windSize/2)-1];return f},t.exports=n},{numeric:143}],145:[function(require,module,exports){"use strict";function SOM(r,t,n,e){this.x=r,this.y=t,n=n||{},this.options={};for(var i in defaultOptions)this.options[i]=n.hasOwnProperty(i)?n[i]:defaultOptions[i];if("number"==typeof this.options.fields)this.numWeights=this.options.fields;else{if(!Array.isArray(this.options.fields))throw new Error("Invalid fields definition");this.numWeights=this.options.fields.length;var o=getConverters(this.options.fields);this.extractor=o.extractor,this.creator=o.creator}if("rect"===this.options.gridType)this.nodeType=NodeSquare,this.gridDim={x:r,y:t};else{this.nodeType=NodeHexagonal;var s=this.x-Math.floor(this.y/2);this.gridDim={x:s,y:this.y,z:-(0-s-this.y)}}if(this.torus=this.options.torus,this.distanceMethod=this.torus?"getDistanceTorus":"getDistance",this.distance=this.options.distance,this.maxDistance=getMaxDistance(this.distance,this.numWeights),e===!0)return void(this.done=!0);if(!(r>0&&t>0))throw new Error("x and y must be positive");this.times={findBMU:0,adjust:0},this.randomizer=this.options.randomizer,this.iterationCount=0,this.iterations=this.options.iterations,this.startLearningRate=this.learningRate=this.options.learningRate,this.mapRadius=Math.floor(Math.max(r,t)/2),this.algorithmMethod=this.options.method,this._initNodes(),this.done=!1}function getConverters(r){for(var t=r.length,n=new Array(t),e=new Array(t),i=0;t>i;i++)n[i]=getNormalizer(r[i].range),e[i]=getDenormalizer(r[i].range);return{extractor:function(e){for(var i=new Array(t),o=0;t>o;o++)i[o]=n[o](e[r[o].name]);return i},creator:function(n){for(var i={},o=0;t>o;o++)i[r[o].name]=e[o](n[o]);return i}}}function getNormalizer(r){return function(t){return(t-r[0])/(r[1]-r[0])}}function getDenormalizer(r){return function(t){return r[0]+t*(r[1]-r[0])}}function squareEuclidean(r,t){for(var n=0,e=0,i=r.length;i>e;e++)n+=(r[e]-t[e])*(r[e]-t[e]);return n}function getRandomValue(r,t){return r[Math.floor(t()*r.length)]}function getMaxDistance(r,t){for(var n=new Array(t),e=new Array(t),i=0;t>i;i++)n[i]=0,e[i]=1;return r(n,e)}var NodeSquare=require("./node-square"),NodeHexagonal=require("./node-hexagonal"),defaultOptions={fields:3,randomizer:Math.random,distance:squareEuclidean,iterations:10,learningRate:.1,gridType:"rect",torus:!0,method:"random"};SOM.load=function loadModel(model,distance){if("SOM"===model.name){var x=model.data.length,y=model.data[0].length;distance?model.options.distance=distance:model.options.distance&&(model.options.distance=eval("("+model.options.distance+")"));var som=new SOM(x,y,model.options,!0);som.nodes=new Array(x);for(var i=0;x>i;i++){som.nodes[i]=new Array(y);for(var j=0;y>j;j++)som.nodes[i][j]=new som.nodeType(i,j,model.data[i][j],som)}return som}throw new Error("expecting a SOM model")},SOM.prototype["export"]=function(r){if(!this.done)throw new Error("model is not ready yet");var t={name:"SOM"};t.options={fields:this.options.fields,gridType:this.options.gridType,torus:this.options.torus},t.data=new Array(this.x);for(var n=0;n<this.x;n++){t.data[n]=new Array(this.y);for(var e=0;e<this.y;e++)t.data[n][e]=this.nodes[n][e].weights}return r&&(t.options.distance=this.distance.toString()),t},SOM.prototype._initNodes=function(){var r,t,n,e=Date.now();for(this.nodes=new Array(this.x),r=0;r<this.x;r++)for(this.nodes[r]=new Array(this.y),t=0;t<this.y;t++){var i=new Array(this.numWeights);for(n=0;n<this.numWeights;n++)i[n]=this.randomizer();this.nodes[r][t]=new this.nodeType(r,t,i,this)}this.times.initNodes=Date.now()-e},SOM.prototype.setTraining=function(r){if(this.trainingSet)throw new Error("training set has already been set");var t,n=Date.now(),e=r,i=r.length;if(this.extractor)for(e=new Array(i),t=0;i>t;t++)e[t]=this.extractor(r[t]);this.numIterations=this.iterations*i,this.timeConstant="random"===this.algorithmMethod?this.numIterations/Math.log(this.mapRadius):i/Math.log(this.mapRadius),this.trainingSet=e,this.times.setTraining=Date.now()-n},SOM.prototype.trainOne=function(){if(this.done)return!1;if(this.numIterations-->0){var r,t,n;return"random"===this.algorithmMethod?(r=this.mapRadius*Math.exp(-this.iterationCount/this.timeConstant),t=getRandomValue(this.trainingSet,this.randomizer),this._adjust(t,r),this.learningRate=this.startLearningRate*Math.exp(-this.iterationCount/this.numIterations)):(n=-Math.floor(this.iterationCount/this.trainingSet.length),r=this.mapRadius*Math.exp(n/this.timeConstant),t=this.trainingSet[this.iterationCount%this.trainingSet.length],this._adjust(t,r),(this.iterationCount+1)%this.trainingSet.length===0&&(this.learningRate=this.startLearningRate*Math.exp(n/Math.floor(this.numIterations/this.trainingSet.length)))),this.iterationCount++,!0}return this.done=!0,!1},SOM.prototype._adjust=function(r,t){var n,e,i,o,s=Date.now(),a=this._findBestMatchingUnit(r),u=Date.now();this.times.findBMU+=u-s;var c=Math.floor(t),f=a.x-c,h=a.x+c,l=a.y-c,m=a.y+c;for(n=f;h>=n;n++){var p=n;for(0>n?p+=this.x:n>=this.x&&(p-=this.x),e=l;m>=e;e++){var d=e;0>e?d+=this.y:e>=this.y&&(d-=this.y),i=a[this.distanceMethod](this.nodes[p][d]),t>i&&(o=Math.exp(-i/(2*t)),this.nodes[p][d].adjustWeights(r,this.learningRate,o))}}this.times.adjust+=Date.now()-u},SOM.prototype.train=function(r){if(!this.done)for(this.setTraining(r);this.trainOne(););},SOM.prototype.getConvertedNodes=function(){for(var r=new Array(this.x),t=0;t<this.x;t++){r[t]=new Array(this.y);for(var n=0;n<this.y;n++){var e=this.nodes[t][n];r[t][n]=this.creator?this.creator(e.weights):e.weights}}return r},SOM.prototype._findBestMatchingUnit=function(r){for(var t,n,e=1/0,i=0;i<this.x;i++)for(var o=0;o<this.y;o++)n=this.distance(this.nodes[i][o].weights,r),e>n&&(e=n,t=this.nodes[i][o]);return t},SOM.prototype.predict=function(r,t){if("boolean"==typeof r&&(t=r,r=null),r||(r=this.trainingSet),Array.isArray(r)&&(Array.isArray(r[0])||"object"==typeof r[0])){var n=this;return r.map(function(r){return n._predict(r,t)})}return this._predict(r,t)},SOM.prototype._predict=function(r,t){Array.isArray(r)||(r=this.extractor(r));var n=this._findBestMatchingUnit(r),e=[n.x,n.y];return t&&(e[2]=n.getPosition(r)),e},SOM.prototype.getQuantizationError=function(){for(var r=this.getFit(),t=r.length,n=0,e=0;t>e;e++)n+=r[e];return n/t},SOM.prototype.getFit=function(r){r||(r=this.trainingSet);for(var t,n=r.length,e=new Array(n),i=0;n>i;i++)t=this._findBestMatchingUnit(r[i]),e[i]=Math.sqrt(this.distance(r[i],t.weights));return e},module.exports=SOM},{"./node-hexagonal":146,"./node-square":147}],146:[function(r,t){function n(r,t,n,i){e.call(this,r,t,n,i),this.hX=r-Math.floor(t/2),this.z=0-this.hX-t}var e=r("./node-square");n.prototype=new e,n.prototype.constructor=n,n.prototype.getDistance=function(r){return Math.max(Math.abs(this.hX-r.hX),Math.abs(this.y-r.y),Math.abs(this.z-r.z))},n.prototype.getDistanceTorus=function(r){var t=Math.abs(this.hX-r.hX),n=Math.abs(this.y-r.y),e=Math.abs(this.z-r.z);return Math.max(Math.min(t,this.som.gridDim.x-t),Math.min(n,this.som.gridDim.y-n),Math.min(e,this.som.gridDim.z-e))},n.prototype.getPosition=function(){throw new Error("Unimplemented : cannot get position of the points for hexagonal grid")},t.exports=n},{"./node-square":147}],147:[function(r,t){function n(r,t,n,e){this.x=r,this.y=t,this.weights=n,this.som=e,this.neighbors={}}n.prototype.adjustWeights=function(r,t,n){for(var e=0,i=this.weights.length;i>e;e++)this.weights[e]+=t*n*(r[e]-this.weights[e])},n.prototype.getDistance=function(r){return Math.max(Math.abs(this.x-r.x),Math.abs(this.y-r.y))},n.prototype.getDistanceTorus=function(r){var t=Math.abs(this.x-r.x),n=Math.abs(this.y-r.y);return Math.max(Math.min(t,this.som.gridDim.x-t),Math.min(n,this.som.gridDim.y-n))},n.prototype.getNeighbors=function(r){if(!this.neighbors[r]){this.neighbors[r]=new Array(2);var t;if(this[r]>0?t=this[r]-1:this.som.torus&&(t=this.som.gridDim[r]-1),"undefined"!=typeof t){var n,e;"x"===r?(n=t,e=this.y):(n=this.x,e=t),this.neighbors[r][0]=this.som.nodes[n][e]}var i;this[r]<this.som.gridDim[r]-1?i=this[r]+1:this.som.torus&&(i=0),"undefined"!=typeof i&&("x"===r?(n=i,e=this.y):(n=this.x,e=i),this.neighbors[r][1]=this.som.nodes[n][e])}return this.neighbors[r]},n.prototype.getPos=function(r,t){var n,e,i=this.getNeighbors(r),o=this.som.distance;if(i[0])if(i[1]){var s=o(t,i[0].weights),a=o(t,i[1].weights);a>s?(n=i[0],e=-1):(n=i[1],e=1)}else n=i[0],e=-1;else n=i[1],e=1;var u=1-o(t,this.weights),c=1-o(t,n.weights),f=(u-c)/(2-u-c);return.5+.5*f*e},n.prototype.getPosition=function(r){return[this.getPos("x",r),this.getPos("y",r)]},t.exports=n},{}],148:[function(r,t){"use strict";function n(r){for(var t=-1/0,n=r.length,e=0;n>e;e++)r[e]>t&&(t=r[e]);return t}function e(r){for(var t=1/0,n=r.length,e=0;n>e;e++)r[e]<t&&(t=r[e]);return t}function i(r){for(var t=1/0,n=-1/0,e=r.length,i=0;e>i;i++)r[i]<t&&(t=r[i]),r[i]>n&&(n=r[i]);return{min:t,max:n}}function o(r){for(var t=0,n=r.length,e=0;n>e;e++)t+=r[e];return t/n}function s(r){for(var t=0,n=r.length,e=0;n>e;e++)t*=r[e];return Math.pow(t,1/n)}function a(r){for(var t=0,n=r.length,e=0;n>e;e++)t+=Math.log(r[e]);return t/n}function u(r,t){for(var n=0,e=0,i=r.length,o=0;i>o;o++)n+=t[o]*r[o],e+=t[o];return n/e}function c(r,t,n){"undefined"==typeof n&&(n=!1),r=n?r:r.slice(),r.sort();for(var e=r.length,i=Math.floor(e*t),o=0,s=i;e-i>s;s++)o+=r[s];return o/(e-2*i)}function f(r,t){"undefined"==typeof t&&(t=1);for(var n=0,e=0,i=r.length,o=0;i>o;o++)n+=Math.pow(r[o],t+1),e+=Math.pow(r[o],t);return n/e}function h(r,t){return Math.sqrt(d(r,t))}function l(r){return h(r)/Math.sqrt(r.length)}function m(r,t){"undefined"==typeof t&&(t=!1),t||(r=r.slice(),r.sort());var n=r.length,e=Math.floor(n/2);return n%2===0?.5*(r[e-1]+r[e]):r[e]}function p(r,t){"undefined"==typeof t&&(t=!1),t||(r=r.slice(),r.sort());var n=r.length/4,e=r[Math.ceil(n)-1],i=m(r,!0),o=r[Math.ceil(3*n)-1];return{q1:e,q2:i,q3:o}}function d(r,t){"undefined"==typeof t&&(t=!0);for(var n=o(r),e=0,i=r.length,s=0;i>s;s++){var a=r[s]-n;e+=a*a}return t?e/(i-1):e/i}function g(r,t){return Math.sqrt(v(r,t))}function v(r,t){"undefined"==typeof t&&(t=!0);for(var n=0,e=0,i=r.length,o=0;i>o;o++){var s=r[o],a=d(s);n+=(s.length-1)*a,e+=t?s.length-1:s.length}return n/e}function y(r){var t,n=r.length,e=new Array(n);for(t=0;n>t;t++)e[t]=0;var i=new Array(n),o=0;for(t=0;n>t;t++){var s=i.indexOf(r[t]);s>=0?e[s]++:(i[o]=r[t],e[o]=1,o++)}var a=0,u=0;for(t=0;o>t;t++)e[t]>a&&(a=e[t],u=t);return i[u]}function w(r,t,n){"undefined"==typeof n&&(n=!0);var e=o(r),i=o(t);if(r.length!==t.length)throw"Vectors do not have the same dimensions";for(var s=0,a=r.length,u=0;a>u;u++){var c=r[u]-e,f=t[u]-i;s+=c*f}return n?s/(a-1):s/a}function x(r,t){"undefined"==typeof t&&(t=!0);for(var n=o(r),e=0,i=0,s=r.length,a=0;s>a;a++){var u=r[a]-n;e+=u*u,i+=u*u*u}var c=e/s,f=i/s,h=f/Math.pow(c,1.5);if(t){var l=Math.sqrt(s*(s-1)),m=s-2;return l/m*h}return h}function b(r,t){"undefined"==typeof t&&(t=!0);for(var n=o(r),e=r.length,i=0,s=0,a=0;e>a;a++){var u=r[a]-n;i+=u*u,s+=u*u*u*u}var c=i/e,f=s/e;if(t){var h=i/(e-1),l=e*(e+1)/((e-1)*(e-2)*(e-3)),m=s/(h*h),p=(e-1)*(e-1)/((e-2)*(e-3));return l*m-3*p}return f/(c*c)-3}function M(r,t){"undefined"==typeof t&&(t=0);for(var n=0,e=r.length,i=0;e>i;i++)n+=r[i]*Math.log(r[i]+t);return-n}function k(r,t){for(var n=0,e=r.length,i=0;e>i;i++)n+=r[i]*t[i];return n}function A(r,t){return Math.sqrt(S(r,t))}function S(r,t){for(var n=k(r,t),e=0,i=r.length,o=0,s=0,a=0;i>a;a++){var u=r[a]-n,c=t[a];e+=c*u*u,s+=c,o+=c*c}return e*(s/(s*s-o))}function j(r,t){"undefined"==typeof t&&(t=!1);var n=r;t||(n=r.slice());for(var e=o(n),i=n.length,s=0;i>s;s++)n[s]-=e}function R(r,t,n){"undefined"==typeof t&&(t=h(r)),"undefined"==typeof n&&(n=!1);for(var e=r.length,i=n?r:new Array(e),o=0;e>o;o++)i[o]=r[o]/t;return i}function T(r){var t=r.length,n=new Array(t);n[0]=r[0];for(var e=1;t>e;e++)n[e]=n[e-1]+r[e];return n}t.exports={min:e,max:n,minMax:i,mean:o,geometricMean:s,logGeometricMean:a,grandMean:u,truncatedMean:c,contraHarmonicMean:f,standardDeviation:h,standardError:l,median:m,quartiles:p,variance:d,pooledStandardDeviation:g,pooledVariance:v,mode:y,covariance:w,skewness:x,kurtosis:b,entropy:M,weightedMean:k,weightedStandardDeviation:A,weightedVariance:S,center:j,standardize:R,cumulativeSum:T}},{}],149:[function(r,t,n){n.array=r("./array"),n.matrix=r("./matrix")},{"./array":148,"./matrix":150}],150:[function(r,t){"use strict";function n(r,t){"undefined"==typeof t&&(t=0);for(var n=0,e=r.length,i=r[0].length,o=0;e>o;o++)for(var s=0;i>s;s++)n+=r[o][s]*Math.log(r[o][s]+t);return-n}function e(r,t){"undefined"==typeof t&&(t=0);var n,e,i,o,s=r.length,a=r[0].length;if(-1===t){for(n=[0],e=s*a,i=0;s>i;i++)for(o=0;a>o;o++)n[0]+=r[i][o];n[0]/=e}else if(0===t)for(n=new Array(a),e=s,o=0;a>o;o++){for(n[o]=0,i=0;s>i;i++)n[o]+=r[i][o];n[o]/=e}else{if(1!==t)throw new Error("Invalid dimension");for(n=new Array(s),e=a,o=0;s>o;o++){for(n[o]=0,i=0;a>i;i++)n[o]+=r[o][i];n[o]/=e}}return n}function i(r,t,n){for(var e=o(r,t,n),i=e.length,s=0;i>s;s++)e[s]=Math.sqrt(e[s]);return e}function o(r,t,n){"undefined"==typeof n&&(n=!0),t=t||e(r);var i=r.length;if(0===i)return[];for(var o=r[0].length,s=new Array(o),a=0;o>a;a++){for(var u=0,c=0,f=0,h=0;i>h;h++)f=r[h][a]-t[a],u+=f,c+=f*f;s[a]=n?(c-u*u/i)/(i-1):(c-u*u/i)/i}return s}function s(r){for(var t=r.length,n=r[0].length,e=new Array(n),i=0;n>i;i++){for(var o=new Array(t),s=0;t>s;s++)o[s]=r[s][i];o.sort();var a=o.length;e[i]=a%2===0?.5*(o[a/2]+o[a/2-1]):o[Math.floor(a/2)]}return e}function a(r){var t,n,e=r.length,i=r[0].length,o=new Array(i);for(t=0;i>t;t++){for(var s=new Array(e),a=0;e>a;a++)s[a]=0;var u=new Array(e),c=0;for(n=0;e>n;n++){var f=u.indexOf(r[n][t]);f>=0?s[f]++:(u[c]=r[n][t],s[c]=1,c++)}var h=0,l=0;for(n=0;c>n;n++)s[n]>h&&(h=s[n],l=n);o[t]=u[l]}return o}function u(r,t){"undefined"==typeof t&&(t=!0);for(var n=e(r),i=r.length,o=n.length,s=new Array(o),a=0;o>a;a++){for(var u=0,c=0,f=0;i>f;f++){var h=r[f][a]-n[a];u+=h*h,c+=h*h*h}var l=u/i,m=c/i,p=m/Math.pow(l,1.5);if(t){var d=Math.sqrt(i*(i-1)),g=i-2;s[a]=d/g*p}else s[a]=p}return s}function c(r,t){"undefined"==typeof t&&(t=!0);for(var n=e(r),i=r.length,o=r[0].length,s=new Array(o),a=0;o>a;a++){for(var u=0,c=0,f=0;i>f;f++){var h=r[f][a]-n[a];u+=h*h,c+=h*h*h*h}var l=u/i,m=c/i;if(t){var p=u/(i-1),d=i*(i+1)/((i-1)*(i-2)*(i-3)),g=c/(p*p),v=(i-1)*(i-1)/((i-2)*(i-3));s[a]=d*g-3*v}else s[a]=m/(l*l)-3}return s}function f(r){for(var t=r.length,n=i(r),e=n.length,o=new Array(e),s=Math.sqrt(t),a=0;e>a;a++)o[a]=n[a]/s;return o}function h(r,t){return l(r,void 0,t)}function l(r,t,n){"undefined"==typeof n&&(n=0),"undefined"==typeof t&&(0===n?t=r.length-1:1===n&&(t=r[0].length-1));var i=e(r,n),o=r.length;if(0===o)return[[]];var s,a,u,c,f,h=r[0].length;if(0===n){for(s=new Array(h),a=0;h>a;a++)s[a]=new Array(h);for(a=0;h>a;a++)for(u=a;h>u;u++){for(c=0,f=0;o>f;f++)c+=(r[f][u]-i[u])*(r[f][a]-i[a]);c/=t,s[a][u]=c,s[u][a]=c}}else{if(1!==n)throw new Error("Invalid dimension");for(s=new Array(o),a=0;o>a;a++)s[a]=new Array(o);for(a=0;o>a;a++)for(u=a;o>u;u++){for(c=0,f=0;h>f;f++)c+=(r[u][f]-i[u])*(r[a][f]-i[a]);c/=t,s[a][u]=c,s[u][a]=c}}return s}function m(r){var t,n,o=e(r),s=i(r,!0,o),a=p(r,o,s),u=r.length,c=r[0].length,f=new Array(c);for(t=0;c>t;t++)f[t]=new Array(c);for(t=0;c>t;t++)for(n=t;c>n;n++){for(var h=0,l=0,m=a.length;m>l;l++)h+=a[l][n]*a[l][t];h/=u-1,f[t][n]=h,f[n][t]=h}return f}function p(r,t,n){return t=t||e(r),"undefined"==typeof n&&(n=i(r,!0,t)),g(d(r,t,!1),n,!0)}function d(r,t,n){t=t||e(r);var i,o,s,a=r,u=r.length;if(!n)for(a=new Array(u),i=0;u>i;i++)a[i]=new Array(r[i].length);for(i=0;u>i;i++){var c=a[i];for(o=0,s=c.length;s>o;o++)c[o]=r[i][o]-t[o]}return a}function g(r,t,n){"undefined"==typeof t&&(t=i(r));var e,o,s,a=r,u=r.length;if(!n)for(a=new Array(u),e=0;u>e;e++)a[e]=new Array(r[e].length);for(e=0;u>e;e++){var c=a[e],f=r[e];for(o=0,s=c.length;s>o;o++)0===t[o]||isNaN(t[o])||(c[o]=f[o]/t[o])}return a}function v(r,t){var n=e(r),i=r.length;if(0===i)return[];for(var o=r[0].length,s=new Array(o),a=0;o>a;a++){for(var u=0,c=0,f=0,h=0;i>h;h++){var l=r[h][a]-n[a],m=t[h];u+=m*l*l,f+=m,c+=m*m}s[a]=u*(f/(f*f-c))}return s}function y(r,t,n){"undefined"==typeof n&&(n=0);var e=r.length;if(0===e)return[];var i,o,s,a,u,c,f=r[0].length;if(0===n){for(i=new Array(f),o=0;f>o;o++)i[o]=0;for(o=0;e>o;o++)for(c=r[o],u=t[o],a=0;f>a;a++)i[a]+=c[a]*u}else{if(1!==n)throw new Error("Invalid dimension");for(i=new Array(e),o=0;e>o;o++)i[o]=0;for(a=0;e>a;a++)for(c=r[a],u=t[a],o=0;f>o;o++)i[a]+=c[o]*u}var h=b(t);if(0!==h)for(o=0,s=i.length;s>o;o++)i[o]/=h;return i}function w(r,t,n,e){e=e||0,n=n||y(r,t,e);for(var i=0,o=0,s=0,a=t.length;a>s;s++)i+=t[s],o+=t[s]*t[s];var u=i/(i*i-o);return x(r,t,n,u,e)}function x(r,t,n,e,i){i=i||0,n=n||y(r,t,i),"undefined"==typeof e&&(e=1);var o=r.length;if(0===o)return[[]];var s,a,u,c,f,h=r[0].length;if(0===i){for(s=new Array(h),a=0;h>a;a++)s[a]=new Array(h);for(a=0;h>a;a++)for(u=a;h>u;u++){for(f=0,c=0;o>c;c++)f+=t[c]*(r[c][u]-n[u])*(r[c][a]-n[a]);s[a][u]=f*e,s[u][a]=f*e}}else{if(1!==i)throw new Error("Invalid dimension");for(s=new Array(o),a=0;o>a;a++)s[a]=new Array(o);for(a=0;o>a;a++)for(u=a;o>u;u++){for(f=0,c=0;h>c;c++)f+=t[c]*(r[u][c]-n[u])*(r[a][c]-n[a]);s[a][u]=f*e,s[u][a]=f*e}}return s}function b(r){for(var t=0,n=r.length,e=0;n>e;e++)t+=r[e];return t}t.exports={entropy:n,mean:e,standardDeviation:i,variance:o,median:s,mode:a,skewness:u,kurtosis:c,standardError:f,covariance:h,scatter:l,correlation:m,zScores:p,center:d,standardize:g,weightedVariance:v,weightedMean:y,weightedCovariance:w,weightedScatter:x}},{}],151:[function(r,t,n){t.exports=n=r("./svm"),n.kernel=r("./kernel").kernel},{"./kernel":152,"./svm":153}],152:[function(r,t){"use strict";function n(r,t,n,e){return i(n)(r,t,e)}function e(r,t){for(var n=r.length,e=0,i=0;n>i;i++)e+=r[i]*t[i];return e}function i(r){switch(r="undefined"==typeof r?"lineal":r){case"lineal":return o;case"polynomial":return s;case"radial":return a;default:throw new TypeError("Function kernel undefined: "+r)}}function o(r,t){return e(r,t)}function s(r,t,n){return n="undefined"==typeof n?2:n,Math.pow(e(r,t)+1,n)}function a(r,t,n){n="undefined"==typeof n?2:n;for(var i=r.length,o=new Array(i),s=0;i>s;s++)o[s]=r[s]-t[s];var a=e(o,o);return Math.exp(a/(-2*n*n))}t.exports={kernel:n,getKernel:i,lineal:o,polynomial:s,radial:a}},{}],153:[function(r,t){"use strict";function n(r,t,n,e,i,o,s){for(var a=t.length,u=i,c=0;a>c;c++)i+=e[c]*n[c]*o(t[c],r,s);return u}function e(r){r=r||{},this.options={};for(var t in o)this.options[t]=r.hasOwnProperty(t)?r[t]:o[t];this.kernel=i(this.options.k),this.b=0}var i=(r("./kernel").kernel,r("./kernel").getKernel),o={C:10,tol:.1,max_passes:100,par:2,k:"lineal"};e.prototype.train=function(r,t){for(var e=t.length,i=new Array(e),o=0;e>o;o++)i[o]=0;if(r.length!==e)throw new TypeError("Arrays should have the same length");for(var s=0,a=0,u=0,c=0,f=0,h=0,l=0,m=0,p=0,d=0,g=0;c<this.options.max_passes;){for(var v=0,y=0;e>y;y++)if(f=n(r[y],r,t,i,s,this.kernel,this.options.par)-t[y],t[y]*f<-this.options.tol&&i[y]<this.options.C||t[y]*f>this.options.tol&&i[y]>0){var w=0;do w=Math.ceil(Math.random()*(e-1));while(w===y);h=n(r[w],r,t,i,s,this.kernel,this.options.par)-t[w],l=i[y],m=i[w],t[y]===t[w]?(p=Math.max(0,l+m-this.options.C),d=Math.min(this.options.C,l+m)):(p=Math.max(0,l-m),d=Math.min(this.options.C,this.options.C-l+m)),p!==d&&(g=2*this.kernel(r[y],r[w],this.options.par)-this.kernel(r[y],r[y],this.options.par)-this.kernel(r[w],r[w],this.options.par),0>g&&(i[w]=i[w]-t[w]*(f-h)/g,i[w]>d?i[w]=d:i[w]<p&&(i[w]=p),Math.abs(m-i[w])>=1e-4&&(i[y]=i[y]+t[y]*t[w]*(m-i[w]),a=s-f-t[y]*(i[y]-l)*this.kernel(r[y],r[y],this.options.par)-t[w]*(i[w]-m)*this.kernel(r[y],r[w],this.options.par),u=s-h-t[y]*(i[y]-l)*this.kernel(r[y],r[w],this.options.par)-t[w]*(i[w]-m)*this.kernel(r[w],r[w],this.options.par),s=i[y]<this.options.C&&i[y]>0?a:i[w]<this.options.C&&i[w]>0?u:(a+u)/2,v+=1)))
}0==v?c+=1:c=0}this.b=s;var x=r[0].length;this.W=new Array(x);for(var b=0;x>b;b++){this.W[b]=0;for(var M=0;e>M;M++)this.W[b]+=t[M]*i[M]*r[M][b]}this.alphas=i.splice()},e.load=function(r){if("SVM"===r.name){var t=new e(r.options);return t.W=r.W.slice(),t.b=r.b,t}throw new TypeError("expecting a SVM model")},e.prototype["export"]=function(){var r={name:"SVM"};return r.options=this.options,r.W=this.W,r.b=this.b,r},e.prototype.getAlphas=function(){return this.alphas.slice()},e.prototype.getThreshold=function(){return this.b},e.prototype.predict=function(r){var t;if(Array.isArray(r)&&(Array.isArray(r[0])||"object"==typeof r[0])){for(var n=new Array(r.length),e=0;e<n.length;e++){t=this.b;for(var i=0;i<this.W.length;i++)t+=this.W[i]*r[i];n[e]=0>t?-1:1}return n}t=this.b;for(var o=0;o<this.W.length;o++)t+=this.W[o]*r[o];return 0>t?-1:1},t.exports=e},{"./kernel":152}],154:[function(r,t,n){"use strict";function e(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function i(r,t){r>>>=0,t>>>=0;var n=65535&r,e=r-n;return(e*t>>>0)+n*t>>>0}function o(r){0===r.state[0]&&0===r.state[1]&&0===r.state[2]&&0===r.state[3]&&(r.state[0]=88,r.state[1]=83,r.state[2]=65,r.state[3]=68)}function s(r){var t=r.state[0];t^=t<<h,t^=t>>>l,t^=r.state[3]<<m,r.state[0]=r.state[1],r.state[1]=r.state[2],r.state[2]=r.state[3],r.state[3]=t}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function r(r,t){for(var n=0;n<t.length;n++){var e=t[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(r,e.key,e)}}return function(t,n,e){return n&&r(t.prototype,n),e&&r(t,e),t}}(),u=8,c=1/16777216,f=function(){function r(){var t=arguments.length<=0||void 0===arguments[0]?Date.now():arguments[0];e(this,r),this.state=new Uint32Array(4),this.init(t)}return a(r,[{key:"init",value:function(r){this.state[0]=r,this.state[1]=0,this.state[2]=0,this.state[3]=0;for(var t=1;u>t;t++)this.state[3&t]^=t+i(1812433253,this.state[t-1&3]^this.state[t-1&3]>>>30>>>0)>>>0;o(this);for(var t=0;u>t;t++)s(this)}},{key:"getUint32",value:function(){return s(this),this.state[3]+this.state[2]>>>0}},{key:"getFloat",value:function(){return(this.getUint32()>>>8)*c}},{key:"random",get:function(){return this._random||(this._random=this.getFloat.bind(this)),this._random}}]),r}();n["default"]=f;var h=15,l=18,m=11;t.exports=n["default"]},{}]},{},[1])(1)});
//# sourceMappingURL=ml.min.js.map